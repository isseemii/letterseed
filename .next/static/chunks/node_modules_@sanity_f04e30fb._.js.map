{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/ui/node_modules/react-compiler-runtime/src/index.ts"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport * as React from 'react';\n\nconst {useRef, useEffect, isValidElement} = React;\nconst ReactSecretInternals =\n  //@ts-ignore\n  React.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE ??\n  //@ts-ignore\n  React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n\ntype MemoCache = Array<number | typeof $empty>;\n\nconst $empty = Symbol.for('react.memo_cache_sentinel');\n\n// Re-export React.c if present, otherwise fallback to the userspace polyfill for versions of React\n// < 19.\nexport const c =\n  // @ts-expect-error\n  typeof React.__COMPILER_RUNTIME?.c === 'function'\n    ? // @ts-expect-error\n      React.__COMPILER_RUNTIME.c\n    : function c(size: number) {\n        return React.useMemo<Array<unknown>>(() => {\n          const $ = new Array(size);\n          for (let ii = 0; ii < size; ii++) {\n            $[ii] = $empty;\n          }\n          // This symbol is added to tell the react devtools that this array is from\n          // useMemoCache.\n          // @ts-ignore\n          $[$empty] = true;\n          return $;\n        }, []);\n      };\n\nconst LazyGuardDispatcher: {[key: string]: (...args: Array<any>) => any} = {};\n[\n  'readContext',\n  'useCallback',\n  'useContext',\n  'useEffect',\n  'useImperativeHandle',\n  'useInsertionEffect',\n  'useLayoutEffect',\n  'useMemo',\n  'useReducer',\n  'useRef',\n  'useState',\n  'useDebugValue',\n  'useDeferredValue',\n  'useTransition',\n  'useMutableSource',\n  'useSyncExternalStore',\n  'useId',\n  'unstable_isNewReconciler',\n  'getCacheSignal',\n  'getCacheForType',\n  'useCacheRefresh',\n].forEach(name => {\n  LazyGuardDispatcher[name] = () => {\n    throw new Error(\n      `[React] Unexpected React hook call (${name}) from a React compiled function. ` +\n        \"Check that all hooks are called directly and named according to convention ('use[A-Z]') \",\n    );\n  };\n});\n\nlet originalDispatcher: unknown = null;\n\n// Allow guards are not emitted for useMemoCache\nLazyGuardDispatcher['useMemoCache'] = (count: number) => {\n  if (originalDispatcher == null) {\n    throw new Error(\n      'React Compiler internal invariant violation: unexpected null dispatcher',\n    );\n  } else {\n    return (originalDispatcher as any).useMemoCache(count);\n  }\n};\n\nenum GuardKind {\n  PushGuardContext = 0,\n  PopGuardContext = 1,\n  PushExpectHook = 2,\n  PopExpectHook = 3,\n}\n\nfunction setCurrent(newDispatcher: any) {\n  ReactSecretInternals.ReactCurrentDispatcher.current = newDispatcher;\n  return ReactSecretInternals.ReactCurrentDispatcher.current;\n}\n\nconst guardFrames: Array<unknown> = [];\n\n/**\n * When `enableEmitHookGuards` is set, this does runtime validation\n * of the no-conditional-hook-calls rule.\n * As React Compiler needs to statically understand which calls to move out of\n * conditional branches (i.e. React Compiler cannot memoize the results of hook\n * calls), its understanding of \"the rules of React\" are more restrictive.\n * This validation throws on unsound inputs at runtime.\n *\n * Components should only be invoked through React as React Compiler could memoize\n * the call to AnotherComponent, introducing conditional hook calls in its\n * compiled output.\n * ```js\n * function Invalid(props) {\n *  const myJsx = AnotherComponent(props);\n *  return <div> { myJsx } </div>;\n * }\n *\n * Hooks must be named as hooks.\n * ```js\n * const renamedHook = useState;\n * function Invalid() {\n *   const [state, setState] = renamedHook(0);\n * }\n * ```\n *\n * Hooks must be directly called.\n * ```\n * function call(fn) {\n *  return fn();\n * }\n * function Invalid() {\n *   const result = call(useMyHook);\n * }\n * ```\n */\nexport function $dispatcherGuard(kind: GuardKind) {\n  const curr = ReactSecretInternals.ReactCurrentDispatcher.current;\n  if (kind === GuardKind.PushGuardContext) {\n    // Push before checking invariant or errors\n    guardFrames.push(curr);\n\n    if (guardFrames.length === 1) {\n      // save if we're the first guard on the stack\n      originalDispatcher = curr;\n    }\n\n    if (curr === LazyGuardDispatcher) {\n      throw new Error(\n        `[React] Unexpected call to custom hook or component from a React compiled function. ` +\n          \"Check that (1) all hooks are called directly and named according to convention ('use[A-Z]') \" +\n          'and (2) components are returned as JSX instead of being directly invoked.',\n      );\n    }\n    setCurrent(LazyGuardDispatcher);\n  } else if (kind === GuardKind.PopGuardContext) {\n    // Pop before checking invariant or errors\n    const lastFrame = guardFrames.pop();\n\n    if (lastFrame == null) {\n      throw new Error(\n        'React Compiler internal error: unexpected null in guard stack',\n      );\n    }\n    if (guardFrames.length === 0) {\n      originalDispatcher = null;\n    }\n    setCurrent(lastFrame);\n  } else if (kind === GuardKind.PushExpectHook) {\n    // ExpectHooks could be nested, so we save the current dispatcher\n    // for the matching PopExpectHook to restore.\n    guardFrames.push(curr);\n    setCurrent(originalDispatcher);\n  } else if (kind === GuardKind.PopExpectHook) {\n    const lastFrame = guardFrames.pop();\n    if (lastFrame == null) {\n      throw new Error(\n        'React Compiler internal error: unexpected null in guard stack',\n      );\n    }\n    setCurrent(lastFrame);\n  } else {\n    throw new Error('React Compiler internal error: unreachable block' + kind);\n  }\n}\n\nexport function $reset($: MemoCache) {\n  for (let ii = 0; ii < $.length; ii++) {\n    $[ii] = $empty;\n  }\n}\n\nexport function $makeReadOnly() {\n  throw new Error('TODO: implement $makeReadOnly in react-compiler-runtime');\n}\n\n/**\n * Instrumentation to count rerenders in React components\n */\nexport const renderCounterRegistry: Map<\n  string,\n  Set<{count: number}>\n> = new Map();\nexport function clearRenderCounterRegistry() {\n  for (const counters of renderCounterRegistry.values()) {\n    counters.forEach(counter => {\n      counter.count = 0;\n    });\n  }\n}\n\nfunction registerRenderCounter(name: string, val: {count: number}) {\n  let counters = renderCounterRegistry.get(name);\n  if (counters == null) {\n    counters = new Set();\n    renderCounterRegistry.set(name, counters);\n  }\n  counters.add(val);\n}\n\nfunction removeRenderCounter(name: string, val: {count: number}): void {\n  const counters = renderCounterRegistry.get(name);\n  if (counters == null) {\n    return;\n  }\n  counters.delete(val);\n}\n\nexport function useRenderCounter(name: string): void {\n  const val = useRef<{count: number}>(null);\n\n  if (val.current != null) {\n    val.current.count += 1;\n  }\n  useEffect(() => {\n    // Not counting initial render shouldn't be a problem\n    if (val.current == null) {\n      const counter = {count: 0};\n      registerRenderCounter(name, counter);\n      // @ts-ignore\n      val.current = counter;\n    }\n    return () => {\n      if (val.current !== null) {\n        removeRenderCounter(name, val.current);\n      }\n    };\n  });\n}\n\nconst seenErrors = new Set();\n\nexport function $structuralCheck(\n  oldValue: any,\n  newValue: any,\n  variableName: string,\n  fnName: string,\n  kind: string,\n  loc: string,\n): void {\n  function error(l: string, r: string, path: string, depth: number) {\n    const str = `${fnName}:${loc} [${kind}] ${variableName}${path} changed from ${l} to ${r} at depth ${depth}`;\n    if (seenErrors.has(str)) {\n      return;\n    }\n    seenErrors.add(str);\n    console.error(str);\n  }\n  const depthLimit = 2;\n  function recur(oldValue: any, newValue: any, path: string, depth: number) {\n    if (depth > depthLimit) {\n      return;\n    } else if (oldValue === newValue) {\n      return;\n    } else if (typeof oldValue !== typeof newValue) {\n      error(`type ${typeof oldValue}`, `type ${typeof newValue}`, path, depth);\n    } else if (typeof oldValue === 'object') {\n      const oldArray = Array.isArray(oldValue);\n      const newArray = Array.isArray(newValue);\n      if (oldValue === null && newValue !== null) {\n        error('null', `type ${typeof newValue}`, path, depth);\n      } else if (newValue === null) {\n        error(`type ${typeof oldValue}`, 'null', path, depth);\n      } else if (oldValue instanceof Map) {\n        if (!(newValue instanceof Map)) {\n          error(`Map instance`, `other value`, path, depth);\n        } else if (oldValue.size !== newValue.size) {\n          error(\n            `Map instance with size ${oldValue.size}`,\n            `Map instance with size ${newValue.size}`,\n            path,\n            depth,\n          );\n        } else {\n          for (const [k, v] of oldValue) {\n            if (!newValue.has(k)) {\n              error(\n                `Map instance with key ${k}`,\n                `Map instance without key ${k}`,\n                path,\n                depth,\n              );\n            } else {\n              recur(v, newValue.get(k), `${path}.get(${k})`, depth + 1);\n            }\n          }\n        }\n      } else if (newValue instanceof Map) {\n        error('other value', `Map instance`, path, depth);\n      } else if (oldValue instanceof Set) {\n        if (!(newValue instanceof Set)) {\n          error(`Set instance`, `other value`, path, depth);\n        } else if (oldValue.size !== newValue.size) {\n          error(\n            `Set instance with size ${oldValue.size}`,\n            `Set instance with size ${newValue.size}`,\n            path,\n            depth,\n          );\n        } else {\n          for (const v of newValue) {\n            if (!oldValue.has(v)) {\n              error(\n                `Set instance without element ${v}`,\n                `Set instance with element ${v}`,\n                path,\n                depth,\n              );\n            }\n          }\n        }\n      } else if (newValue instanceof Set) {\n        error('other value', `Set instance`, path, depth);\n      } else if (oldArray || newArray) {\n        if (oldArray !== newArray) {\n          error(\n            `type ${oldArray ? 'array' : 'object'}`,\n            `type ${newArray ? 'array' : 'object'}`,\n            path,\n            depth,\n          );\n        } else if (oldValue.length !== newValue.length) {\n          error(\n            `array with length ${oldValue.length}`,\n            `array with length ${newValue.length}`,\n            path,\n            depth,\n          );\n        } else {\n          for (let ii = 0; ii < oldValue.length; ii++) {\n            recur(oldValue[ii], newValue[ii], `${path}[${ii}]`, depth + 1);\n          }\n        }\n      } else if (isValidElement(oldValue) || isValidElement(newValue)) {\n        if (isValidElement(oldValue) !== isValidElement(newValue)) {\n          error(\n            `type ${isValidElement(oldValue) ? 'React element' : 'object'}`,\n            `type ${isValidElement(newValue) ? 'React element' : 'object'}`,\n            path,\n            depth,\n          );\n        } else if (oldValue.type !== newValue.type) {\n          error(\n            `React element of type ${oldValue.type}`,\n            `React element of type ${newValue.type}`,\n            path,\n            depth,\n          );\n        } else {\n          recur(\n            oldValue.props,\n            newValue.props,\n            `[props of ${path}]`,\n            depth + 1,\n          );\n        }\n      } else {\n        for (const key in newValue) {\n          if (!(key in oldValue)) {\n            error(\n              `object without key ${key}`,\n              `object with key ${key}`,\n              path,\n              depth,\n            );\n          }\n        }\n        for (const key in oldValue) {\n          if (!(key in newValue)) {\n            error(\n              `object with key ${key}`,\n              `object without key ${key}`,\n              path,\n              depth,\n            );\n          } else {\n            recur(oldValue[key], newValue[key], `${path}.${key}`, depth + 1);\n          }\n        }\n      }\n    } else if (typeof oldValue === 'function') {\n      // Bail on functions for now\n      return;\n    } else if (isNaN(oldValue) || isNaN(newValue)) {\n      if (isNaN(oldValue) !== isNaN(newValue)) {\n        error(\n          `${isNaN(oldValue) ? 'NaN' : 'non-NaN value'}`,\n          `${isNaN(newValue) ? 'NaN' : 'non-NaN value'}`,\n          path,\n          depth,\n        );\n      }\n    } else if (oldValue !== newValue) {\n      error(oldValue, newValue, path, depth);\n    }\n  }\n  recur(oldValue, newValue, '', 0);\n}\n"],"names":["_a","c","oldValue","newValue"],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 329, "column": 0}, "map": {"version":3,"sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/insert-menu/node_modules/react-compiler-runtime/src/index.ts"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport * as React from 'react';\n\nconst {useRef, useEffect, isValidElement} = React;\nconst ReactSecretInternals =\n  //@ts-ignore\n  React.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE ??\n  //@ts-ignore\n  React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n\ntype MemoCache = Array<number | typeof $empty>;\n\nconst $empty = Symbol.for('react.memo_cache_sentinel');\n\n// Re-export React.c if present, otherwise fallback to the userspace polyfill for versions of React\n// < 19.\nexport const c =\n  // @ts-expect-error\n  typeof React.__COMPILER_RUNTIME?.c === 'function'\n    ? // @ts-expect-error\n      React.__COMPILER_RUNTIME.c\n    : function c(size: number) {\n        return React.useMemo<Array<unknown>>(() => {\n          const $ = new Array(size);\n          for (let ii = 0; ii < size; ii++) {\n            $[ii] = $empty;\n          }\n          // This symbol is added to tell the react devtools that this array is from\n          // useMemoCache.\n          // @ts-ignore\n          $[$empty] = true;\n          return $;\n        }, []);\n      };\n\nconst LazyGuardDispatcher: {[key: string]: (...args: Array<any>) => any} = {};\n[\n  'readContext',\n  'useCallback',\n  'useContext',\n  'useEffect',\n  'useImperativeHandle',\n  'useInsertionEffect',\n  'useLayoutEffect',\n  'useMemo',\n  'useReducer',\n  'useRef',\n  'useState',\n  'useDebugValue',\n  'useDeferredValue',\n  'useTransition',\n  'useMutableSource',\n  'useSyncExternalStore',\n  'useId',\n  'unstable_isNewReconciler',\n  'getCacheSignal',\n  'getCacheForType',\n  'useCacheRefresh',\n].forEach(name => {\n  LazyGuardDispatcher[name] = () => {\n    throw new Error(\n      `[React] Unexpected React hook call (${name}) from a React compiled function. ` +\n        \"Check that all hooks are called directly and named according to convention ('use[A-Z]') \",\n    );\n  };\n});\n\nlet originalDispatcher: unknown = null;\n\n// Allow guards are not emitted for useMemoCache\nLazyGuardDispatcher['useMemoCache'] = (count: number) => {\n  if (originalDispatcher == null) {\n    throw new Error(\n      'React Compiler internal invariant violation: unexpected null dispatcher',\n    );\n  } else {\n    return (originalDispatcher as any).useMemoCache(count);\n  }\n};\n\nenum GuardKind {\n  PushGuardContext = 0,\n  PopGuardContext = 1,\n  PushExpectHook = 2,\n  PopExpectHook = 3,\n}\n\nfunction setCurrent(newDispatcher: any) {\n  ReactSecretInternals.ReactCurrentDispatcher.current = newDispatcher;\n  return ReactSecretInternals.ReactCurrentDispatcher.current;\n}\n\nconst guardFrames: Array<unknown> = [];\n\n/**\n * When `enableEmitHookGuards` is set, this does runtime validation\n * of the no-conditional-hook-calls rule.\n * As React Compiler needs to statically understand which calls to move out of\n * conditional branches (i.e. React Compiler cannot memoize the results of hook\n * calls), its understanding of \"the rules of React\" are more restrictive.\n * This validation throws on unsound inputs at runtime.\n *\n * Components should only be invoked through React as React Compiler could memoize\n * the call to AnotherComponent, introducing conditional hook calls in its\n * compiled output.\n * ```js\n * function Invalid(props) {\n *  const myJsx = AnotherComponent(props);\n *  return <div> { myJsx } </div>;\n * }\n *\n * Hooks must be named as hooks.\n * ```js\n * const renamedHook = useState;\n * function Invalid() {\n *   const [state, setState] = renamedHook(0);\n * }\n * ```\n *\n * Hooks must be directly called.\n * ```\n * function call(fn) {\n *  return fn();\n * }\n * function Invalid() {\n *   const result = call(useMyHook);\n * }\n * ```\n */\nexport function $dispatcherGuard(kind: GuardKind) {\n  const curr = ReactSecretInternals.ReactCurrentDispatcher.current;\n  if (kind === GuardKind.PushGuardContext) {\n    // Push before checking invariant or errors\n    guardFrames.push(curr);\n\n    if (guardFrames.length === 1) {\n      // save if we're the first guard on the stack\n      originalDispatcher = curr;\n    }\n\n    if (curr === LazyGuardDispatcher) {\n      throw new Error(\n        `[React] Unexpected call to custom hook or component from a React compiled function. ` +\n          \"Check that (1) all hooks are called directly and named according to convention ('use[A-Z]') \" +\n          'and (2) components are returned as JSX instead of being directly invoked.',\n      );\n    }\n    setCurrent(LazyGuardDispatcher);\n  } else if (kind === GuardKind.PopGuardContext) {\n    // Pop before checking invariant or errors\n    const lastFrame = guardFrames.pop();\n\n    if (lastFrame == null) {\n      throw new Error(\n        'React Compiler internal error: unexpected null in guard stack',\n      );\n    }\n    if (guardFrames.length === 0) {\n      originalDispatcher = null;\n    }\n    setCurrent(lastFrame);\n  } else if (kind === GuardKind.PushExpectHook) {\n    // ExpectHooks could be nested, so we save the current dispatcher\n    // for the matching PopExpectHook to restore.\n    guardFrames.push(curr);\n    setCurrent(originalDispatcher);\n  } else if (kind === GuardKind.PopExpectHook) {\n    const lastFrame = guardFrames.pop();\n    if (lastFrame == null) {\n      throw new Error(\n        'React Compiler internal error: unexpected null in guard stack',\n      );\n    }\n    setCurrent(lastFrame);\n  } else {\n    throw new Error('React Compiler internal error: unreachable block' + kind);\n  }\n}\n\nexport function $reset($: MemoCache) {\n  for (let ii = 0; ii < $.length; ii++) {\n    $[ii] = $empty;\n  }\n}\n\nexport function $makeReadOnly() {\n  throw new Error('TODO: implement $makeReadOnly in react-compiler-runtime');\n}\n\n/**\n * Instrumentation to count rerenders in React components\n */\nexport const renderCounterRegistry: Map<\n  string,\n  Set<{count: number}>\n> = new Map();\nexport function clearRenderCounterRegistry() {\n  for (const counters of renderCounterRegistry.values()) {\n    counters.forEach(counter => {\n      counter.count = 0;\n    });\n  }\n}\n\nfunction registerRenderCounter(name: string, val: {count: number}) {\n  let counters = renderCounterRegistry.get(name);\n  if (counters == null) {\n    counters = new Set();\n    renderCounterRegistry.set(name, counters);\n  }\n  counters.add(val);\n}\n\nfunction removeRenderCounter(name: string, val: {count: number}): void {\n  const counters = renderCounterRegistry.get(name);\n  if (counters == null) {\n    return;\n  }\n  counters.delete(val);\n}\n\nexport function useRenderCounter(name: string): void {\n  const val = useRef<{count: number}>(null);\n\n  if (val.current != null) {\n    val.current.count += 1;\n  }\n  useEffect(() => {\n    // Not counting initial render shouldn't be a problem\n    if (val.current == null) {\n      const counter = {count: 0};\n      registerRenderCounter(name, counter);\n      // @ts-ignore\n      val.current = counter;\n    }\n    return () => {\n      if (val.current !== null) {\n        removeRenderCounter(name, val.current);\n      }\n    };\n  });\n}\n\nconst seenErrors = new Set();\n\nexport function $structuralCheck(\n  oldValue: any,\n  newValue: any,\n  variableName: string,\n  fnName: string,\n  kind: string,\n  loc: string,\n): void {\n  function error(l: string, r: string, path: string, depth: number) {\n    const str = `${fnName}:${loc} [${kind}] ${variableName}${path} changed from ${l} to ${r} at depth ${depth}`;\n    if (seenErrors.has(str)) {\n      return;\n    }\n    seenErrors.add(str);\n    console.error(str);\n  }\n  const depthLimit = 2;\n  function recur(oldValue: any, newValue: any, path: string, depth: number) {\n    if (depth > depthLimit) {\n      return;\n    } else if (oldValue === newValue) {\n      return;\n    } else if (typeof oldValue !== typeof newValue) {\n      error(`type ${typeof oldValue}`, `type ${typeof newValue}`, path, depth);\n    } else if (typeof oldValue === 'object') {\n      const oldArray = Array.isArray(oldValue);\n      const newArray = Array.isArray(newValue);\n      if (oldValue === null && newValue !== null) {\n        error('null', `type ${typeof newValue}`, path, depth);\n      } else if (newValue === null) {\n        error(`type ${typeof oldValue}`, 'null', path, depth);\n      } else if (oldValue instanceof Map) {\n        if (!(newValue instanceof Map)) {\n          error(`Map instance`, `other value`, path, depth);\n        } else if (oldValue.size !== newValue.size) {\n          error(\n            `Map instance with size ${oldValue.size}`,\n            `Map instance with size ${newValue.size}`,\n            path,\n            depth,\n          );\n        } else {\n          for (const [k, v] of oldValue) {\n            if (!newValue.has(k)) {\n              error(\n                `Map instance with key ${k}`,\n                `Map instance without key ${k}`,\n                path,\n                depth,\n              );\n            } else {\n              recur(v, newValue.get(k), `${path}.get(${k})`, depth + 1);\n            }\n          }\n        }\n      } else if (newValue instanceof Map) {\n        error('other value', `Map instance`, path, depth);\n      } else if (oldValue instanceof Set) {\n        if (!(newValue instanceof Set)) {\n          error(`Set instance`, `other value`, path, depth);\n        } else if (oldValue.size !== newValue.size) {\n          error(\n            `Set instance with size ${oldValue.size}`,\n            `Set instance with size ${newValue.size}`,\n            path,\n            depth,\n          );\n        } else {\n          for (const v of newValue) {\n            if (!oldValue.has(v)) {\n              error(\n                `Set instance without element ${v}`,\n                `Set instance with element ${v}`,\n                path,\n                depth,\n              );\n            }\n          }\n        }\n      } else if (newValue instanceof Set) {\n        error('other value', `Set instance`, path, depth);\n      } else if (oldArray || newArray) {\n        if (oldArray !== newArray) {\n          error(\n            `type ${oldArray ? 'array' : 'object'}`,\n            `type ${newArray ? 'array' : 'object'}`,\n            path,\n            depth,\n          );\n        } else if (oldValue.length !== newValue.length) {\n          error(\n            `array with length ${oldValue.length}`,\n            `array with length ${newValue.length}`,\n            path,\n            depth,\n          );\n        } else {\n          for (let ii = 0; ii < oldValue.length; ii++) {\n            recur(oldValue[ii], newValue[ii], `${path}[${ii}]`, depth + 1);\n          }\n        }\n      } else if (isValidElement(oldValue) || isValidElement(newValue)) {\n        if (isValidElement(oldValue) !== isValidElement(newValue)) {\n          error(\n            `type ${isValidElement(oldValue) ? 'React element' : 'object'}`,\n            `type ${isValidElement(newValue) ? 'React element' : 'object'}`,\n            path,\n            depth,\n          );\n        } else if (oldValue.type !== newValue.type) {\n          error(\n            `React element of type ${oldValue.type}`,\n            `React element of type ${newValue.type}`,\n            path,\n            depth,\n          );\n        } else {\n          recur(\n            oldValue.props,\n            newValue.props,\n            `[props of ${path}]`,\n            depth + 1,\n          );\n        }\n      } else {\n        for (const key in newValue) {\n          if (!(key in oldValue)) {\n            error(\n              `object without key ${key}`,\n              `object with key ${key}`,\n              path,\n              depth,\n            );\n          }\n        }\n        for (const key in oldValue) {\n          if (!(key in newValue)) {\n            error(\n              `object with key ${key}`,\n              `object without key ${key}`,\n              path,\n              depth,\n            );\n          } else {\n            recur(oldValue[key], newValue[key], `${path}.${key}`, depth + 1);\n          }\n        }\n      }\n    } else if (typeof oldValue === 'function') {\n      // Bail on functions for now\n      return;\n    } else if (isNaN(oldValue) || isNaN(newValue)) {\n      if (isNaN(oldValue) !== isNaN(newValue)) {\n        error(\n          `${isNaN(oldValue) ? 'NaN' : 'non-NaN value'}`,\n          `${isNaN(newValue) ? 'NaN' : 'non-NaN value'}`,\n          path,\n          depth,\n        );\n      }\n    } else if (oldValue !== newValue) {\n      error(oldValue, newValue, path, depth);\n    }\n  }\n  recur(oldValue, newValue, '', 0);\n}\n"],"names":["_a","c","oldValue","newValue"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAA,gBAAA,CAAA;AAAA,SAAA,eAAA;IAAA,kBAAA,IAAA;IAAA,eAAA,IAAA;IAAA,QAAA,IAAA;IAAA,kBAAA,IAAA;IAAA,GAAA,IAAA;IAAA,4BAAA,IAAA;IAAA,uBAAA,IAAA;IAAA,kBAAA,IAAA;AAAA;AAAA,OAAA,OAAA,GAAA,aAAA;AAOA,IAAA,QAAuB;AAEvB,IAAM,EAAC,MAAA,EAAQ,SAAA,EAAW,cAAA,CAAc,CAAA,GAAI;AAT5C,IAAA;AAUA,IAAM,uBAAA,YAAA;AAAA,CAEJ,KAAM,MAAA,+DAAA,KAAN,OAAA,KAEM,MAAA,kDAAA;AAIR,IAAM,SAAS,OAAO,GAAA,CAAI,2BAA2B;AAlBrD,IAAAA;AAsBO,IAAM,IAAA,mBAAA;AAEX,OAAA,CAAA,CAAOA,MAAM,MAAA,kBAAA,KAAN,OAAA,KAAA,IAAAA,IAA0B,CAAA,MAAM,aAAA,mBAAA;AAE7B,MAAA,kBAAA,CAAmB,CAAA,GACzB,SAASC,GAAE,IAAA,EAAc;IACvB,OAAa,MAAA,OAAA;sBAAwB,MAAM;YACzC,MAAM,IAAI,IAAI,MAAM,IAAI;YACxB,IAAA,IAAS,KAAK,GAAG,KAAK,MAAM,KAAM;gBAChC,CAAA,CAAE,EAAE,CAAA,GAAI;YACV;YAIA,CAAA,CAAE,MAAM,CAAA,GAAI;YACZ,OAAO;QACT;qBAAG,CAAC,CAAC;AACP;AAEN,IAAM,sBAAqE,CAAC;AAC5E;IACE;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACF,CAAE,OAAA,CAAQ,CAAA,SAAQ;IAChB,mBAAA,CAAoB,IAAI,CAAA,GAAI,MAAM;QAChC,MAAM,IAAI,MACR,CAAA,oCAAA,EAAuC,IAAI,CAAA,0HAAA,CAAA;IAG/C;AACF,CAAC;AAED,IAAI,qBAA8B;AAGlC,mBAAA,CAAoB,cAAc,CAAA,GAAI,CAAC,UAAkB;IACvD,IAAI,sBAAsB,MAAM;QAC9B,MAAM,IAAI,MACR;IAEJ,OAAO;QACL,OAAQ,mBAA2B,YAAA,CAAa,KAAK;IACvD;AACF;AASA,SAAS,WAAW,aAAA,EAAoB;IACtC,qBAAqB,sBAAA,CAAuB,OAAA,GAAU;IACtD,OAAO,qBAAqB,sBAAA,CAAuB,OAAA;AACrD;AAEA,IAAM,cAA8B,CAAC,CAAA;AAqC9B,SAAS,iBAAiB,IAAA,EAAiB;IAChD,MAAM,OAAO,qBAAqB,sBAAA,CAAuB,OAAA;IACzD,IAAI,SAAS,EAAA,oBAAA,KAA4B;QAEvC,YAAY,IAAA,CAAK,IAAI;QAErB,IAAI,YAAY,MAAA,KAAW,GAAG;YAE5B,qBAAqB;QACvB;QAEA,IAAI,SAAS,qBAAqB;YAChC,MAAM,IAAI,MACR,CAAA,yPAAA,CAAA;QAIJ;QACA,WAAW,mBAAmB;IAChC,OAAA,IAAW,SAAS,EAAA,mBAAA,KAA2B;QAE7C,MAAM,YAAY,YAAY,GAAA,CAAI;QAElC,IAAI,aAAa,MAAM;YACrB,MAAM,IAAI,MACR;QAEJ;QACA,IAAI,YAAY,MAAA,KAAW,GAAG;YAC5B,qBAAqB;QACvB;QACA,WAAW,SAAS;IACtB,OAAA,IAAW,SAAS,EAAA,kBAAA,KAA0B;QAG5C,YAAY,IAAA,CAAK,IAAI;QACrB,WAAW,kBAAkB;IAC/B,OAAA,IAAW,SAAS,EAAA,iBAAA,KAAyB;QAC3C,MAAM,YAAY,YAAY,GAAA,CAAI;QAClC,IAAI,aAAa,MAAM;YACrB,MAAM,IAAI,MACR;QAEJ;QACA,WAAW,SAAS;IACtB,OAAO;QACL,MAAM,IAAI,MAAM,qDAAqD,IAAI;IAC3E;AACF;AAEO,SAAS,OAAO,CAAA,EAAc;IACnC,IAAA,IAAS,KAAK,GAAG,KAAK,EAAE,MAAA,EAAQ,KAAM;QACpC,CAAA,CAAE,EAAE,CAAA,GAAI;IACV;AACF;AAEO,SAAS,gBAAgB;IAC9B,MAAM,IAAI,MAAM,yDAAyD;AAC3E;AAKO,IAAM,wBAGT,aAAA,GAAA,IAAI,IAAI;AACL,SAAS,6BAA6B;IAC3C,KAAA,MAAW,YAAY,sBAAsB,MAAA,CAAO,EAAG;QACrD,SAAS,OAAA,CAAQ,CAAA,YAAW;YAC1B,QAAQ,KAAA,GAAQ;QAClB,CAAC;IACH;AACF;AAEA,SAAS,sBAAsB,IAAA,EAAc,GAAA,EAAsB;IACjE,IAAI,WAAW,sBAAsB,GAAA,CAAI,IAAI;IAC7C,IAAI,YAAY,MAAM;QACpB,WAAW,aAAA,GAAA,IAAI,IAAI;QACnB,sBAAsB,GAAA,CAAI,MAAM,QAAQ;IAC1C;IACA,SAAS,GAAA,CAAI,GAAG;AAClB;AAEA,SAAS,oBAAoB,IAAA,EAAc,GAAA,EAA4B;IACrE,MAAM,WAAW,sBAAsB,GAAA,CAAI,IAAI;IAC/C,IAAI,YAAY,MAAM;QACpB;IACF;IACA,SAAS,MAAA,CAAO,GAAG;AACrB;AAEO,SAAS,iBAAiB,IAAA,EAAoB;IACnD,MAAM,MAAM,OAAwB,IAAI;IAExC,IAAI,IAAI,OAAA,IAAW,MAAM;QACvB,IAAI,OAAA,CAAQ,KAAA,IAAS;IACvB;IACA;sCAAU,MAAM;YAEd,IAAI,IAAI,OAAA,IAAW,MAAM;gBACvB,MAAM,UAAU;oBAAC,OAAO;gBAAC;gBACzB,sBAAsB,MAAM,OAAO;gBAEnC,IAAI,OAAA,GAAU;YAChB;YACA;8CAAO,MAAM;oBACX,IAAI,IAAI,OAAA,KAAY,MAAM;wBACxB,oBAAoB,MAAM,IAAI,OAAO;oBACvC;gBACF;;QACF,CAAC;;AACH;AAEA,IAAM,aAAa,aAAA,GAAA,IAAI,IAAI;AAEpB,SAAS,iBACd,QAAA,EACA,QAAA,EACA,YAAA,EACA,MAAA,EACA,IAAA,EACA,GAAA,EACM;IACN,SAAS,MAAM,CAAA,EAAW,CAAA,EAAW,IAAA,EAAc,KAAA,EAAe;QAChE,MAAM,MAAM,GAAG,MAAM,CAAA,CAAA,EAAI,GAAG,CAAA,EAAA,EAAK,IAAI,CAAA,EAAA,EAAK,YAAY,GAAG,IAAI,CAAA,cAAA,EAAiB,CAAC,CAAA,IAAA,EAAO,CAAC,CAAA,UAAA,EAAa,KAAK,EAAA;QACzG,IAAI,WAAW,GAAA,CAAI,GAAG,GAAG;YACvB;QACF;QACA,WAAW,GAAA,CAAI,GAAG;QAClB,QAAQ,KAAA,CAAM,GAAG;IACnB;IACA,MAAM,aAAa;IACnB,SAAS,MAAMC,SAAAA,EAAeC,SAAAA,EAAe,IAAA,EAAc,KAAA,EAAe;QACxE,IAAI,QAAQ,YAAY;YACtB;QACF,OAAA,IAAWD,cAAaC,WAAU;YAChC;QACF,OAAA,IAAW,OAAOD,cAAa,OAAOC,WAAU;YAC9C,MAAM,CAAA,KAAA,EAAQ,OAAOD,SAAQ,EAAA,EAAI,CAAA,KAAA,EAAQ,OAAOC,SAAQ,EAAA,EAAI,MAAM,KAAK;QACzE,OAAA,IAAW,OAAOD,cAAa,UAAU;YACvC,MAAM,WAAW,MAAM,OAAA,CAAQA,SAAQ;YACvC,MAAM,WAAW,MAAM,OAAA,CAAQC,SAAQ;YACvC,IAAID,cAAa,QAAQC,cAAa,MAAM;gBAC1C,MAAM,QAAQ,CAAA,KAAA,EAAQ,OAAOA,SAAQ,EAAA,EAAI,MAAM,KAAK;YACtD,OAAA,IAAWA,cAAa,MAAM;gBAC5B,MAAM,CAAA,KAAA,EAAQ,OAAOD,SAAQ,EAAA,EAAI,QAAQ,MAAM,KAAK;YACtD,OAAA,IAAWA,qBAAoB,KAAK;gBAClC,IAAI,CAAA,CAAEC,qBAAoB,GAAA,GAAM;oBAC9B,MAAM,CAAA,YAAA,CAAA,EAAgB,CAAA,WAAA,CAAA,EAAe,MAAM,KAAK;gBAClD,OAAA,IAAWD,UAAS,IAAA,KAASC,UAAS,IAAA,EAAM;oBAC1C,MACE,CAAA,uBAAA,EAA0BD,UAAS,IAAI,EAAA,EACvC,CAAA,uBAAA,EAA0BC,UAAS,IAAI,EAAA,EACvC,MACA;gBAEJ,OAAO;oBACL,KAAA,MAAW,CAAC,GAAG,CAAC,CAAA,IAAKD,UAAU;wBAC7B,IAAI,CAACC,UAAS,GAAA,CAAI,CAAC,GAAG;4BACpB,MACE,CAAA,sBAAA,EAAyB,CAAC,EAAA,EAC1B,CAAA,yBAAA,EAA4B,CAAC,EAAA,EAC7B,MACA;wBAEJ,OAAO;4BACL,MAAM,GAAGA,UAAS,GAAA,CAAI,CAAC,GAAG,GAAG,IAAI,CAAA,KAAA,EAAQ,CAAC,CAAA,CAAA,CAAA,EAAK,QAAQ,CAAC;wBAC1D;oBACF;gBACF;YACF,OAAA,IAAWA,qBAAoB,KAAK;gBAClC,MAAM,eAAe,CAAA,YAAA,CAAA,EAAgB,MAAM,KAAK;YAClD,OAAA,IAAWD,qBAAoB,KAAK;gBAClC,IAAI,CAAA,CAAEC,qBAAoB,GAAA,GAAM;oBAC9B,MAAM,CAAA,YAAA,CAAA,EAAgB,CAAA,WAAA,CAAA,EAAe,MAAM,KAAK;gBAClD,OAAA,IAAWD,UAAS,IAAA,KAASC,UAAS,IAAA,EAAM;oBAC1C,MACE,CAAA,uBAAA,EAA0BD,UAAS,IAAI,EAAA,EACvC,CAAA,uBAAA,EAA0BC,UAAS,IAAI,EAAA,EACvC,MACA;gBAEJ,OAAO;oBACL,KAAA,MAAW,KAAKA,UAAU;wBACxB,IAAI,CAACD,UAAS,GAAA,CAAI,CAAC,GAAG;4BACpB,MACE,CAAA,6BAAA,EAAgC,CAAC,EAAA,EACjC,CAAA,0BAAA,EAA6B,CAAC,EAAA,EAC9B,MACA;wBAEJ;oBACF;gBACF;YACF,OAAA,IAAWC,qBAAoB,KAAK;gBAClC,MAAM,eAAe,CAAA,YAAA,CAAA,EAAgB,MAAM,KAAK;YAClD,OAAA,IAAW,YAAY,UAAU;gBAC/B,IAAI,aAAa,UAAU;oBACzB,MACE,CAAA,KAAA,EAAQ,WAAW,UAAU,QAAQ,EAAA,EACrC,CAAA,KAAA,EAAQ,WAAW,UAAU,QAAQ,EAAA,EACrC,MACA;gBAEJ,OAAA,IAAWD,UAAS,MAAA,KAAWC,UAAS,MAAA,EAAQ;oBAC9C,MACE,CAAA,kBAAA,EAAqBD,UAAS,MAAM,EAAA,EACpC,CAAA,kBAAA,EAAqBC,UAAS,MAAM,EAAA,EACpC,MACA;gBAEJ,OAAO;oBACL,IAAA,IAAS,KAAK,GAAG,KAAKD,UAAS,MAAA,EAAQ,KAAM;wBAC3C,MAAMA,SAAAA,CAAS,EAAE,CAAA,EAAGC,SAAAA,CAAS,EAAE,CAAA,EAAG,GAAG,IAAI,CAAA,CAAA,EAAI,EAAE,CAAA,CAAA,CAAA,EAAK,QAAQ,CAAC;oBAC/D;gBACF;YACF,OAAA,IAAW,eAAeD,SAAQ,KAAK,eAAeC,SAAQ,GAAG;gBAC/D,IAAI,eAAeD,SAAQ,MAAM,eAAeC,SAAQ,GAAG;oBACzD,MACE,CAAA,KAAA,EAAQ,eAAeD,SAAQ,IAAI,kBAAkB,QAAQ,EAAA,EAC7D,CAAA,KAAA,EAAQ,eAAeC,SAAQ,IAAI,kBAAkB,QAAQ,EAAA,EAC7D,MACA;gBAEJ,OAAA,IAAWD,UAAS,IAAA,KAASC,UAAS,IAAA,EAAM;oBAC1C,MACE,CAAA,sBAAA,EAAyBD,UAAS,IAAI,EAAA,EACtC,CAAA,sBAAA,EAAyBC,UAAS,IAAI,EAAA,EACtC,MACA;gBAEJ,OAAO;oBACL,MACED,UAAS,KAAA,EACTC,UAAS,KAAA,EACT,CAAA,UAAA,EAAa,IAAI,CAAA,CAAA,CAAA,EACjB,QAAQ;gBAEZ;YACF,OAAO;gBACL,IAAA,MAAW,OAAOA,UAAU;oBAC1B,IAAI,CAAA,CAAE,OAAOD,SAAAA,GAAW;wBACtB,MACE,CAAA,mBAAA,EAAsB,GAAG,EAAA,EACzB,CAAA,gBAAA,EAAmB,GAAG,EAAA,EACtB,MACA;oBAEJ;gBACF;gBACA,IAAA,MAAW,OAAOA,UAAU;oBAC1B,IAAI,CAAA,CAAE,OAAOC,SAAAA,GAAW;wBACtB,MACE,CAAA,gBAAA,EAAmB,GAAG,EAAA,EACtB,CAAA,mBAAA,EAAsB,GAAG,EAAA,EACzB,MACA;oBAEJ,OAAO;wBACL,MAAMD,SAAAA,CAAS,GAAG,CAAA,EAAGC,SAAAA,CAAS,GAAG,CAAA,EAAG,GAAG,IAAI,CAAA,CAAA,EAAI,GAAG,EAAA,EAAI,QAAQ,CAAC;oBACjE;gBACF;YACF;QACF,OAAA,IAAW,OAAOD,cAAa,YAAY;YAEzC;QACF,OAAA,IAAW,MAAMA,SAAQ,KAAK,MAAMC,SAAQ,GAAG;YAC7C,IAAI,MAAMD,SAAQ,MAAM,MAAMC,SAAQ,GAAG;gBACvC,MACE,GAAG,MAAMD,SAAQ,IAAI,QAAQ,eAAe,EAAA,EAC5C,GAAG,MAAMC,SAAQ,IAAI,QAAQ,eAAe,EAAA,EAC5C,MACA;YAEJ;QACF,OAAA,IAAWD,cAAaC,WAAU;YAChC,MAAMD,WAAUC,WAAU,MAAM,KAAK;QACvC;IACF;IACA,MAAM,UAAU,UAAU,IAAI,CAAC;AACjC","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 653, "column": 0}, "map": {"version":3,"file":"index.mjs","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/helpers.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/reference/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/assets/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/crossDatasetReference/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/documents/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/globalDocumentReference/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/markers/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/mediaLibrary/types.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/mediaLibrary/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/mediaLibrary/defineAssetAspect.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/mutations/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/paths/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/portableText/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/schema/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/schema/define.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/search/types.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/search/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/slug/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/transactionLog/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/types/src/validation/asserters.ts"],"sourcesContent":["export function isObject(obj: unknown): obj is Record<string, unknown> {\n  return typeof obj === 'object' && obj !== null && !Array.isArray(obj)\n}\n","import {isObject} from '../helpers'\nimport {type Reference} from './types'\n\n/** @internal */\nexport function isReference(reference: unknown): reference is Reference {\n  return isObject(reference) && typeof reference._ref === 'string'\n}\n","import {isObject} from '../helpers'\nimport {isReference} from '../reference'\nimport {type Image} from './types'\n\n/** @public */\nexport function isImage(value: unknown): value is Image {\n  return isObject(value) && isReference(value.asset) && value.asset._ref.startsWith('image-')\n}\n","import {isObject} from '../helpers'\nimport {type CrossDatasetReferenceValue} from './types'\n\n/** @beta */\nexport function isCrossDatasetReference(\n  reference: unknown,\n): reference is CrossDatasetReferenceValue {\n  return (\n    isObject(reference) &&\n    typeof reference._ref === 'string' &&\n    typeof reference._dataset === 'string' &&\n    typeof reference._projectId === 'string'\n  )\n}\n","import {isObject} from '../helpers'\nimport {type KeyedObject, type SanityDocument, type TypedObject} from './types'\n\n/** @public */\nexport function isSanityDocument(document: unknown): document is SanityDocument {\n  return (\n    isObject(document) && typeof document._id === 'string' && typeof document._type === 'string'\n  )\n}\n\n/** @public */\nexport function isTypedObject(obj: unknown): obj is TypedObject {\n  return isObject(obj) && typeof obj._type === 'string'\n}\n\n/** @public */\nexport function isKeyedObject(obj: unknown): obj is KeyedObject {\n  return isObject(obj) && typeof obj._key === 'string'\n}\n","import {isObject} from '../helpers'\nimport {type GlobalDocumentReferenceValue} from './types'\n\n/** @beta */\nexport function isGlobalDocumentReference(\n  reference: unknown,\n): reference is GlobalDocumentReferenceValue {\n  if (!isObject(reference) || typeof reference._ref !== 'string') {\n    return false\n  }\n\n  return reference._ref.split(':').length === 3\n}\n","import {type ValidationMarker} from './types'\n\n/** @internal */\nexport function isValidationErrorMarker(\n  marker: ValidationMarker,\n): marker is ValidationMarker & {level: 'error'} {\n  return marker.level === 'error'\n}\n\n/** @internal */\nexport function isValidationWarningMarker(\n  marker: ValidationMarker,\n): marker is ValidationMarker & {level: 'warning'} {\n  return marker.level === 'warning'\n}\n\n/** @internal */\nexport function isValidationInfoMarker(\n  marker: ValidationMarker,\n): marker is ValidationMarker & {level: 'info'} {\n  return marker.level === 'info'\n}\n","import {type FileAsset, type ImageAsset} from '../assets/types'\nimport {type SanityDocumentLike} from '../documents/types'\nimport {type FieldDefinition, type IntrinsicTypeName} from '../schema/definition/schemaDefinition'\n\n/**\n * @public\n */\nexport type MediaLibraryAssetAspectSupportedFieldDefinitions = FieldDefinition<\n  Exclude<IntrinsicTypeName, 'document' | 'image' | 'file' | 'reference' | 'crossDatasetReference'>\n>\n\n/**\n * @public\n */\nexport type MediaLibraryAssetAspectDefinition = MediaLibraryAssetAspectSupportedFieldDefinitions & {\n  assetType?: MediaLibraryAssetType | MediaLibraryAssetType[]\n}\n\n/**\n * @public\n */\nexport const MEDIA_LIBRARY_ASSET_ASPECT_TYPE_NAME = 'sanity.asset.aspect'\n\n/**\n * @public\n */\nexport type MediaLibraryAssetAspectTypeName = typeof MEDIA_LIBRARY_ASSET_ASPECT_TYPE_NAME\n\n/**\n * @public\n */\nexport type MediaLibraryAssetType = ImageAsset['_type'] | FileAsset['_type']\n\n/**\n * A document representing a Media Library asset aspect.\n *\n * Each aspect provides a schema describing custom data that can be assigned to assets.\n *\n * @public\n */\nexport interface MediaLibraryAssetAspectDocument extends SanityDocumentLike {\n  _type: MediaLibraryAssetAspectTypeName\n  /**\n   * Asset types the aspect can be assigned to.\n   *\n   * If no `assetType` is defined, the aspect may be assigned to any asset type.\n   */\n  assetType?: MediaLibraryAssetType[]\n  definition: FieldDefinition\n}\n","import {MEDIA_LIBRARY_ASSET_ASPECT_TYPE_NAME, type MediaLibraryAssetAspectDocument} from './types'\n\n/**\n * Check whether the provided value resembles a Media Library asset aspect document.\n *\n * Note: This function does not perform a comprehensive check.\n *\n * @see validateMediaLibraryAssetAspect\n *\n * @internal\n */\nexport function isAssetAspect(\n  maybeAssetAspect: unknown,\n): maybeAssetAspect is MediaLibraryAssetAspectDocument {\n  return (\n    typeof maybeAssetAspect === 'object' &&\n    maybeAssetAspect !== null &&\n    '_type' in maybeAssetAspect &&\n    maybeAssetAspect._type === MEDIA_LIBRARY_ASSET_ASPECT_TYPE_NAME\n  )\n}\n","import {\n  MEDIA_LIBRARY_ASSET_ASPECT_TYPE_NAME,\n  type MediaLibraryAssetAspectDefinition,\n  type MediaLibraryAssetAspectDocument,\n} from './types'\n\n/**\n * Define a Media Library asset aspect.\n *\n * Aspects can be deployed using the `sanity media deploy-aspect` CLI command.\n *\n * @public\n * @beta\n */\nexport function defineAssetAspect(\n  definition: MediaLibraryAssetAspectDefinition,\n): MediaLibraryAssetAspectDocument {\n  const {assetType, name} = definition\n\n  return {\n    _type: MEDIA_LIBRARY_ASSET_ASPECT_TYPE_NAME,\n    _id: `${name}`,\n    definition,\n    ...(assetType && {\n      assetType: Array.isArray(assetType) ? assetType : [assetType],\n    }),\n  }\n}\n","import {type TransactionLogMutation} from '../transactionLog'\nimport {\n  type CreateIfNotExistsMutation,\n  type CreateMutation,\n  type CreateOrReplaceMutation,\n  type DeleteMutation,\n  type Mutation,\n  type PatchMutation,\n} from './types'\n\n/** @internal */\nexport function isCreateMutation(\n  mutation: Mutation | TransactionLogMutation,\n): mutation is CreateMutation {\n  return 'create' in mutation\n}\n\n/** @internal */\nexport function isCreateIfNotExistsMutation(\n  mutation: Mutation | TransactionLogMutation,\n): mutation is CreateIfNotExistsMutation {\n  return 'createIfNotExists' in mutation\n}\n\n/** @internal */\nexport function isCreateOrReplaceMutation(\n  mutation: Mutation | TransactionLogMutation,\n): mutation is CreateOrReplaceMutation {\n  return 'createOrReplace' in mutation\n}\n\n/** @internal */\nexport function isDeleteMutation(\n  mutation: Mutation | TransactionLogMutation,\n): mutation is DeleteMutation {\n  return 'delete' in mutation\n}\n\n/** @internal */\nexport function isPatchMutation(\n  mutation: Mutation | TransactionLogMutation,\n): mutation is PatchMutation {\n  return 'patch' in mutation\n}\n","import {type IndexTuple, type KeyedSegment, type PathSegment} from './types'\n\nconst reKeySegment = /_key\\s*==\\s*['\"](.*)['\"]/\nconst reIndexTuple = /^\\d*:\\d*$/\n\n/** @internal */\nexport function isIndexSegment(segment: PathSegment): segment is number {\n  return typeof segment === 'number' || (typeof segment === 'string' && /^\\[\\d+\\]$/.test(segment))\n}\n\n/** @internal */\nexport function isKeySegment(segment: PathSegment): segment is KeyedSegment {\n  if (typeof segment === 'string') {\n    return reKeySegment.test(segment.trim())\n  }\n\n  return typeof segment === 'object' && '_key' in segment\n}\n\n/** @internal */\nexport function isIndexTuple(segment: PathSegment): segment is IndexTuple {\n  if (typeof segment === 'string' && reIndexTuple.test(segment)) {\n    return true\n  }\n\n  if (!Array.isArray(segment) || segment.length !== 2) {\n    return false\n  }\n\n  const [from, to] = segment\n  return (typeof from === 'number' || from === '') && (typeof to === 'number' || to === '')\n}\n","import {type PortableTextObject, type PortableTextSpan, type PortableTextTextBlock} from './types'\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return !!value && (typeof value == 'object' || typeof value == 'function')\n}\n\n/**\n * Assert that a given object is a portable-text text-block type object\n *\n * @remarks\n * * The `markDefs` and `style` property of a block is optional.\n * * Block types can be named, so expect anything of the _type property.\n *\n * @alpha\n */\nexport function isPortableTextTextBlock<T = PortableTextSpan | PortableTextObject>(\n  value: unknown,\n): value is PortableTextTextBlock<T> {\n  return (\n    isRecord(value) &&\n    typeof value._type === 'string' && // block types can be named, so expect anything here.\n    Array.isArray(value.children) &&\n    value.children.every((child) => isRecord(child)) &&\n    ('markDefs' in value // optional property\n      ? Array.isArray(value.markDefs) && value.markDefs.every((def) => isRecord(def))\n      : true) &&\n    ('style' in value ? typeof value.style === 'string' : true) // optional property\n  )\n}\n\n/**\n * Assert that a given object is a portable-text span-type object\n *\n * @remarks\n * The `marks` property of a block is optional.\n *\n * @alpha\n */\nexport function isPortableTextSpan(value: unknown): value is PortableTextSpan {\n  return (\n    isRecord(value) &&\n    value._type === 'span' &&\n    typeof value.text === 'string' &&\n    ('marks' in value // optional property\n      ? Array.isArray(value.marks) && value.marks.every((mark) => typeof mark === 'string')\n      : true)\n  )\n}\n\n/**\n * Assert that a given object is a portable-text list-text-block-type object\n *\n * @remarks\n * Uses `isPortableTextTextBlock` and checks for `listItem` and `level`\n *\n * @see isPortableTextTextBlock\n *\n * @alpha\n */\nexport function isPortableTextListBlock<T = PortableTextSpan | PortableTextObject>(\n  value: unknown,\n): value is PortableTextTextBlock<T> {\n  return (\n    isPortableTextTextBlock(value) &&\n    'listItem' in value &&\n    typeof value.listItem === 'string' &&\n    'level' in value &&\n    Number.isInteger(value.level)\n  )\n}\n","import {type CrossDatasetReferenceSchemaType} from '../crossDatasetReference'\nimport {type TitledListValue} from './definition'\nimport {\n  type ArraySchemaType,\n  type BaseSchemaType,\n  type BlockChildrenObjectField,\n  type BlockListObjectField,\n  type BlockSchemaType,\n  type BlockStyleObjectField,\n  type BooleanSchemaType,\n  type DeprecatedSchemaType,\n  type DeprecationConfiguration,\n  type FileSchemaType,\n  type ImageSchemaType,\n  type NumberSchemaType,\n  type ObjectSchemaType,\n  type ReferenceSchemaType,\n  type SchemaType,\n  type SpanSchemaType,\n  type StringSchemaType,\n} from './types'\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return !!value && (typeof value == 'object' || typeof value == 'function')\n}\n\n/**\n * Returns wether or not the given type is a document type\n * (eg that it was defined as `type: 'document'`)\n *\n * @param type - Schema type to test\n * @returns True if type is a document type, false otherwise\n *\n * @public\n */\nexport function isDocumentSchemaType(type: unknown): type is ObjectSchemaType {\n  if (!isObjectSchemaType(type)) {\n    return false\n  }\n\n  let current: SchemaType | undefined = type as SchemaType\n  while (current) {\n    if (current.name === 'document') {\n      return true\n    }\n\n    current = current.type\n  }\n  return false\n}\n\n/** @internal */\nexport function isObjectSchemaType(type: unknown): type is ObjectSchemaType {\n  if (!isRecord(type)) return false\n  return type.jsonType === 'object'\n}\n\n/** @internal */\nexport function isArraySchemaType(type: unknown): type is ArraySchemaType {\n  if (!isRecord(type)) return false\n  return type.jsonType === 'array'\n}\n\n/** @internal */\nexport function isArrayOfBlocksSchemaType(\n  type: unknown,\n): type is ArraySchemaType<ObjectSchemaType> {\n  return isArraySchemaType(type) && type.of.some((memberType) => isBlockSchemaType(memberType))\n}\n\n/** @internal */\nexport function isArrayOfObjectsSchemaType(\n  type: unknown,\n): type is ArraySchemaType<ObjectSchemaType> {\n  return isArraySchemaType(type) && type.of.every((memberType) => isObjectSchemaType(memberType))\n}\n\n/** @internal */\nexport function isArrayOfPrimitivesSchemaType(type: unknown): type is ArraySchemaType {\n  return isArraySchemaType(type) && type.of.every((memberType) => isPrimitiveSchemaType(memberType))\n}\n\n/** @internal */\nexport function isBooleanSchemaType(type: unknown): type is BooleanSchemaType {\n  if (!isRecord(type)) return false\n  return type.jsonType === 'boolean'\n}\n\n/** @internal */\nexport function isStringSchemaType(type: unknown): type is StringSchemaType {\n  if (!isRecord(type)) return false\n  return type.jsonType === 'string'\n}\n\n/** @internal */\nexport function isDateTimeSchemaType(type: unknown): type is StringSchemaType {\n  if (!isStringSchemaType(type)) return false\n  return type.name === 'datetime'\n}\n\n/** @internal */\nexport function isNumberSchemaType(type: unknown): type is NumberSchemaType {\n  if (!isRecord(type)) return false\n  return type.jsonType === 'number'\n}\n\n/** @internal */\nexport function isPrimitiveSchemaType(\n  type: unknown,\n): type is BooleanSchemaType | StringSchemaType | NumberSchemaType {\n  return isBooleanSchemaType(type) || isStringSchemaType(type) || isNumberSchemaType(type)\n}\n\n/** @internal */\nexport function isReferenceSchemaType(type: unknown): type is ReferenceSchemaType {\n  return isRecord(type) && (type.name === 'reference' || isReferenceSchemaType(type.type))\n}\n\n/** @internal */\nexport function isImageSchemaType(type: unknown): type is ImageSchemaType {\n  return isRecord(type) && (type.name === 'image' || isImageSchemaType(type.type))\n}\n\n/** @internal */\nexport function isFileSchemaType(type: unknown): type is FileSchemaType {\n  return isRecord(type) && (type.name === 'file' || isFileSchemaType(type.type))\n}\n\n/** @internal */\nexport function isDeprecatedSchemaType<TSchemaType extends BaseSchemaType>(\n  type: TSchemaType,\n): type is DeprecatedSchemaType<TSchemaType> {\n  if (!isRecord(type)) return false\n  return typeof type.deprecated !== 'undefined'\n}\n\n/** @internal */\nexport function isDeprecationConfiguration(type: unknown): type is DeprecationConfiguration {\n  if (!isRecord(type)) return false\n  return typeof type.deprecated !== 'undefined'\n}\n\n/** @internal */\nexport function isCrossDatasetReferenceSchemaType(\n  type: unknown,\n): type is CrossDatasetReferenceSchemaType {\n  return (\n    isRecord(type) &&\n    (type.name === 'crossDatasetReference' || isCrossDatasetReferenceSchemaType(type.type))\n  )\n}\n\n/** @internal */\nexport function isTitledListValue(item: unknown): item is TitledListValue {\n  return typeof item === 'object' && item !== null && 'title' in item && 'value' in item\n}\n\n/** @internal */\nexport function isSpanSchemaType(type: unknown): type is SpanSchemaType {\n  if (!isRecord(type)) return false\n  // we check for `annotations` and `decorators` instead of `type.name` because\n  // schema names can technically change if someone extends the type\n  return Array.isArray(type.annotations) && Array.isArray(type.decorators)\n}\n\n/** @internal */\nexport function isBlockSchemaType(type: unknown): type is BlockSchemaType {\n  if (!isRecord(type)) return false\n  if (!Array.isArray(type.fields)) return false\n  const maybeSpanChildren = type.fields.find(isBlockChildrenObjectField)\n  const maybeStyle = type.fields.find(isBlockStyleObjectField)\n  const maybeList = type.fields.find(isBlockListObjectField)\n  return (\n    isBlockChildrenObjectField(maybeSpanChildren) &&\n    isBlockStyleObjectField(maybeStyle) &&\n    isBlockListObjectField(maybeList)\n  )\n}\n\n/** @internal */\nexport function isBlockStyleObjectField(field: unknown): field is BlockStyleObjectField {\n  if (!isRecord(field)) return false\n  if (field.name !== 'style') return false\n  return isRecord(field.type) && field.type.jsonType === 'string'\n}\n\n/** @internal */\nexport function isBlockListObjectField(field: unknown): field is BlockListObjectField {\n  if (!isRecord(field)) return false\n  if (field.name !== 'listItem') return false\n  return isRecord(field.type) && field.type.jsonType === 'string'\n}\n\n/** @internal */\nexport function isBlockChildrenObjectField(field: unknown): field is BlockChildrenObjectField {\n  if (!isRecord(field)) return false\n  if (field.name !== 'children') return false\n  if (!isArraySchemaType(field.type)) return false\n  // there will always be a span item in `SpanChildrenObjectField`\n  return field.type.of.some(isSpanSchemaType)\n}\n","import {\n  type DefineArrayMemberBase,\n  type DefineSchemaBase,\n  type DefineSchemaOptions,\n  type MaybeAllowUnknownProps,\n  type NarrowPreview,\n  type StrictDefinition,\n  type WidenInitialValue,\n  type WidenValidation,\n} from './defineTypes'\nimport {type FieldDefinitionBase, type IntrinsicTypeName} from './definition'\nimport {type AutocompleteString} from './types'\n\n/**\n * Helper function for defining a Sanity type definition. This function does not do anything on its own;\n * it exists to check that your schema definition is correct, and help autocompletion in your IDE.\n *\n * This function will narrow the schema type down to fields and options based on the provided type-string.\n *\n * Schema types defined using `defineType` should typically be added to the Studio config under `schema.types`.\n * Defined types can be referenced by their `name`. This is referred to as a type-alias.\n *\n * When using type-aliases as `type`, `defineType` cannot know the base-type, so type-safety will be reduced.\n * If you know the base type of the type-alias, provide `defineOptions.aliasFor: <base type name>`.\n * This will enforce that the schema definition conforms with the provided type.\n *\n * By default, `defineType` only allows known properties and options.\n * Use `defineOptions.strict: false` to allow unknown properties and options.\n *\n * ### Basic usage\n *\n * ```ts\n * defineType({\n *   type: 'object',\n *   name: 'custom-object',\n *   fields: [ {type: 'string', name: 'title', title: 'Title'}],\n * })\n * ```\n *\n * ### Usage with aliasFor narrowing\n *\n * ```ts\n * defineType({\n *   type: 'custom-object',\n *   name: 'redefined-custom-object',\n *   options: {\n *     columns: 2\n *   }\n * }, {aliasFor: 'object' })\n * ```\n *\n * ### Allow unknown properties\n *\n * ```ts\n * defineType({\n *   type: 'custom-object',\n *   name: 'redefined-custom-object',\n *   allowsUnknownProperties: true\n *   options: {\n *     columns: 2,\n *     allowsUnknownOptions: true\n *   }\n * }, {strict: false})\n * ```\n * ### Maximum safety and best autocompletion\n *\n * Use {@link defineType}, {@link defineField} and {@link defineArrayMember}:\n *\n * ```ts\n *  defineType({\n *    type: 'object',\n *    name: 'custom-object',\n *    fields: [\n *      defineField({\n *        type: 'array',\n *        name: 'arrayField',\n *        title: 'Things',\n *        of: [\n *          defineArrayMember({\n *            type: 'object',\n *            name: 'type-name-in-array',\n *            fields: [defineField({type: 'string', name: 'title', title: 'Title'})],\n *          }),\n *        ],\n *      }),\n *    ],\n *  })\n * ```\n *\n * ## Note on type-safety in the current implementation\n *\n * Type-safety inside array-like properties (schema properties like `fields` and `of`) can only be guaranteed when\n * {@link defineField} and {@link defineArrayMember} are used to wrap each value in the array.\n *\n * For array-values without a function-wrapper, TypeScript will resolve to a union type of all possible properties across\n * all schema types. This result in less precise typing.\n *\n * ### Extending the Sanity Schema types\n *\n * If you want to extend the Sanity Schema types with your own properties or options to make them typesafe,\n * you can use [TypeScript declaration merging](https://www.typescriptlang.org/docs/handbook/declaration-merging.html).\n *\n * With declaration merging, properties and options will be available in a type-safe manner, and\n * `strict: false` will not be necessary.\n *\n * #### Example: Add option to StringOptions\n *\n * ```ts\n * // string.ts\n *\n * //redeclare the sanity module\n * declare module 'sanity' {\n *  // redeclare StringOptions; it will be merged with StringOptions in the sanity module\n *  export interface StringOptions {\n *    myCustomOption?: boolean\n *  }\n * }\n *\n * // the option is now part of the StringOptions type, just as if it was declared in the sanity codebase:\n * defineType({\n *   type: 'string',\n *   name: 'my-string',\n *   options: {\n *     myCustomOption: true // this does not give an error anymore\n *   }\n * })\n *\n * ```\n *\n * #### Example: Add a schema definition to \"intrinsic-types\"\n *\n * ```ts\n * //my-custom-type-definition.ts\n *\n * // create a new schema definition based on object (we remove the ability to assign field, change the type add some options)\n *  export type MagicallyAddedDefinition = Omit<Schema.ObjectDefinition, 'type' | 'fields'> & {\n *    type: 'magically-added-type'\n *    options?: {\n *      sparkles?: boolean\n *    }\n *  }\n *\n *  // redeclares sanity module so we can add interfaces props to it\n * declare module 'sanity' {\n *     // redeclares IntrinsicDefinitions and adds a named definition to it\n *     // it is important that the key is the same as the type in the definition ('magically-added-type')\n *     export interface IntrinsicDefinitions {\n *       'magically-added-type': MagicallyAddedDefinition\n *     }\n * }\n *\n * // defineType will now narrow `type: 'magically-added-type'` to `MagicallyAddedDefinition`\n * defineType({\n *   type: 'magically-added-type'\n *   name: 'magic',\n *   options: {\n *     sparkles: true // this is allowed,\n *     //@ts-expect-error this is not allowed in MagicallyAddedDefinition.options\n *     sparks: true\n *   }\n * })\n * ```\n *\n * @param schemaDefinition - should be a valid schema type definition.\n * @param defineOptions - optional param to provide type hints for `schemaDefinition`.\n *\n * @see defineField\n * @see defineArrayMember\n * @see typed\n *\n * @beta\n */\nexport function defineType<\n  const TType extends IntrinsicTypeName | AutocompleteString,\n  const TName extends string,\n  TSelect extends Record<string, string> | undefined,\n  TPrepareValue extends Record<keyof TSelect, any> | undefined,\n  TAlias extends IntrinsicTypeName | undefined,\n  TStrict extends StrictDefinition,\n>(\n  schemaDefinition: {\n    type: TType\n    name: TName\n  } & DefineSchemaBase<TType, TAlias> &\n    NarrowPreview<TType, TAlias, TSelect, TPrepareValue> &\n    MaybeAllowUnknownProps<TStrict>,\n\n  defineOptions?: DefineSchemaOptions<TStrict, TAlias>,\n): typeof schemaDefinition {\n  return schemaDefinition\n}\n\n/**\n * Define a field within a document, object, image or file definition `fields` array.\n *\n * This function will narrow the schema type down to fields and options based on the provided\n * type-string.\n *\n * Using `defineField` is optional, but should provide improved autocompletion in your IDE, when building your schema.\n * Field-properties like `validation` and `initialValue`will also be more specific.\n *\n * See {@link defineType} for more examples.\n *\n * @param schemaField - should be a valid field type definition.\n * @param defineOptions - optional param to provide type hints for `schemaField`.\n *\n * @see defineField\n * @see defineArrayMember\n * @see typed\n *\n * @beta\n */\nexport function defineField<\n  const TType extends IntrinsicTypeName | AutocompleteString,\n  const TName extends string,\n  TSelect extends Record<string, string> | undefined,\n  TPrepareValue extends Record<keyof TSelect, any> | undefined,\n  TAlias extends IntrinsicTypeName | undefined,\n  TStrict extends StrictDefinition,\n>(\n  schemaField: {\n    type: TType\n    name: TName\n  } & DefineSchemaBase<TType, TAlias> &\n    NarrowPreview<TType, TAlias, TSelect, TPrepareValue> &\n    MaybeAllowUnknownProps<TStrict> &\n    FieldDefinitionBase,\n\n  defineOptions?: DefineSchemaOptions<TStrict, TAlias>,\n): typeof schemaField & WidenValidation & WidenInitialValue {\n  // TODO: re-evaluate the need for this cast\n  return schemaField as typeof schemaField & WidenValidation & WidenInitialValue\n}\n\n/**\n * Define an array item member type within an array definition `of`-array.\n *\n * This function will narrow the schema type down to fields and options based on the provided\n * `type` string.\n *\n * Using `defineArrayMember` is optional, but should provide improved autocompletion in your IDE, when building your schema.\n * Field properties like `validation` and `initialValue` will also be more specific.\n *\n * See {@link defineType} for example usage.\n *\n * @param arrayOfSchema - should be a valid `array.of` member definition.\n * @param defineOptions - optional param to provide type hints for `arrayOfSchema`.\n *\n * @see defineType\n * @see defineField\n * @see typed\n *\n * @beta\n */\nexport function defineArrayMember<\n  const TType extends IntrinsicTypeName | AutocompleteString,\n  const TName extends string,\n  TSelect extends Record<string, string> | undefined,\n  TPrepareValue extends Record<keyof TSelect, any> | undefined,\n  TAlias extends IntrinsicTypeName | undefined,\n  TStrict extends StrictDefinition,\n>(\n  arrayOfSchema: {\n    type: TType\n    /**\n     * When provided, `name` is used as `_type` for the array item when stored.\n     *\n     * Necessary when an array contains multiple entries with the same `type`, each with\n     * different configuration (title and initialValue for instance).\n     */\n    name?: TName\n  } & DefineArrayMemberBase<TType, TAlias> &\n    NarrowPreview<TType, TAlias, TSelect, TPrepareValue> &\n    MaybeAllowUnknownProps<TStrict>,\n\n  defineOptions?: DefineSchemaOptions<TStrict, TAlias>,\n): typeof arrayOfSchema & WidenValidation & WidenInitialValue {\n  // TODO: re-evaluate the need for this cast\n  return arrayOfSchema as typeof arrayOfSchema & WidenValidation & WidenInitialValue\n}\n\n/**\n * `typed` can be used to ensure that an object conforms to an exact interface.\n *\n * It can be useful when working with `defineType` and `defineField` on occasions where a wider type with\n * custom options or properties is required.\n *\n * ## Example  usage\n * ```ts\n *  defineField({\n *    type: 'string',\n *    name: 'nestedField',\n *    options: typed<StringOptions & {myCustomOption: boolean}>({\n *      layout: 'radio',\n *      // allowed\n *      myCustomOption: true,\n *      //@ts-expect-error unknownProp is not part of StringOptions & {myCustomOption: boolean}\n *      unknownProp: 'not allowed in typed context',\n *    }),\n *  }),\n * ```\n *\n * @param input - returned directly\n *\n * @internal\n */\nexport function typed<T>(input: T): T {\n  return input\n}\n","/**\n * @public\n */\nexport const searchStrategies = ['groqLegacy', 'groq2024'] as const\n\n/**\n * @public\n */\nexport type SearchStrategy = (typeof searchStrategies)[number]\n","import {searchStrategies, type SearchStrategy} from './types'\n\n/**\n * @internal\n */\nexport function isSearchStrategy(\n  maybeSearchStrategy: unknown,\n): maybeSearchStrategy is SearchStrategy {\n  return searchStrategies.includes(maybeSearchStrategy as SearchStrategy)\n}\n","import {isObject} from '../helpers'\nimport {type Slug} from './types'\n\n/**\n * Checks whether the given `thing` is a slug, eg an object with a `current` string property.\n *\n * @param thing - The thing to check\n * @returns True if slug, false otherwise\n * @public\n */\nexport function isSlug(thing: unknown): thing is Slug {\n  return isObject(thing) && typeof thing.current === 'string'\n}\n","import {type Mutation} from '../mutations'\nimport {type CreateSquashedMutation, type TransactionLogMutation} from './types'\n\n/** @internal */\nexport function isCreateSquashedMutation(\n  mutation: Mutation | TransactionLogMutation,\n): mutation is CreateSquashedMutation {\n  return 'createSquashed' in mutation\n}\n","import {type FormNodeValidation} from './types'\n\n/** @internal */\nexport function isValidationError(\n  node: FormNodeValidation,\n): node is FormNodeValidation & {level: 'error'} {\n  return node.level === 'error'\n}\n\n/** @internal */\nexport function isValidationWarning(\n  node: FormNodeValidation,\n): node is FormNodeValidation & {level: 'warning'} {\n  return node.level === 'warning'\n}\n\n/** @internal */\nexport function isValidationInfo(\n  node: FormNodeValidation,\n): node is FormNodeValidation & {level: 'info'} {\n  return node.level === 'info'\n}\n"],"names":["isRecord"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],"debugId":null}},
    {"offset": {"line": 926, "column": 0}, "map": {"version":3,"file":"paths.mjs","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/util/src/paths.ts"],"sourcesContent":["import {\n  type IndexTuple,\n  isIndexSegment,\n  isIndexTuple,\n  isKeySegment,\n  type KeyedSegment,\n  type Path,\n  type PathSegment,\n} from '@sanity/types'\n\nconst rePropName =\n  /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g\nconst reKeySegment = /_key\\s*==\\s*['\"](.*)['\"]/\nconst EMPTY_PATH: Path = []\n\nexport const FOCUS_TERMINATOR = '$'\n\n// Fields named as GROQ data types cannot be accessed using dot notation. These fields must instead\n// be serialized using square bracket notation.\nconst GROQ_DATA_TYPE_VALUES = ['true', 'false', 'null']\n\nexport function get<R>(obj: unknown, path: Path | string): R | undefined\nexport function get<R>(obj: unknown, path: Path | string, defaultValue: R): R\nexport function get(obj: unknown, path: Path | string, defaultVal?: unknown): unknown {\n  const select = typeof path === 'string' ? fromString(path) : path\n  if (!Array.isArray(select)) {\n    throw new Error('Path must be an array or a string')\n  }\n\n  let acc: unknown | undefined = obj\n  for (let i = 0; i < select.length; i++) {\n    const segment = select[i]\n    if (isIndexSegment(segment)) {\n      if (!Array.isArray(acc)) {\n        return defaultVal\n      }\n\n      acc = acc[segment]\n    }\n\n    if (isKeySegment(segment)) {\n      if (!Array.isArray(acc)) {\n        return defaultVal\n      }\n\n      acc = acc.find((item) => item._key === segment._key)\n    }\n\n    if (typeof segment === 'string') {\n      acc =\n        typeof acc === 'object' && acc !== null\n          ? ((acc as Record<string, unknown>)[segment] as Record<string, unknown>)\n          : undefined\n    }\n\n    if (typeof acc === 'undefined') {\n      return defaultVal\n    }\n  }\n\n  return acc\n}\n\nconst pathsMemo = new Map<string, Path>()\nexport function pathFor(path: Path): Path {\n  if (path.length === 0) {\n    return EMPTY_PATH\n  }\n  const asString = toString(path)\n  if (pathsMemo.has(asString)) {\n    return pathsMemo.get(asString)!\n  }\n  pathsMemo.set(asString, path)\n  Object.freeze(path)\n  return path\n}\n\nexport function isEqual(path: Path, otherPath: Path): boolean {\n  return (\n    path.length === otherPath.length &&\n    path.every((segment, i) => isSegmentEqual(segment, otherPath[i]))\n  )\n}\n\nexport function numEqualSegments(path: Path, otherPath: Path): number {\n  const length = Math.min(path.length, otherPath.length)\n  for (let i = 0; i < length; i++) {\n    if (!isSegmentEqual(path[i], otherPath[i])) {\n      return i\n    }\n  }\n  return length\n}\n\nexport function isSegmentEqual(segmentA: PathSegment, segmentB: PathSegment): boolean {\n  if (isKeySegment(segmentA) && isKeySegment(segmentB)) {\n    return segmentA._key === segmentB._key\n  }\n\n  if (isIndexSegment(segmentA)) {\n    return Number(segmentA) === Number(segmentB)\n  }\n\n  if (isIndexTuple(segmentA) && isIndexTuple(segmentB)) {\n    return segmentA[0] === segmentB[0] && segmentA[1] === segmentB[1]\n  }\n\n  return segmentA === segmentB\n}\n\nexport function hasFocus(focusPath: Path, path: Path): boolean {\n  const withoutTerminator =\n    focusPath[focusPath.length - 1] === FOCUS_TERMINATOR ? focusPath.slice(0, -1) : focusPath\n  return isEqual(withoutTerminator, path)\n}\n\nexport function hasItemFocus(focusPath: Path, item: PathSegment): boolean {\n  return focusPath.length === 1 && isSegmentEqual(focusPath[0], item)\n}\n\nexport function isExpanded(segment: PathSegment, focusPath: Path): boolean {\n  const [head, ...tail] = focusPath\n  return tail.length > 0 && isSegmentEqual(segment, head)\n}\n\nexport function startsWith(prefix: Path, path: Path): boolean {\n  return prefix.every((segment, i) => isSegmentEqual(segment, path[i]))\n}\n\nexport function trimLeft(prefix: Path, path: Path): Path {\n  if (prefix.length === 0 || path.length === 0) {\n    return path\n  }\n  const [prefixHead, ...prefixTail] = prefix\n  const [pathHead, ...pathTail] = path\n  if (!isSegmentEqual(prefixHead, pathHead)) {\n    return path\n  }\n  return pathFor(trimLeft(prefixTail, pathTail))\n}\n\nexport function trimRight(suffix: Path, path: Path): Path {\n  const sufLen = suffix.length\n  const pathLen = path.length\n  if (sufLen === 0 || pathLen === 0) {\n    return path\n  }\n\n  let i = 0\n  while (\n    i < sufLen &&\n    i < pathLen &&\n    isSegmentEqual(path[pathLen - i - 1], suffix[sufLen - i - 1])\n  ) {\n    i++\n  }\n\n  return pathFor(path.slice(0, pathLen - i))\n}\n\nexport function trimChildPath(path: Path, childPath: Path): Path {\n  return startsWith(path, childPath) ? trimLeft(path, childPath) : EMPTY_PATH\n}\n\nexport function toString(path: Path): string {\n  if (!Array.isArray(path)) {\n    throw new Error('Path is not an array')\n  }\n\n  return path.reduce<string>((target, segment, i) => {\n    const isHead = i === 0\n\n    if (typeof segment === 'number') {\n      return `${target}[${segment}]`\n    }\n\n    if (typeof segment === 'string') {\n      if (isHead) {\n        return segment\n      }\n\n      if (GROQ_DATA_TYPE_VALUES.includes(segment)) {\n        return `${target}[\"${segment}\"]`\n      }\n\n      return `${target}.${segment}`\n    }\n\n    if (isKeySegment(segment) && segment._key) {\n      return `${target}[_key==\"${segment._key}\"]`\n    }\n\n    if (Array.isArray(segment)) {\n      const [from, to] = segment\n      return `${target}[${from}:${to}]`\n    }\n\n    throw new Error(`Unsupported path segment \\`${JSON.stringify(segment)}\\``)\n  }, '')\n}\n\nexport function _resolveKeyedPath(value: unknown, path: Path): Path {\n  if (path.length === 0) {\n    return path\n  }\n  const [next, ...rest] = path\n  if (typeof next === 'number') {\n    if (!Array.isArray(value) || !(next in value)) {\n      return []\n    }\n    const item = value[next]\n    const key = item?._key\n    return [typeof key === 'string' ? {_key: item._key} : next, ..._resolveKeyedPath(item, rest)]\n  }\n  const nextVal = get(value, [next])\n  return [next, ..._resolveKeyedPath(nextVal, rest)]\n}\n\n/**\n * Takes a value and a path that may include numeric indices and attempts to replace numeric indices with keyed paths\n *\n * @param value - any json value\n * @param path - a Path that may include numeric indices\n * @returns a path where numeric indices has been replaced by keyed segments (e.g. `{_key: <key>}`)\n * Will do as good attempt as possible, but in case of missing array items, it will return the best possible match:\n * - `resolveKeyedPath([0, 'bar'], [])` will return [] since array has no value at index 0\n * - `resolveKeyedPath([0, 'foo'], [{_key: 'xyz', 'foo': 'bar'}, {_key: 'abc'}])` will return `[{_key: 'xyz'}, 'foo']` since array has no value at index 0\n * - `resolveKeyedPath([0, 'foo', 'bar'], [{_key: 'xyz'}])` will return `[{_key: 'xyz'}, 'foo', 'bar']` since array has no value at index 0\n * Object keys will be preserved as-is, e.g. `resolveKeyedPath(['foo', 'bar'], undefined)` will return `['foo', 'bar']`\n */\nexport function resolveKeyedPath(value: unknown, path: Path): Path {\n  if (!Array.isArray(path)) {\n    throw new Error('Path is not an array')\n  }\n  return pathFor(_resolveKeyedPath(value, path))\n}\n\nexport function fromString(path: string): Path {\n  if (typeof path !== 'string') {\n    throw new Error('Path is not a string')\n  }\n\n  const segments = path.match(rePropName)\n  if (!segments) {\n    throw new Error('Invalid path string')\n  }\n\n  return segments.map(normalizePathSegment)\n}\n\nfunction normalizePathSegment(segment: string): PathSegment {\n  if (isIndexSegment(segment)) {\n    return normalizeIndexSegment(segment)\n  }\n\n  if (isKeySegment(segment)) {\n    return normalizeKeySegment(segment)\n  }\n\n  if (isIndexTuple(segment)) {\n    return normalizeIndexTupleSegment(segment)\n  }\n\n  return segment\n}\n\nfunction normalizeIndexSegment(segment: string): PathSegment {\n  return Number(segment.replace(/[^\\d]/g, ''))\n}\n\nfunction normalizeKeySegment(segment: string): KeyedSegment {\n  const segments = segment.match(reKeySegment)\n  return {_key: segments![1]}\n}\n\nfunction normalizeIndexTupleSegment(segment: string): IndexTuple {\n  const [from, to] = segment.split(':').map((seg) => (seg === '' ? seg : Number(seg)))\n  return [from, to]\n}\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1087, "column": 0}, "map": {"version":3,"file":"legacyDateFormat.mjs","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/util/src/datetime-formatter/sanitizeLocale.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/util/src/datetime-formatter/formatter.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/util/src/datetime-formatter/momentToDateFnsFormat.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/util/src/legacyDateFormat.ts"],"sourcesContent":["// this is used to avoid issues with the Intl.DateTimeFormat constructor as part of the efps tests\nconst sanitizeLocale = (locale: string): string => locale.replace(/@posix$/, '')\n\nexport default sanitizeLocale\n","import {format} from 'date-fns'\n\nimport sanitizeLocale from './sanitizeLocale'\n\nfunction getMonthName(\n  date: Date,\n  style: 'long' | 'short' | 'narrow' | undefined = 'long',\n  locale = 'en-US',\n): string {\n  const validLocale = sanitizeLocale(locale)\n  return new Intl.DateTimeFormat(validLocale, {month: style}).format(date)\n}\n\nfunction getDayName(\n  date: Date,\n  style: 'long' | 'short' | 'narrow' | undefined = 'long',\n  locale = 'en-US',\n): string {\n  const validLocale = sanitizeLocale(locale)\n  return new Intl.DateTimeFormat(validLocale, {weekday: style}).format(date)\n}\n\nfunction getLocalizedDate(date: Date, options: Intl.DateTimeFormatOptions, locale = 'en-US') {\n  const validLocale = sanitizeLocale(locale)\n  return new Intl.DateTimeFormat(validLocale, options).format(date)\n}\n\n/**\n * Zero-pads a number to `length` digits (e.g. zeroPad(7, 2) = \"07\").\n */\nfunction zeroPad(num: number, length: number): string {\n  return String(num).padStart(length, '0')\n}\n\n/**\n * Returns an English ordinal for a given day number\n */\nfunction getOrdinal(day: number): string {\n  const j = day % 10\n  const k = day % 100\n  if (j === 1 && k !== 11) return `${day}st`\n  if (j === 2 && k !== 12) return `${day}nd`\n  if (j === 3 && k !== 13) return `${day}rd`\n  return `${day}th`\n}\n\nfunction getISODayOfWeek(date: Date): number {\n  // Sunday=0 in JS, but ISO calls Monday=1...Sunday=7\n  const dow = date.getDay()\n  return dow === 0 ? 7 : dow\n}\n\nfunction getISOWeekYear(date: Date): number {\n  // Clone date, shift to the \"Thursday\" of this week\n  const temp = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()))\n  const dayOfWeek = getISODayOfWeek(temp)\n  temp.setUTCDate(temp.getUTCDate() - dayOfWeek + 4)\n  return temp.getUTCFullYear()\n}\n\nfunction getISOWeekNumber(date: Date): number {\n  const temp = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()))\n  const dayOfWeek = getISODayOfWeek(temp)\n  temp.setUTCDate(temp.getUTCDate() - dayOfWeek + 4)\n  const yearStart = new Date(Date.UTC(temp.getUTCFullYear(), 0, 1))\n  return Math.ceil(((temp.valueOf() - yearStart.valueOf()) / 86400000 + 1) / 7)\n}\n\nfunction getDayOfYear(date: Date): number {\n  const startOfYear = new Date(Date.UTC(date.getFullYear(), 0, 1))\n  // fix for local-time differences\n  const diff =\n    date.valueOf() -\n    startOfYear.valueOf() +\n    (startOfYear.getTimezoneOffset() - date.getTimezoneOffset()) * 60_000\n  return Math.floor(diff / (1000 * 60 * 60 * 24)) + 1\n}\n\n// \"Locale\" week-year => approximate with ISO logic here\nfunction getLocaleWeekYear(date: Date): number {\n  return getISOWeekYear(date)\n}\n\n/**\n * Returns fractional seconds based on the count of 'S' in the token.\n */\nfunction getFractionalSeconds(date: Date, length: number): string {\n  const ms = zeroPad(date.getMilliseconds(), 3) // \"123\"\n  if (length === 1) {\n    return ms.slice(0, 1) // \"1\"\n  } else if (length === 2) {\n    return ms.slice(0, 2) // \"12\"\n  } else if (length === 3) {\n    return ms // \"123\"\n  }\n  // length=4 => e.g. \"1230\"\n  return `${ms}0`\n}\n\nfunction getTimeZoneAbbreviation(date: Date) {\n  const parts = new Intl.DateTimeFormat(sanitizeLocale('en-US'), {\n    timeZoneName: 'short',\n  }).formatToParts(date)\n  const tz = parts.find((part) => part.type === 'timeZoneName')\n  return tz ? tz.value : ''\n}\n\n/**\n * Formats a Date object using many Moment-like tokens.\n */\nfunction formatMomentLike(date: Date, formatStr: string): string {\n  // Store escaped sequences to restore later\n  const escapeSequences: string[] = []\n  const escapeToken = '\\uE000' // Use a Unicode private use character as placeholder\n\n  // Replace bracketed content with placeholders\n  const processedFormat = formatStr.replace(/\\[([^\\]]+)\\]/g, (_, contents) => {\n    escapeSequences.push(contents)\n    return escapeToken\n  })\n\n  // Basic fields\n  const year = date.getFullYear()\n  const monthIndex = date.getMonth() // 0..11\n  const dayOfMonth = date.getDate() // 1..31\n  const dayOfWeek = date.getDay() // 0..6 (Sun=0)\n  const hours = date.getHours() // 0..23\n  const minutes = date.getMinutes() // 0..59\n  const seconds = date.getSeconds() // 0..59\n\n  // Week-related\n  const isoWeekNum = getISOWeekNumber(date)\n  const isoWeekYear = getISOWeekYear(date)\n  const localeWeekYear = getLocaleWeekYear(date)\n\n  // Timestamps\n  const unixMs = date.getTime() // milliseconds since epoch\n  const unixSec = Math.floor(unixMs / 1000) // seconds since epoch\n\n  // Build token -> value map\n  const tokens = [\n    // Year\n    // 1970 1971 ... 2029 2030\n    {key: 'YYYY', getValue: () => String(year)},\n    // 70 71 ... 29 30\n    {key: 'YY', getValue: () => String(year).slice(-2)},\n    // 1970 1971 ... 9999 +10000 +10001\n    {key: 'Y', getValue: () => String(year)},\n    // Expanded years, -001970 -001971 ... +001907 +001971\n    {key: 'YYYYY', getValue: () => zeroPad(year, 5)},\n\n    // ISO week-year\n    // 1970 1971 ... 2029 2030\n    {key: 'GGGG', getValue: () => String(isoWeekYear)},\n    // 70 71 ... 29 30\n    {key: 'GG', getValue: () => String(isoWeekYear).slice(-2)},\n\n    // \"locale\" week-year\n    {key: 'gggg', getValue: () => String(localeWeekYear)},\n    {key: 'gg', getValue: () => String(localeWeekYear).slice(-2)},\n\n    // Quarter\n    {key: 'Q', getValue: () => String(Math.floor(monthIndex / 3) + 1)},\n    {key: 'Qo', getValue: () => getOrdinal(Math.floor(monthIndex / 3) + 1)},\n\n    // --- Month (using Intl) ---\n    {key: 'MMMM', getValue: () => getMonthName(date, 'long')}, // e.g. \"January\"\n    {key: 'MMM', getValue: () => getMonthName(date, 'short')}, // e.g. \"Jan\"\n    // For numeric months, we still do a manual approach:\n    {key: 'MM', getValue: () => zeroPad(monthIndex + 1, 2)},\n    {key: 'M', getValue: () => String(monthIndex + 1)},\n    {key: 'Mo', getValue: () => getOrdinal(monthIndex + 1)},\n\n    // Day of Month\n    {key: 'DD', getValue: () => zeroPad(dayOfMonth, 2)},\n    {key: 'D', getValue: () => String(dayOfMonth)},\n    {key: 'Do', getValue: () => getOrdinal(dayOfMonth)},\n\n    // --- Day of Week (using Intl) ---\n    {key: 'dddd', getValue: () => getDayName(date, 'long')}, // e.g. \"Monday\"\n    {key: 'ddd', getValue: () => getDayName(date, 'short')}, // e.g. \"Mon\"\n    {\n      key: 'dd',\n      // e.g. \"Mo\" => first 2 chars of short day name\n      getValue: () => getDayName(date, 'short').slice(0, 2),\n    },\n    {key: 'd', getValue: () => String(dayOfWeek)},\n    {key: 'do', getValue: () => getOrdinal(dayOfWeek + 1)},\n\n    // Day of the year\n    {key: 'DDDD', getValue: () => zeroPad(getDayOfYear(date), 3)},\n    {key: 'DDD', getValue: () => String(getDayOfYear(date))},\n    {key: 'DDDo', getValue: () => getOrdinal(getDayOfYear(date))},\n\n    // ISO day of week\n    {key: 'E', getValue: () => String(getISODayOfWeek(date))},\n\n    // Week of the year\n    // w 1 2 ... 52 53\n    {key: 'w', getValue: () => zeroPad(isoWeekNum, 2)},\n    // week 1st 2nd ... 52nd 53rd\n    {key: 'wo', getValue: () => getOrdinal(isoWeekNum)},\n    // 01 02 ... 52 53\n    {key: 'ww', getValue: () => zeroPad(isoWeekNum, 2)},\n\n    // ISO Week\n    {key: 'WW', getValue: () => zeroPad(isoWeekNum, 2)},\n    {key: 'W', getValue: () => String(isoWeekNum)},\n    {key: 'Wo', getValue: () => getOrdinal(isoWeekNum)},\n\n    // or \"locale\" week => replace isoWeekNum\n\n    // 24h hours\n    {key: 'HH', getValue: () => zeroPad(hours, 2)},\n    {key: 'H', getValue: () => String(hours)},\n\n    // 12h hours\n    {key: 'hh', getValue: () => zeroPad(((hours + 11) % 12) + 1, 2)},\n    {key: 'h', getValue: () => String(((hours + 11) % 12) + 1)},\n\n    // 1 2 ... 23 24\n    {key: 'k', getValue: () => String(hours || 24)},\n    // 01 02 ... 23 24\n    {key: 'kk', getValue: () => zeroPad(hours || 24, 2)},\n\n    // Minutes\n    {key: 'mm', getValue: () => zeroPad(minutes, 2)},\n    {key: 'm', getValue: () => String(minutes)},\n\n    // Seconds\n    {key: 'ss', getValue: () => zeroPad(seconds, 2)},\n    {key: 's', getValue: () => String(seconds)},\n\n    // Fractional seconds (S..SSSS) => handled separately\n    // Timezone offset (Z, ZZ) => handled separately\n\n    // AM/PM\n    {key: 'A', getValue: () => (hours < 12 ? 'AM' : 'PM')},\n    {key: 'a', getValue: () => (hours < 12 ? 'am' : 'pm')},\n\n    // Unix timestamps\n    {key: 'X', getValue: () => String(unixSec)},\n    {key: 'x', getValue: () => String(unixMs)},\n\n    // Eras BC AD\n    {key: 'N', getValue: () => (year < 0 ? 'BC' : 'AD')},\n    {key: 'NN', getValue: () => (year < 0 ? 'BC' : 'AD')},\n    {key: 'NNN', getValue: () => (year < 0 ? 'BC' : 'AD')},\n\n    // Before Christ, Anno Domini\n    {key: 'NNNN', getValue: () => (year < 0 ? 'Before Christ' : 'Anno Domini')},\n    {key: 'NNNNN', getValue: () => (year < 0 ? 'BC' : 'AD')},\n\n    // Time zone offset\n    {key: 'z', getValue: () => getTimeZoneAbbreviation(date)},\n    {key: 'zz', getValue: () => getTimeZoneAbbreviation(date)},\n    {key: 'Z', getValue: () => format(date, 'xxx')},\n    {key: 'ZZ', getValue: () => format(date, 'xx')},\n\n    // Time\n    {key: 'LTS', getValue: () => getLocalizedDate(date, {timeStyle: 'medium'})},\n    {key: 'LT', getValue: () => getLocalizedDate(date, {timeStyle: 'short'})},\n\n    // Date (uppercase = longer names)\n    {\n      key: 'LLLL',\n      getValue: () =>\n        getLocalizedDate(date, {\n          weekday: 'long',\n          year: 'numeric',\n          month: 'long',\n          day: 'numeric',\n          hour: 'numeric',\n          minute: 'numeric',\n        }),\n    },\n    {\n      key: 'LLL',\n      getValue: () =>\n        getLocalizedDate(date, {\n          year: 'numeric',\n          month: 'long',\n          day: 'numeric',\n          hour: 'numeric',\n          minute: 'numeric',\n        }),\n    },\n    {\n      key: 'LL',\n      getValue: () => getLocalizedDate(date, {year: 'numeric', month: 'long', day: 'numeric'}),\n    },\n    {\n      key: 'L',\n      getValue: () => getLocalizedDate(date, {year: 'numeric', month: '2-digit', day: '2-digit'}),\n    },\n\n    // Date (lowercase = shorter names)\n    {\n      key: 'llll',\n      getValue: () =>\n        getLocalizedDate(date, {\n          weekday: 'short',\n          year: 'numeric',\n          month: 'short',\n          day: 'numeric',\n          hour: 'numeric',\n          minute: 'numeric',\n        }),\n    },\n    {\n      key: 'lll',\n      getValue: () =>\n        getLocalizedDate(date, {\n          year: 'numeric',\n          month: 'short',\n          day: 'numeric',\n          hour: 'numeric',\n          minute: 'numeric',\n        }),\n    },\n    {\n      key: 'll',\n      getValue: () => getLocalizedDate(date, {year: 'numeric', month: 'short', day: 'numeric'}),\n    },\n    {\n      key: 'l',\n      getValue: () => getLocalizedDate(date, {year: 'numeric', month: 'numeric', day: 'numeric'}),\n    },\n  ]\n\n  // Sort tokens by descending length to avoid partial collisions\n  tokens.sort((a, b) => b.key.length - a.key.length)\n\n  // 1) Fractional seconds (avoid colliding with LTS)\n  const fracSecRegex = /(?<!LT)S{1,4}/g\n  let output = processedFormat.replace(fracSecRegex, (match) => {\n    return getFractionalSeconds(date, match.length)\n  })\n\n  // Find each token and replace it, make sure not to replace overlapping tokens\n  for (const {key, getValue} of tokens) {\n    // Escape special characters\n    const escapedKey = key.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\n    // Match the token, but only if it's not part of a larger word\n    const tokenRegex = new RegExp(`(^|[^A-Z0-9a-z])(${escapedKey})(?![A-Z0-9a-z])`, 'g')\n\n    // Only compute the value if the token exists in the output\n    if (output.match(tokenRegex)) {\n      const value = getValue()\n      output = output.replace(tokenRegex, `$1${value}`)\n    }\n  }\n\n  // After all token replacements, restore escaped sequences\n  output = output.replace(new RegExp(escapeToken, 'g'), () => escapeSequences.shift() || '')\n\n  return output\n}\n\nexport default formatMomentLike\n","/**\n * Converts a Moment.js format string into a UTS 35 (Unicode Technical Standard #35)\n * format string\n *\n * This function doesn't take absolutely every token into account, but should cover\n * all common cases. If you find a missing token, feel free to add it.\n *\n */\nexport function momentToDateFnsFormat(momentFormat: string): string {\n  // A list of replacements from Moment tokens to date-fns tokens\n  // ordered from longest to shortest to prevent partial replacements\n  const formatMap: Record<string, string> = {\n    YYYY: 'yyyy',\n    YY: 'yy',\n    MMMM: 'MMMM',\n    MMM: 'MMM',\n    MM: 'MM',\n    M: 'M',\n    DD: 'dd',\n    D: 'd',\n    dddd: 'EEEE',\n    ddd: 'EEE',\n    HH: 'HH',\n    H: 'H',\n    hh: 'hh',\n    h: 'h',\n    mm: 'mm',\n    m: 'm',\n    ss: 'ss',\n    s: 's',\n    A: 'a',\n    a: 'a',\n  }\n\n  // Replace each token in the format string\n  return Object.keys(formatMap).reduce(\n    (acc, key) => acc.replace(new RegExp(key, 'g'), formatMap[key]),\n    momentFormat,\n  )\n}\n","import {TZDateMini} from '@date-fns/tz'\nimport {UTCDateMini} from '@date-fns/utc'\nimport {parse as dateFnsParse, parseISO} from 'date-fns'\n\nimport formatMomentLike from './datetime-formatter/formatter'\nimport {momentToDateFnsFormat} from './datetime-formatter/momentToDateFnsFormat'\nimport sanitizeLocale from './datetime-formatter/sanitizeLocale'\n\nexport {sanitizeLocale}\n\nexport const DEFAULT_DATE_FORMAT = 'YYYY-MM-DD'\nexport const DEFAULT_TIME_FORMAT = 'HH:mm'\n// take local as default time zone\nconst DEFAULT_TIMEZONE = Intl.DateTimeFormat().resolvedOptions().timeZone\n\nexport type ParseResult = {isValid: boolean; date?: Date; error?: string} & (\n  | {isValid: true; date: Date}\n  | {isValid: false; error?: string}\n)\n\nexport function format(\n  input: Date,\n  dateFormat: string,\n  options: {useUTC?: boolean; timeZone?: string} = {useUTC: false, timeZone: undefined},\n): string {\n  const {useUTC, timeZone} = options\n\n  if (useUTC) return formatMomentLike(new UTCDateMini(input), dateFormat)\n  return formatMomentLike(\n    timeZone ? new TZDateMini(input, timeZone || DEFAULT_TIMEZONE) : new Date(input),\n    dateFormat,\n  )\n}\n\n/*\n  It would be so good to remove date-fns from this file, but it's used in the parse function. We could write our own parser,\n  but this is better than moment.\n */\nexport function parse(dateString: string, dateFormat?: string, timeZone?: string): ParseResult {\n  const dnsFormat = dateFormat ? momentToDateFnsFormat(dateFormat) : undefined\n\n  // parse string to date using the format string from date-fns\n  const parsed = dnsFormat ? dateFnsParse(dateString, dnsFormat, new Date()) : parseISO(dateString)\n  if (parsed && !isNaN(parsed.getTime())) {\n    const parsedDate =\n      timeZone && isValidTimeZoneString(timeZone) ? new TZDateMini(parsed, timeZone) : parsed\n    return {isValid: true, date: parsedDate}\n  }\n  return {isValid: false, error: `Invalid date. Must be on the format \"${dateFormat}\"`}\n}\n\nexport function isValidTimeZoneString(timeZone: string): boolean {\n  return Intl.supportedValuesOf('timeZone').includes(timeZone)\n}\n"],"names":["format","dateFnsParse"],"mappings":"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","ignoreList":[0,1,2,3],"debugId":null}},
    {"offset": {"line": 1582, "column": 0}, "map": {"version":3,"file":"content.mjs","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/util/src/content/hasOwn.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/util/src/content/isDeepEmpty.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/util/src/content/isShallowEmptyObject.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/util/src/content/randomKey.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/util/src/content/resolveJSType.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/util/src/content/resolveTypeName.ts"],"sourcesContent":["export default Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty)\n","import hasOwn from './hasOwn'\n\nfunction isDeepEmptyObject(value: {[key: string]: any}): boolean {\n  for (const key in value) {\n    if (key === '_type' || key === '_key') {\n      continue\n    }\n    if (hasOwn(value, key) && !isDeepEmpty(value[key])) {\n      return false\n    }\n  }\n  return true\n}\n\nfunction isDeepEmptyArray(value: unknown[]): boolean {\n  for (let i = 0; i < value.length; i++) {\n    if (!isDeepEmpty(value[i])) {\n      return false\n    }\n  }\n  return true\n}\n\n/**\n * Looks at the value and determines if it is deeply empty while not considering _type and _key attributes on objects.\n * A value will be considered deeply empty if it is:\n *  - undefined or null\n *  - an object where all property values are deeply empty\n *  - an array where all items are deeply empty\n * @param value - the value to check for deep emptiness\n */\nexport function isDeepEmpty(value: unknown): boolean {\n  if (value === undefined || value === null) {\n    return true\n  }\n  const type = typeof value\n\n  if (Array.isArray(value)) {\n    return isDeepEmptyArray(value)\n  }\n  if (type === 'object') {\n    return isDeepEmptyObject(value)\n  }\n  return false\n}\n\n/**\n * @deprecated Use `isDeepEmpty` instead\n * todo: remove in v4\n */\nexport const isEmptyArray = isDeepEmptyArray\n\n/**\n * @deprecated Use `isDeepEmpty` instead\n * todo: remove in v4\n */\nexport const isEmpty = isDeepEmpty\n\n/**\n * @deprecated Use `isDeepEmpty` instead\n * todo: remove in v4\n */\nexport const isEmptyObject = isDeepEmptyObject\n","import hasOwn from './hasOwn'\n\nexport function isShallowEmptyObject(value: {[key: string]: unknown}): boolean {\n  for (const key in value) {\n    if (key === '_type' || key === '_key') {\n      continue\n    }\n    if (hasOwn(value, key) && value[key] !== undefined) {\n      return false\n    }\n  }\n  return true\n}\n","import getRandomValues from 'get-random-values-esm'\n\nconst getByteHexTable = (() => {\n  let table: any[]\n  return () => {\n    if (table) {\n      return table\n    }\n\n    table = []\n    for (let i = 0; i < 256; ++i) {\n      table[i] = (i + 0x100).toString(16).slice(1)\n    }\n    return table\n  }\n})()\n\n// WHATWG crypto RNG - https://w3c.github.io/webcrypto/Overview.html\nfunction whatwgRNG(length = 16) {\n  const rnds8 = new Uint8Array(length)\n  getRandomValues(rnds8)\n  return rnds8\n}\n\nexport function randomKey(length?: number): string {\n  const table = getByteHexTable()\n  return whatwgRNG(length)\n    .reduce((str, n) => str + table[n], '')\n    .slice(0, length)\n}\n","const toString = Object.prototype.toString\n// Copied from https://github.com/ForbesLindesay/type-of, but inlined to have fine grained control\n\nexport function resolveJSType(val: unknown) {\n  switch (toString.call(val)) {\n    case '[object Function]':\n      return 'function'\n    case '[object Date]':\n      return 'date'\n    case '[object RegExp]':\n      return 'regexp'\n    case '[object Arguments]':\n      return 'arguments'\n    case '[object Array]':\n      return 'array'\n    case '[object String]':\n      return 'string'\n    default:\n  }\n\n  if (typeof val == 'object' && val && typeof (val as any).length == 'number') {\n    try {\n      if (typeof (val as any).callee == 'function') {\n        return 'arguments'\n      }\n    } catch (ex) {\n      if (ex instanceof TypeError) {\n        return 'arguments'\n      }\n    }\n  }\n\n  if (val === null) {\n    return 'null'\n  }\n\n  if (val === undefined) {\n    return 'undefined'\n  }\n\n  if (val && (val as any).nodeType === 1) {\n    return 'element'\n  }\n\n  if (val === Object(val)) {\n    return 'object'\n  }\n\n  return typeof val\n}\n","import {resolveJSType} from './resolveJSType'\n\nexport function resolveTypeName(value: unknown): string {\n  const jsType = resolveJSType(value)\n  if (jsType !== 'object') {\n    return jsType\n  }\n\n  const obj = value as Record<string, unknown> & {_type?: string}\n  return ('_type' in obj && obj._type) || jsType\n}\n"],"names":[],"mappings":";;;;;;;;;;;AAAA,IAAA,SAAe,OAAO,SAAA,CAAU,cAAA,CAAe,IAAA,CAAK,IAAA,CAAK,OAAO,SAAA,CAAU,cAAc;ACExF,SAAS,kBAAkB,KAAA,EAAsC;IAC/D,IAAA,MAAW,OAAO,MAChB,IAAI,CAAA,CAAA,QAAQ,WAAW,QAAQ,MAAA,KAG3B,OAAO,OAAO,GAAG,KAAK,CAAC,YAAY,KAAA,CAAM,GAAG,CAAC,GAC/C,OAAO,CAAA;IAGX,OAAO,CAAA;AACT;AAEA,SAAS,iBAAiB,KAAA,EAA2B;IACnD,IAAA,IAAS,IAAI,GAAG,IAAI,MAAM,MAAA,EAAQ,IAChC,IAAI,CAAC,YAAY,KAAA,CAAM,CAAC,CAAC,GACvB,OAAO,CAAA;IAGX,OAAO,CAAA;AACT;AAUO,SAAS,YAAY,KAAA,EAAyB;IACnD,IAA2B,SAAU,MACnC,OAAO,CAAA;IAET,MAAM,OAAO,OAAO;IAEpB,OAAI,MAAM,OAAA,CAAQ,KAAK,IACd,iBAAiB,KAAK,IAE3B,SAAS,WACJ,kBAAkB,KAAK,IAEzB,CAAA;AACT;AAMO,MAAM,eAAe,kBAMf,UAAU,aAMV,gBAAgB;AC5DtB,SAAS,qBAAqB,KAAA,EAA0C;IAC7E,IAAA,MAAW,OAAO,MAChB,IAAI,CAAA,CAAA,QAAQ,WAAW,QAAQ,MAAA,KAG3B,OAAO,OAAO,GAAG,KAAK,KAAA,CAAM,GAAG,CAAA,KAAM,KAAA,GACvC,OAAO,CAAA;IAGX,OAAO,CAAA;AACT;ACVA,MAAM,kBAAmB,aAAA,GAAA,CAAA,MAAM;IAC7B,IAAI;IACJ,OAAO,MAAM;QACX,IAAI,OACF,OAAO;QAGT,QAAQ,CAAA,CAAA;QACR,IAAA,IAAS,IAAI,GAAG,IAAI,KAAK,EAAE,EACzB,KAAA,CAAM,CAAC,CAAA,GAAA,CAAK,IAAI,GAAA,EAAO,QAAA,CAAS,EAAE,EAAE,KAAA,CAAM,CAAC;QAE7C,OAAO;IACT;AACF,CAAA,EAAA;AAGA,SAAS,UAAU,SAAS,EAAA,EAAI;IAC9B,MAAM,QAAQ,IAAI,WAAW,MAAM;IACnC,OAAA,0KAAA,EAAgB,KAAK,GACd;AACT;AAEO,SAAS,UAAU,MAAA,EAAyB;IACjD,MAAM,QAAQ,gBAAA;IACd,OAAO,UAAU,MAAM,EACpB,MAAA,CAAO,CAAC,KAAK,IAAM,MAAM,KAAA,CAAM,CAAC,CAAA,EAAG,EAAE,EACrC,KAAA,CAAM,GAAG,MAAM;AACpB;AC7BA,MAAM,WAAW,OAAO,SAAA,CAAU,QAAA;AAG3B,SAAS,cAAc,GAAA,EAAc;IAC1C,OAAQ,SAAS,IAAA,CAAK,GAAG,GAAA;QACvB,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;IACT;IAGF,IAAI,OAAO,OAAO,YAAY,OAAO,OAAQ,IAAY,MAAA,IAAU,UACjE,IAAI;QACF,IAAI,OAAQ,IAAY,MAAA,IAAU,YAChC,OAAO;IAEX,EAAA,OAAS,IAAI;QACX,IAAI,cAAc,WAChB,OAAO;IAEX;IAGF,OAAI,QAAQ,OACH,SAGL,QAAQ,KAAA,IACH,cAGL,OAAQ,IAAY,QAAA,KAAa,IAC5B,YAGL,QAAQ,OAAO,GAAG,IACb,WAGF,OAAO;AAChB;AC/CO,SAAS,gBAAgB,KAAA,EAAwB;IACtD,MAAM,SAAS,cAAc,KAAK;IAClC,IAAI,WAAW,UACb,OAAO;IAGT,MAAM,MAAM;IACZ,OAAQ,WAAW,OAAO,IAAI,KAAA,IAAU;AAC1C","ignoreList":[0,1,2,3,4,5],"debugId":null}},
    {"offset": {"line": 1666, "column": 0}, "map": {"version":3,"file":"concurrency-limiter.mjs","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/util/src/concurrency-limiter.ts"],"sourcesContent":["/**\n * ConcurrencyLimiter manages the number of concurrent operations that can be performed.\n * It ensures that the number of operations does not exceed a specified maximum limit.\n */\nexport class ConcurrencyLimiter {\n  current = 0\n  resolvers: Array<() => void> = []\n  public max: number\n  constructor(max: number) {\n    this.max = max\n  }\n\n  /**\n   * Indicates when a slot for a new operation is ready.\n   * If under the limit, it resolves immediately; otherwise, it waits until a slot is free.\n   */\n  ready = (): Promise<void> => {\n    if (this.max === Infinity) return Promise.resolve()\n\n    if (this.current < this.max) {\n      this.current++\n      return Promise.resolve()\n    }\n\n    return new Promise<void>((resolve) => {\n      this.resolvers.push(resolve)\n    })\n  }\n\n  /**\n   * Releases a slot, decrementing the current count of operations if nothing is in the queue.\n   * If there are operations waiting, it allows the next one in the queue to proceed.\n   */\n  release = (): void => {\n    if (this.max === Infinity) return\n\n    const nextResolver = this.resolvers.shift()\n    if (nextResolver) {\n      nextResolver()\n      return\n    }\n\n    this.current = Math.max(0, this.current - 1)\n  }\n}\n"],"names":[],"mappings":";;;AAIO,MAAM,mBAAmB;IAC9B,UAAU,EAAA;IACV,YAA+B,CAAA,CAAA,CAAA;IACxB,IAAA;IACP,YAAY,GAAA,CAAa;QACvB,IAAA,CAAK,GAAA,GAAM;IACb;IAAA;;;GAAA,GAMA,QAAQ,IACF,IAAA,CAAK,GAAA,KAAQ,IAAA,IAAiB,QAAQ,OAAA,CAAA,IAEtC,IAAA,CAAK,OAAA,GAAU,IAAA,CAAK,GAAA,GAAA,CACtB,IAAA,CAAK,OAAA,IACE,QAAQ,OAAA,EAAA,IAGV,IAAI,QAAc,CAAC,YAAY;YACpC,IAAA,CAAK,SAAA,CAAU,IAAA,CAAK,OAAO;QAC7B,CAAC,EAAA;IAAA;;;GAAA,GAOH,UAAU,MAAY;QACpB,IAAI,IAAA,CAAK,GAAA,KAAQ,IAAA,EAAU,CAAA;QAE3B,MAAM,eAAe,IAAA,CAAK,SAAA,CAAU,KAAA,CAAA;QACpC,IAAI,cAAc;YAChB,aAAA;YACA;QACF;QAEA,IAAA,CAAK,OAAA,GAAU,KAAK,GAAA,CAAI,GAAG,IAAA,CAAK,OAAA,GAAU,CAAC;IAC7C,EAAA;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1703, "column": 0}, "map": {"version":3,"file":"client.mjs","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/util/src/client/concurrency-limiter/createClientConcurrencyLimiter.ts"],"sourcesContent":["import {type ObservableSanityClient, type SanityClient} from '@sanity/client'\nimport {finalize, from, switchMap} from 'rxjs'\n\nimport {ConcurrencyLimiter} from '../../concurrency-limiter'\n\n/**\n * Decorates a sanity client to limit the concurrency of `client.fetch`\n * requests. Keeps the concurrency limit state and returns wrapped clients with\n * that same state if the `clone` `config` or `withConfig` methods are called.\n */\nexport function createClientConcurrencyLimiter(\n  maxConcurrency: number,\n): (input: SanityClient) => SanityClient {\n  const limiter = new ConcurrencyLimiter(maxConcurrency)\n\n  function wrapClient(client: SanityClient): SanityClient {\n    return new Proxy(client, {\n      get: (target, property) => {\n        switch (property) {\n          case 'fetch': {\n            return async (...args: Parameters<SanityClient['fetch']>) => {\n              await limiter.ready()\n              try {\n                // note we want to await before we return so the finally block\n                // will run after the promise has been fulfilled or rejected\n                return await target.fetch(...args)\n              } finally {\n                limiter.release()\n              }\n            }\n          }\n          case 'clone': {\n            return (...args: Parameters<SanityClient['clone']>) => {\n              return wrapClient(target.clone(...args))\n            }\n          }\n          case 'config': {\n            return (...args: Parameters<SanityClient['config']>) => {\n              const result = target.config(...args)\n\n              // if there is a config, it returns a client so we need to wrap again\n              if (args[0]) return wrapClient(result)\n              return result\n            }\n          }\n          case 'withConfig': {\n            return (...args: Parameters<SanityClient['withConfig']>) => {\n              return wrapClient(target.withConfig(...args))\n            }\n          }\n          case 'observable': {\n            return wrapObservableClient(target.observable)\n          }\n          default: {\n            return target[property as keyof SanityClient]\n          }\n        }\n      },\n    })\n  }\n\n  function wrapObservableClient(\n    observableSanityClient: ObservableSanityClient,\n  ): ObservableSanityClient {\n    return new Proxy(observableSanityClient, {\n      get: (target, property) => {\n        switch (property) {\n          case 'fetch': {\n            return (...args: Parameters<ObservableSanityClient['fetch']>) =>\n              from(limiter.ready()).pipe(\n                switchMap(() => target.fetch(...args)),\n                finalize(() => limiter.release()),\n              )\n          }\n          case 'clone': {\n            return (...args: Parameters<ObservableSanityClient['clone']>) => {\n              return wrapObservableClient(target.clone(...args))\n            }\n          }\n          case 'config': {\n            return (...args: Parameters<ObservableSanityClient['config']>) => {\n              const result = target.config(...args)\n\n              // if there is a config, it returns a client so we need to wrap again\n              if (args[0]) return wrapObservableClient(result)\n              return result\n            }\n          }\n          case 'withConfig': {\n            return (...args: Parameters<ObservableSanityClient['withConfig']>) => {\n              return wrapObservableClient(target.withConfig(...args))\n            }\n          }\n          default: {\n            return target[property as keyof ObservableSanityClient]\n          }\n        }\n      },\n    })\n  }\n\n  return wrapClient\n}\n"],"names":[],"mappings":";;;;;;;;;AAUO,SAAS,+BACd,cAAA,EACuC;IACvC,MAAM,UAAU,0KAAI,qBAAA,CAAmB,cAAc;IAErD,SAAS,WAAW,MAAA,EAAoC;QACtD,OAAO,IAAI,MAAM,QAAQ;YACvB,KAAK,CAAC,QAAQ,aAAa;gBACzB,OAAQ,UAAA;oBACN,KAAK;wBACH,OAAO,OAAA,GAAU,SAA4C;4BAC3D,MAAM,QAAQ,KAAA,CAAA;4BACd,IAAI;gCAGF,OAAO,MAAM,OAAO,KAAA,CAAM,GAAG,IAAI;4BACnC,SAAA;gCACE,QAAQ,OAAA,CAAA;4BACV;wBACF;oBAEF,KAAK;wBACH,OAAO,CAAA,GAAI,OACF,WAAW,OAAO,KAAA,CAAM,GAAG,IAAI,CAAC;oBAG3C,KAAK;wBACH,OAAO,CAAA,GAAI,SAA6C;4BACtD,MAAM,SAAS,OAAO,MAAA,CAAO,GAAG,IAAI;4BAGpC,OAAI,IAAA,CAAK,CAAC,CAAA,GAAU,WAAW,MAAM,IAC9B;wBACT;oBAEF,KAAK;wBACH,OAAO,CAAA,GAAI,OACF,WAAW,OAAO,UAAA,CAAW,GAAG,IAAI,CAAC;oBAGhD,KAAK;wBACH,OAAO,qBAAqB,OAAO,UAAU;oBAE/C;wBACE,OAAO,MAAA,CAAO,QAA8B,CAAA;gBAAA;YAGlD;QAAA,CACD;IACH;IAEA,SAAS,qBACP,sBAAA,EACwB;QACxB,OAAO,IAAI,MAAM,wBAAwB;YACvC,KAAK,CAAC,QAAQ,aAAa;gBACzB,OAAQ,UAAA;oBACN,KAAK;wBACH,OAAO,CAAA,GAAI,qLACT,OAAA,EAAK,QAAQ,KAAA,CAAA,CAAO,EAAE,IAAA,mLACpB,YAAA,EAAU,IAAM,OAAO,KAAA,CAAM,GAAG,IAAI,CAAC,oLACrC,WAAA,EAAS,IAAM,QAAQ,OAAA,CAAA,CAAS;oBAGtC,KAAK;wBACH,OAAO,CAAA,GAAI,OACF,qBAAqB,OAAO,KAAA,CAAM,GAAG,IAAI,CAAC;oBAGrD,KAAK;wBACH,OAAO,CAAA,GAAI,SAAuD;4BAChE,MAAM,SAAS,OAAO,MAAA,CAAO,GAAG,IAAI;4BAGpC,OAAI,IAAA,CAAK,CAAC,CAAA,GAAU,qBAAqB,MAAM,IACxC;wBACT;oBAEF,KAAK;wBACH,OAAO,CAAA,GAAI,OACF,qBAAqB,OAAO,UAAA,CAAW,GAAG,IAAI,CAAC;oBAG1D;wBACE,OAAO,MAAA,CAAO,QAAwC,CAAA;gBAAA;YAG5D;QAAA,CACD;IACH;IAEA,OAAO;AACT","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1775, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/color/src/constants.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/color/src/lib/convert/hslToRgb.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/color/src/lib/convert/rgbToHex.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/color/src/buildTints.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/color/src/color.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/color/src/config.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/color/src/lib/convert/hexToRgb.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/color/src/lib/convert/rgbToHsl.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/color/src/lib/clamp.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/color/src/lib/transform/darken.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/color/src/lib/interpolate.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/color/src/lib/transform/limit.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/color/src/lib/transform/screen.ts"],"sourcesContent":["import {ColorHueKey, ColorTintKey} from './types'\n\n/**\n * Color hue keys.\n * @public\n */\nexport const COLOR_HUES: ColorHueKey[] = [\n  'gray',\n  'blue',\n  'purple',\n  'magenta',\n  'red',\n  'orange',\n  'yellow',\n  'green',\n  'cyan',\n]\n\n/**\n * Color tint keys.\n * @public\n */\nexport const COLOR_TINTS: ColorTintKey[] = [\n  '50',\n  '100',\n  '200',\n  '300',\n  '400',\n  '500',\n  '600',\n  '700',\n  '800',\n  '900',\n  '950',\n]\n","import {HSL, RGB} from '../../types'\n\n/** @internal */\nexport function hslToRgb(hsl: HSL): RGB {\n  const h = hsl[0]\n  const s = hsl[1] / 100\n  const l = hsl[2] / 100\n  const k = (n: number) => (n + h / 30) % 12\n  const a = s * Math.min(l, 1 - l)\n  const f = (n: number) => l - a * Math.max(-1, Math.min(k(n) - 3, Math.min(9 - k(n), 1)))\n\n  return [255 * f(0), 255 * f(8), 255 * f(4)]\n}\n","import {RGB} from '../../types'\n\n/** @internal */\nexport function rgbToHex([r, g, b]: RGB): string {\n  const _r = Math.round(r)\n  const _g = Math.round(g)\n  const _b = Math.round(b)\n\n  return '#' + ((1 << 24) + (_r << 16) + (_g << 8) + _b).toString(16).slice(1)\n}\n","import {COLOR_TINTS} from './constants'\nimport {hslToRgb} from './lib/convert/hslToRgb'\nimport {rgbToHex} from './lib/convert/rgbToHex'\nimport {ColorTintConfig, ColorHueConfig, ColorHueKey, ColorTints} from './types'\n\n/** @internal */\nexport function buildTints(options: {\n  hueKey: ColorHueKey\n  black: ColorTintConfig\n  color: ColorHueConfig\n}): ColorTints {\n  const {hueKey, color} = options\n\n  return COLOR_TINTS.reduce<Partial<ColorTints>>((acc, tintKey) => {\n    const tint = Number(tintKey)\n    const rgb = hslToRgb(color.tints[tintKey].hsl)\n    const hex = rgbToHex([Math.round(rgb[0]), Math.round(rgb[1]), Math.round(rgb[2])])\n\n    acc[tintKey] = {\n      title: `${hueKey.slice(0, 1).toUpperCase()}${hueKey.slice(1)} ${tint}`,\n      hex,\n    }\n\n    return acc\n  }, {}) as ColorTints\n}\n","/* THIS FILE IS AUTO-GENERATED – DO NOT EDIT */\n\nimport {Color, ColorHues, ColorTint, ColorTints} from './types'\n\n/** @public */\nexport const black: ColorTint = {\n  title: 'Black',\n  hex: '#0d0e12',\n}\n\n/** @public */\nexport const white: ColorTint = {\n  title: 'White',\n  hex: '#ffffff',\n}\n\n/** @public */\nexport const gray: ColorTints = {\n  '50': {\n    title: 'Gray 50',\n    hex: '#f6f6f8',\n  },\n  '100': {\n    title: 'Gray 100',\n    hex: '#eeeef1',\n  },\n  '200': {\n    title: 'Gray 200',\n    hex: '#e3e4e8',\n  },\n  '300': {\n    title: 'Gray 300',\n    hex: '#bbbdc9',\n  },\n  '400': {\n    title: 'Gray 400',\n    hex: '#9499ad',\n  },\n  '500': {\n    title: 'Gray 500',\n    hex: '#727892',\n  },\n  '600': {\n    title: 'Gray 600',\n    hex: '#515870',\n  },\n  '700': {\n    title: 'Gray 700',\n    hex: '#383d51',\n  },\n  '800': {\n    title: 'Gray 800',\n    hex: '#252837',\n  },\n  '900': {\n    title: 'Gray 900',\n    hex: '#1b1d27',\n  },\n  '950': {\n    title: 'Gray 950',\n    hex: '#13141b',\n  },\n}\n\n/** @public */\nexport const blue: ColorTints = {\n  '50': {\n    title: 'Blue 50',\n    hex: '#f5f8ff',\n  },\n  '100': {\n    title: 'Blue 100',\n    hex: '#e5edff',\n  },\n  '200': {\n    title: 'Blue 200',\n    hex: '#dbe5ff',\n  },\n  '300': {\n    title: 'Blue 300',\n    hex: '#a8bfff',\n  },\n  '400': {\n    title: 'Blue 400',\n    hex: '#7595ff',\n  },\n  '500': {\n    title: 'Blue 500',\n    hex: '#556bfc',\n  },\n  '600': {\n    title: 'Blue 600',\n    hex: '#4043e7',\n  },\n  '700': {\n    title: 'Blue 700',\n    hex: '#2927aa',\n  },\n  '800': {\n    title: 'Blue 800',\n    hex: '#192457',\n  },\n  '900': {\n    title: 'Blue 900',\n    hex: '#161a41',\n  },\n  '950': {\n    title: 'Blue 950',\n    hex: '#101228',\n  },\n}\n\n/** @public */\nexport const purple: ColorTints = {\n  '50': {\n    title: 'Purple 50',\n    hex: '#f8f5ff',\n  },\n  '100': {\n    title: 'Purple 100',\n    hex: '#f1ebff',\n  },\n  '200': {\n    title: 'Purple 200',\n    hex: '#ece1fe',\n  },\n  '300': {\n    title: 'Purple 300',\n    hex: '#ccb1fc',\n  },\n  '400': {\n    title: 'Purple 400',\n    hex: '#b087f7',\n  },\n  '500': {\n    title: 'Purple 500',\n    hex: '#8f57ef',\n  },\n  '600': {\n    title: 'Purple 600',\n    hex: '#721fe5',\n  },\n  '700': {\n    title: 'Purple 700',\n    hex: '#4c1a9e',\n  },\n  '800': {\n    title: 'Purple 800',\n    hex: '#2f1862',\n  },\n  '900': {\n    title: 'Purple 900',\n    hex: '#23173f',\n  },\n  '950': {\n    title: 'Purple 950',\n    hex: '#181128',\n  },\n}\n\n/** @public */\nexport const magenta: ColorTints = {\n  '50': {\n    title: 'Magenta 50',\n    hex: '#fef6f9',\n  },\n  '100': {\n    title: 'Magenta 100',\n    hex: '#fde8ef',\n  },\n  '200': {\n    title: 'Magenta 200',\n    hex: '#fcdee9',\n  },\n  '300': {\n    title: 'Magenta 300',\n    hex: '#f7abc5',\n  },\n  '400': {\n    title: 'Magenta 400',\n    hex: '#f0709b',\n  },\n  '500': {\n    title: 'Magenta 500',\n    hex: '#e72767',\n  },\n  '600': {\n    title: 'Magenta 600',\n    hex: '#b11651',\n  },\n  '700': {\n    title: 'Magenta 700',\n    hex: '#7c1342',\n  },\n  '800': {\n    title: 'Magenta 800',\n    hex: '#4b1130',\n  },\n  '900': {\n    title: 'Magenta 900',\n    hex: '#341325',\n  },\n  '950': {\n    title: 'Magenta 950',\n    hex: '#1f0f14',\n  },\n}\n\n/** @public */\nexport const red: ColorTints = {\n  '50': {\n    title: 'Red 50',\n    hex: '#fff6f5',\n  },\n  '100': {\n    title: 'Red 100',\n    hex: '#ffe7e5',\n  },\n  '200': {\n    title: 'Red 200',\n    hex: '#ffdedc',\n  },\n  '300': {\n    title: 'Red 300',\n    hex: '#fdada5',\n  },\n  '400': {\n    title: 'Red 400',\n    hex: '#f77769',\n  },\n  '500': {\n    title: 'Red 500',\n    hex: '#ef4434',\n  },\n  '600': {\n    title: 'Red 600',\n    hex: '#cc2819',\n  },\n  '700': {\n    title: 'Red 700',\n    hex: '#8b2018',\n  },\n  '800': {\n    title: 'Red 800',\n    hex: '#4d1714',\n  },\n  '900': {\n    title: 'Red 900',\n    hex: '#321615',\n  },\n  '950': {\n    title: 'Red 950',\n    hex: '#1e1011',\n  },\n}\n\n/** @public */\nexport const orange: ColorTints = {\n  '50': {\n    title: 'Orange 50',\n    hex: '#fff7f0',\n  },\n  '100': {\n    title: 'Orange 100',\n    hex: '#ffeadb',\n  },\n  '200': {\n    title: 'Orange 200',\n    hex: '#ffddc7',\n  },\n  '300': {\n    title: 'Orange 300',\n    hex: '#ffb685',\n  },\n  '400': {\n    title: 'Orange 400',\n    hex: '#ff8e42',\n  },\n  '500': {\n    title: 'Orange 500',\n    hex: '#fa6400',\n  },\n  '600': {\n    title: 'Orange 600',\n    hex: '#b14802',\n  },\n  '700': {\n    title: 'Orange 700',\n    hex: '#7c3404',\n  },\n  '800': {\n    title: 'Orange 800',\n    hex: '#461e07',\n  },\n  '900': {\n    title: 'Orange 900',\n    hex: '#32160b',\n  },\n  '950': {\n    title: 'Orange 950',\n    hex: '#21120d',\n  },\n}\n\n/** @public */\nexport const yellow: ColorTints = {\n  '50': {\n    title: 'Yellow 50',\n    hex: '#fefae1',\n  },\n  '100': {\n    title: 'Yellow 100',\n    hex: '#fcf3bb',\n  },\n  '200': {\n    title: 'Yellow 200',\n    hex: '#f9e994',\n  },\n  '300': {\n    title: 'Yellow 300',\n    hex: '#f7d455',\n  },\n  '400': {\n    title: 'Yellow 400',\n    hex: '#f9bc15',\n  },\n  '500': {\n    title: 'Yellow 500',\n    hex: '#d28a04',\n  },\n  '600': {\n    title: 'Yellow 600',\n    hex: '#965908',\n  },\n  '700': {\n    title: 'Yellow 700',\n    hex: '#653a0b',\n  },\n  '800': {\n    title: 'Yellow 800',\n    hex: '#3b220c',\n  },\n  '900': {\n    title: 'Yellow 900',\n    hex: '#271a11',\n  },\n  '950': {\n    title: 'Yellow 950',\n    hex: '#181410',\n  },\n}\n\n/** @public */\nexport const green: ColorTints = {\n  '50': {\n    title: 'Green 50',\n    hex: '#e7fef5',\n  },\n  '100': {\n    title: 'Green 100',\n    hex: '#c5fce8',\n  },\n  '200': {\n    title: 'Green 200',\n    hex: '#a9f9dc',\n  },\n  '300': {\n    title: 'Green 300',\n    hex: '#59f3ba',\n  },\n  '400': {\n    title: 'Green 400',\n    hex: '#0ff0a1',\n  },\n  '500': {\n    title: 'Green 500',\n    hex: '#04b97a',\n  },\n  '600': {\n    title: 'Green 600',\n    hex: '#01794f',\n  },\n  '700': {\n    title: 'Green 700',\n    hex: '#015133',\n  },\n  '800': {\n    title: 'Green 800',\n    hex: '#023120',\n  },\n  '900': {\n    title: 'Green 900',\n    hex: '#06231a',\n  },\n  '950': {\n    title: 'Green 950',\n    hex: '#071715',\n  },\n}\n\n/** @public */\nexport const cyan: ColorTints = {\n  '50': {\n    title: 'Cyan 50',\n    hex: '#e7fefe',\n  },\n  '100': {\n    title: 'Cyan 100',\n    hex: '#c5fcfc',\n  },\n  '200': {\n    title: 'Cyan 200',\n    hex: '#96f8f8',\n  },\n  '300': {\n    title: 'Cyan 300',\n    hex: '#62efef',\n  },\n  '400': {\n    title: 'Cyan 400',\n    hex: '#18e2e2',\n  },\n  '500': {\n    title: 'Cyan 500',\n    hex: '#04b8be',\n  },\n  '600': {\n    title: 'Cyan 600',\n    hex: '#037782',\n  },\n  '700': {\n    title: 'Cyan 700',\n    hex: '#024950',\n  },\n  '800': {\n    title: 'Cyan 800',\n    hex: '#042f34',\n  },\n  '900': {\n    title: 'Cyan 900',\n    hex: '#072227',\n  },\n  '950': {\n    title: 'Cyan 950',\n    hex: '#0d181c',\n  },\n}\n\n/** @public */\nexport const hues: ColorHues = {gray, blue, purple, magenta, red, orange, yellow, green, cyan}\n\n/** @public */\nexport const color: Color = {black, white, ...hues}\n","import {ColorConfig} from './types'\n\n/** @internal */\nexport const config: ColorConfig = {\n  black: {\n    title: 'Black',\n    hsl: [225, 16, 6],\n  },\n  white: {\n    title: 'White',\n    hsl: [0, 0, 100],\n  },\n  gray: {\n    title: 'Gray',\n    tints: {\n      50: {\n        title: 'Gray 50',\n        hsl: [240, 12, 97],\n      },\n      100: {\n        title: 'Gray 100',\n        hsl: [240, 10, 94],\n      },\n      200: {\n        title: 'Gray 200',\n        hsl: [231, 10, 90],\n      },\n      300: {\n        title: 'Gray 300',\n        hsl: [232, 11, 76],\n      },\n      400: {\n        title: 'Gray 400',\n        hsl: [228, 13, 63],\n      },\n      500: {\n        title: 'Gray 500',\n        hsl: [229, 13, 51],\n      },\n      600: {\n        title: 'Gray 600',\n        hsl: [228, 16, 38],\n      },\n      700: {\n        title: 'Gray 700',\n        hsl: [229, 18, 27],\n      },\n      800: {\n        title: 'Gray 800',\n        hsl: [229, 19, 18],\n      },\n      900: {\n        title: 'Gray 900',\n        hsl: [228, 19, 13],\n      },\n      950: {\n        title: 'Gray 950',\n        hsl: [233, 17, 9],\n      },\n    },\n  },\n  blue: {\n    title: 'Blue',\n    tints: {\n      50: {\n        title: 'Blue 50',\n        hsl: [222, 100, 98],\n      },\n      100: {\n        title: 'Blue 100',\n        hsl: [222, 100, 95],\n      },\n      200: {\n        title: 'Blue 200',\n        hsl: [223, 100, 93],\n      },\n      300: {\n        title: 'Blue 300',\n        hsl: [224, 100, 83],\n      },\n      400: {\n        title: 'Blue 400',\n        hsl: [226, 100, 73],\n      },\n      500: {\n        title: 'Blue 500',\n        hsl: [232, 96, 66],\n      },\n      600: {\n        title: 'Blue 600',\n        hsl: [239, 78, 58],\n      },\n      700: {\n        title: 'Blue 700',\n        hsl: [241, 63, 41],\n      },\n      800: {\n        title: 'Blue 800',\n        hsl: [230, 55, 22],\n      },\n      900: {\n        title: 'Blue 900',\n        hsl: [234, 49, 17],\n      },\n      950: {\n        title: 'Blue 950',\n        hsl: [235, 43, 11],\n      },\n    },\n  },\n  purple: {\n    title: 'Purple',\n    tints: {\n      50: {\n        title: 'Purple 50',\n        hsl: [260, 95, 98],\n      },\n      100: {\n        title: 'Purple 100',\n        hsl: [260, 98, 96],\n      },\n      200: {\n        title: 'Purple 200',\n        hsl: [263, 96, 94],\n      },\n      300: {\n        title: 'Purple 300',\n        hsl: [262, 92, 84],\n      },\n      400: {\n        title: 'Purple 400',\n        hsl: [262, 88, 75],\n      },\n      500: {\n        title: 'Purple 500',\n        hsl: [262, 83, 64],\n      },\n      600: {\n        title: 'Purple 600',\n        hsl: [265, 79, 51],\n      },\n      700: {\n        title: 'Purple 700',\n        hsl: [263, 72, 36],\n      },\n      800: {\n        title: 'Purple 800',\n        hsl: [258, 60, 24],\n      },\n      900: {\n        title: 'Purple 900',\n        hsl: [257, 46, 17],\n      },\n      950: {\n        title: 'Purple 950',\n        hsl: [260, 41, 11],\n      },\n    },\n  },\n  magenta: {\n    title: 'Magenta',\n    tints: {\n      50: {\n        title: 'Magenta 50',\n        hsl: [340, 82, 98],\n      },\n      100: {\n        title: 'Magenta 100',\n        hsl: [339, 83, 95],\n      },\n      200: {\n        title: 'Magenta 200',\n        hsl: [339, 83, 93],\n      },\n      300: {\n        title: 'Magenta 300',\n        hsl: [340, 82, 82],\n      },\n      400: {\n        title: 'Magenta 400',\n        hsl: [340, 81, 69],\n      },\n      500: {\n        title: 'Magenta 500',\n        hsl: [340, 80, 53],\n      },\n      600: {\n        title: 'Magenta 600',\n        hsl: [337, 78, 39],\n      },\n      700: {\n        title: 'Magenta 700',\n        hsl: [333, 73, 28],\n      },\n      800: {\n        title: 'Magenta 800',\n        hsl: [328, 63, 18],\n      },\n      900: {\n        title: 'Magenta 900',\n        hsl: [327, 46, 14],\n      },\n      950: {\n        title: 'Magenta 950',\n        hsl: [341, 35, 9],\n      },\n    },\n  },\n  red: {\n    title: 'Red',\n    tints: {\n      50: {\n        title: 'Red 50',\n        hsl: [5, 100, 98],\n      },\n      100: {\n        title: 'Red 100',\n        hsl: [4, 100, 95],\n      },\n      200: {\n        title: 'Red 200',\n        hsl: [4, 98, 93],\n      },\n      300: {\n        title: 'Red 300',\n        hsl: [5, 95, 82],\n      },\n      400: {\n        title: 'Red 400',\n        hsl: [6, 90, 69],\n      },\n      500: {\n        title: 'Red 500',\n        hsl: [5, 85, 57],\n      },\n      600: {\n        title: 'Red 600',\n        hsl: [5, 78, 45],\n      },\n      700: {\n        title: 'Red 700',\n        hsl: [4, 70, 32],\n      },\n      800: {\n        title: 'Red 800',\n        hsl: [3, 58, 19],\n      },\n      900: {\n        title: 'Red 900',\n        hsl: [2, 41, 14],\n      },\n      950: {\n        title: 'Red 950',\n        hsl: [356, 30, 9],\n      },\n    },\n  },\n  orange: {\n    title: 'Orange',\n    tints: {\n      50: {\n        title: 'Orange 50',\n        hsl: [28, 100, 97],\n      },\n      100: {\n        title: 'Orange 100',\n        hsl: [25, 100, 93],\n      },\n      200: {\n        title: 'Orange 200',\n        hsl: [24, 100, 89],\n      },\n      300: {\n        title: 'Orange 300',\n        hsl: [24, 100, 76],\n      },\n      400: {\n        title: 'Orange 400',\n        hsl: [24, 100, 63],\n      },\n      500: {\n        title: 'Orange 500',\n        hsl: [24, 100, 49],\n      },\n      600: {\n        title: 'Orange 600',\n        hsl: [24, 98, 35],\n      },\n      700: {\n        title: 'Orange 700',\n        hsl: [24, 94, 25],\n      },\n      800: {\n        title: 'Orange 800',\n        hsl: [22, 82, 15],\n      },\n      900: {\n        title: 'Orange 900',\n        hsl: [17, 65, 12],\n      },\n      950: {\n        title: 'Orange 950',\n        hsl: [14, 43, 9],\n      },\n    },\n  },\n  yellow: {\n    title: 'Yellow',\n    tints: {\n      50: {\n        title: 'Yellow 50',\n        hsl: [51, 94, 94],\n      },\n      100: {\n        title: 'Yellow 100',\n        hsl: [52, 91, 86],\n      },\n      200: {\n        title: 'Yellow 200',\n        hsl: [50, 90, 78],\n      },\n      300: {\n        title: 'Yellow 300',\n        hsl: [47, 91, 65],\n      },\n      400: {\n        title: 'Yellow 400',\n        hsl: [44, 95, 53],\n      },\n      500: {\n        title: 'Yellow 500',\n        hsl: [39, 96, 42],\n      },\n      600: {\n        title: 'Yellow 600',\n        hsl: [34, 90, 31],\n      },\n      700: {\n        title: 'Yellow 700',\n        hsl: [31, 80, 22],\n      },\n      800: {\n        title: 'Yellow 800',\n        hsl: [28, 66, 14],\n      },\n      900: {\n        title: 'Yellow 900',\n        hsl: [24, 40, 11],\n      },\n      950: {\n        title: 'Yellow 950',\n        hsl: [24, 20, 8],\n      },\n    },\n  },\n  green: {\n    title: 'Green',\n    tints: {\n      50: {\n        title: 'Green 50',\n        hsl: [157, 89, 95],\n      },\n      100: {\n        title: 'Green 100',\n        hsl: [158, 89, 88],\n      },\n      200: {\n        title: 'Green 200',\n        hsl: [158, 87, 82],\n      },\n      300: {\n        title: 'Green 300',\n        hsl: [158, 86, 65],\n      },\n      400: {\n        title: 'Green 400',\n        hsl: [159, 88, 50],\n      },\n      500: {\n        title: 'Green 500',\n        hsl: [159, 96, 37],\n      },\n      600: {\n        title: 'Green 600',\n        hsl: [159, 98, 24],\n      },\n      700: {\n        title: 'Green 700',\n        hsl: [158, 98, 16],\n      },\n      800: {\n        title: 'Green 800',\n        hsl: [158, 91, 10],\n      },\n      900: {\n        title: 'Green 900',\n        hsl: [162, 72, 8],\n      },\n      950: {\n        title: 'Green 950',\n        hsl: [172, 51, 6],\n      },\n    },\n  },\n  cyan: {\n    title: 'Cyan',\n    tints: {\n      50: {\n        title: 'Cyan 50',\n        hsl: [180, 92, 95],\n      },\n      100: {\n        title: 'Cyan 100',\n        hsl: [180, 91, 88],\n      },\n      200: {\n        title: 'Cyan 200',\n        hsl: [180, 87, 78],\n      },\n      300: {\n        title: 'Cyan 300',\n        hsl: [180, 81, 66],\n      },\n      400: {\n        title: 'Cyan 400',\n        hsl: [180, 81, 49],\n      },\n      500: {\n        title: 'Cyan 500',\n        hsl: [182, 96, 38],\n      },\n      600: {\n        title: 'Cyan 600',\n        hsl: [185, 96, 26],\n      },\n      700: {\n        title: 'Cyan 700',\n        hsl: [185, 95, 16],\n      },\n      800: {\n        title: 'Cyan 800',\n        hsl: [187, 86, 11],\n      },\n      900: {\n        title: 'Cyan 900',\n        hsl: [188, 68, 9],\n      },\n      950: {\n        title: 'Cyan 950',\n        hsl: [196, 37, 8],\n      },\n    },\n  },\n}\n","import {RGB} from '../../types'\n\n/** @internal */\nexport function hexToRgb(hex: string): RGB {\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex)\n\n  if (!result) {\n    throw new Error('input is not valid hex')\n  }\n\n  return [parseInt(result[1], 16), parseInt(result[2], 16), parseInt(result[3], 16)]\n}\n","import {HSL, RGB} from '../../types'\n\n/**\n * @see https://css-tricks.com/converting-color-spaces-in-javascript/\n *\n * @internal\n */\nexport function rgbToHsl([r, g, b]: RGB): HSL {\n  // Make r, g, and b fractions of 1\n  r /= 255\n  g /= 255\n  b /= 255\n\n  // Find greatest and smallest channel values\n  const cmin = Math.min(r, g, b)\n  const cmax = Math.max(r, g, b)\n  const delta = cmax - cmin\n\n  let h = 0\n  let s = 0\n  let l = 0\n\n  // Calculate hue\n  // No difference\n  if (delta == 0) h = 0\n  // Red is max\n  else if (cmax == r) h = ((g - b) / delta) % 6\n  // Green is max\n  else if (cmax == g) h = (b - r) / delta + 2\n  // Blue is max\n  else h = (r - g) / delta + 4\n\n  h = Math.round(h * 60)\n\n  // Make negative hues positive behind 360°\n  if (h < 0) h += 360\n\n  // Calculate lightness\n  l = (cmax + cmin) / 2\n\n  // Calculate saturation\n  s = delta == 0 ? 0 : delta / (1 - Math.abs(2 * l - 1))\n\n  // Multiply l and s by 100\n  s = +(s * 100).toFixed(0)\n  l = +(l * 100).toFixed(0)\n\n  return [h, s, l]\n}\n","/** @internal */\nexport function clamp(num: number): number {\n  return Math.max(Math.min(num, 255), 0)\n}\n","import {RGB} from '../../types'\nimport {clamp} from '../clamp'\n\nfunction darkenChannel(backdrop: number, source: number) {\n  return Math.min(backdrop, source)\n}\n\n/**\n * Apply the `darken` blend mode\n * Source: https://www.w3.org/TR/compositing-1/#blendingdarken\n *\n * @internal\n */\nexport function darken(b: RGB, s: RGB): RGB {\n  return [\n    Math.round(clamp(darkenChannel(b[0] / 255, s[0] / 255) * 255)),\n    Math.round(clamp(darkenChannel(b[1] / 255, s[1] / 255) * 255)),\n    Math.round(clamp(darkenChannel(b[2] / 255, s[2] / 255) * 255)),\n  ]\n}\n","/** @internal */\nexport function interpolate(min: number, max: number, val: number): number {\n  const size = max - min\n\n  return min + size * val\n}\n","import {RGB} from '../../types'\nimport {interpolate} from '../interpolate'\n\n/** @internal */\nexport function limit(darkest: RGB, lightest: RGB, source: RGB): RGB {\n  const r = Math.round(interpolate(darkest[0], lightest[0], source[0] / 255))\n  const g = Math.round(interpolate(darkest[1], lightest[1], source[1] / 255))\n  const b = Math.round(interpolate(darkest[2], lightest[2], source[2] / 255))\n\n  return [r, g, b]\n}\n","import {RGB} from '../../types'\nimport {clamp} from '../clamp'\n\nfunction screenChannel(backdrop: number, source: number) {\n  return backdrop + source - backdrop * source\n}\n\n/**\n * Apply the `screen` blend mode\n * Source: https://www.w3.org/TR/compositing-1/#blendingscreen\n *\n * @internal\n */\nexport function screen(b: RGB, s: RGB): RGB {\n  return [\n    Math.round(clamp(screenChannel(b[0] / 255, s[0] / 255) * 255)),\n    Math.round(clamp(screenChannel(b[1] / 255, s[1] / 255) * 255)),\n    Math.round(clamp(screenChannel(b[2] / 255, s[2] / 255) * 255)),\n  ]\n}\n"],"names":["color"],"mappings":"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AO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;AACF,GAGa,UAAsB;IACjC,IAAM;QACJ,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;AACF,GAGa,MAAkB;IAC7B,IAAM;QACJ,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;AACF,GAGa,SAAqB;IAChC,IAAM;QACJ,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;AACF,GAGa,SAAqB;IAChC,IAAM;QACJ,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;AACF,GAGa,QAAoB;IAC/B,IAAM;QACJ,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;IACP;AACF,GAGa,OAAmB;IAC9B,IAAM;QACJ,OAAO;QACP,KAAK;IACP;IACA,KAAO;QACL,OAAO;QACP,KAAK;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","ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12],"debugId":null}},
    {"offset": {"line": 3192, "column": 0}, "map": {"version":3,"sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/bifur-client/dist/esm/createClient.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { distinctUntilChanged, filter, finalize, map, mapTo, mergeMap, share, shareReplay, switchMap, take, } from 'rxjs/operators';\nimport { combineLatest, defer, EMPTY, fromEvent, merge, of, partition, } from 'rxjs';\nimport { customAlphabet } from 'nanoid';\n// at 1000 IDs per second ~4 million years needed in order to have a 1% probability of at least one collision.\n// => https://zelark.github.io/nano-id-cc/\nvar defaultGetNextRequestId = customAlphabet('0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-', 20);\nvar HEARTBEAT = '♥';\nfunction formatRequest(method, params, id) {\n    return JSON.stringify({\n        jsonrpc: '2.0',\n        method: method,\n        params: addApiVersion(params, 'v1'),\n        id: id,\n    });\n}\nfunction tryParse(input) {\n    try {\n        return [null, JSON.parse(input)];\n    }\n    catch (error) {\n        return error instanceof Error ? [error] : [new Error(\"\".concat(error))];\n    }\n}\nfunction addApiVersion(params, v) {\n    return __assign(__assign({}, params), { apiVersion: v });\n}\nexport var createClient = function (connection$, options) {\n    if (options === void 0) { options = {}; }\n    var token$ = options.token$, _a = options.getNextRequestId, getNextRequestId = _a === void 0 ? defaultGetNextRequestId : _a;\n    var _b = partition(connection$.pipe(switchMap(function (connection) { return fromEvent(connection, 'message'); })), function (event) { return event.data === HEARTBEAT; }), heartbeats$ = _b[0], responses$ = _b[1];\n    var parsedResponses$ = responses$.pipe(mergeMap(function (response) {\n        var _a = tryParse(response.data), err = _a[0], msg = _a[1];\n        if (err) {\n            console.warn('Unable to parse message: %s', err.message);\n            return EMPTY;\n        }\n        if (!msg || !msg.jsonrpc) {\n            console.warn('Received empty or non-jsonrpc message: %s', msg);\n            return EMPTY;\n        }\n        return of(msg);\n    }), share());\n    var authedConnection$ = token$\n        ? combineLatest([token$, connection$]).pipe(distinctUntilChanged(function (_a, _b) {\n            var oldToken = _a[0], oldSocket = _a[1];\n            var newToken = _b[0], newSocket = _b[1];\n            return oldToken === newToken && oldSocket === newSocket;\n        }), switchMap(function (_a) {\n            var token = _a[0], ws = _a[1];\n            return token\n                ? call(ws, 'authorization', {\n                    authorization: \"Bearer \".concat(token),\n                }).pipe(take(1), mapTo(ws))\n                : of(ws);\n        }), shareReplay({ refCount: true, bufferSize: 1 }))\n        : connection$;\n    function call(ws, method, params) {\n        if (params === void 0) { params = {}; }\n        var requestId = getNextRequestId();\n        return merge(parsedResponses$.pipe(filter(function (rpcResult) { return rpcResult.id === requestId; }), map(function (rpcResult) { return rpcResult.result; })), defer(function () {\n            ws.send(formatRequest(method, params, requestId));\n            return EMPTY;\n        }));\n    }\n    // Will call the rpc method and return an observable that emits the first reply and then ends\n    function requestMethod(method, params) {\n        return authedConnection$.pipe(take(1), mergeMap(function (ws) { return call(ws, method, params).pipe(take(1)); }));\n    }\n    // Will call the rpc method with the '_subscribe' suffix and return an observable of all received messages and\n    // keeps the subscription open forever/until unsubscribe\n    function requestSubscribe(method, params) {\n        return authedConnection$.pipe(take(1), mergeMap(function (ws) {\n            return call(ws, \"\".concat(method, \"_subscribe\"), params).pipe(take(1), mergeMap(function (subscriptionId) {\n                return parsedResponses$.pipe(filter(function (message) {\n                    return message.method === \"\".concat(method, \"_subscription\") &&\n                        message.params.subscription === subscriptionId;\n                }), map(function (message) { return message.params.result; }), finalize(function () {\n                    if (ws.readyState !== ws.CLOSED &&\n                        ws.readyState !== ws.CLOSING) {\n                        ws.send(formatRequest(\"\".concat(method, \"_unsubscribe\"), { subscriptionId: subscriptionId }, getNextRequestId()));\n                    }\n                }));\n            }));\n        }));\n    }\n    return {\n        // heartbeat$ is a stream of date objects representing when the \"last message was received\"\n        // it will keep the connection open until it is unsubscribed and can therefore be used to keep connection alive\n        // between requests\n        heartbeats: merge(authedConnection$, heartbeats$, responses$).pipe(map(function () { return new Date(); })),\n        listen: function (method, params) {\n            return requestSubscribe(method, params);\n        },\n        request: function (method, params) {\n            return requestMethod(method, params);\n        },\n    };\n};\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3355, "column": 0}, "map": {"version":3,"sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/bifur-client/dist/esm/createConnect.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Observable } from 'rxjs';\nvar WebSocketError = /** @class */ (function (_super) {\n    __extends(WebSocketError, _super);\n    function WebSocketError(message, type, code, reason) {\n        var _this = _super.call(this, message) || this;\n        _this.type = type;\n        _this.code = code;\n        _this.reason = reason;\n        return _this;\n    }\n    return WebSocketError;\n}(Error));\nexport { WebSocketError };\nexport function createConnect(getWebsocketInstance) {\n    return function (url) {\n        return new Observable(function (subscriber) {\n            var ws = getWebsocketInstance(url);\n            var didUnsubscribe = false;\n            var onOpen = function () {\n                subscriber.next(ws);\n            };\n            var onError = function () {\n                subscriber.error(new WebSocketError('WebSocket connection error', 'CONNECTION_ERROR'));\n            };\n            var onClose = function (ev) {\n                if (!didUnsubscribe) {\n                    subscriber.error(new WebSocketError('WebSocket connection error', 'CONNECTION_CLOSED', ev.code, ev.reason));\n                }\n                else {\n                    subscriber.complete();\n                }\n            };\n            ws.onopen = onOpen;\n            ws.onclose = onClose;\n            ws.onerror = onError;\n            return function () {\n                didUnsubscribe = true;\n                ws.close(1000, 'WebSockets connection closed by client');\n            };\n        });\n    };\n}\n"],"names":[],"mappings":";;;;AAeA;AAfA,IAAI,YAAY,AAAC,IAAI,IAAI,IAAI,CAAC,SAAS,IAAK,AAAC;IACzC,IAAI,gBAAgB,SAAU,CAAC,EAAE,CAAC;QAC9B,gBAAgB,OAAO,cAAc,IAChC,CAAA;YAAE,WAAW,EAAE;QAAC,CAAA,aAAa,SAAS,SAAU,CAAC,EAAE,CAAC;YAAI,EAAE,SAAS,GAAG;QAAG,KAC1E,SAAU,CAAC,EAAE,CAAC;YAAI,IAAK,IAAI,KAAK,EAAG,IAAI,OAAO,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE;QAAE;QACpG,OAAO,cAAc,GAAG;IAC5B;IACA,OAAO,SAAU,CAAC,EAAE,CAAC;QACjB,IAAI,OAAO,MAAM,cAAc,MAAM,MACjC,MAAM,IAAI,UAAU,yBAAyB,OAAO,KAAK;QAC7D,cAAc,GAAG;QACjB,SAAS;YAAO,IAAI,CAAC,WAAW,GAAG;QAAG;QACtC,EAAE,SAAS,GAAG,MAAM,OAAO,OAAO,MAAM,CAAC,KAAK,CAAC,GAAG,SAAS,GAAG,EAAE,SAAS,EAAE,IAAI,IAAI;IACvF;AACJ;;AAEA,IAAI,iBAAgC,SAAU,MAAM;IAChD,UAAU,gBAAgB;IAC1B,SAAS,eAAe,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM;QAC/C,IAAI,QAAQ,OAAO,IAAI,CAAC,IAAI,EAAE,YAAY,IAAI;QAC9C,MAAM,IAAI,GAAG;QACb,MAAM,IAAI,GAAG;QACb,MAAM,MAAM,GAAG;QACf,OAAO;IACX;IACA,OAAO;AACX,EAAE;;AAEK,SAAS,cAAc,oBAAoB;IAC9C,OAAO,SAAU,GAAG;QAChB,OAAO,IAAI,iKAAA,CAAA,aAAU,CAAC,SAAU,UAAU;YACtC,IAAI,KAAK,qBAAqB;YAC9B,IAAI,iBAAiB;YACrB,IAAI,SAAS;gBACT,WAAW,IAAI,CAAC;YACpB;YACA,IAAI,UAAU;gBACV,WAAW,KAAK,CAAC,IAAI,eAAe,8BAA8B;YACtE;YACA,IAAI,UAAU,SAAU,EAAE;gBACtB,IAAI,CAAC,gBAAgB;oBACjB,WAAW,KAAK,CAAC,IAAI,eAAe,8BAA8B,qBAAqB,GAAG,IAAI,EAAE,GAAG,MAAM;gBAC7G,OACK;oBACD,WAAW,QAAQ;gBACvB;YACJ;YACA,GAAG,MAAM,GAAG;YACZ,GAAG,OAAO,GAAG;YACb,GAAG,OAAO,GAAG;YACb,OAAO;gBACH,iBAAiB;gBACjB,GAAG,KAAK,CAAC,MAAM;YACnB;QACJ;IACJ;AACJ","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3427, "column": 0}, "map": {"version":3,"sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/bifur-client/dist/esm/operators.js"],"sourcesContent":["import { timer, race } from 'rxjs';\nimport { mergeMap } from 'rxjs/operators';\n// Operator that will time out using <withObservable> if <due> time passes before receiving the first value\nexport var timeoutFirstWith = function (due, withObservable) {\n    return function (input$) {\n        return race(input$, timer(due).pipe(mergeMap(function () { return withObservable; })));\n    };\n};\n"],"names":[],"mappings":";;;AAAA;AAAA;AACA;;;AAEO,IAAI,mBAAmB,SAAU,GAAG,EAAE,cAAc;IACvD,OAAO,SAAU,MAAM;QACnB,OAAO,CAAA,GAAA,yKAAA,CAAA,OAAI,AAAD,EAAE,QAAQ,CAAA,GAAA,0KAAA,CAAA,QAAK,AAAD,EAAE,KAAK,IAAI,CAAC,CAAA,GAAA,4KAAA,CAAA,WAAQ,AAAD,EAAE;YAAc,OAAO;QAAgB;IACtF;AACJ","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3448, "column": 0}, "map": {"version":3,"sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/bifur-client/dist/esm/errorCodes.js"],"sourcesContent":["export var ERROR_CODES;\n(function (ERROR_CODES) {\n    // Connection-level errors\n    ERROR_CODES[ERROR_CODES[\"BAD_REQUEST\"] = 4000] = \"BAD_REQUEST\";\n    ERROR_CODES[ERROR_CODES[\"UNAUTHORIZED\"] = 4001] = \"UNAUTHORIZED\";\n    ERROR_CODES[ERROR_CODES[\"NOT_FOUND\"] = 4004] = \"NOT_FOUND\";\n    // Application-level errors\n    ERROR_CODES[ERROR_CODES[\"INVALID_REQUEST\"] = -32600] = \"INVALID_REQUEST\";\n    ERROR_CODES[ERROR_CODES[\"METHOD_NOT_FOUND\"] = -32601] = \"METHOD_NOT_FOUND\";\n    ERROR_CODES[ERROR_CODES[\"INVALID_PARAMS\"] = -32602] = \"INVALID_PARAMS\";\n    ERROR_CODES[ERROR_CODES[\"SUBSCRIPTION_NOT_FOUND\"] = -32602] = \"SUBSCRIPTION_NOT_FOUND\";\n    ERROR_CODES[ERROR_CODES[\"PARSE_ERROR\"] = -32700] = \"PARSE_ERROR\";\n})(ERROR_CODES || (ERROR_CODES = {}));\n"],"names":[],"mappings":";;;AAAO,IAAI;AACX,CAAC,SAAU,WAAW;IAClB,0BAA0B;IAC1B,WAAW,CAAC,WAAW,CAAC,cAAc,GAAG,KAAK,GAAG;IACjD,WAAW,CAAC,WAAW,CAAC,eAAe,GAAG,KAAK,GAAG;IAClD,WAAW,CAAC,WAAW,CAAC,YAAY,GAAG,KAAK,GAAG;IAC/C,2BAA2B;IAC3B,WAAW,CAAC,WAAW,CAAC,kBAAkB,GAAG,CAAC,MAAM,GAAG;IACvD,WAAW,CAAC,WAAW,CAAC,mBAAmB,GAAG,CAAC,MAAM,GAAG;IACxD,WAAW,CAAC,WAAW,CAAC,iBAAiB,GAAG,CAAC,MAAM,GAAG;IACtD,WAAW,CAAC,WAAW,CAAC,yBAAyB,GAAG,CAAC,MAAM,GAAG;IAC9D,WAAW,CAAC,WAAW,CAAC,cAAc,GAAG,CAAC,MAAM,GAAG;AACvD,CAAC,EAAE,eAAe,CAAC,cAAc,CAAC,CAAC","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3470, "column": 0}, "map": {"version":3,"sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/bifur-client/dist/esm/index.js"],"sourcesContent":["import { createClient } from './createClient';\nimport { createConnect } from './createConnect';\nimport { timeoutFirstWith } from './operators';\nimport { shareReplay, takeUntil } from 'rxjs/operators';\nimport { throwError, fromEvent, of } from 'rxjs';\nvar id = function (arg) { return arg; };\nexport { ERROR_CODES } from './errorCodes';\nexport { createClient };\nexport function fromUrl(url, options) {\n    if (options === void 0) { options = {}; }\n    var timeout = options.timeout, token$ = options.token$;\n    var connect = createConnect(function (url, protocols) {\n        return new window.WebSocket(url, protocols);\n    });\n    return createClient(connect(url).pipe(timeout\n        ? timeoutFirstWith(timeout, throwError(function () {\n            return new Error(\"Timeout after \".concat(timeout, \" while establishing WebSockets connection\"));\n        }))\n        : id, shareReplay({ refCount: true }), takeUntil(fromEvent(window, 'beforeunload'))), { token$: token$ });\n}\nexport function fromSanityClient(client) {\n    var _a = client.config(), dataset = _a.dataset, token = _a.token;\n    return fromUrl(client.getUrl(\"/socket/\".concat(dataset)).replace(/^http/, 'ws'), token ? { token$: of(token) } : {});\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;;;;;;AADA,IAAI,KAAK,SAAU,GAAG;IAAI,OAAO;AAAK;;;AAG/B,SAAS,QAAQ,GAAG,EAAE,OAAO;IAChC,IAAI,YAAY,KAAK,GAAG;QAAE,UAAU,CAAC;IAAG;IACxC,IAAI,UAAU,QAAQ,OAAO,EAAE,SAAS,QAAQ,MAAM;IACtD,IAAI,UAAU,CAAA,GAAA,8KAAA,CAAA,gBAAa,AAAD,EAAE,SAAU,GAAG,EAAE,SAAS;QAChD,OAAO,IAAI,OAAO,SAAS,CAAC,KAAK;IACrC;IACA,OAAO,CAAA,GAAA,6KAAA,CAAA,eAAY,AAAD,EAAE,QAAQ,KAAK,IAAI,CAAC,UAChC,CAAA,GAAA,0KAAA,CAAA,mBAAgB,AAAD,EAAE,SAAS,CAAA,GAAA,+KAAA,CAAA,aAAU,AAAD,EAAE;QACnC,OAAO,IAAI,MAAM,iBAAiB,MAAM,CAAC,SAAS;IACtD,MACE,IAAI,CAAA,GAAA,+KAAA,CAAA,cAAW,AAAD,EAAE;QAAE,UAAU;IAAK,IAAI,CAAA,GAAA,6KAAA,CAAA,YAAS,AAAD,EAAE,CAAA,GAAA,8KAAA,CAAA,YAAS,AAAD,EAAE,QAAQ,mBAAmB;QAAE,QAAQ;IAAO;AAC/G;AACO,SAAS,iBAAiB,MAAM;IACnC,IAAI,KAAK,OAAO,MAAM,IAAI,UAAU,GAAG,OAAO,EAAE,QAAQ,GAAG,KAAK;IAChE,OAAO,QAAQ,OAAO,MAAM,CAAC,WAAW,MAAM,CAAC,UAAU,OAAO,CAAC,SAAS,OAAO,QAAQ;QAAE,QAAQ,CAAA,GAAA,uKAAA,CAAA,KAAE,AAAD,EAAE;IAAO,IAAI,CAAC;AACtH","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3533, "column": 0}, "map": {"version":3,"file":"noopLogger-b5b1676e.js","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/telemetry/src/utils/browserEvents.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/telemetry/src/noopLogger.ts"],"sourcesContent":["import {TelemetryStore} from '@sanity/telemetry'\n\nconst capture = {capture: true}\n\nfunction listen(target: EventTarget, type: string, cb: () => void) {\n  target.addEventListener(type, cb, capture)\n  return () => target.removeEventListener(type, cb, capture)\n}\n\nexport function onPageHide(listener: () => void) {\n  // prefer pagehide to unload event\n  if ('onpagehide' in window) {\n    return listen(window, 'pagehide', listener)\n  }\n  // only register beforeunload/unload in browsers that don't support\n  // pagehide to avoid breaking bfcache\n  const cleanupUnload = listen(window, 'unload', listener)\n  const cleanupBeforeUnload = listen(window, 'unload', listener)\n  return () => {\n    cleanupUnload()\n    cleanupBeforeUnload()\n  }\n}\n\nexport function onVisibilityHidden(cb: () => void) {\n  return listen(document, 'visibilitychange', () => {\n    if (document.visibilityState === 'hidden') {\n      cb()\n    }\n  })\n}\n\nexport function registerLifecycleEvents(store: TelemetryStore<unknown>) {\n  const unregisterVisibilityHidden = onVisibilityHidden(() => store.flush())\n  const unregisterPageHide = onPageHide(() => store.endWithBeacon())\n  return () => {\n    unregisterPageHide()\n    unregisterVisibilityHidden()\n  }\n}\n","import {DefinedTelemetryTrace, TelemetryLogger, TelemetryTrace} from './types'\n\nfunction createNoopLogger(): TelemetryLogger<unknown> {\n  const logger = {\n    updateUserProperties() {},\n    trace,\n    log,\n  }\n  function trace(\n    telemetryTrace: DefinedTelemetryTrace<unknown, unknown>,\n  ): TelemetryTrace<unknown, unknown> {\n    return {\n      start() {},\n      log(data?: unknown) {},\n      complete() {},\n      newContext(name: string) {\n        return logger\n      },\n      error(error: Error) {},\n      await: (promise: Promise<unknown>) => promise,\n    }\n  }\n\n  function log(event: unknown, data?: unknown) {}\n\n  return logger\n}\n\nexport const noopLogger = createNoopLogger()\n"],"names":["capture","listen","target","type","cb","addEventListener","removeEventListener","onPageHide","listener","window","cleanupUnload","cleanupBeforeUnload","onVisibilityHidden","document","visibilityState","registerLifecycleEvents","store","unregisterVisibilityHidden","flush","unregisterPageHide","endWithBeacon","createNoopLogger","logger","updateUserProperties","trace","log","telemetryTrace","start","data","complete","newContext","name","error","await","promise","event","noopLogger"],"mappings":";;;;;;AAEA,MAAMA,OAAA,GAAU;IAACA,OAAA,EAAS;CAAI;AAE9B,SAASC,MAAAA,CAAOC,MAAqB,EAAAC,IAAA,EAAcC,EAAgB,EAAA;IAC1DF,MAAA,CAAAG,gBAAA,CAAiBF,IAAM,EAAAC,EAAA,EAAIJ,OAAO,CAAA;IACzC,OAAO,IAAME,MAAA,CAAOI,mBAAoB,CAAAH,IAAA,EAAMC,IAAIJ,OAAO,CAAA;AAC3D;AAEO,SAASO,WAAWC,QAAsB,EAAA;IAE/C,IAAI,gBAAgBC,MAAQ,EAAA;QACnB,OAAAR,MAAA,CAAOQ,MAAQ,EAAA,UAAA,EAAYD,QAAQ,CAAA;IAC5C;IAGA,MAAME,aAAgB,GAAAT,MAAA,CAAOQ,MAAQ,EAAA,QAAA,EAAUD,QAAQ,CAAA;IACvD,MAAMG,mBAAsB,GAAAV,MAAA,CAAOQ,MAAQ,EAAA,QAAA,EAAUD,QAAQ,CAAA;IAC7D,OAAO,MAAM;QACGE,aAAA,EAAA;QACMC,mBAAA,EAAA;IAAA,CACtB;AACF;AAEO,SAASC,mBAAmBR,EAAgB,EAAA;IAC1C,OAAAH,MAAA,CAAOY,QAAU,EAAA,kBAAA,EAAoB,MAAM;QAC5C,IAAAA,QAAA,CAASC,eAAAA,KAAoB,QAAU,EAAA;YACtCV,EAAA,EAAA;QACL;IAAA,CACD,CAAA;AACH;AAEO,SAASW,wBAAwBC,KAAgC,EAAA;IACtE,MAAMC,0BAA6B,GAAAL,kBAAA,CAAmB,IAAMI,KAAA,CAAME,KAAAA,CAAO,CAAA,CAAA;IACzE,MAAMC,kBAAqB,GAAAZ,UAAA,CAAW,IAAMS,KAAA,CAAMI,aAAAA,CAAe,CAAA,CAAA;IACjE,OAAO,MAAM;QACQD,kBAAA,EAAA;QACQF,0BAAA,EAAA;IAAA,CAC7B;AACF;ACrCA,SAASI,gBAA6CA,CAAA,EAAA;IACpD,MAAMC,MAAS,GAAA;QACbC,oBAAuBA,CAAA,EAAA,EAAC,CAAA;QACxBC,KAAA;QACAC;IAAA,CACF;IACA,SAASD,MACPE,cACkC,EAAA;QAC3B,OAAA;YACLC,KAAQA,CAAA,EAAA,EAAC,CAAA;YACTF,KAAIG,IAAgB,EAAA,CAAC,CAAA;YACrBC,QAAWA,CAAA,EAAA,EAAC,CAAA;YACZC,YAAWC,IAAc,EAAA;gBAChB,OAAAT,MAAA;YACT,CAAA;YACAU,OAAMA,KAAc,EAAA,CAAC,CAAA;YACrBC,KAAA,GAAQC,OAA8B,GAAAA;QAAA,CACxC;IACF;IAES,SAAAT,GAAAA,CAAIU,KAAAA,EAAgBP,IAAgB,EAAA,CAAC;IAEvC,OAAAN,MAAA;AACT;AAEO,MAAMc,aAAaf,gBAAiB,CAAA,CAAA","ignoreList":[0,1],"debugId":null}},
    {"offset": {"line": 3602, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/telemetry/src/createSessionId.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/telemetry/src/createTraceId.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/telemetry/src/utils/trimErrorMessage.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/telemetry/src/createStore.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/telemetry/src/createBatchedStore.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/telemetry/src/defineEvent.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/telemetry/src/defineTrace.ts"],"sourcesContent":["import {typeid} from 'typeid-js'\n\n/**\n * @public\n */\nexport type SessionId = string & {__type: 'SessionId'}\n\nexport function createSessionId(): SessionId {\n  return typeid('session').toString() as SessionId\n}\n","import {typeid} from 'typeid-js'\n\n/**\n * @public\n */\nexport type TraceId = string & {__type: 'TraceId'}\n\nexport function createTraceId(): TraceId {\n  return typeid('trace').toString() as TraceId\n}\n","function splitAt(str: string, index: number) {\n  return index < 1 ? [str, ''] : [str.substring(0, index), str.substring(index)]\n}\n\nconst MAX_LENGTH = 1024\n\nexport function trimErrorMessage(errorMessage: string) {\n  const newLineIndex = errorMessage.indexOf('\\n')\n  const splitIndex =\n    newLineIndex === -1 ? MAX_LENGTH : Math.min(newLineIndex, MAX_LENGTH)\n  const [first, rest] = splitAt(errorMessage, splitIndex)\n\n  return first + (rest ? `… (+${rest.length})` : '')\n}\n","import {\n  DefinedTelemetryLog,\n  DefinedTelemetryTrace,\n  TelemetryEvent,\n  TelemetryLogEvent,\n  TelemetryLogger,\n  TelemetryTrace,\n  TelemetryTraceEvent,\n} from './types'\nimport {Observable, Subject} from 'rxjs'\nimport {SessionId} from './createSessionId'\nimport {createTraceId} from './createTraceId'\nimport {trimErrorMessage} from './utils/trimErrorMessage'\n\n/**\n * Bare-bones store for logging and reacting to telemetry events\n * @internal\n * @param sessionId\n */\nexport function createStore<UserProperties>(sessionId: SessionId): {\n  events$: Observable<TelemetryEvent>\n  logger: TelemetryLogger<UserProperties>\n} {\n  const logEntries$ = new Subject<TelemetryEvent>()\n  const eventSampleTimes = new WeakMap<DefinedTelemetryLog<unknown>, Date>()\n\n  function pushTraceError<Data, Err extends {message: string}>(\n    traceId: string,\n    telemetryTrace: DefinedTelemetryTrace<Data>,\n    error: {message: string},\n    context: unknown,\n  ) {\n    logEntries$.next({\n      sessionId,\n      type: 'trace.error',\n      traceId,\n      name: telemetryTrace.name,\n      version: telemetryTrace.version,\n      data: {message: trimErrorMessage(error.message)},\n      context,\n      createdAt: new Date().toISOString(),\n    })\n  }\n\n  function pushTraceEntry<Data>(\n    type: 'trace.start',\n    traceId: string,\n    telemetryTrace: DefinedTelemetryTrace<Data>,\n    data: undefined,\n    context: unknown,\n  ): void\n  function pushTraceEntry<Data>(\n    type: 'trace.log',\n    traceId: string,\n    telemetryTrace: DefinedTelemetryTrace<Data>,\n    data: Data,\n    context: unknown,\n  ): void\n  function pushTraceEntry<Data>(\n    type: 'trace.complete',\n    traceId: string,\n    telemetryTrace: DefinedTelemetryTrace<Data>,\n    data: Data,\n    context: unknown,\n  ): void\n\n  function pushTraceEntry<Data>(\n    type: TelemetryTraceEvent['type'],\n    traceId: string,\n    telemetryTrace: DefinedTelemetryTrace<Data>,\n    data: Data,\n    context: unknown,\n  ) {\n    logEntries$.next({\n      sessionId,\n      type,\n      traceId,\n      name: telemetryTrace.name,\n      version: telemetryTrace.version,\n      data,\n      context,\n      createdAt: new Date().toISOString(),\n    })\n  }\n\n  function pushLogEntry<Data>(\n    type: TelemetryLogEvent['type'],\n    event: DefinedTelemetryLog<Data>,\n    data?: unknown,\n  ) {\n    logEntries$.next({\n      sessionId,\n      type,\n      version: event.version,\n      name: event.name,\n      data,\n      createdAt: new Date().toISOString(),\n    })\n  }\n\n  function pushUserPropertiesEntry(properties: UserProperties) {\n    logEntries$.next({\n      sessionId,\n      type: 'userProperties',\n      properties: properties,\n      createdAt: new Date().toISOString(),\n    })\n  }\n\n  function createTrace<Data = void>(\n    traceId: string,\n    traceDef: DefinedTelemetryTrace<Data>,\n    context: unknown,\n  ): TelemetryTrace<UserProperties, Data> {\n    return {\n      start() {\n        pushTraceEntry('trace.start', traceId, traceDef, undefined, context)\n      },\n      newContext(name: string): TelemetryLogger<UserProperties> {\n        return {\n          trace<InnerData>(innerTraceDef: DefinedTelemetryTrace<InnerData>) {\n            return createTrace<InnerData>(\n              `${traceId}.${name}`,\n              innerTraceDef,\n              context,\n            )\n          },\n          updateUserProperties() {},\n          log,\n        }\n      },\n      log(data?: unknown) {\n        pushTraceEntry('trace.log', traceId, traceDef, data, context)\n      },\n      complete() {\n        pushTraceEntry('trace.complete', traceId, traceDef, undefined, context)\n      },\n      error(error: {message: string}) {\n        pushTraceError(traceId, traceDef, error, context)\n      },\n      await<P extends Promise<Data>>(promise: P, data?: Data): P {\n        this.start()\n        promise.then(\n          (result) => {\n            this.log(data ? data : result)\n            this.complete()\n            return result\n          },\n          (error) => {\n            this.error(error)\n            throw error\n          },\n        )\n        return promise\n      },\n    }\n  }\n\n  function log<Data>(event: DefinedTelemetryLog<Data>, data?: Data) {\n    if (typeof event.maxSampleRate === 'number' && event.maxSampleRate > 0) {\n      const lastSampledAt = eventSampleTimes.get(event)\n      const now = new Date()\n      if (\n        !lastSampledAt ||\n        now.getTime() - lastSampledAt.getTime() > event.maxSampleRate\n      ) {\n        eventSampleTimes.set(event, now)\n        pushLogEntry('log', event, data)\n      }\n    } else {\n      pushLogEntry('log', event, data)\n    }\n  }\n\n  return {\n    events$: logEntries$.asObservable(),\n    logger: {\n      updateUserProperties(properties: UserProperties) {\n        pushUserPropertiesEntry(properties)\n      },\n      trace: <Data>(\n        traceDef: DefinedTelemetryTrace<Data>,\n        context: unknown,\n      ) => {\n        const traceId = createTraceId()\n        return createTrace(traceId, traceDef, context)\n      },\n      log,\n    },\n  }\n}\n","import {TelemetryEvent, TelemetryStore} from './types'\nimport {\n  catchError,\n  combineLatest,\n  combineLatestAll,\n  concatMap,\n  EMPTY,\n  from,\n  lastValueFrom,\n  map,\n  mergeMap,\n  Observable,\n  of,\n  tap,\n  throttle,\n} from 'rxjs'\nimport {SessionId} from './createSessionId'\nimport {createStore} from './createStore'\n\n/**\n * This is like rxjs.timer() except for that it's calling timeout.unref()\n * This prevents the timer from keeping the event loop active https://nodejs.org/api/timers.html#timeoutunref\n * We don't want any of our timers to hold up the process from completing\n * @param ms\n */\nconst unrefTimer = (ms: number) =>\n  new Observable((subscriber) => {\n    const timeout = setTimeout(() => {\n      subscriber.next()\n      subscriber.complete()\n    }, ms)\n    if (typeof timeout.unref === 'function') {\n      // unref the timeout to avoid holding the process open in node.js\n      timeout.unref()\n    }\n    return () => clearTimeout(timeout)\n  })\n\n/**\n * 'unknown' - we don't know if the user has consented or not (e.g. something went wrong)\n * 'unset' - the user has not yet been asked for consent\n * 'granted' - the user has consented\n * 'denied' - the user has denied consent\n */\nexport type ConsentStatus = 'undetermined' | 'unset' | 'granted' | 'denied'\n\nexport interface CreateBatchedStoreOptions {\n  /**\n   * Optionally provide a flush interval\n   */\n  flushInterval?: number\n\n  /**\n   *  Provide a strategy for resolving consent depending on context (e.g. studio/cli)\n   *  @public\n   */\n  resolveConsent: () => Promise<{status: ConsentStatus}>\n  /**\n   * Provide a strategy for submitting events (e.g. using fetch in browser, or node server side)\n   * @public\n   */\n  sendEvents: (events: TelemetryEvent[]) => Promise<unknown>\n\n  /**\n   * Optionally provide a strategy for submitting final events (e.g. events that's queued when the browser exits)\n   * @public\n   */\n  sendBeacon?: (events: TelemetryEvent[]) => boolean\n}\n\nexport function createBatchedStore<UserProperties>(\n  sessionId: SessionId,\n  options: CreateBatchedStoreOptions,\n): TelemetryStore<UserProperties> {\n  const store = createStore<UserProperties>(sessionId)\n\n  function resolveConsent(): Promise<{status: ConsentStatus}> {\n    return options.resolveConsent().catch((err) =>\n      // if we for some reason can't fetch consent we treat it as \"undetermined\", and try again at next flush\n      ({status: 'undetermined' as const}),\n    )\n  }\n\n  const _buffer: TelemetryEvent[] = []\n\n  function consume() {\n    const buf = _buffer.slice()\n    _buffer.length = 0\n    return buf\n  }\n\n  function submit() {\n    const pending = consume()\n    if (pending.length === 0) {\n      return EMPTY\n    }\n    return combineLatest([of(pending), resolveConsent()]).pipe(\n      mergeMap(([events, consent]) => {\n        if (events.length === 0 || consent.status !== 'granted') {\n          // consent is not granted, we just consumed (cleared) the buffer so we can return empty\n          return EMPTY\n        }\n        return from(options.sendEvents(events)).pipe(\n          catchError((err) => {\n            // In case of error, put events back on the buffer\n            _buffer.unshift(...events)\n            // and ignore the error\n            return EMPTY\n          }),\n        )\n      }),\n    )\n  }\n\n  const flushInterval = options.flushInterval ?? 30000\n\n  const flush$ = store.events$.pipe(\n    tap((ev) => _buffer.push(ev)),\n    map(() => {}), // void to avoid accidental use of events further down the pipe\n    throttle(() => unrefTimer(flushInterval), {\n      leading: false,\n      trailing: true,\n    }),\n    concatMap(() => submit()),\n  )\n\n  function flush() {\n    return lastValueFrom(submit(), {\n      defaultValue: undefined,\n    }).then(() => {})\n  }\n\n  // start subscribing to events\n  const subscription = flush$.subscribe()\n\n  function endWithBeacon() {\n    if (!options.sendBeacon) {\n      // we don't have a beacon strategy, so we just flush - this may make us lose events, but it's the best we can do\n      end()\n      return true\n    }\n    const events = consume()\n    subscription.unsubscribe()\n    return events.length > 0 ? options.sendBeacon(events) : true\n  }\n\n  function end() {\n    // flush before destroying\n    return flush()\n      .then(\n        () => {}, // void promise\n        () => {}, // ignore errors\n      )\n      .finally(() => {\n        // Note: we might end up with an error here\n        subscription.unsubscribe()\n      })\n  }\n\n  return {\n    end,\n    endWithBeacon,\n    // Note: flush may fail\n    flush,\n    logger: store.logger,\n  }\n}\n","import {DefinedTelemetryLog, TelemetryLogOptions} from './types'\n\n/**\n * @param options\n */\nexport function defineEvent<Data = void>(\n  options: TelemetryLogOptions,\n): DefinedTelemetryLog<Data> {\n  return {\n    type: 'log',\n    name: options.name,\n    version: options.version,\n    description: options.description,\n    maxSampleRate: options.maxSampleRate,\n    schema: undefined as unknown as Data,\n  }\n}\n","import {DefinedTelemetryTrace, TelemetryTraceOptions} from './types'\n\n/**\n * @param options\n * */\nexport function defineTrace<Data = void, Context = void>(\n  options: TelemetryTraceOptions,\n): DefinedTelemetryTrace<Data, Context> {\n  return {\n    type: 'trace',\n    name: options.name,\n    version: options.version,\n    description: options.description,\n    schema: undefined as unknown as Data,\n    context: undefined as unknown as Context,\n  }\n}\n"],"names":["createSessionId","typeid","toString","createTraceId","splitAt","str","index","substring","MAX_LENGTH","trimErrorMessage","errorMessage","newLineIndex","indexOf","splitIndex","Math","min","first","rest","concat","length","createStore","sessionId","logEntries$","Subject","eventSampleTimes","WeakMap","pushTraceError","traceId","telemetryTrace","error","context","next","type","name","version","data","message","createdAt","Date","toISOString","pushTraceEntry","pushLogEntry","event","pushUserPropertiesEntry","properties","createTrace","traceDef","start","newContext","trace","innerTraceDef","updateUserProperties","log","complete","await","promise","then","result","maxSampleRate","lastSampledAt","get","now","getTime","set","events$","asObservable","logger","unrefTimer","ms","Observable","subscriber","timeout","setTimeout","unref","clearTimeout","createBatchedStore","options","_a","store","resolveConsent","catch","err","status","_buffer","consume","buf","slice","submit","pending","EMPTY","combineLatest","of","pipe","mergeMap","_ref","events","consent","from","sendEvents","catchError","unshift","flushInterval","flush$","tap","ev","push","map","throttle","leading","trailing","concatMap","flush","lastValueFrom","defaultValue","subscription","subscribe","endWithBeacon","sendBeacon","end","unsubscribe","finally","defineEvent","description","schema","defineTrace"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6],"debugId":null}},
    {"offset": {"line": 3874, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/telemetry/src/react/useTelemetryStoreLifeCycleEvents.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/telemetry/src/react/TelemetryProvider.tsx","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/telemetry/src/react/useTelemetry.ts"],"sourcesContent":["import type {TelemetryStore} from '../types'\nimport {useEffect} from 'react'\nimport {onPageHide, onVisibilityHidden} from '../utils/browserEvents'\n\nexport function useTelemetryStoreLifeCycleEvents(\n  store: TelemetryStore<unknown>,\n) {\n  // when visibility changes to hidden, flush events, but continue tracking\n  useEffect(() => onVisibilityHidden(store.flush), [store.flush])\n  // when browser navigates away, closes or reloads the page, use provided sendBeacon method to send events\n  useEffect(() => onPageHide(store.endWithBeacon), [store.endWithBeacon])\n}\n","import type React from 'react'\nimport {createContext} from 'react'\nimport {TelemetryLogger, TelemetryStore} from '../types'\nimport {useTelemetryStoreLifeCycleEvents} from './useTelemetryStoreLifeCycleEvents'\nimport {noopLogger} from '../noopLogger'\n\n/**\n * @internal\n */\nexport const TelemetryLoggerContext =\n  createContext<TelemetryLogger<unknown>>(noopLogger)\n\nexport function TelemetryProvider<UserProperties>({\n  children,\n  store,\n}: {\n  children: React.ReactNode\n  store: TelemetryStore<UserProperties>\n}) {\n  // Hook the telemetry store up to page life cycle events like hide/unload\n  useTelemetryStoreLifeCycleEvents(store)\n\n  return (\n    <TelemetryLoggerContext.Provider value={store.logger}>\n      {children}\n    </TelemetryLoggerContext.Provider>\n  )\n}\n","import {useContext} from 'react'\nimport {TelemetryLoggerContext} from './TelemetryProvider'\nimport type {TelemetryLogger} from '../'\n\nexport function useTelemetry<\n  UserProperties,\n>(): TelemetryLogger<UserProperties> {\n  return useContext(TelemetryLoggerContext) as TelemetryLogger<UserProperties>\n}\n"],"names":["useTelemetryStoreLifeCycleEvents","store","useEffect","onVisibilityHidden","flush","onPageHide","endWithBeacon","TelemetryLoggerContext","createContext","noopLogger","TelemetryProvider","_ref","children","Provider","value","logger","useTelemetry","useContext"],"mappings":";;;;;;;;;;;AAIO,SAASA,iCACdC,KACA,EAAA;sKAEUC,YAAAA,AAAA;sDAAA,8LAAMC,qBAAAA,EAAmBF,KAAM,CAAAG,KAAK;qDAAG;QAACH,KAAA,CAAMG,KAAK;KAAC,CAAA;IAEpDF,8KAAAA,AAAA;sDAAA,8LAAMG,aAAAA,EAAWJ,KAAM,CAAAK,aAAa;qDAAG;QAACL,KAAA,CAAMK,aAAa;KAAC,CAAA;AACxE;ACFa,MAAAC,sBAAA,IACXC,iLAAAA,wLAAwCC,aAAU,CAAA;AAE7C,SAASC,iBAAkCA,CAAAC,IAAA,EAM/C;IAAA,IAN+C,EAChDC,QAAA,EACAX,KAAAA,EAIC,GAAAU,IAAA;IAEDX,gCAAA,CAAiCC,KAAK,CAAA;IAEtC,OAAA,aAAA,GAAA,CAAA,GAAA,sKAAA,CAAA,MAAA,EACGM,sBAAuB,CAAAM,QAAA,EAAvB;QAAgCC,KAAO,EAAAb,KAAA,CAAMc,MAAAA;QAC3CH;IACH,CAAA,CAAA;AAEJ;ACvBO,SAASI,YAEqBA,CAAA,EAAA;IACnC,yKAAOC,aAAAA,EAAWV,sBAAsB,CAAA;AAC1C","ignoreList":[0,1,2],"debugId":null}},
    {"offset": {"line": 3917, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/asset-utils/src/constants.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/asset-utils/src/errors.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/asset-utils/src/utils.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/asset-utils/src/asserters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/asset-utils/src/hotspotCrop.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/asset-utils/src/paths.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/asset-utils/src/parse.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/asset-utils/src/resolve.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/asset-utils/src/urls.ts"],"sourcesContent":["/**\n * @internal\n */\nexport const cdnUrl = 'https://cdn.sanity.io'\n\n/**\n * @internal\n */\nexport const cdnUrlPattern = /^https:\\/\\/cdn\\.sanity\\./\n\n/**\n * @internal\n */\nexport const customCdnUrlPattern =\n  /^https:\\/\\/cdn\\.[^/]+\\/(images|files)\\/[^/]+\\/.*?[a-zA-Z0-9_]{24,40}.*$/\n\n/**\n * @internal\n */\nexport const fileAssetFilenamePattern = /^([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+\\.[a-z0-9]+$/\n\n/**\n * @internal\n */\nexport const fileAssetIdPattern = /^file-([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+-[a-z0-9]+$/\n\n/**\n * @internal\n */\nexport const imageAssetFilenamePattern = /^([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})-\\d+x\\d+\\.[a-z0-9]+$/\n\n/**\n * @internal\n */\nexport const imageAssetIdPattern = /^image-([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+-\\d+x\\d+-[a-z0-9]+$/\n\n/**\n * @internal\n */\nexport const assetFilenamePattern =\n  /^(([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+|([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+-\\d+x\\d+\\.[a-z0-9]+)$/\n\n/**\n * @internal\n */\nexport const pathPattern = /^(images|files)\\/([a-z0-9]+)\\/([a-z0-9][-\\w]*)\\//\n\n/**\n * @internal\n */\nexport const idPattern =\n  /^(?:image-(?:[a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+-\\d+x\\d+-[a-z0-9]+|file-(?:[a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+-[a-z0-9]+)$/\n\n/**\n * Asset type for image assets\n * @internal\n */\nexport const imageAssetType = 'sanity.imageAsset'\n\n/**\n * Asset type for file assets\n * @internal\n */\nexport const fileAssetType = 'sanity.fileAsset'\n\n/**\n * For use in cases where the project and dataset doesn't really matter\n *\n * @internal\n */\nexport const dummyProject = {projectId: 'a', dataset: 'b'}\n\n/**\n * Placeholder asset _ids for in-progress uploads\n * @internal\n */\nexport const inProgressAssetId = 'upload-in-progress-placeholder'\n\n/**\n * Placeholder assetId for in-progress uploads\n * @internal\n */\nexport const inProgressAssetAssetId = 'upload-in-progress'\n\n/**\n * Placeholder extension for in-progress uploads\n * @internal\n */\nexport const inProgressAssetExtension = 'tmp'\n","/**\n * Error type thrown when the library fails to resolve a value, such as an asset ID,\n * filename or project ID/dataset information.\n *\n * The `input` property holds the value passed as the input, which failed to be\n * resolved to something meaningful.\n *\n * @public\n */\nexport class UnresolvableError extends Error {\n  unresolvable = true\n\n  // The input may not be a valid source, so let's not type it as one\n  input?: unknown\n\n  constructor(inputSource: unknown, message = 'Failed to resolve asset ID from source') {\n    super(message)\n    this.input = inputSource\n  }\n}\n\n/**\n * Checks whether or not an error instance is of type UnresolvableError\n *\n * @param err - Error to check for unresolvable error type\n * @returns True if the passed error instance appears to be an unresolvable error\n * @public\n */\nexport function isUnresolvableError(err: unknown): err is UnresolvableError {\n  const error = err as UnresolvableError\n  return Boolean(error.unresolvable && 'input' in error)\n}\n","import {isUnresolvableError} from './errors'\nimport type {SafeFunction} from './types'\n\n/**\n * Returns a getter which returns `undefined` instead of throwing,\n * if encountering an `UnresolvableError`\n *\n * @param method - Function to use as resolver\n * @returns Function that returns `undefined` if passed resolver throws UnresolvableError\n * @internal\n */\nexport function getForgivingResolver<Args extends unknown[], Return>(\n  method: (...args: Args) => Return,\n): SafeFunction<Args, Return> {\n  return (...args: Args): Return | undefined => {\n    try {\n      return method(...args)\n    } catch (err) {\n      if (isUnresolvableError(err)) {\n        return undefined\n      }\n\n      throw err\n    }\n  }\n}\n\n/**\n * Checks whether or not the passed object is an object (and not `null`)\n *\n * @param obj Item to check whether or not is an object\n * @returns Whether or not `obj` is an object\n * @internal\n */\nexport function isObject(obj: unknown): obj is object {\n  return obj !== null && !Array.isArray(obj) && typeof obj === 'object'\n}\n","import {\n  cdnUrlPattern,\n  customCdnUrlPattern,\n  fileAssetIdPattern,\n  imageAssetIdPattern,\n} from './constants.js'\nimport type {\n  SanityAssetIdStub,\n  SanityAssetObjectStub,\n  SanityAssetPathStub,\n  SanityAssetUrlStub,\n  SanityFileAsset,\n  SanityFileUploadStub,\n  SanityImageAsset,\n  SanityImageUploadStub,\n  SanityReference,\n} from './types.js'\nimport {isObject} from './utils.js'\n\n/**\n * Checks whether or not the given source is a Sanity reference\n * (an object containing _ref string key)\n *\n * @param ref - Possible reference\n * @returns Whether or not the passed object is a reference\n * @public\n */\nexport function isReference(ref: unknown): ref is SanityReference {\n  return isObject(ref) && typeof (ref as SanityReference)._ref === 'string'\n}\n\n/**\n * Checks whether or not the given source is an asset ID stub\n * (an object containing an `_id` property)\n *\n * @param stub - Possible asset id stub\n * @returns Whether or not the passed object is an object id stub\n * @public\n */\nexport function isAssetIdStub(stub: unknown): stub is SanityAssetIdStub {\n  return isObject(stub) && typeof (stub as SanityAssetIdStub)._id === 'string'\n}\n\n/**\n * Checks whether or not the given source is an asset path stub\n * (an object containing a `path` property)\n *\n * @param stub - Possible asset path stub\n * @returns Whether or not the passed object is an object path stub\n * @public\n */\nexport function isAssetPathStub(stub: unknown): stub is SanityAssetPathStub {\n  return isObject(stub) && typeof (stub as SanityAssetPathStub).path === 'string'\n}\n\n/**\n * Checks whether or not the given source is an asset URL stub\n * (an object containing a `url` property)\n *\n * @param stub - Possible asset url stub\n * @returns Whether or not the passed object is an object url stub\n * @public\n */\nexport function isAssetUrlStub(stub: unknown): stub is SanityAssetUrlStub {\n  return isObject(stub) && typeof (stub as SanityAssetUrlStub).url === 'string'\n}\n\n/**\n * Checks whether or not the given source is a (partial) sanity file asset document.\n * Only checks the `_type` property, all other properties _may_ be missing\n *\n * @param src - Source to check\n * @returns Whether or not the given source is a file asset\n * @public\n */\nexport function isSanityFileAsset(src: unknown): src is SanityFileAsset {\n  return isObject(src) && (src as SanityFileAsset)._type === 'sanity.fileAsset'\n}\n\n/**\n * Checks whether or not the given source is a (partial) sanity image asset document.\n * Only checks the `_type` property, all other properties _may_ be missing\n *\n * @param src - Source to check\n * @returns Whether or not the given source is a file asset\n * @public\n */\nexport function isSanityImageAsset(src: unknown): src is SanityImageAsset {\n  return isObject(src) && (src as SanityImageAsset)._type === 'sanity.imageAsset'\n}\n\n/**\n * Checks whether or not the given document ID is a valid Sanity image asset document ID\n *\n * @param documentId - Document ID to check\n * @returns Whether or not the given document ID is a Sanity image asset document ID\n * @public\n */\nexport function isImageAssetId(documentId: string): boolean {\n  return imageAssetIdPattern.test(documentId)\n}\n\n/**\n * Checks whether or not the given document ID is a valid Sanity file asset document ID\n *\n * @param documentId - Document ID to check\n * @returns Whether or not the given document ID is a Sanity file asset document ID\n * @public\n */\nexport function isFileAssetId(documentId: string): boolean {\n  return fileAssetIdPattern.test(documentId)\n}\n\n/**\n * Checks whether or not the given document ID is a valid Sanity asset document ID (file or image)\n *\n * @param documentId - Document ID to check\n * @returns Whether or not the given document ID is a Sanity asset document ID (file or image)\n * @public\n */\nexport function isAssetId(documentId: string): boolean {\n  return isImageAssetId(documentId) || isFileAssetId(documentId)\n}\n\n/**\n * Checks whether or not the given source is an asset object stub\n *\n * @param stub - Possible asset object stub\n * @returns Whether or not the passed object is an object stub\n * @public\n */\nexport function isAssetObjectStub(stub: unknown): stub is SanityAssetObjectStub {\n  const item = stub as SanityAssetObjectStub\n  return isObject(item) && Boolean(item.asset) && typeof item.asset === 'object'\n}\n\n/**\n * Checks whether or not the given source is an in-progress upload\n * (has upload property but no asset property)\n *\n * @param stub - Possible in-progress upload\n * @returns Whether or not the passed object is an in-progress upload\n * @public\n */\nexport function isInProgressUpload(\n  stub: unknown,\n): stub is SanityImageUploadStub | SanityFileUploadStub {\n  const item = stub as SanityImageUploadStub | SanityFileUploadStub\n  return isObject(item) && Boolean(item._upload) && !('asset' in item)\n}\n\n/**\n * Checks whether or not the given URL is a valid Sanity CDN URL or what appears to be a valid\n * custom CDN URL (has to be prefixed with `cdn.`, and follow the same path pattern as Sanity CDN )\n *\n * @param url - URL to check\n * @returns True if Sanity CDN URL/Custom CDN URL, false otherwise\n * @internal\n */\nexport function isCdnUrl(url: string): boolean {\n  return cdnUrlPattern.test(url) || customCdnUrlPattern.test(url)\n}\n","import type {SanityImageCrop, SanityImageHotspot} from './types.js'\n\n/**\n * Default crop (equals to \"whole image\")\n *\n * @public\n */\nexport const DEFAULT_CROP: Readonly<SanityImageCrop> = Object.freeze({\n  left: 0,\n  top: 0,\n  bottom: 0,\n  right: 0,\n})\n\n/**\n * Default hotspot (equals to horizontal/vertical center, full size of image)\n *\n * @public\n */\nexport const DEFAULT_HOTSPOT: Readonly<SanityImageHotspot> = Object.freeze({\n  x: 0.5,\n  y: 0.5,\n  height: 1,\n  width: 1,\n})\n\n/**\n * Returns cloned version of the default crop (prevents accidental mutations)\n *\n * @returns Default image crop object\n * @public\n */\nexport const getDefaultCrop = (): SanityImageCrop => ({...DEFAULT_CROP})\n\n/**\n * Returns cloned version of the default hotspot (prevents accidental mutations)\n *\n * @returns Default image hotspot object\n * @public\n */\nexport const getDefaultHotspot = (): SanityImageHotspot => ({...DEFAULT_HOTSPOT})\n\n/**\n * Returns whether or not the passed crop has the default values for a crop region\n *\n * @param crop - The crop to return whether or not is the default crop\n * @returns True if passed crop matches default, false otherwise\n * @public\n */\nexport const isDefaultCrop = (crop: SanityImageCrop): boolean => {\n  const {top, bottom, left, right} = crop\n  const {\n    top: defaultTop,\n    bottom: defaultBottom,\n    left: defaultLeft,\n    right: defaultRight,\n  } = DEFAULT_CROP\n\n  return (\n    top === defaultTop && bottom === defaultBottom && left === defaultLeft && right === defaultRight\n  )\n}\n\n/**\n * Returns whether or not the passed hotspot has the default values for a hotspot region\n *\n * @param hotspot - The hotspot to return whether or not is the default hotspot\n * @returns True if passed hotspot matches default, false otherwise\n * @public\n */\nexport const isDefaultHotspot = (hotspot: SanityImageHotspot): boolean => {\n  const {x, y, width, height} = hotspot\n  const {x: defaultX, y: defaultY, width: defaultWidth, height: defaultHeight} = DEFAULT_HOTSPOT\n\n  return x === defaultX && y === defaultY && width === defaultWidth && height === defaultHeight\n}\n","import {\n  isAssetObjectStub,\n  isAssetPathStub,\n  isAssetUrlStub,\n  isCdnUrl,\n  isReference,\n} from './asserters.js'\nimport {\n  cdnUrl,\n  fileAssetFilenamePattern,\n  imageAssetFilenamePattern,\n  pathPattern,\n} from './constants.js'\nimport {UnresolvableError} from './errors.js'\nimport type {\n  FileUrlBuilderOptions,\n  ImageUrlBuilderOptions,\n  PathBuilderOptions,\n  SanityAssetSource,\n  SanityFileUrlParts,\n  SanityImageUrlParts,\n} from './types.js'\nimport {getForgivingResolver} from './utils.js'\n\n/**\n * Builds the base image path from the minimal set of parts required to assemble it\n *\n * @param asset - An asset-like shape defining ID, dimensions and extension\n * @param options - Project ID and dataset the image belongs to, along with other options\n * @returns The path to the image\n * @public\n */\nexport function buildImagePath(\n  asset: ImageUrlBuilderOptions | SanityImageUrlParts,\n  options?: PathBuilderOptions,\n): string {\n  const projectId = options?.projectId || asset.projectId\n  const dataset = options?.dataset || asset.dataset\n  if (!projectId || !dataset) {\n    throw new Error('Project details (projectId and dataset) required to resolve path for image')\n  }\n\n  const dimensions =\n    'metadata' in asset ? asset.metadata.dimensions : {width: asset.width, height: asset.height}\n  const originalFilename = 'originalFilename' in asset ? asset.originalFilename : undefined\n  const {assetId, extension, vanityFilename} = asset\n  const {width, height} = dimensions\n  const vanity = getVanityStub(originalFilename, vanityFilename, options)\n\n  return `images/${projectId}/${dataset}/${assetId}-${width}x${height}.${extension}${vanity}`\n}\n\n/**\n * Builds the base image URL from the minimal set of parts required to assemble it\n *\n * @param asset - An asset-like shape defining ID, dimensions and extension\n * @param options - Project ID and dataset the image belongs to\n * @returns The URL to the image, as a string\n * @public\n */\nexport function buildImageUrl(\n  asset: ImageUrlBuilderOptions | SanityImageUrlParts,\n  options?: PathBuilderOptions,\n): string {\n  const baseUrl = options?.baseUrl || cdnUrl\n  return `${baseUrl}/${buildImagePath(asset, options)}`\n}\n\n/**\n * Builds the base file path from the minimal set of parts required to assemble it\n *\n * @param asset - An asset-like shape defining ID, dimensions and extension\n * @param options - Project ID and dataset the file belongs to, along with other options\n * @returns The path to the file\n * @public\n */\nexport function buildFilePath(\n  asset: FileUrlBuilderOptions | SanityFileUrlParts,\n  options?: PathBuilderOptions,\n): string {\n  const projectId = options?.projectId || asset.projectId\n  const dataset = options?.dataset || asset.dataset\n  if (!projectId || !dataset) {\n    throw new Error('Project details (projectId and dataset) required to resolve path for file')\n  }\n\n  const originalFilename = 'originalFilename' in asset ? asset.originalFilename : undefined\n  const {assetId, extension, vanityFilename} = asset\n  const vanity = getVanityStub(originalFilename, vanityFilename, options)\n\n  return `files/${projectId}/${dataset}/${assetId}.${extension}${vanity}`\n}\n\n/**\n * Builds the base file URL from the minimal set of parts required to assemble it\n *\n * @param asset - An asset-like shape defining ID and extension\n * @param options - Project ID and dataset the file belongs to, along with other options\n * @returns The URL to the file, as a string\n * @public\n */\nexport function buildFileUrl(asset: FileUrlBuilderOptions, options?: PathBuilderOptions): string {\n  const baseUrl = options?.baseUrl || cdnUrl\n  return `${baseUrl}/${buildFilePath(asset, options)}`\n}\n\n/**\n * Checks whether or not the given URL contains an asset path\n *\n * @param url - URL or path name\n * @returns Whether or not it contained an asset path\n * @public\n */\nfunction hasPath(urlOrPath: string): boolean {\n  return pathPattern.test(tryGetUrlPath(urlOrPath) || '')\n}\n\n/**\n * Tries to get the asset path from a given asset source\n *\n * @param src - The source image to infer an asset path from\n * @returns A path if resolvable, undefined otherwise\n * @public\n */\nexport function tryGetAssetPath(src: SanityAssetSource): string | undefined {\n  if (isAssetObjectStub(src)) {\n    return tryGetAssetPath(src.asset)\n  }\n\n  if (isReference(src)) {\n    return undefined\n  }\n\n  if (typeof src === 'string') {\n    return hasPath(src) ? getUrlPath(src) : undefined\n  }\n\n  if (isAssetPathStub(src)) {\n    return src.path\n  }\n\n  if (isAssetUrlStub(src)) {\n    return getUrlPath(src.url)\n  }\n\n  return undefined\n}\n\n/**\n * Strips the CDN URL and query params from a URL, eg:\n * `https://cdn.sanity.io/images/project/dataset/filename-200x200.jpg?foo=bar` →\n * `images/project/dataset/filename-200x200.jpg`\n *\n * @param url - URL to get path name from\n * @returns The path of a CDN URL\n * @public\n * @throws If URL is not a valid Sanity asset URL\n */\nexport function getUrlPath(url: string): string {\n  if (pathPattern.test(url)) {\n    // Already just a path\n    return url\n  }\n\n  if (!isCdnUrl(url)) {\n    throw new UnresolvableError(`Failed to resolve path from URL \"${url}\"`)\n  }\n\n  return new URL(url).pathname.replace(/^\\/+/, '')\n}\n\n/**\n * {@inheritDoc getUrlPath}\n * @returns Returns `undefined` instead of throwing if a value cannot be resolved\n * @public\n */\nexport const tryGetUrlPath = getForgivingResolver(getUrlPath)\n\n/**\n * Strips the CDN URL, path and query params from a URL, eg:\n * `https://cdn.sanity.io/images/project/dataset/filename-200x200.jpg?foo=bar` →\n * `filename-200x200.jpg`\n *\n * @param url - URL to get filename from\n * @returns The filename of an URL, if URL matches the CDN URL\n * @public\n * @throws If URL is not a valid Sanity asset URL\n */\nexport function getUrlFilename(url: string): string {\n  const path = tryGetUrlPath(url) || url\n  const filename = path.replace(/^(images|files)\\/[a-z0-9]+\\/[a-z0-9][-\\w]\\/*/, '')\n  if (!isValidFilename(filename)) {\n    throw new UnresolvableError(`Failed to resolve filename from URL \"${url}\"`)\n  }\n\n  return filename\n}\n\n/**\n * {@inheritDoc getUrlFilename}\n * @returns Returns `undefined` instead of throwing if a value cannot be resolved\n * @public\n */\nexport const tryGetUrlFilename = getForgivingResolver(getUrlFilename)\n\n/**\n * Checks whether or not a given filename matches the expected Sanity asset filename pattern\n *\n * @param filename - Filename to check for validity\n * @returns Whether or not the specified filename is valid\n * @public\n */\nexport function isValidFilename(filename: string): boolean {\n  return fileAssetFilenamePattern.test(filename) || imageAssetFilenamePattern.test(filename)\n}\n\n/**\n * Get the \"path stub\" at the end of the path, if the user hasn't explicitly opted out of this behavior\n *\n * @param originalFilename - The original filename of the asset\n * @param vanityFilename - The vanity filename of the asset\n * @param options - Options to control the behavior of the path builder\n * @returns The vanity stub, if any\n * @public\n */\nexport function getVanityStub(\n  originalFilename: string | undefined,\n  vanityFilename: string | undefined,\n  options?: PathBuilderOptions,\n): string {\n  const vanity = vanityFilename || originalFilename\n  return options?.useVanityName === false || !vanity ? '' : `/${vanity}`\n}\n","import {isCdnUrl} from './asserters.js'\nimport {\n  fileAssetIdPattern,\n  imageAssetFilenamePattern,\n  imageAssetIdPattern,\n  pathPattern,\n} from './constants.js'\nimport {isValidFilename, tryGetUrlFilename} from './paths.js'\nimport type {\n  SanityAssetIdParts,\n  SanityAssetUrlParts,\n  SanityFileAssetIdParts,\n  SanityFileUrlParts,\n  SanityImageAssetIdParts,\n  SanityImageUrlParts,\n} from './types.js'\n\n/**\n * @internal\n */\nconst exampleFileId = 'file-027401f31c3ac1e6d78c5d539ccd1beff72b9b11-pdf'\n\n/**\n * @internal\n */\nconst exampleImageId = 'image-027401f31c3ac1e6d78c5d539ccd1beff72b9b11-2000x3000-jpg'\n\n/**\n * Parses a Sanity asset document ID into individual parts (type, id, extension, width/height etc)\n *\n * @param documentId - Document ID to parse into named parts\n * @returns Object of named properties\n * @public\n * @throws If document ID is invalid\n */\nexport function parseAssetId(documentId: string): SanityAssetIdParts {\n  if (imageAssetIdPattern.test(documentId)) {\n    return parseImageAssetId(documentId)\n  }\n\n  if (fileAssetIdPattern.test(documentId)) {\n    return parseFileAssetId(documentId)\n  }\n\n  throw new Error(`Invalid image/file asset ID: ${documentId}`)\n}\n\n/**\n * Parses a Sanity file asset document ID into individual parts (type, id, extension)\n *\n * @param documentId - File asset document ID to parse into named parts\n * @returns Object of named properties\n * @public\n * @throws If document ID invalid\n */\nexport function parseFileAssetId(documentId: string): SanityFileAssetIdParts {\n  if (!fileAssetIdPattern.test(documentId)) {\n    throw new Error(\n      `Malformed file asset ID '${documentId}'. Expected an id like \"${exampleFileId}\"`,\n    )\n  }\n\n  const [, assetId, extension] = documentId.split('-')\n  return {type: 'file', assetId, extension}\n}\n\n/**\n * Parses a Sanity image asset document ID into individual parts (type, id, extension, width, height)\n *\n * @param documentId - Image asset document ID to parse into named parts\n * @returns Object of named properties\n * @public\n * @throws If document ID invalid\n */\nexport function parseImageAssetId(documentId: string): SanityImageAssetIdParts {\n  const [, assetId, dimensionString, extension] = documentId.split('-')\n  const [width, height] = (dimensionString || '').split('x').map(Number)\n\n  if (!assetId || !dimensionString || !extension || !(width > 0) || !(height > 0)) {\n    throw new Error(`Malformed asset ID '${documentId}'. Expected an id like \"${exampleImageId}\".`)\n  }\n\n  return {type: 'image', assetId, width, height, extension}\n}\n\n/**\n * Parses a Sanity asset filename into individual parts (type, id, extension, width, height)\n *\n * @param filename - Filename to parse into named parts\n * @returns Object of named properties\n * @public\n * @throws If image/filename is invalid\n */\nexport function parseAssetFilename(filename: string): SanityAssetIdParts {\n  const file = tryGetUrlFilename(filename) || ''\n  if (!isValidFilename(file)) {\n    throw new Error(`Invalid image/file asset filename: ${filename}`)\n  }\n\n  try {\n    const type = imageAssetFilenamePattern.test(file) ? 'image' : 'file'\n    const assetId = file.replace(/\\.([a-z0-9+]+)$/i, '-$1')\n    return parseAssetId(`${type}-${assetId}`)\n  } catch (err) {\n    throw new Error(`Invalid image/file asset filename: ${filename}`)\n  }\n}\n\n/**\n * Parses a full Sanity asset URL into individual parts\n * (type, project ID, dataset, id, extension, width, height)\n *\n * @param url - Full URL to parse into named parts\n * @returns Object of named properties\n * @public\n * @throws If URL is invalid or not a Sanity asset URL\n */\nexport function parseAssetUrl(url: string): SanityAssetUrlParts {\n  if (!isCdnUrl(url)) {\n    throw new Error(`URL is not a valid Sanity asset URL: ${url}`)\n  }\n\n  const path = new URL(url).pathname.replace(/^\\/+/, '')\n  const [projectPath, , projectId, dataset] = path.match(pathPattern) || []\n  if (!projectPath || !projectId || !dataset) {\n    throw new Error(`URL is not a valid Sanity asset URL: ${url}`)\n  }\n\n  const [filename, vanityFilename] = path.slice(projectPath.length).split('/')\n  const parsed = parseAssetFilename(filename)\n\n  return {\n    ...parsed,\n    projectId,\n    dataset,\n    vanityFilename,\n  }\n}\n\n/**\n * Parses a full Sanity image asset URL into individual parts\n * (type, project ID, dataset, id, extension, width, height)\n *\n * @param url - Full URL to parse into named parts\n * @returns Object of named properties\n * @public\n * @throws If URL is invalid or not a Sanity image asset URL\n */\nexport function parseImageAssetUrl(url: string): SanityImageUrlParts {\n  const parsed = parseAssetUrl(url)\n  if (parsed.type !== 'image') {\n    throw new Error(`URL is not a valid Sanity image asset URL: ${url}`)\n  }\n\n  return parsed\n}\n\n/**\n * Parses a full Sanity file asset URL into individual parts\n * (type, project ID, dataset, id, extension, width, height)\n *\n * @param url - Full URL to parse into named parts\n * @returns Object of named properties\n * @public\n * @throws If URL is invalid or not a Sanity file asset URL\n */\nexport function parseFileAssetUrl(url: string): SanityFileUrlParts {\n  const parsed = parseAssetUrl(url)\n  if (parsed.type !== 'file') {\n    throw new Error(`URL is not a valid Sanity file asset URL: ${url}`)\n  }\n\n  return parsed\n}\n\n/**\n * Validates that a given URL is a Sanity asset URL, and returns the asset type if valid.\n *\n * @param url - URL to extract asset type from\n * @returns Asset type if valid URL, false otherwise\n * @public\n */\nexport function getAssetUrlType(url: string): 'image' | 'file' | false {\n  try {\n    return parseAssetUrl(url).type\n  } catch (err) {\n    return false\n  }\n}\n","import {\n  isAssetIdStub,\n  isAssetObjectStub,\n  isAssetPathStub,\n  isAssetUrlStub,\n  isCdnUrl,\n  isInProgressUpload,\n  isReference,\n  isSanityFileAsset,\n  isSanityImageAsset,\n} from './asserters.js'\nimport {\n  cdnUrl,\n  dummyProject,\n  fileAssetFilenamePattern,\n  fileAssetType,\n  idPattern,\n  imageAssetFilenamePattern,\n  imageAssetType,\n  inProgressAssetAssetId,\n  inProgressAssetExtension,\n  inProgressAssetId,\n  pathPattern,\n} from './constants.js'\nimport {UnresolvableError} from './errors.js'\nimport {getDefaultCrop, getDefaultHotspot} from './hotspotCrop.js'\nimport {parseFileAssetId, parseImageAssetId} from './parse.js'\nimport {\n  buildFilePath,\n  buildFileUrl,\n  buildImagePath,\n  buildImageUrl,\n  getUrlPath,\n  tryGetAssetPath,\n} from './paths.js'\nimport type {\n  PathBuilderOptions,\n  ResolvedSanityFile,\n  ResolvedSanityImage,\n  SanityAssetSource,\n  SanityFileAsset,\n  SanityFileObjectStub,\n  SanityFileSource,\n  SanityImageAsset,\n  SanityImageDimensions,\n  SanityImageObjectStub,\n  SanityImageSource,\n  SanityProjectDetails,\n} from './types.js'\nimport {getForgivingResolver} from './utils.js'\n\n/**\n * Returns the width, height and aspect ratio of a passed image asset, from any\n * inferrable structure (id, url, path, asset document, image object etc)\n *\n * @param src - Input source (image object, asset, reference, id, url, path)\n * @returns Object with width, height and aspect ratio properties\n *\n * @throws {@link UnresolvableError}\n * Throws if passed image source could not be resolved to an asset ID\n * @public\n */\nexport function getImageDimensions(src: SanityImageSource): SanityImageDimensions {\n  // Check if this is an in-progress upload\n  if (isInProgressUpload(src)) {\n    // Return placeholder dimensions for in-progress uploads\n    return {width: 0, height: 0, aspectRatio: 0}\n  }\n\n  const imageId = getAssetDocumentId(src)\n  const {width, height} = parseImageAssetId(imageId)\n  const aspectRatio = width / height\n  return {width, height, aspectRatio}\n}\n\n/**\n * {@inheritDoc getImageDimensions}\n * @returns Returns `undefined` instead of throwing if a value cannot be resolved\n * @public\n */\nexport const tryGetImageDimensions = getForgivingResolver(getImageDimensions)\n\n/**\n * Returns the file extension for a given asset\n *\n * @param src - Input source (file/image object, asset, reference, id, url, path)\n * @returns The file extension, if resolvable (no `.` included)\n *\n * @throws {@link UnresolvableError}\n * Throws if passed asset source could not be resolved to an asset ID\n * @public\n */\nexport function getExtension(src: SanityAssetSource): string {\n  // Check if this is an in-progress upload\n  if (isInProgressUpload(src)) {\n    // Return placeholder extension for in-progress uploads\n    return inProgressAssetExtension\n  }\n\n  return isFileSource(src)\n    ? getFile(src, dummyProject).asset.extension\n    : getImage(src, dummyProject).asset.extension\n}\n\n/**\n * {@inheritDoc getExtension}\n * @returns Returns `undefined` instead of throwing if a value cannot be resolved\n * @public\n */\nexport const tryGetExtension = getForgivingResolver(getExtension)\n\n/**\n * Tries to resolve an image object with as much information as possible,\n * from any inferrable structure (id, url, path, image object etc)\n *\n * @param src - Input source (image object, asset, reference, id, url, path)\n * @param project - Project ID and dataset the image belongs to\n * @returns Image object\n *\n * @throws {@link UnresolvableError}\n * Throws if passed image source could not be resolved to an asset ID\n * @public\n */\nexport function getImage(\n  src: SanityImageSource,\n  project?: SanityProjectDetails,\n): ResolvedSanityImage {\n  // Check if this is an in-progress upload\n  if (isInProgressUpload(src)) {\n    // Return a placeholder image object that allows rendering to continue\n    return {\n      asset: {\n        _id: inProgressAssetId,\n        _type: imageAssetType,\n        assetId: inProgressAssetAssetId,\n        extension: inProgressAssetExtension,\n        url: '',\n        path: '',\n        metadata: {\n          dimensions: {width: 1, height: 1, aspectRatio: 1},\n        },\n      },\n      crop: getDefaultCrop(),\n      hotspot: getDefaultHotspot(),\n    }\n  }\n\n  const projectDetails = project || tryGetProject(src)\n  const asset = getImageAsset(src, projectDetails)\n\n  const img = src as SanityImageObjectStub\n  return {\n    asset,\n    crop: img.crop || getDefaultCrop(),\n    hotspot: img.hotspot || getDefaultHotspot(),\n  }\n}\n\n/**\n * {@inheritDoc getImage}\n * @returns Returns `undefined` instead of throwing if a value cannot be resolved\n * @public\n */\nexport const tryGetImage = getForgivingResolver(getImage)\n\n/**\n * Tries to resolve a (partial) image asset document with as much information as possible,\n * from any inferrable structure (id, url, path, image object etc)\n *\n * @param src - Input source (image object, asset, reference, id, url, path)\n * @param project - Project ID and dataset the image belongs to\n * @returns Image asset document\n *\n * @throws {@link UnresolvableError}\n * Throws if passed image source could not be resolved to an asset ID\n * @public\n */\nexport function getImageAsset(\n  src: SanityImageSource,\n  project?: SanityProjectDetails,\n): SanityImageAsset {\n  const projectDetails = project || getProject(src)\n  const pathOptions: PathBuilderOptions = {...projectDetails, useVanityName: false}\n\n  const _id = getAssetDocumentId(src)\n  const sourceObj = src as SanityImageObjectStub\n  const source = (sourceObj.asset || src) as SanityImageAsset\n  const metadata = source.metadata || {}\n  const {assetId, width, height, extension} = parseImageAssetId(_id)\n  const aspectRatio = width / height\n  const baseAsset: SanityImageAsset = {\n    ...(isSanityImageAsset(src) ? src : {}),\n    _id,\n    _type: 'sanity.imageAsset',\n    assetId,\n    extension,\n    metadata: {\n      ...metadata,\n      dimensions: {width, height, aspectRatio},\n    },\n\n    // Placeholders, overwritten below\n    url: '',\n    path: '',\n  }\n\n  return {\n    ...baseAsset,\n    path: buildImagePath(baseAsset, pathOptions),\n    url: buildImageUrl(baseAsset, pathOptions),\n  }\n}\n\n/**\n * {@inheritDoc getImageAsset}\n * @returns Returns `undefined` instead of throwing if a value cannot be resolved\n * @public\n */\nexport const tryGetImageAsset = getForgivingResolver(getImageAsset)\n\n/**\n * Tries to resolve an file object with as much information as possible,\n * from any inferrable structure (id, url, path, file object etc)\n *\n * @param src - Input source (file object, asset, reference, id, url, path)\n * @param project - Project ID and dataset the file belongs to\n * @returns File object\n *\n * @throws {@link UnresolvableError}\n * Throws if passed file source could not be resolved to an asset ID\n * @public\n */\nexport function getFile(src: SanityFileSource, project?: SanityProjectDetails): ResolvedSanityFile {\n  // Check if this is an in-progress upload\n  if (isInProgressUpload(src)) {\n    // Return a placeholder file object that allows rendering to continue\n    return {\n      asset: {\n        _id: inProgressAssetId,\n        _type: fileAssetType,\n        assetId: inProgressAssetAssetId,\n        extension: inProgressAssetExtension,\n        url: '',\n        path: '',\n        metadata: {},\n      },\n    }\n  }\n\n  const projectDetails = project || tryGetProject(src)\n  const asset = getFileAsset(src, projectDetails)\n  return {asset}\n}\n\n/**\n * {@inheritDoc getFile}\n * @returns Returns `undefined` instead of throwing if a value cannot be resolved\n * @public\n */\nexport const tryGetFile = getForgivingResolver(getFile)\n\n/**\n * Tries to resolve a (partial) file asset document with as much information as possible,\n * from any inferrable structure (id, url, path, file object etc)\n *\n * @param src - Input source (file object, asset, reference, id, url, path)\n * @param options - Project ID and dataset the file belongs to, along with other options\n * @returns File asset document\n *\n * @throws {@link UnresolvableError}\n * Throws if passed file source could not be resolved to an asset ID\n * @public\n */\nexport function getFileAsset(src: SanityFileSource, options?: PathBuilderOptions): SanityFileAsset {\n  // Check if this is an in-progress upload\n  if (isInProgressUpload(src)) {\n    // Return a placeholder file object that allows rendering to continue\n    return {\n      assetId: inProgressAssetAssetId,\n      _id: inProgressAssetId,\n      _type: fileAssetType,\n      extension: inProgressAssetExtension,\n      metadata: {},\n      url: '',\n      path: '',\n    }\n  }\n  const projectDetails: PathBuilderOptions = {...(options || getProject(src)), useVanityName: false}\n\n  const _id = getAssetDocumentId(src)\n  const sourceObj = src as SanityFileObjectStub\n  const source = (sourceObj.asset || src) as SanityFileAsset\n  const {assetId, extension} = parseFileAssetId(_id)\n  const baseAsset: SanityFileAsset = {\n    ...(isSanityFileAsset(src) ? src : {}),\n    _id,\n    _type: 'sanity.fileAsset',\n    assetId,\n    extension,\n    metadata: source.metadata || {},\n\n    // Placeholders, overwritten below\n    url: '',\n    path: '',\n  }\n\n  return {\n    ...baseAsset,\n    path: buildFilePath(baseAsset, projectDetails),\n    url: buildFileUrl(baseAsset, projectDetails),\n  }\n}\n\n/**\n * {@inheritDoc getFileAsset}\n * @returns Returns `undefined` instead of throwing if a value cannot be resolved\n * @public\n */\nexport const tryGetFileAsset = getForgivingResolver(getFileAsset)\n\n/**\n * Tries to resolve the asset document ID from any inferrable structure\n *\n * @param src - Input source (image/file object, asset, reference, id, url, path)\n * @returns The asset document ID\n *\n * @throws {@link UnresolvableError}\n * Throws if passed asset source could not be resolved to an asset document ID\n * @public\n */\nexport function getAssetDocumentId(src: unknown): string {\n  // Check if this is an in-progress upload (has upload but no asset)\n  if (isInProgressUpload(src)) {\n    // Return a placeholder ID that indicates in-progress state\n    // This allows the render cycle to continue until asset is available\n    return inProgressAssetId\n  }\n\n  const source = isAssetObjectStub(src) ? src.asset : src\n\n  let id = ''\n  if (typeof source === 'string') {\n    id = getIdFromString(source)\n  } else if (isReference(source)) {\n    id = source._ref\n  } else if (isAssetIdStub(source)) {\n    id = source._id\n  } else if (isAssetPathStub(source)) {\n    id = idFromUrl(`${cdnUrl}/${source.path}`)\n  } else if (isAssetUrlStub(source)) {\n    id = idFromUrl(source.url)\n  }\n\n  const hasId = id && idPattern.test(id)\n  if (!hasId) {\n    throw new UnresolvableError(src)\n  }\n\n  return id\n}\n\n/**\n * {@inheritDoc getAssetDocumentId}\n * @returns Returns `undefined` instead of throwing if a value cannot be resolved\n * @public\n */\nexport const tryGetAssetDocumentId = getForgivingResolver(getAssetDocumentId)\n\n/**\n * Tries to cooerce a string (ID, URL or path) to an image asset ID\n *\n * @param str - Input string (ID, URL or path)\n * @returns string\n *\n *\n * @throws {@link UnresolvableError}\n * Throws if passed image source could not be resolved to an asset ID\n * @public\n */\nexport function getIdFromString(str: string): string {\n  if (idPattern.test(str)) {\n    // Already an ID\n    return str\n  }\n\n  const isAbsoluteUrl = isCdnUrl(str)\n  const path = isAbsoluteUrl ? new URL(str).pathname : str\n\n  if (path.indexOf('/images') === 0 || path.indexOf('/files') === 0) {\n    // Full URL\n    return idFromUrl(str)\n  }\n\n  if (pathPattern.test(str)) {\n    // Path\n    return idFromUrl(`${cdnUrl}/${str}`)\n  }\n\n  if (isFileAssetFilename(str)) {\n    // Just a filename (projectId/dataset irrelevant: just need asset ID)\n    return idFromUrl(`${cdnUrl}/files/a/b/${str}`)\n  }\n\n  if (isImageAssetFilename(str)) {\n    // Just a filename (projectId/dataset irrelevant: just need asset ID)\n    return idFromUrl(`${cdnUrl}/images/a/b/${str}`)\n  }\n\n  throw new UnresolvableError(str)\n}\n\n/**\n * {@inheritDoc getIdFromString}\n * @returns Returns `undefined` instead of throwing if a value cannot be resolved\n * @public\n */\nexport const tryGetIdFromString = getForgivingResolver(getIdFromString)\n\n/**\n * Converts from a full asset URL to just the asset document ID\n *\n * @param url - A full asset URL to convert\n * @returns string\n * @public\n */\nfunction idFromUrl(url: string): string {\n  const path = getUrlPath(url)\n  const [type, , , fileName] = path.split('/')\n  const prefix = type.replace(/s$/, '')\n  return `${prefix}-${fileName.replace(/\\./g, '-')}`\n}\n\n/**\n * Resolves project ID and dataset the image belongs to, based on full URL or path\n * @param src - Image URL or path\n * @returns object | undefined\n *\n * @throws {@link UnresolvableError}\n * Throws if passed image source could not be resolved to an asset ID\n * @public\n */\nexport function getProject(src: SanityImageSource): SanityProjectDetails {\n  const path = tryGetAssetPath(src)\n  if (!path) {\n    throw new UnresolvableError(src, 'Failed to resolve project ID and dataset from source')\n  }\n\n  const [, , projectId, dataset] = path.match(pathPattern) || []\n  if (!projectId || !dataset) {\n    throw new UnresolvableError(src, 'Failed to resolve project ID and dataset from source')\n  }\n\n  return {projectId, dataset}\n}\n\n/**\n * {@inheritDoc getProject}\n * @returns Returns `undefined` instead of throwing if a value cannot be resolved\n * @public\n */\nexport const tryGetProject = getForgivingResolver(getProject)\n\n/**\n * Returns whether or not the passed filename is a valid image asset filename\n *\n * @param filename - Filename to validate\n * @returns Whether or not the filename is an image asset filename\n * @public\n */\nexport function isImageAssetFilename(filename: string): boolean {\n  return imageAssetFilenamePattern.test(filename)\n}\n\n/**\n * Returns whether or not the passed filename is a valid file asset filename\n *\n * @param filename - Filename to validate\n * @returns Whether or not the filename is a file asset filename\n * @public\n */\nexport function isFileAssetFilename(filename: string): boolean {\n  return fileAssetFilenamePattern.test(filename)\n}\n\n/**\n * Returns whether or not the passed filename is a valid file or image asset filename\n *\n * @param filename - Filename to validate\n * @returns Whether or not the filename is an asset filename\n * @public\n */\nexport function isAssetFilename(filename: string): boolean {\n  return isImageAssetFilename(filename) || isFileAssetFilename(filename)\n}\n\n/**\n * Return whether or not the passed source is a file source\n *\n * @param src - Source to check\n * @returns Whether or not the given source is a file source\n * @public\n */\nexport function isFileSource(src: unknown): src is SanityFileSource {\n  const assetId = tryGetAssetDocumentId(src)\n  return assetId ? assetId.startsWith('file-') : false\n}\n\n/**\n * Return whether or not the passed source is an image source\n *\n * @param src - Source to check\n * @returns Whether or not the given source is an image source\n * @public\n */\nexport function isImageSource(src: unknown): src is SanityImageSource {\n  const assetId = tryGetAssetDocumentId(src)\n  return assetId ? assetId.startsWith('image-') : false\n}\n","import {getAssetUrlType} from './parse.js'\n\n/**\n * Checks whether or not a given URL is a valid Sanity asset URL\n *\n * @param url - URL to test\n * @returns True if url is a valid Sanity asset URL, false otherwise\n * @public\n */\nexport function isSanityAssetUrl(url: string): boolean {\n  return getAssetUrlType(url) !== false\n}\n\n/**\n * Checks whether or not a given URL is a valid Sanity image asset URL\n *\n * @param url - URL to test\n * @returns True if url is a valid Sanity image asset URL, false otherwise\n * @public\n */\nexport function isSanityImageUrl(url: string): boolean {\n  return getAssetUrlType(url) === 'image'\n}\n\n/**\n * Checks whether or not a given URL is a valid Sanity file asset URL\n *\n * @param url - URL to test\n * @returns True if url is a valid Sanity file asset URL, false otherwise\n * @public\n */\nexport function isSanityFileUrl(url: string): boolean {\n  return getAssetUrlType(url) === 'file'\n}\n"],"names":[],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8],"debugId":null}},
    {"offset": {"line": 4374, "column": 0}, "map": {"version":3,"file":"image-url.umd.js","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/image-url/src/parseAssetId.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/image-url/src/parseSource.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/image-url/src/urlForImage.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/image-url/src/builder.ts"],"sourcesContent":["const example = 'image-Tb9Ew8CXIwaY6R1kjMvI0uRR-2000x3000-jpg'\n\nexport default function parseAssetId(ref: string) {\n  const [, id, dimensionString, format] = ref.split('-')\n\n  if (!id || !dimensionString || !format) {\n    throw new Error(`Malformed asset _ref '${ref}'. Expected an id like \"${example}\".`)\n  }\n\n  const [imgWidthStr, imgHeightStr] = dimensionString.split('x')\n\n  const width = +imgWidthStr\n  const height = +imgHeightStr\n\n  const isValidAssetId = isFinite(width) && isFinite(height)\n  if (!isValidAssetId) {\n    throw new Error(`Malformed asset _ref '${ref}'. Expected an id like \"${example}\".`)\n  }\n\n  return {id, width, height, format}\n}\n","import {\n  SanityAsset,\n  SanityImageObject,\n  SanityImageSource,\n  SanityImageWithAssetStub,\n  SanityReference,\n} from './types'\n\nconst isRef = (src: SanityImageSource): src is SanityReference => {\n  const source = src as SanityReference\n  return source ? typeof source._ref === 'string' : false\n}\n\nconst isAsset = (src: SanityImageSource): src is SanityAsset => {\n  const source = src as SanityAsset\n  return source ? typeof source._id === 'string' : false\n}\n\nconst isAssetStub = (src: SanityImageSource): src is SanityImageWithAssetStub => {\n  const source = src as SanityImageWithAssetStub\n  return source && source.asset ? typeof source.asset.url === 'string' : false\n}\n\n// Detect in-progress uploads (has upload key but no complete asset reference)\nexport const isInProgressUpload = (src: SanityImageSource): boolean => {\n  if (typeof src === 'object' && src !== null) {\n    const obj = src as any\n    // Check if it has an upload key (indicating in-progress upload)\n    return obj._upload && (!obj.asset || !obj.asset._ref)\n  }\n  return false\n}\n\n// Convert an asset-id, asset or image to an image record suitable for processing\n// eslint-disable-next-line complexity\nexport default function parseSource(source?: SanityImageSource) {\n  if (!source) {\n    return null\n  }\n\n  let image: SanityImageObject\n\n  if (typeof source === 'string' && isUrl(source)) {\n    // Someone passed an existing image url?\n    image = {\n      asset: {_ref: urlToId(source)},\n    }\n  } else if (typeof source === 'string') {\n    // Just an asset id\n    image = {\n      asset: {_ref: source},\n    }\n  } else if (isRef(source)) {\n    // We just got passed an asset directly\n    image = {\n      asset: source,\n    }\n  } else if (isAsset(source)) {\n    // If we were passed an image asset document\n    image = {\n      asset: {\n        _ref: source._id || '',\n      },\n    }\n  } else if (isAssetStub(source)) {\n    // If we were passed a partial asset (`url`, but no `_id`)\n    image = {\n      asset: {\n        _ref: urlToId(source.asset.url),\n      },\n    }\n  } else if (typeof source.asset === 'object') {\n    // Probably an actual image with materialized asset\n    image = {...source}\n  } else {\n    // We got something that does not look like an image, or it is an image\n    // that currently isn't sporting an asset.\n    return null\n  }\n\n  const img = source as SanityImageObject\n  if (img.crop) {\n    image.crop = img.crop\n  }\n\n  if (img.hotspot) {\n    image.hotspot = img.hotspot\n  }\n\n  return applyDefaults(image)\n}\n\nfunction isUrl(url: string) {\n  return /^https?:\\/\\//.test(`${url}`)\n}\n\nfunction urlToId(url: string) {\n  const parts = url.split('/').slice(-1)\n  return `image-${parts[0]}`.replace(/\\.([a-z]+)$/, '-$1')\n}\n\n// Mock crop and hotspot if image lacks it\nfunction applyDefaults(image: SanityImageObject) {\n  if (image.crop && image.hotspot) {\n    return image as Required<SanityImageObject>\n  }\n\n  // We need to pad in default values for crop or hotspot\n  const result = {...image}\n\n  if (!result.crop) {\n    result.crop = {\n      left: 0,\n      top: 0,\n      bottom: 0,\n      right: 0,\n    }\n  }\n\n  if (!result.hotspot) {\n    result.hotspot = {\n      x: 0.5,\n      y: 0.5,\n      height: 1.0,\n      width: 1.0,\n    }\n  }\n\n  return result as Required<SanityImageObject>\n}\n","import parseAssetId from './parseAssetId'\nimport parseSource, {isInProgressUpload} from './parseSource'\nimport {\n  CropSpec,\n  HotspotSpec,\n  ImageUrlBuilderOptions,\n  ImageUrlBuilderOptionsWithAsset,\n  SanityAsset,\n  SanityImageFitResult,\n  SanityImageRect,\n  SanityReference,\n} from './types'\n\nexport const SPEC_NAME_TO_URL_NAME_MAPPINGS = [\n  ['width', 'w'],\n  ['height', 'h'],\n  ['format', 'fm'],\n  ['download', 'dl'],\n  ['blur', 'blur'],\n  ['sharpen', 'sharp'],\n  ['invert', 'invert'],\n  ['orientation', 'or'],\n  ['minHeight', 'min-h'],\n  ['maxHeight', 'max-h'],\n  ['minWidth', 'min-w'],\n  ['maxWidth', 'max-w'],\n  ['quality', 'q'],\n  ['fit', 'fit'],\n  ['crop', 'crop'],\n  ['saturation', 'sat'],\n  ['auto', 'auto'],\n  ['dpr', 'dpr'],\n  ['pad', 'pad'],\n  ['frame', 'frame'],\n]\n\nexport default function urlForImage(options: ImageUrlBuilderOptions): string {\n  let spec = {...(options || {})}\n  const source = spec.source\n  delete spec.source\n\n  const image = parseSource(source)\n  if (!image) {\n    if (source && isInProgressUpload(source)) {\n      // This is a placeholder image that will be replaced with the actual image when the upload is complete\n      // This is a 0x0 transparent PNG image\n      return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8HwQACfsD/QNViZkAAAAASUVORK5CYII='\n    }\n    throw new Error(`Unable to resolve image URL from source (${JSON.stringify(source)})`)\n  }\n\n  const id = (image.asset as SanityReference)._ref || (image.asset as SanityAsset)._id || ''\n  const asset = parseAssetId(id)\n\n  // Compute crop rect in terms of pixel coordinates in the raw source image\n  const cropLeft = Math.round(image.crop.left * asset.width)\n  const cropTop = Math.round(image.crop.top * asset.height)\n  const crop = {\n    left: cropLeft,\n    top: cropTop,\n    width: Math.round(asset.width - image.crop.right * asset.width - cropLeft),\n    height: Math.round(asset.height - image.crop.bottom * asset.height - cropTop),\n  }\n\n  // Compute hot spot rect in terms of pixel coordinates\n  const hotSpotVerticalRadius = (image.hotspot.height * asset.height) / 2\n  const hotSpotHorizontalRadius = (image.hotspot.width * asset.width) / 2\n  const hotSpotCenterX = image.hotspot.x * asset.width\n  const hotSpotCenterY = image.hotspot.y * asset.height\n  const hotspot = {\n    left: hotSpotCenterX - hotSpotHorizontalRadius,\n    top: hotSpotCenterY - hotSpotVerticalRadius,\n    right: hotSpotCenterX + hotSpotHorizontalRadius,\n    bottom: hotSpotCenterY + hotSpotVerticalRadius,\n  }\n\n  // If irrelevant, or if we are requested to: don't perform crop/fit based on\n  // the crop/hotspot.\n  if (!(spec.rect || spec.focalPoint || spec.ignoreImageParams || spec.crop)) {\n    spec = {...spec, ...fit({crop, hotspot}, spec)}\n  }\n\n  return specToImageUrl({...spec, asset})\n}\n\n// eslint-disable-next-line complexity\nfunction specToImageUrl(spec: ImageUrlBuilderOptionsWithAsset) {\n  const cdnUrl = (spec.baseUrl || 'https://cdn.sanity.io').replace(/\\/+$/, '')\n  const vanityStub = spec.vanityName ? `/${spec.vanityName}` : ''\n  const filename = `${spec.asset.id}-${spec.asset.width}x${spec.asset.height}.${spec.asset.format}${vanityStub}`\n  const baseUrl = `${cdnUrl}/images/${spec.projectId}/${spec.dataset}/${filename}`\n\n  const params = []\n\n  if (spec.rect) {\n    // Only bother url with a crop if it actually crops anything\n    const {left, top, width, height} = spec.rect\n    const isEffectiveCrop =\n      left !== 0 || top !== 0 || height !== spec.asset.height || width !== spec.asset.width\n\n    if (isEffectiveCrop) {\n      params.push(`rect=${left},${top},${width},${height}`)\n    }\n  }\n\n  if (spec.bg) {\n    params.push(`bg=${spec.bg}`)\n  }\n\n  if (spec.focalPoint) {\n    params.push(`fp-x=${spec.focalPoint.x}`)\n    params.push(`fp-y=${spec.focalPoint.y}`)\n  }\n\n  const flip = [spec.flipHorizontal && 'h', spec.flipVertical && 'v'].filter(Boolean).join('')\n  if (flip) {\n    params.push(`flip=${flip}`)\n  }\n\n  // Map from spec name to url param name, and allow using the actual param name as an alternative\n  SPEC_NAME_TO_URL_NAME_MAPPINGS.forEach((mapping) => {\n    const [specName, param] = mapping\n    if (typeof spec[specName] !== 'undefined') {\n      params.push(`${param}=${encodeURIComponent(spec[specName])}`)\n    } else if (typeof spec[param] !== 'undefined') {\n      params.push(`${param}=${encodeURIComponent(spec[param])}`)\n    }\n  })\n\n  if (params.length === 0) {\n    return baseUrl\n  }\n\n  return `${baseUrl}?${params.join('&')}`\n}\n\nfunction fit(\n  source: {crop: CropSpec; hotspot: HotspotSpec},\n  spec: ImageUrlBuilderOptions\n): SanityImageFitResult {\n  let cropRect: SanityImageRect\n\n  const imgWidth = spec.width\n  const imgHeight = spec.height\n\n  // If we are not constraining the aspect ratio, we'll just use the whole crop\n  if (!(imgWidth && imgHeight)) {\n    return {width: imgWidth, height: imgHeight, rect: source.crop}\n  }\n\n  const crop = source.crop\n  const hotspot = source.hotspot\n\n  // If we are here, that means aspect ratio is locked and fitting will be a bit harder\n  const desiredAspectRatio = imgWidth / imgHeight\n  const cropAspectRatio = crop.width / crop.height\n\n  if (cropAspectRatio > desiredAspectRatio) {\n    // The crop is wider than the desired aspect ratio. That means we are cutting from the sides\n    const height = Math.round(crop.height)\n    const width = Math.round(height * desiredAspectRatio)\n    const top = Math.max(0, Math.round(crop.top))\n\n    // Center output horizontally over hotspot\n    const hotspotXCenter = Math.round((hotspot.right - hotspot.left) / 2 + hotspot.left)\n    let left = Math.max(0, Math.round(hotspotXCenter - width / 2))\n\n    // Keep output within crop\n    if (left < crop.left) {\n      left = crop.left\n    } else if (left + width > crop.left + crop.width) {\n      left = crop.left + crop.width - width\n    }\n\n    cropRect = {left, top, width, height}\n  } else {\n    // The crop is taller than the desired ratio, we are cutting from top and bottom\n    const width = crop.width\n    const height = Math.round(width / desiredAspectRatio)\n    const left = Math.max(0, Math.round(crop.left))\n\n    // Center output vertically over hotspot\n    const hotspotYCenter = Math.round((hotspot.bottom - hotspot.top) / 2 + hotspot.top)\n    let top = Math.max(0, Math.round(hotspotYCenter - height / 2))\n\n    // Keep output rect within crop\n    if (top < crop.top) {\n      top = crop.top\n    } else if (top + height > crop.top + crop.height) {\n      top = crop.top + crop.height - height\n    }\n\n    cropRect = {left, top, width, height}\n  }\n\n  return {\n    width: imgWidth,\n    height: imgHeight,\n    rect: cropRect,\n  }\n}\n\n// For backwards-compatibility\nexport {parseSource}\n","import type {\n  AutoMode,\n  CropMode,\n  FitMode,\n  ImageFormat,\n  ImageUrlBuilderOptions,\n  ImageUrlBuilderOptionsWithAliases,\n  SanityModernClientLike,\n  Orientation,\n  SanityClientLike,\n  SanityImageSource,\n  SanityProjectDetails,\n} from './types'\nimport urlForImage, {SPEC_NAME_TO_URL_NAME_MAPPINGS} from './urlForImage'\n\nconst validFits = ['clip', 'crop', 'fill', 'fillmax', 'max', 'scale', 'min']\nconst validCrops = ['top', 'bottom', 'left', 'right', 'center', 'focalpoint', 'entropy']\nconst validAutoModes = ['format']\n\nfunction isSanityModernClientLike(\n  client?: SanityClientLike | SanityProjectDetails | SanityModernClientLike\n): client is SanityModernClientLike {\n  return client && 'config' in client ? typeof client.config === 'function' : false\n}\n\nfunction isSanityClientLike(\n  client?: SanityClientLike | SanityProjectDetails | SanityModernClientLike\n): client is SanityClientLike {\n  return client && 'clientConfig' in client ? typeof client.clientConfig === 'object' : false\n}\n\nfunction rewriteSpecName(key: string) {\n  const specs = SPEC_NAME_TO_URL_NAME_MAPPINGS\n  for (const entry of specs) {\n    const [specName, param] = entry\n    if (key === specName || key === param) {\n      return specName\n    }\n  }\n\n  return key\n}\n\nexport default function urlBuilder(\n  options?: SanityClientLike | SanityProjectDetails | SanityModernClientLike\n) {\n  // Did we get a modernish client?\n  if (isSanityModernClientLike(options)) {\n    // Inherit config from client\n    const {apiHost: apiUrl, projectId, dataset} = options.config()\n    const apiHost = apiUrl || 'https://api.sanity.io'\n    return new ImageUrlBuilder(null, {\n      baseUrl: apiHost.replace(/^https:\\/\\/api\\./, 'https://cdn.'),\n      projectId,\n      dataset,\n    })\n  }\n\n  // Did we get a SanityClient?\n  if (isSanityClientLike(options)) {\n    // Inherit config from client\n    const {apiHost: apiUrl, projectId, dataset} = options.clientConfig\n    const apiHost = apiUrl || 'https://api.sanity.io'\n    return new ImageUrlBuilder(null, {\n      baseUrl: apiHost.replace(/^https:\\/\\/api\\./, 'https://cdn.'),\n      projectId,\n      dataset,\n    })\n  }\n\n  // Or just accept the options as given\n  return new ImageUrlBuilder(null, options || {})\n}\n\nexport class ImageUrlBuilder {\n  public options: ImageUrlBuilderOptions\n\n  constructor(parent: ImageUrlBuilder | null, options: ImageUrlBuilderOptions) {\n    this.options = parent\n      ? {...(parent.options || {}), ...(options || {})} // Merge parent options\n      : {...(options || {})} // Copy options\n  }\n\n  withOptions(options: Partial<ImageUrlBuilderOptionsWithAliases>) {\n    const baseUrl = options.baseUrl || this.options.baseUrl\n\n    const newOptions: {[key: string]: any} = {baseUrl}\n    for (const key in options) {\n      if (options.hasOwnProperty(key)) {\n        const specKey = rewriteSpecName(key)\n        newOptions[specKey] = options[key]\n      }\n    }\n\n    return new ImageUrlBuilder(this, {baseUrl, ...newOptions})\n  }\n\n  // The image to be represented. Accepts a Sanity 'image'-document, 'asset'-document or\n  // _id of asset. To get the benefit of automatic hot-spot/crop integration with the content\n  // studio, the 'image'-document must be provided.\n  image(source: SanityImageSource) {\n    return this.withOptions({source})\n  }\n\n  // Specify the dataset\n  dataset(dataset: string) {\n    return this.withOptions({dataset})\n  }\n\n  // Specify the projectId\n  projectId(projectId: string) {\n    return this.withOptions({projectId})\n  }\n\n  // Specify background color\n  bg(bg: string) {\n    return this.withOptions({bg})\n  }\n\n  // Set DPR scaling factor\n  dpr(dpr: number) {\n    // A DPR of 1 is the default - so only include it if we have a different value\n    return this.withOptions(dpr && dpr !== 1 ? {dpr} : {})\n  }\n\n  // Specify the width of the image in pixels\n  width(width: number) {\n    return this.withOptions({width})\n  }\n\n  // Specify the height of the image in pixels\n  height(height: number) {\n    return this.withOptions({height})\n  }\n\n  // Specify focal point in fraction of image dimensions. Each component 0.0-1.0\n  focalPoint(x: number, y: number) {\n    return this.withOptions({focalPoint: {x, y}})\n  }\n\n  maxWidth(maxWidth: number) {\n    return this.withOptions({maxWidth})\n  }\n\n  minWidth(minWidth: number) {\n    return this.withOptions({minWidth})\n  }\n\n  maxHeight(maxHeight: number) {\n    return this.withOptions({maxHeight})\n  }\n\n  minHeight(minHeight: number) {\n    return this.withOptions({minHeight})\n  }\n\n  // Specify width and height in pixels\n  size(width: number, height: number) {\n    return this.withOptions({width, height})\n  }\n\n  // Specify blur between 0 and 100\n  blur(blur: number) {\n    return this.withOptions({blur})\n  }\n\n  sharpen(sharpen: number) {\n    return this.withOptions({sharpen})\n  }\n\n  // Specify the desired rectangle of the image\n  rect(left: number, top: number, width: number, height: number) {\n    return this.withOptions({rect: {left, top, width, height}})\n  }\n\n  // Specify the image format of the image. 'jpg', 'pjpg', 'png', 'webp'\n  format(format?: ImageFormat | undefined) {\n    return this.withOptions({format})\n  }\n\n  invert(invert: boolean) {\n    return this.withOptions({invert})\n  }\n\n  // Rotation in degrees 0, 90, 180, 270\n  orientation(orientation: Orientation) {\n    return this.withOptions({orientation})\n  }\n\n  // Compression quality 0-100\n  quality(quality: number) {\n    return this.withOptions({quality})\n  }\n\n  // Make it a download link. Parameter is default filename.\n  forceDownload(download: boolean | string) {\n    return this.withOptions({download})\n  }\n\n  // Flip image horizontally\n  flipHorizontal() {\n    return this.withOptions({flipHorizontal: true})\n  }\n\n  // Flip image vertically\n  flipVertical() {\n    return this.withOptions({flipVertical: true})\n  }\n\n  // Ignore crop/hotspot from image record, even when present\n  ignoreImageParams() {\n    return this.withOptions({ignoreImageParams: true})\n  }\n\n  fit(value: FitMode) {\n    if (validFits.indexOf(value) === -1) {\n      throw new Error(`Invalid fit mode \"${value}\"`)\n    }\n\n    return this.withOptions({fit: value})\n  }\n\n  crop(value: CropMode) {\n    if (validCrops.indexOf(value) === -1) {\n      throw new Error(`Invalid crop mode \"${value}\"`)\n    }\n\n    return this.withOptions({crop: value})\n  }\n\n  // Saturation\n  saturation(saturation: number) {\n    return this.withOptions({saturation})\n  }\n\n  auto(value: AutoMode) {\n    if (validAutoModes.indexOf(value) === -1) {\n      throw new Error(`Invalid auto mode \"${value}\"`)\n    }\n\n    return this.withOptions({auto: value})\n  }\n\n  // Specify the number of pixels to pad the image\n  pad(pad: number) {\n    return this.withOptions({pad})\n  }\n\n  // Vanity URL for more SEO friendly URLs\n  vanityName(value: string) {\n    return this.withOptions({vanityName: value})\n  }\n\n  frame(frame: number) {\n    if (frame !== 1) {\n      throw new Error(`Invalid frame value \"${frame}\"`)\n    }\n\n    return this.withOptions({frame})\n  }\n\n  // Gets the url based on the submitted parameters\n  url() {\n    return urlForImage(this.options)\n  }\n\n  // Alias for url()\n  toString() {\n    return this.url()\n  }\n}\n"],"names":["example","parseAssetId","ref","_ref$split","split","id","dimensionString","format","Error","_dimensionString$spli","imgWidthStr","imgHeightStr","width","height","isValidAssetId","isFinite","isRef","src","source","_ref","isAsset","_id","isAssetStub","asset","url","isInProgressUpload","obj","_upload","parseSource","image","isUrl","urlToId","_extends","img","crop","hotspot","applyDefaults","test","parts","slice","replace","result","left","top","bottom","right","x","y","SPEC_NAME_TO_URL_NAME_MAPPINGS","urlForImage","options","spec","JSON","stringify","cropLeft","Math","round","cropTop","hotSpotVerticalRadius","hotSpotHorizontalRadius","hotSpotCenterX","hotSpotCenterY","rect","focalPoint","ignoreImageParams","fit","specToImageUrl","cdnUrl","baseUrl","vanityStub","vanityName","filename","projectId","dataset","params","_spec$rect","isEffectiveCrop","push","bg","flip","flipHorizontal","flipVertical","filter","Boolean","join","forEach","mapping","specName","param","encodeURIComponent","length","cropRect","imgWidth","imgHeight","desiredAspectRatio","cropAspectRatio","max","hotspotXCenter","hotspotYCenter","validFits","validCrops","validAutoModes","isSanityModernClientLike","client","config","isSanityClientLike","clientConfig","rewriteSpecName","key","specs","_iterator","_createForOfIteratorHelperLoose","_step","done","entry","value","urlBuilder","_options$config","apiUrl","apiHost","ImageUrlBuilder","_options$clientConfig","parent","_proto","prototype","withOptions","newOptions","hasOwnProperty","specKey","dpr","maxWidth","minWidth","maxHeight","minHeight","size","blur","sharpen","invert","orientation","quality","forceDownload","download","indexOf","saturation","auto","pad","frame","toString"],"mappings":"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","ignoreList":[0,1,2,3],"debugId":null}},
    {"offset": {"line": 5054, "column": 0}, "map": {"version":3,"sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/comlink/node_modules/uuid/dist/esm-browser/native.js"],"sourcesContent":["const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default { randomUUID };\n"],"names":[],"mappings":";;;AAAA,MAAM,aAAa,OAAO,WAAW,eAAe,OAAO,UAAU,IAAI,OAAO,UAAU,CAAC,IAAI,CAAC;uCACjF;IAAE;AAAW","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5067, "column": 0}, "map": {"version":3,"sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/comlink/node_modules/uuid/dist/esm-browser/rng.js"],"sourcesContent":["let getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n    if (!getRandomValues) {\n        if (typeof crypto === 'undefined' || !crypto.getRandomValues) {\n            throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n        }\n        getRandomValues = crypto.getRandomValues.bind(crypto);\n    }\n    return getRandomValues(rnds8);\n}\n"],"names":[],"mappings":";;;AAAA,IAAI;AACJ,MAAM,QAAQ,IAAI,WAAW;AACd,SAAS;IACpB,IAAI,CAAC,iBAAiB;QAClB,IAAI,OAAO,WAAW,eAAe,CAAC,OAAO,eAAe,EAAE;YAC1D,MAAM,IAAI,MAAM;QACpB;QACA,kBAAkB,OAAO,eAAe,CAAC,IAAI,CAAC;IAClD;IACA,OAAO,gBAAgB;AAC3B","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5087, "column": 0}, "map": {"version":3,"sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/comlink/node_modules/uuid/dist/esm-browser/regex.js"],"sourcesContent":["export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;\n"],"names":[],"mappings":";;;uCAAe","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5097, "column": 0}, "map": {"version":3,"sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/comlink/node_modules/uuid/dist/esm-browser/validate.js"],"sourcesContent":["import REGEX from './regex.js';\nfunction validate(uuid) {\n    return typeof uuid === 'string' && REGEX.test(uuid);\n}\nexport default validate;\n"],"names":[],"mappings":";;;AAAA;;AACA,SAAS,SAAS,IAAI;IAClB,OAAO,OAAO,SAAS,YAAY,iMAAA,CAAA,UAAK,CAAC,IAAI,CAAC;AAClD;uCACe","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5112, "column": 0}, "map": {"version":3,"sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/comlink/node_modules/uuid/dist/esm-browser/stringify.js"],"sourcesContent":["import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n"],"names":[],"mappings":";;;;AAAA;;AACA,MAAM,YAAY,EAAE;AACpB,IAAK,IAAI,IAAI,GAAG,IAAI,KAAK,EAAE,EAAG;IAC1B,UAAU,IAAI,CAAC,CAAC,IAAI,KAAK,EAAE,QAAQ,CAAC,IAAI,KAAK,CAAC;AAClD;AACO,SAAS,gBAAgB,GAAG,EAAE,SAAS,CAAC;IAC3C,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAC9B,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAC1B,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAC1B,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAC1B,MACA,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAC1B,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAC1B,MACA,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAC1B,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAC1B,MACA,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAC1B,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAC1B,MACA,SAAS,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,GAC3B,SAAS,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,GAC3B,SAAS,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,GAC3B,SAAS,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,GAC3B,SAAS,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,GAC3B,SAAS,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,EAAE,WAAW;AAChD;AACA,SAAS,UAAU,GAAG,EAAE,SAAS,CAAC;IAC9B,MAAM,OAAO,gBAAgB,KAAK;IAClC,IAAI,CAAC,CAAA,GAAA,oMAAA,CAAA,UAAQ,AAAD,EAAE,OAAO;QACjB,MAAM,UAAU;IACpB;IACA,OAAO;AACX;uCACe","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5139, "column": 0}, "map": {"version":3,"sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/comlink/node_modules/uuid/dist/esm-browser/v4.js"],"sourcesContent":["import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? rng();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nexport default v4;\n"],"names":[],"mappings":";;;AAAA;AACA;AACA;;;;AACA,SAAS,GAAG,OAAO,EAAE,GAAG,EAAE,MAAM;IAC5B,IAAI,kMAAA,CAAA,UAAM,CAAC,UAAU,IAAI,CAAC,OAAO,CAAC,SAAS;QACvC,OAAO,kMAAA,CAAA,UAAM,CAAC,UAAU;IAC5B;IACA,UAAU,WAAW,CAAC;IACtB,MAAM,OAAO,QAAQ,MAAM,IAAI,QAAQ,GAAG,QAAQ,CAAA,GAAA,+LAAA,CAAA,UAAG,AAAD;IACpD,IAAI,KAAK,MAAM,GAAG,IAAI;QAClB,MAAM,IAAI,MAAM;IACpB;IACA,IAAI,CAAC,EAAE,GAAG,AAAC,IAAI,CAAC,EAAE,GAAG,OAAQ;IAC7B,IAAI,CAAC,EAAE,GAAG,AAAC,IAAI,CAAC,EAAE,GAAG,OAAQ;IAC7B,IAAI,KAAK;QACL,SAAS,UAAU;QACnB,IAAI,SAAS,KAAK,SAAS,KAAK,IAAI,MAAM,EAAE;YACxC,MAAM,IAAI,WAAW,CAAC,gBAAgB,EAAE,OAAO,CAAC,EAAE,SAAS,GAAG,wBAAwB,CAAC;QAC3F;QACA,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,EAAE,EAAG;YACzB,GAAG,CAAC,SAAS,EAAE,GAAG,IAAI,CAAC,EAAE;QAC7B;QACA,OAAO;IACX;IACA,OAAO,CAAA,GAAA,qMAAA,CAAA,kBAAe,AAAD,EAAE;AAC3B;uCACe","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5188, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/id-utils/src/constants.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/id-utils/src/helpers.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/id-utils/src/brands.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/id-utils/src/predicates.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/id-utils/src/converters.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/id-utils/src/create.ts"],"sourcesContent":["export const VALID_ID = /^[a-z-A-Z0-9._-]+$/\n\nexport const DRAFTS_DIR = 'drafts'\nexport const VERSION_DIR = 'versions'\n\nexport const PATH_SEPARATOR = '.'\nexport const DRAFTS_PREFIX = `${DRAFTS_DIR}${PATH_SEPARATOR}`\nexport const VERSION_PREFIX = `${VERSION_DIR}${PATH_SEPARATOR}`\n","// internal helpers\n\nimport {partition as lodashPartition} from 'lodash'\n\nexport type SafeError = {success: false; error: Error}\nexport type SafeSuccess<T> = {success: true; value: T}\n\nexport type SafeResult<T> = SafeSuccess<T> | SafeError\n\n// eslint-disable-next-line @typescript-eslint/no-shadow\nexport function error(error: Error): SafeError {\n  return {success: false, error}\n}\nexport function success<T>(value: T): SafeSuccess<T> {\n  return {success: true, value}\n}\n\nexport function safe<T>(fn: () => T): SafeResult<T> {\n  try {\n    return success(fn())\n  } catch (err) {\n    return error(err instanceof Error ? err : new Error(String(err)))\n  }\n}\n\n/**\n * lodash types are wildly inaccurate\n * todo: replace with es-toolkit, which has better typings\n * @param array\n * @param predicate\n */\n\nexport function partition<T, S extends T>(\n  array: T[],\n  predicate: (element: T) => element is S,\n): [trueValues: S[], falseValues: Exclude<T, S>[]] {\n  return lodashPartition(array, predicate)\n}\n","import {type Brand, make} from 'ts-brand'\n\nimport {DRAFTS_PREFIX, VALID_ID, VERSION_PREFIX} from './constants'\nimport {partition, safe} from './helpers'\n\n/**\n * @public\n */\nexport type DraftId = Brand<string, 'draftId'>\n/**\n * @public\n */\nexport type PublishedId = Brand<string, 'publishedId'>\n/**\n * @public\n */\nexport type VersionId = Brand<string, 'versionId'>\n/**\n * @public\n */\nexport type DocumentId = DraftId | PublishedId | VersionId\n\n/**\n * @public\n */\nexport const DocumentId = make<DocumentId>((id: string) => {\n  validateAnyId(id)\n  const results = [validatePublishedId, validateDraftId, validateVersionId].map(\n    validator => safe(() => validator(id)),\n  )\n  const [successes, errors] = partition(results, res => res.success)\n\n  if (successes.length > 0) {\n    return id\n  }\n\n  if (errors.length > 0) {\n    throw new AggregateError(\n      errors.map(res => res.error),\n      `Invalid Document ID\\n - ${errors.map(res => res.error.message).join('\\n - ')}`,\n    )\n  }\n  /* istanbul ignore */\n  /* v8 ignore next 3 */\n  return id\n})\n\n/**\n * @public\n */\n\nexport const DraftId = make<DraftId>(id => {\n  validateAnyId(id)\n  validateDraftId(id)\n})\n/**\n * @public\n */\nexport const PublishedId = make<PublishedId>(id => {\n  validateAnyId(id)\n  validatePublishedId(id)\n})\n\n/**\n * @public\n */\nexport const VersionId = make<VersionId>(id => {\n  validateAnyId(id)\n  validateVersionId(id)\n})\n\nfunction validateAnyId(id: string) {\n  if (id.length === 0) {\n    throw new Error(`Must be a non-empty string`)\n  }\n  if (!VALID_ID.test(id)) {\n    throw new Error(\n      `Not a valid document ID: \"${id}\" – Must match the ${VALID_ID} RegExp`,\n    )\n  }\n\n  return id\n}\n\nfunction validateDraftId(id: string) {\n  if (!id.startsWith(DRAFTS_PREFIX)) {\n    throw new Error(\n      `Not a valid draft ID: \"${id}\" – must start with \"${DRAFTS_PREFIX}\"`,\n    )\n  }\n  if (id.length === DRAFTS_PREFIX.length) {\n    throw new Error(\n      `Not a valid draft ID: \"${id}\" – must have at least one character followed by \"${DRAFTS_PREFIX}\"`,\n    )\n  }\n  return id\n}\n\nfunction validateVersionId(id: string) {\n  if (!id.startsWith(VERSION_PREFIX)) {\n    throw new Error(\n      `Not a valid version ID: \"${id}\" – must start with \"${VERSION_PREFIX}\"`,\n    )\n  }\n  if (id.length === VERSION_PREFIX.length) {\n    throw new Error(\n      `Not a valid version ID: \"${id}\" – must have at least one character followed by \"${VERSION_PREFIX}\"`,\n    )\n  }\n  const [, versionName, ...documentId] = id.split('.')\n  if (!versionName || !VALID_ID.test(versionName)) {\n    throw new Error(\n      `Not a valid version ID: \"${id}\" – VERSION must match the ${VALID_ID} RegExp in versions.[VERSION].id`,\n    )\n  }\n  if (documentId.length === 0) {\n    throw new Error(\n      `Not a valid version ID: \"${id}\" – missing document ID in versions.bundle.[ID]`,\n    )\n  }\n  if (versionName === 'drafts' || versionName === 'versions') {\n    throw new Error(\n      `Not a valid version ID: \"${id}\" – invalid VERSION \"${versionName}\" in versions.[VERSION].id`,\n    )\n  }\n  return id\n}\n\nfunction validatePublishedId(id: string) {\n  if (id.startsWith(DRAFTS_PREFIX) || id.startsWith(VERSION_PREFIX)) {\n    throw new Error(\n      `Not a valid published ID: \"${id}\" – cannot start with \"${DRAFTS_PREFIX}\" or \"${VERSION_PREFIX}\"`,\n    )\n  }\n  return id\n}\n","import {\n  type DocumentId,\n  type DraftId,\n  type PublishedId,\n  type VersionId,\n} from './brands'\nimport {DRAFTS_PREFIX, VERSION_PREFIX} from './constants'\nimport {getPublishedId} from './converters'\n\n/**\n *\n * Checks if two document ids resolves to the same published ID, ignoring any draft or version prefix.\n *\n * @public\n *\n * @param id - The document ID to check\n * @param otherId - The other document ID to check\n *\n * @example\n * Draft vs published document ID, but representing the same document:\n * ```\n * // Prints \"true\":\n * console.log(isPublishedIdEqual('drafts.foo', 'foo'));\n * ```\n * @example\n * Version vs published document ID, but representing the same document:\n * ```\n * // Prints \"true\":\n * console.log(isPublishedIdEqual('versions.xyz.foo', 'foo'));\n * ```\n * @example\n * Different documents:\n * ```\n * // Prints \"false\":\n * console.log(isPublishedIdEqual('foo', 'bar'));\n * ```\n *\n * @returns `true` if the document IDs represents the same document, `false` otherwise\n */\nexport function isPublishedIdEqual(\n  id: DocumentId,\n  otherId: DocumentId,\n): boolean {\n  return getPublishedId(id) === getPublishedId(otherId)\n}\n\n/**\n * Check whether a given document ID is a draft ID\n * @public\n * @param id - The document ID to check\n */\nexport function isDraftId(id: DocumentId): id is DraftId {\n  return id.startsWith(DRAFTS_PREFIX)\n}\n\n/**\n * Check whether a given document ID is a published ID\n * @public\n * @param id - The document ID to check\n */\nexport function isPublishedId(id: DocumentId): id is PublishedId {\n  return !isDraftId(id) && !isVersionId(id)\n}\n\n/**\n * Check whether a given document ID is a version ID\n * @public\n * @param id - The document ID to check\n */\nexport function isVersionId(id: DocumentId): id is VersionId {\n  return id.startsWith(VERSION_PREFIX)\n}\n\n/**\n * Check whether a particular document ID is the draft ID of another document ID\n * @public\n * @param id - The document ID to check if the candidate is a draft of\n * @param candidate - The candidate document ID to check\n * Note: returns true for identical draft ids, i.e. isDraftOf(DraftId('drafts.foo'), DraftId('drafts.foo')) will be true.\n */\nexport function isDraftOf(\n  id: DocumentId,\n  candidate: DocumentId,\n): candidate is DraftId {\n  return isDraftId(candidate) && isPublishedIdEqual(id, candidate)\n}\n\n/**\n * Check whether a particular document ID is the published ID of another document ID\n * @public\n * @param id - The document ID to check if the candidate is a draft of\n * @param candidate - The candidate document ID to check\n *\n * Note: returns true for identical ids, i.e. isPublishedOf(PublishedId('foo'), PublishedId('foo')) will be true.\n */\nexport function isPublishedOf(\n  id: DocumentId,\n  candidate: DocumentId,\n): candidate is VersionId {\n  return isPublishedId(candidate) && isPublishedIdEqual(id, candidate)\n}\n\n/**\n * Check whether a particular document ID is a version ID of another document ID\n * @public\n * @param id - The document ID to check if the candidate is a draft of\n * @param candidate - The candidate document ID to check\n *\n * Note: returns true for identical versions, i.e. isVersionOf(VersionId('versions.xyz.foo'), VersionId('versions.xyz.foo')) will be true.\n */\nexport function isVersionOf(\n  id: DocumentId,\n  candidate: DocumentId,\n): candidate is VersionId {\n  return isVersionId(candidate) && isPublishedIdEqual(id, candidate)\n}\n","import {type DocumentId, DraftId, PublishedId, VersionId} from './brands'\nimport {DRAFTS_PREFIX, PATH_SEPARATOR, VERSION_PREFIX} from './constants'\nimport {isDraftId, isPublishedId, isVersionId} from './predicates'\n\n/**\n * Returns the published ID of the provided document ID\n * @public\n * @param id - the DocumentId to return the published ID for\n */\nexport function getPublishedId(id: DocumentId): PublishedId {\n  if (isDraftId(id)) {\n    return PublishedId(id.slice(DRAFTS_PREFIX.length))\n  }\n  if (isVersionId(id)) {\n    // [\"versions.\", versionId, ...publishedIdParts]\n    const [, , ...publishedId] = id.split(PATH_SEPARATOR)\n    return PublishedId(publishedId.join(PATH_SEPARATOR))\n  }\n  return id\n}\n\n/**\n * Returns the draft ID of the provided document ID\n * @public\n * @param id - the DocumentId to return the draft ID for\n */\nexport function getDraftId(id: DocumentId): DraftId {\n  if (isVersionId(id)) {\n    // [\"versions.\", versionId, ...publishedIdParts]\n    const [, , ...publishedId] = id.split(PATH_SEPARATOR)\n    return DraftId(DRAFTS_PREFIX + publishedId.join(PATH_SEPARATOR))\n  }\n  if (isPublishedId(id)) {\n    return DraftId(DRAFTS_PREFIX + id)\n  }\n  return id\n}\n\n/**\n * Returns a version ID of the provided document ID\n * @public\n * @param id - the DocumentId to return the version ID for\n * @param versionName - the name of the version to return a version ID for\n */\nexport function getVersionId(id: DocumentId, versionName: string): VersionId {\n  if (isVersionId(id) || isDraftId(id)) {\n    return getVersionId(getPublishedId(id), versionName)\n  }\n  return VersionId(VERSION_PREFIX + versionName + PATH_SEPARATOR + id)\n}\n\n/**\n *  @public\n *  Extracts and returns the version name of a version id\n *  e.g. getVersionNameFromId(VersionId(`versions.xyz.foo`)) = `xyz`\n *  @param id - the version id to extract version name from\n */\nexport function getVersionNameFromId(id: VersionId): string {\n  // [\"versions.\", versionId, ...publishedIdParts]\n  const [, versionId] = id.split(PATH_SEPARATOR)\n\n  return versionId!\n}\n","import {uuid} from '@sanity/uuid'\nimport {deburr} from 'lodash'\n\nimport {DraftId, PublishedId, VersionId} from './brands'\nimport {DRAFTS_PREFIX, PATH_SEPARATOR, VERSION_PREFIX} from './constants'\n\nconst UNSAFE_CHARS = /[^a-zA-Z0-9_-]+/g\nconst LEADING = /^[_-]+/\nconst TRAILING = /[_-]+$/\n\n// Note: Document IDs have a max limit of 128 characters, but we need to leave some breathing room\n// for the prefix and separator characters.\n//  - the version prefix is (9 chars)\n//  - version name is typically 9 chars\n//  - the path separator is one char\nconst GENERATED_IDS_MAX_LENGTH = 96\n\n/**\n * Create a new document id\n *\n * @param input Optional input string to create the id from.\n * The input string will be converted to a string safe to use as a sanity document id, i.e.\n * - stripped for any special characters\n * - capped at max 100 chars\n * If no input is provided, a random uuid will be used instead\n */\nexport function createPublishedId(input?: string): PublishedId {\n  return PublishedId(generateId(input))\n}\n\n/**\n * Create a new draft id\n *\n * @param input Optional input string to create the id from.\n * The input string will be converted to a string safe to use as a sanity document id, i.e.\n * - stripped for any special characters\n * - capped at max 100 chars\n * If no input is provided, a random uuid will be used instead\n */\nexport function createDraftId(input?: string): DraftId {\n  return DraftId(DRAFTS_PREFIX + generateId(input))\n}\n\n/**\n * Create a new version id\n *\n * @param versionName - The name of the version to create\n * @param input Optional input string to create the id from.\n * The input string will be converted to a string safe to use as a sanity document id, i.e.\n * - stripped for any special characters\n * - capped at max 100 chars\n * If no input is provided, a random uuid will be used instead\n */\nexport function createVersionId(\n  versionName: string,\n  input?: string,\n): VersionId {\n  return VersionId(\n    VERSION_PREFIX + versionName + PATH_SEPARATOR + generateId(input),\n  )\n}\n\nfunction generateId(input?: string) {\n  return input ? makeSafe(input) : uuid()\n}\n\nfunction makeSafe(input: string) {\n  return deburr(input)\n    .replace(UNSAFE_CHARS, '')\n    .replace(TRAILING, '')\n    .replace(LEADING, '')\n    .slice(0, GENERATED_IDS_MAX_LENGTH)\n}\n"],"names":["error"],"mappings":"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","ignoreList":[0,1,2,3,4,5],"debugId":null}},
    {"offset": {"line": 5344, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/descriptors/src/utils.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/descriptors/src/encoder.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/descriptors/src/reconciler.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/descriptors/src/set.ts"],"sourcesContent":["export function arrayEquals(arr1: Uint8Array | number[], arr2: Uint8Array | number[]) {\n  for (let i = 0; i < arr1.length; i++) {\n    if (arr1[i] != arr2[i]) return false\n  }\n\n  return true\n}\n\nexport function arrayCompare(arr1: Uint8Array | number[], arr2: Uint8Array | number[]) {\n  for (let i = 0; i < arr1.length; i++) {\n    if (arr1[i] < arr2[i]) return -1\n    if (arr1[i] > arr2[i]) return 1\n  }\n\n  return 0\n}\n\nexport function arrayZero(arr: Uint8Array | number[]): boolean {\n  for (let i = 0; i < arr.length; i++) {\n    if (arr[i] != 0) return false\n  }\n  return true\n}\n","import {Hash} from 'sha256-uint8array'\nimport {arrayCompare} from './utils'\n\n/** The ID if a descriptor. */\nexport type ID = string\n\n/**\n * A descriptor with an `id` and `type`.\n *\n * @public\n */\nexport type Encoded<T extends string, U extends EncodableObject = EncodableObject> = U & {\n  id: ID\n  type: T\n}\n\n/**\n * The subset of values which we can encode.\n *\n * @public\n */\nexport type EncodableValue = EncodableObject | Array<EncodableValue> | boolean | string | null\n\n/**\n * A JavaScript object which can be encoded as a descriptor.\n * @public\n */\nexport type EncodableObject = {[key: string]: EncodableValue | undefined}\n\n// Not sure why, but ESLint thinks that this shadows an existing identifier.\n// eslint-disable-next-line no-shadow\nenum Tag {\n  NULL = 0x6e,\n  TRUE = 0x74,\n  FALSE = 0x66,\n  STRING = 0x73,\n  ARRAY_START = 0x61,\n  ARRAY_END = 0x41,\n  OBJECT_START = 0x6f,\n  OBJECT_END = 0x4f,\n}\n\nconst MULTIHASH_SHA256 = '\\x12\\x20'\n\nclass IDEncoder {\n  hash: Hash = new Hash()\n  buffer: ArrayBuffer = new ArrayBuffer(4)\n  uint8 = new Uint8Array(this.buffer)\n  uint8_byte = new Uint8Array(this.buffer, 0, 1)\n  int32 = new Int32Array(this.buffer)\n\n  encodeByte(byte: number) {\n    this.uint8_byte[0] = byte\n    this.hash.update(this.uint8_byte)\n  }\n\n  encodeString(val: string) {\n    this.hash.update(val, 'utf8')\n  }\n\n  encodeInt32(val: number) {\n    this.int32[0] = val\n    if (this.int32[0] !== val) throw new Error('Only 32-bit numbers can be encoded as descriptors')\n    this.hash.update(this.uint8)\n  }\n\n  encodeValue(val: EncodableValue) {\n    if (val === null) {\n      this.encodeByte(Tag.NULL)\n    } else if (val === true) {\n      this.encodeByte(Tag.TRUE)\n    } else if (val === false) {\n      this.encodeByte(Tag.FALSE)\n    } else if (typeof val === 'string') {\n      this.encodeByte(Tag.STRING)\n      this.encodeString(val)\n    } else if (Array.isArray(val)) {\n      this.encodeByte(Tag.ARRAY_START)\n      for (const elem of val) {\n        this.encodeValue(elem)\n      }\n      this.encodeByte(Tag.ARRAY_END)\n    } else {\n      const digests = []\n\n      for (const [key, field] of Object.entries(val)) {\n        if (field === undefined) {\n          continue\n        }\n\n        const fieldEncoder = new IDEncoder()\n        fieldEncoder.encodeString(key)\n        fieldEncoder.encodeValue(field)\n        digests.push(fieldEncoder.getDigest())\n      }\n\n      digests.sort((a, b) => arrayCompare(a, b))\n\n      this.encodeByte(Tag.OBJECT_START)\n      for (const digest of digests) {\n        this.hash.update(digest)\n      }\n      this.encodeByte(Tag.OBJECT_END)\n    }\n  }\n\n  encodeObjectWithType(type: string, val: EncodableObject) {\n    const digests = []\n\n    for (const [key, field] of Object.entries(val)) {\n      if (field === undefined) {\n        continue\n      }\n\n      const fieldEncoder = new IDEncoder()\n      fieldEncoder.encodeString(key)\n      fieldEncoder.encodeValue(field)\n      digests.push(fieldEncoder.getDigest())\n    }\n\n    const typeEncoder = new IDEncoder()\n    typeEncoder.encodeString('type')\n    typeEncoder.encodeValue(type)\n    digests.push(typeEncoder.getDigest())\n\n    digests.sort((a, b) => arrayCompare(a, b))\n\n    this.encodeByte(Tag.OBJECT_START)\n    for (const digest of digests) {\n      this.hash.update(digest)\n    }\n    this.encodeByte(Tag.OBJECT_END)\n  }\n\n  getDigest() {\n    return this.hash.digest()\n  }\n}\n\n/**\n * Encodes binary data into the base64url format as specified by multibase:\n * https://github.com/multiformats/multibase.\n *\n * @public\n */\nexport function encodeBase64(data: Uint8Array, prefix: string = ''): string {\n  let binary = prefix\n  for (let i = 0; i < data.length; i++) {\n    binary += String.fromCharCode(data[i])\n  }\n  return 'u' + globalThis.btoa(binary).replaceAll('+', '-').replaceAll('/', '_').replaceAll('=', '')\n}\n\n/**\n * Encodes a SHA256 hash (which should be 32 bytes long) as specified by multihash:\n * https://github.com/multiformats/multihash.\n *\n * @public\n */\nexport function encodeBase64Sha256(data: Uint8Array): string {\n  return encodeBase64(data, MULTIHASH_SHA256)\n}\n\n/**\n * Decodes a base64 value encoded using multibase.\n *\n * @public\n */\nexport function decodeBase64(input: string, into: Uint8Array): void {\n  if (input[0] !== 'u') throw new Error('Invalid base64')\n\n  const binary = globalThis.atob(input.slice(1).replaceAll('-', '+').replaceAll('_', '/'))\n  for (let i = 0; i < binary.length; i++) {\n    into[i] = binary.charCodeAt(i)\n  }\n}\n\n/**\n * Encodes an object with the given type.\n */\nexport function encode<Type extends string, Props extends EncodableObject>(\n  type: Type,\n  props: Props,\n  options?: {\n    /**\n     * This is invoked with the raw SHA256 hash, which will also be placed in\n     * `id` in encoded form.\n     **/\n    withDigest?: (digest: Uint8Array) => void\n  },\n): Encoded<Type, Props> {\n  const idEncoder = new IDEncoder()\n  idEncoder.encodeObjectWithType(type, props)\n  const digest = idEncoder.getDigest()\n  if (options?.withDigest) options.withDigest(digest)\n  const id = encodeBase64(digest, MULTIHASH_SHA256)\n  return {id, type, ...props}\n}\n","import {arrayCompare, arrayEquals, arrayZero} from './utils'\n\nconst NUM_HASH = 3\n\n/**\n * A sketch of a set of n-byte objects (als sometimes called \"invertible Bloom\n * filter\"). It supports the following operation:\n *\n * - `construct`: Create a sketch with a given number of buckets (i.e.\n *   capacity).\n * - `toggle`: Add/remove (depending on whether it already existed) a value into\n *   the sketch.\n * - `toggleAll`: Add/remove all the values from _another_ sketch.\n * - `decode`: Attempt to recover the values inside the set. This should succeed\n *   with a high probability if the set currently contains ~80% of the number of\n *   buckets it was constructed with.\n *\n * The typical use case is to use this to construct two different sketches, each\n * could contain hundreds or thousands entries, and then by invoking `toggleAll`\n * between these sketches it's possible to decode the symmetric difference\n * between the sets.\n *\n * This is an implementation of https://doi.org/10.4230/LIPIcs.ICALP.2024.20.\n *\n * @internal\n */\nexport class SetSketch {\n  arr: Uint8Array\n  byteSize: number\n  numBuckets: number\n\n  constructor(byteSize: number, numBuckets: number) {\n    if (numBuckets >= 31) throw new Error('numBuckets must be less than 31')\n\n    this.byteSize = byteSize\n    this.numBuckets = numBuckets\n    this.arr = new Uint8Array(this.byteSize * this.numBuckets)\n  }\n\n  toggle(val: Uint8Array | number[], yieldBucket?: (bucket: number) => void): void {\n    for (let k = 0; k < NUM_HASH; k++) {\n      const bucket = val[k] % this.numBuckets\n      if (yieldBucket) yieldBucket(bucket)\n\n      const offset = bucket * this.byteSize\n      for (let idx = 0; idx < this.byteSize; idx++) {\n        this.arr[offset + idx] ^= val[idx]\n      }\n    }\n  }\n\n  toggleAll(other: SetSketch): void {\n    for (let i = 0; i < this.arr.length; i++) {\n      this.arr[i] ^= other.arr[i]\n    }\n  }\n\n  copy(): SetSketch {\n    const result = new SetSketch(this.byteSize, this.numBuckets)\n    for (let idx = 0; idx < this.arr.length; idx++) {\n      result.arr[idx] = this.arr[idx]\n    }\n    return result\n  }\n\n  decode(): BufferSet | null {\n    const max = this.numBuckets * 2\n    const set = new BufferSet(this.byteSize, max)\n    const queue = new BitQueue(this.numBuckets)\n\n    let t = 0\n\n    while (!queue.isEmpty()) {\n      const bucket = queue.pop()\n      if (this.looksPure(bucket)) {\n        if (t >= max) {\n          // It's possible for the algorithm to be stuck in a loop so we guard this here.\n          return null\n        }\n\n        const offset = bucket * this.byteSize\n\n        // OPT: Maybe we could avoid copying here.\n        const slice = this.arr.slice(offset, offset + this.byteSize)\n\n        set.toggle(slice)\n        this.toggle(slice, (otherBuckets) => {\n          if (otherBuckets !== bucket) {\n            queue.set(otherBuckets)\n          }\n        })\n\n        t++\n      }\n    }\n\n    if (!arrayZero(this.arr)) return null\n\n    return set\n  }\n\n  looksPure(bucket: number): boolean {\n    const offset = bucket * this.byteSize\n    const val = this.arr.subarray(offset, offset + this.byteSize)\n    if (arrayZero(val)) return false\n\n    let hashedToBucketCount = 0\n\n    for (let k = 0; k < NUM_HASH; k++) {\n      const hashedBucket = val[k] % this.numBuckets\n      if (hashedBucket === bucket) hashedToBucketCount++\n    }\n\n    return hashedToBucketCount % 2 == 1\n  }\n}\n\n/**\n * Represents a set of Uint8Array's which are all of the same size.\n * The primary interface is the `toggle` method which either adds or removes\n * a value to the set.\n *\n * @beta\n */\nexport class BufferSet {\n  arr: Uint8Array\n  byteSize: number\n  length: number\n  capacity: number\n\n  constructor(byteSize: number, capacity: number) {\n    this.arr = new Uint8Array(byteSize * capacity)\n    this.byteSize = byteSize\n    this.length = 0\n    this.capacity = capacity\n  }\n\n  toggle(val: Uint8Array | number[]): void {\n    for (let i = 0; i < this.length; i++) {\n      const start = i * this.byteSize\n      const slice = this.arr.subarray(start, start + this.byteSize)\n      if (arrayEquals(val, slice)) {\n        if (i != this.length - 1) {\n          // Move the last entry into this slot.\n          const lastEntryByteIdx = (this.length - 1) * this.byteSize\n          for (let j = 0; j < this.byteSize; j++) {\n            slice[j] = this.arr[lastEntryByteIdx + j]\n          }\n        }\n\n        this.length--\n        return\n      }\n    }\n\n    if (this.length === this.capacity) throw new Error('BufferSet is full')\n\n    const byteIdx = this.length * this.byteSize\n    for (let i = 0; i < this.byteSize; i++) {\n      this.arr[byteIdx + i] = val[i]\n    }\n    this.length++\n  }\n\n  forEach(fn: (val: Uint8Array) => void): void {\n    for (let i = 0; i < this.length; i++) {\n      const start = i * this.byteSize\n      fn(this.arr.subarray(start, start + this.byteSize))\n    }\n  }\n\n  /**\n   * Returns a normalized JSON representation.\n   *\n   * This is not optimized and should mainly be used for debugging.\n   */\n  toJSON(): number[][] {\n    const result: number[][] = []\n    this.forEach((entry) => {\n      result.push(Array.from(entry))\n    })\n\n    result.sort((a, b) => arrayCompare(a, b))\n    return result\n  }\n}\n\n/**\n * A queue which can store numbers in the range of [0, 32).The `set` method is\n * idempontent and will only add a value to the queue if it's not set there\n * already.\n *\n * It uses a single bitset to efficiently keep track of which values have\n * already been set.\n *\n * The construct defaults to putting all the numbers onto the queue.\n */\nclass BitQueue {\n  bitset: number\n  queue: number[]\n\n  constructor(size: number) {\n    // Set all bits to 1\n    this.bitset = (1 << size) - 1\n    this.queue = Array.from({length: size}, (_, i) => i)\n  }\n\n  set(idx: number) {\n    const mask = 1 << idx\n    if (this.bitset & mask) {\n      // Already set. Nothing to do.\n      return\n    }\n\n    this.queue.push(idx)\n    this.bitset |= mask\n  }\n\n  isEmpty() {\n    return this.bitset === 0\n  }\n\n  pop(): number {\n    const idx = this.queue.shift()!\n    const mask = 1 << idx\n    this.bitset &= ~mask\n    return idx\n  }\n}\n","import {type EncodableObject, encode, type Encoded, type ID} from './encoder'\nimport {SetSketch} from './reconciler'\nimport type {SynchronizationRequest, SynchronizationResult} from './sync'\n\n/**\n * A set descriptor. This follows the very specific form with a property called\n * `keys` containing other descriptor IDs.\n *\n * @public\n */\nexport type EncodedSet<Type extends string> = Encoded<Type, {keys: ID[]}>\n\n/**\n * SetSynchronization contains information about a set so that it can be\n * synchronized.\n *\n * @public\n */\nexport interface SetSynchronization<Type extends string> {\n  /** @internal */\n  set: EncodedSet<Type>\n\n  /** @internal */\n  digest: Uint8Array\n\n  /** @internal */\n  objectValues: Record<string, Encoded<string, EncodableObject>>\n\n  /** @internal */\n  setValues: Record<string, SetSynchronization<string>>\n  /** @internal */\n  sketch: SetSketch\n}\n\n/**\n * SetBuilder is a class which helps you construct a set for efficient synchronization.\n *\n * @public\n */\nexport class SetBuilder {\n  private objectValues: Record<string, Encoded<string, EncodableObject>> = {}\n  private setValues: Record<string, SetSynchronization<string>> = {}\n  private keys: string[] = []\n  private sketch: SetSketch = new SetSketch(32, 8)\n\n  /**\n   * Add an object to the set.\n   */\n  addObject<Type extends string>(type: Type, obj: EncodableObject): void {\n    const value = encode(type, obj, {\n      withDigest: (digest) => {\n        this.sketch.toggle(digest)\n      },\n    })\n    this.objectValues[value.id] = value\n    this.keys.push(value.id)\n  }\n\n  /**\n   * Add another set to the set.\n   */\n  addSet<Type extends string>(sync: SetSynchronization<Type>): void {\n    this.setValues[sync.set.id] = sync\n    this.sketch.toggle(sync.digest)\n    this.keys.push(sync.set.id)\n  }\n\n  build<Type extends string>(type: Type): SetSynchronization<Type> {\n    this.keys.sort()\n\n    let digest: Uint8Array\n\n    const set = encode(\n      type,\n      {keys: this.keys},\n      {\n        withDigest: (d) => {\n          digest = d\n        },\n      },\n    )\n\n    return {\n      set,\n      digest: digest!,\n      objectValues: this.objectValues,\n      setValues: this.setValues,\n      sketch: this.sketch,\n    }\n  }\n}\n\n/**\n * The main logic for synchronizing a set to a server.\n *\n * Initially this function should be invoked with `prevResult` set to `null`.\n * This returns a SynchronizationRequest which should then be sent to a server.\n * Once the server returns a result this function should be invoked with this\n * as a parameter. This proccess should be continued until this function return\n * `null`.\n *\n * @param sync The set to synchronize.\n * @param prevResult The result from the previous synchronization.\n * @returns `null` when the synchronization is complete, or a request which should be sent.\n * @public\n */\nexport function processSetSynchronization<Type extends string>(\n  sync: SetSynchronization<Type>,\n  prevResult: SynchronizationResult | null,\n): SynchronizationRequest | null {\n  const id = sync.set.id\n  if (!prevResult) return {id}\n\n  if (prevResult.type === 'complete') return null\n\n  const descriptors: Array<Encoded<string, EncodableObject>> = []\n\n  for (const missingId of prevResult.missingIds) {\n    const descriptor = findDescriptor(sync, missingId)\n    if (!descriptor) throw new Error(`Synchronization server is requested an unknonwn descriptor`)\n    descriptors.push(descriptor)\n  }\n\n  return {id, descriptors}\n}\n\nfunction findDescriptor<Type extends string>(\n  sync: SetSynchronization<Type>,\n  id: ID,\n): Encoded<string, EncodableObject> | null {\n  if (sync.set.id === id) return sync.set\n\n  const desc = sync.objectValues[id]\n  if (desc) return desc\n\n  for (const child of Object.values(sync.setValues)) {\n    const childDesc = findDescriptor(child, id)\n    if (childDesc) return childDesc\n  }\n\n  return null\n}\n"],"names":[],"mappings":"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","ignoreList":[0,1,2,3],"debugId":null}},
    {"offset": {"line": 5629, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/clone.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/commonOverlap.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/commonPrefix.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/commonSuffix.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/utils/surrogatePairs.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/bisect.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/halfMatch.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/charsToLines.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/linesToChars.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/lineMode.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/compute.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/diff.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/cleanup.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/match/bitap.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/match/match.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/diffText.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/levenshtein.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/diff/xIndex.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/utils/utf8Indices.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/patch/constants.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/patch/addPadding.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/patch/createPatchObject.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/patch/splitMax.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/patch/apply.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/patch/make.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/patch/parse.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-match-patch/src/patch/stringify.ts"],"sourcesContent":["import {type Diff} from './diff.js'\n\n/**\n * Clones a diff tuple.\n *\n * @param diff - Tuple to clone.\n * @returns New, cloned tuple.\n * @internal\n */\nexport function cloneDiff(diff: Diff): Diff {\n  const [type, patch] = diff\n  return [type, patch]\n}\n","/**\n * Determine if the suffix of one string is the prefix of another.\n *\n * @param textA - First string.\n * @param textB - Second string.\n * @returns Number of characters common to the end of the first string\n *   and the start of the second string.\n * @internal\n */\nexport function getCommonOverlap(textA: string, textB: string): number {\n  let text1 = textA\n  let text2 = textB\n\n  // Cache the text lengths to prevent multiple calls.\n  const text1Length = text1.length\n  const text2Length = text2.length\n\n  // Eliminate the null case.\n  if (text1Length === 0 || text2Length === 0) {\n    return 0\n  }\n\n  // Truncate the longer string.\n  if (text1Length > text2Length) {\n    text1 = text1.substring(text1Length - text2Length)\n  } else if (text1Length < text2Length) {\n    text2 = text2.substring(0, text1Length)\n  }\n  const textLength = Math.min(text1Length, text2Length)\n\n  // Quick check for the worst case.\n  if (text1 === text2) {\n    return textLength\n  }\n\n  // Start by looking for a single character match\n  // and increase length until no match is found.\n  // Performance analysis: http://neil.fraser.name/news/2010/11/04/\n  let best = 0\n  let length = 1\n\n  for (let found = 0; found !== -1; ) {\n    const pattern = text1.substring(textLength - length)\n    found = text2.indexOf(pattern)\n    if (found === -1) {\n      return best\n    }\n    length += found\n    if (found === 0 || text1.substring(textLength - length) === text2.substring(0, length)) {\n      best = length\n      length++\n    }\n  }\n\n  // Only for typescript, never reached\n  return best\n}\n","/**\n * Determine the common prefix of two strings.\n *\n * @param text1 - First string.\n * @param text2 - Second string.\n * @returns The number of characters common to the start of each string.\n * @internal\n */\nexport function getCommonPrefix(text1: string, text2: string): number {\n  // Quick check for common null cases.\n  if (!text1 || !text2 || text1[0] !== text2[0]) {\n    return 0\n  }\n\n  // Binary search.\n  // Performance analysis: http://neil.fraser.name/news/2007/10/09/\n  let pointerMin = 0\n  let pointerMax = Math.min(text1.length, text2.length)\n  let pointerMid = pointerMax\n  let pointerStart = 0\n  while (pointerMin < pointerMid) {\n    if (text1.substring(pointerStart, pointerMid) === text2.substring(pointerStart, pointerMid)) {\n      pointerMin = pointerMid\n      pointerStart = pointerMin\n    } else {\n      pointerMax = pointerMid\n    }\n    pointerMid = Math.floor((pointerMax - pointerMin) / 2 + pointerMin)\n  }\n  return pointerMid\n}\n","/**\n * Determine the common suffix of two strings.\n *\n * @param text1 - First string.\n * @param text2 - Second string.\n * @returns The number of characters common to the end of each string.\n * @internal\n */\nexport function getCommonSuffix(text1: string, text2: string): number {\n  // Quick check for common null cases.\n  if (!text1 || !text2 || text1[text1.length - 1] !== text2[text2.length - 1]) {\n    return 0\n  }\n\n  // Binary search.\n  // Performance analysis: http://neil.fraser.name/news/2007/10/09/\n  let pointerMin = 0\n  let pointerMax = Math.min(text1.length, text2.length)\n  let pointerMid = pointerMax\n  let pointerEnd = 0\n  while (pointerMin < pointerMid) {\n    if (\n      text1.substring(text1.length - pointerMid, text1.length - pointerEnd) ===\n      text2.substring(text2.length - pointerMid, text2.length - pointerEnd)\n    ) {\n      pointerMin = pointerMid\n      pointerEnd = pointerMin\n    } else {\n      pointerMax = pointerMid\n    }\n    pointerMid = Math.floor((pointerMax - pointerMin) / 2 + pointerMin)\n  }\n\n  return pointerMid\n}\n","/**\n * Checks if the character is a high surrogate\n *\n * @param char - Character to check\n * @returns True if high surrogate, false otherwise\n */\nexport function isHighSurrogate(char: string): boolean {\n  const charCode = char.charCodeAt(0)\n  return charCode >= 0xd800 && charCode <= 0xdbff\n}\n\n/**\n * Checks if the character is a low surrogate\n *\n * @param char - Character to check\n * @returns True if low surrogate, false otherwise\n */\nexport function isLowSurrogate(char: string): boolean {\n  const charCode = char.charCodeAt(0)\n  return charCode >= 0xdc00 && charCode <= 0xdfff\n}\n","import {type Diff, DIFF_DELETE, DIFF_INSERT, doDiff} from './diff.js'\n\n/**\n * Find the 'middle snake' of a diff, split the problem in two\n * and return the recursively constructed diff.\n * See Myers 1986 paper: An O(ND) Difference Algorithm and Its Variations.\n *\n * @param text1 - Old string to be diffed.\n * @param text2 - New string to be diffed.\n * @returns Array of diff tuples.\n * @internal\n */\nexport function bisect(text1: string, text2: string, deadline: number): Diff[] {\n  // Cache the text lengths to prevent multiple calls.\n  const text1Length = text1.length\n  const text2Length = text2.length\n  const maxD = Math.ceil((text1Length + text2Length) / 2)\n  const vOffset = maxD\n  const vLength = 2 * maxD\n  const v1 = new Array(vLength)\n  const v2 = new Array(vLength)\n  // Setting all elements to -1 is faster in Chrome & Firefox than mixing\n  // integers and undefined.\n  for (let x = 0; x < vLength; x++) {\n    v1[x] = -1\n    v2[x] = -1\n  }\n  v1[vOffset + 1] = 0\n  v2[vOffset + 1] = 0\n  const delta = text1Length - text2Length\n  // If the total number of characters is odd, then the front path will collide\n  // with the reverse path.\n  const front = delta % 2 !== 0\n  // Offsets for start and end of k loop.\n  // Prevents mapping of space beyond the grid.\n  let k1start = 0\n  let k1end = 0\n  let k2start = 0\n  let k2end = 0\n  for (let d = 0; d < maxD; d++) {\n    // Bail out if deadline is reached.\n    if (Date.now() > deadline) {\n      break\n    }\n    // Walk the front path one step.\n    for (let k1 = -d + k1start; k1 <= d - k1end; k1 += 2) {\n      const k1Offset = vOffset + k1\n      let x1\n      if (k1 === -d || (k1 !== d && v1[k1Offset - 1] < v1[k1Offset + 1])) {\n        x1 = v1[k1Offset + 1]\n      } else {\n        x1 = v1[k1Offset - 1] + 1\n      }\n      let y1 = x1 - k1\n      while (x1 < text1Length && y1 < text2Length && text1.charAt(x1) === text2.charAt(y1)) {\n        x1++\n        y1++\n      }\n      v1[k1Offset] = x1\n      if (x1 > text1Length) {\n        // Ran off the right of the graph.\n        k1end += 2\n      } else if (y1 > text2Length) {\n        // Ran off the bottom of the graph.\n        k1start += 2\n      } else if (front) {\n        const k2Offset = vOffset + delta - k1\n        if (k2Offset >= 0 && k2Offset < vLength && v2[k2Offset] !== -1) {\n          // Mirror x2 onto top-left coordinate system.\n          const x2 = text1Length - v2[k2Offset]\n          if (x1 >= x2) {\n            // Overlap detected.\n            return bisectSplit(text1, text2, x1, y1, deadline)\n          }\n        }\n      }\n    }\n\n    // Walk the reverse path one step.\n    for (let k2 = -d + k2start; k2 <= d - k2end; k2 += 2) {\n      const k2Offset = vOffset + k2\n      let x2\n      if (k2 === -d || (k2 !== d && v2[k2Offset - 1] < v2[k2Offset + 1])) {\n        x2 = v2[k2Offset + 1]\n      } else {\n        x2 = v2[k2Offset - 1] + 1\n      }\n      let y2 = x2 - k2\n      while (\n        x2 < text1Length &&\n        y2 < text2Length &&\n        text1.charAt(text1Length - x2 - 1) === text2.charAt(text2Length - y2 - 1)\n      ) {\n        x2++\n        y2++\n      }\n      v2[k2Offset] = x2\n      if (x2 > text1Length) {\n        // Ran off the left of the graph.\n        k2end += 2\n      } else if (y2 > text2Length) {\n        // Ran off the top of the graph.\n        k2start += 2\n      } else if (!front) {\n        const k1Offset = vOffset + delta - k2\n        if (k1Offset >= 0 && k1Offset < vLength && v1[k1Offset] !== -1) {\n          const x1 = v1[k1Offset]\n          const y1 = vOffset + x1 - k1Offset\n          // Mirror x2 onto top-left coordinate system.\n          x2 = text1Length - x2\n          if (x1 >= x2) {\n            // Overlap detected.\n            return bisectSplit(text1, text2, x1, y1, deadline)\n          }\n        }\n      }\n    }\n  }\n  // Number of diffs equals number of characters, no commonality at all.\n  return [\n    [DIFF_DELETE, text1],\n    [DIFF_INSERT, text2],\n  ]\n}\n\n/**\n * Given the location of the 'middle snake', split the diff in two parts\n * and recurse.\n *\n * @param text1 - Old string to be diffed.\n * @param text2 - New string to be diffed.\n * @param x - Index of split point in text1.\n * @param y - Index of split point in text2.\n * @param deadline - Time at which to bail if not yet complete.\n * @returns Array of diff tuples.\n * @internal\n */\nfunction bisectSplit(text1: string, text2: string, x: number, y: number, deadline: number): Diff[] {\n  const text1a = text1.substring(0, x)\n  const text2a = text2.substring(0, y)\n  const text1b = text1.substring(x)\n  const text2b = text2.substring(y)\n\n  // Compute both diffs serially.\n  const diffs = doDiff(text1a, text2a, {checkLines: false, deadline})\n  const diffsb = doDiff(text1b, text2b, {checkLines: false, deadline})\n\n  return diffs.concat(diffsb)\n}\n","import {getCommonPrefix} from './commonPrefix.js'\nimport {getCommonSuffix} from './commonSuffix.js'\n\ntype HalfMatch = [string, string, string, string, string]\n\n/**\n * Does a slice of shorttext exist within longtext such that the slice\n * is at least half the length of longtext?\n *\n * @param longtext - Longer string.\n * @param shorttext - Shorter string.\n * @param i - Start index of quarter length slice within longtext.\n * @returns Five element Array, containing the prefix of\n *     longtext, the suffix of longtext, the prefix of shorttext, the suffix\n *     of shorttext and the common middle.  Or null if there was no match.\n * @internal\n */\nexport function findHalfMatch(text1: string, text2: string, timeout = 1): null | HalfMatch {\n  if (timeout <= 0) {\n    // Don't risk returning a non-optimal diff if we have unlimited time.\n    return null\n  }\n\n  const longText = text1.length > text2.length ? text1 : text2\n  const shortText = text1.length > text2.length ? text2 : text1\n  if (longText.length < 4 || shortText.length * 2 < longText.length) {\n    return null // Pointless.\n  }\n\n  // First check if the second quarter is the seed for a half-match.\n  const halfMatch1 = halfMatchI(longText, shortText, Math.ceil(longText.length / 4))\n  // Check again based on the third quarter.\n  const halfMatch2 = halfMatchI(longText, shortText, Math.ceil(longText.length / 2))\n\n  let halfMatch\n  if (halfMatch1 && halfMatch2) {\n    // Both matched.  Select the longest.\n    halfMatch = halfMatch1[4].length > halfMatch2[4].length ? halfMatch1 : halfMatch2\n  } else if (!halfMatch1 && !halfMatch2) {\n    return null\n  } else if (!halfMatch2) {\n    halfMatch = halfMatch1\n  } else if (!halfMatch1) {\n    halfMatch = halfMatch2\n  }\n\n  if (!halfMatch) {\n    throw new Error('Unable to find a half match.')\n  }\n\n  // A half-match was found, sort out the return data.\n  let text1A: string\n  let text1B: string\n  let text2A: string\n  let text2B: string\n\n  if (text1.length > text2.length) {\n    text1A = halfMatch[0]\n    text1B = halfMatch[1]\n    text2A = halfMatch[2]\n    text2B = halfMatch[3]\n  } else {\n    text2A = halfMatch[0]\n    text2B = halfMatch[1]\n    text1A = halfMatch[2]\n    text1B = halfMatch[3]\n  }\n  const midCommon = halfMatch[4]\n  return [text1A, text1B, text2A, text2B, midCommon]\n}\n\n/**\n * Do the two texts share a slice which is at least half the length of the\n * longer text?\n * This speedup can produce non-minimal diffs.\n *\n * @param longText - First string.\n * @param shortText - Second string.\n * @returns Five element array, containing the prefix of longText,\n *     the suffix of longText, the prefix of shortText, the suffix of\n *     shortText and the common middle.  Or null if there was no match.\n * @internal\n */\nfunction halfMatchI(longText: string, shortText: string, i: number): null | HalfMatch {\n  // Start with a 1/4 length slice at position i as a seed.\n  const seed = longText.slice(i, i + Math.floor(longText.length / 4))\n  let j = -1\n  let bestCommon = ''\n  let bestLongTextA\n  let bestLongTextB\n  let bestShortTextA\n  let bestShortTextB\n\n  while ((j = shortText.indexOf(seed, j + 1)) !== -1) {\n    const prefixLength = getCommonPrefix(longText.slice(i), shortText.slice(j))\n    const suffixLength = getCommonSuffix(longText.slice(0, i), shortText.slice(0, j))\n    if (bestCommon.length < suffixLength + prefixLength) {\n      bestCommon = shortText.slice(j - suffixLength, j) + shortText.slice(j, j + prefixLength)\n      bestLongTextA = longText.slice(0, i - suffixLength)\n      bestLongTextB = longText.slice(i + prefixLength)\n      bestShortTextA = shortText.slice(0, j - suffixLength)\n      bestShortTextB = shortText.slice(j + prefixLength)\n    }\n  }\n  if (bestCommon.length * 2 >= longText.length) {\n    return [\n      bestLongTextA || '',\n      bestLongTextB || '',\n      bestShortTextA || '',\n      bestShortTextB || '',\n      bestCommon || '',\n    ]\n  }\n\n  return null\n}\n","import {type Diff} from './diff.js'\n\n/**\n * Rehydrate the text in a diff from a string of line hashes to real lines of text.\n *\n * @param diffs - Array of diff tuples.\n * @param lineArray - Array of unique strings.\n * @internal\n */\nexport function charsToLines(diffs: Diff[], lineArray: string[]): void {\n  for (let x = 0; x < diffs.length; x++) {\n    const chars = diffs[x][1]\n    const text: string[] = []\n    for (let y = 0; y < chars.length; y++) {\n      text[y] = lineArray[chars.charCodeAt(y)]\n    }\n    diffs[x][1] = text.join('')\n  }\n}\n","/**\n * Split two texts into an array of strings.  Reduce the texts to a string of\n * hashes where each Unicode character represents one line.\n *\n * @param textA - First string.\n * @param textB - Second string.\n * @returns An object containing the encoded textA, the encoded textB and\n *   the array of unique strings. The zeroth element of the array of unique\n *   strings is intentionally blank.\n * @internal\n */\nexport function linesToChars(\n  textA: string,\n  textB: string,\n): {\n  chars1: string\n  chars2: string\n  lineArray: string[]\n} {\n  const lineArray: string[] = [] // e.g. lineArray[4] === 'Hello\\n'\n  const lineHash: {[key: string]: number} = {} // e.g. lineHash['Hello\\n'] === 4\n\n  // '\\x00' is a valid character, but various debuggers don't like it.\n  // So we'll insert a junk entry to avoid generating a null character.\n  lineArray[0] = ''\n\n  /**\n   * Split a text into an array of strings.  Reduce the texts to a string of\n   * hashes where each Unicode character represents one line.\n   * Modifies linearray and linehash through being a closure.\n   *\n   * @param text - String to encode.\n   * @returns Encoded string.\n   * @internal\n   */\n  function diffLinesToMunge(text: string) {\n    let chars = ''\n    // Walk the text, pulling out a substring for each line.\n    // text.split('\\n') would would temporarily double our memory footprint.\n    // Modifying text would create many large strings to garbage collect.\n    let lineStart = 0\n    let lineEnd = -1\n    // Keeping our own length variable is faster than looking it up.\n    let lineArrayLength = lineArray.length\n    while (lineEnd < text.length - 1) {\n      lineEnd = text.indexOf('\\n', lineStart)\n      if (lineEnd === -1) {\n        lineEnd = text.length - 1\n      }\n      let line = text.slice(lineStart, lineEnd + 1)\n\n      // eslint-disable-next-line no-prototype-builtins\n      if (lineHash.hasOwnProperty ? lineHash.hasOwnProperty(line) : lineHash[line] !== undefined) {\n        chars += String.fromCharCode(lineHash[line])\n      } else {\n        if (lineArrayLength === maxLines) {\n          // Bail out at 65535 because\n          // String.fromCharCode(65536) == String.fromCharCode(0)\n          line = text.slice(lineStart)\n          lineEnd = text.length\n        }\n        chars += String.fromCharCode(lineArrayLength)\n        lineHash[line] = lineArrayLength\n        lineArray[lineArrayLength++] = line\n      }\n      lineStart = lineEnd + 1\n    }\n    return chars\n  }\n  // Allocate 2/3rds of the space for textA, the rest for textB.\n  let maxLines = 40000\n  const chars1 = diffLinesToMunge(textA)\n  maxLines = 65535\n  const chars2 = diffLinesToMunge(textB)\n  return {chars1, chars2, lineArray}\n}\n","import {charsToLines} from './charsToLines.js'\nimport {cleanupSemantic} from './cleanup.js'\nimport {\n  type Diff,\n  DIFF_DELETE,\n  DIFF_EQUAL,\n  DIFF_INSERT,\n  doDiff,\n  type InternalDiffOptions,\n} from './diff.js'\nimport {linesToChars} from './linesToChars.js'\n\n/**\n * Do a quick line-level diff on both strings, then rediff the parts for\n * greater accuracy.\n * This speedup can produce non-minimal diffs.\n *\n * @param textA - Old string to be diffed.\n * @param textB - New string to be diffed.\n * @param options - Options for the differ.\n * @returns Array of diff tuples.\n * @internal\n */\nexport function doLineModeDiff(textA: string, textB: string, opts: InternalDiffOptions): Diff[] {\n  // Don't reassign fn params\n  let text1 = textA\n  let text2 = textB\n\n  // Scan the text on a line-by-line basis first.\n  const a = linesToChars(text1, text2)\n  text1 = a.chars1\n  text2 = a.chars2\n  const linearray = a.lineArray\n\n  let diffs = doDiff(text1, text2, {\n    checkLines: false,\n    deadline: opts.deadline,\n  })\n\n  // Convert the diff back to original text.\n  charsToLines(diffs, linearray)\n  // Eliminate freak matches (e.g. blank lines)\n  diffs = cleanupSemantic(diffs)\n\n  // Rediff any replacement blocks, this time character-by-character.\n  // Add a dummy entry at the end.\n  diffs.push([DIFF_EQUAL, ''])\n  let pointer = 0\n  let countDelete = 0\n  let countInsert = 0\n  let textDelete = ''\n  let textInsert = ''\n  while (pointer < diffs.length) {\n    switch (diffs[pointer][0]) {\n      case DIFF_INSERT:\n        countInsert++\n        textInsert += diffs[pointer][1]\n        break\n      case DIFF_DELETE:\n        countDelete++\n        textDelete += diffs[pointer][1]\n        break\n      case DIFF_EQUAL:\n        // Upon reaching an equality, check for prior redundancies.\n        if (countDelete >= 1 && countInsert >= 1) {\n          // Delete the offending records and add the merged ones.\n          diffs.splice(pointer - countDelete - countInsert, countDelete + countInsert)\n          pointer = pointer - countDelete - countInsert\n          const aa = doDiff(textDelete, textInsert, {\n            checkLines: false,\n            deadline: opts.deadline,\n          })\n          for (let j = aa.length - 1; j >= 0; j--) {\n            diffs.splice(pointer, 0, aa[j])\n          }\n          pointer += aa.length\n        }\n        countInsert = 0\n        countDelete = 0\n        textDelete = ''\n        textInsert = ''\n        break\n      default:\n        throw new Error('Unknown diff operation.')\n    }\n    pointer++\n  }\n  diffs.pop() // Remove the dummy entry at the end.\n\n  return diffs\n}\n","import {bisect} from './bisect.js'\nimport {\n  type Diff,\n  DIFF_DELETE,\n  DIFF_EQUAL,\n  DIFF_INSERT,\n  doDiff,\n  type InternalDiffOptions,\n} from './diff.js'\nimport {findHalfMatch} from './halfMatch.js'\nimport {doLineModeDiff} from './lineMode.js'\n\n/**\n * Find the differences between two texts.  Assumes that the texts do not\n * have any common prefix or suffix.\n *\n * @param text1 - Old string to be diffed.\n * @param text2 - New string to be diffed.\n * @param checklines - Speedup flag.  If false, then don't run a\n *     line-level diff first to identify the changed areas.\n *     If true, then run a faster, slightly less optimal diff.\n * @param deadline - Time when the diff should be complete by.\n * @returns Array of diff tuples.\n * @internal\n */\nexport function computeDiff(text1: string, text2: string, opts: InternalDiffOptions): Diff[] {\n  let diffs: Diff[]\n\n  if (!text1) {\n    // Just add some text (speedup).\n    return [[DIFF_INSERT, text2]]\n  }\n\n  if (!text2) {\n    // Just delete some text (speedup).\n    return [[DIFF_DELETE, text1]]\n  }\n\n  const longtext = text1.length > text2.length ? text1 : text2\n  const shorttext = text1.length > text2.length ? text2 : text1\n  const i = longtext.indexOf(shorttext)\n  if (i !== -1) {\n    // Shorter text is inside the longer text (speedup).\n    diffs = [\n      [DIFF_INSERT, longtext.substring(0, i)],\n      [DIFF_EQUAL, shorttext],\n      [DIFF_INSERT, longtext.substring(i + shorttext.length)],\n    ]\n    // Swap insertions for deletions if diff is reversed.\n    if (text1.length > text2.length) {\n      diffs[0][0] = DIFF_DELETE\n      diffs[2][0] = DIFF_DELETE\n    }\n    return diffs\n  }\n\n  if (shorttext.length === 1) {\n    // Single character string.\n    // After the previous speedup, the character can't be an equality.\n    return [\n      [DIFF_DELETE, text1],\n      [DIFF_INSERT, text2],\n    ]\n  }\n\n  // Check to see if the problem can be split in two.\n  const halfMatch = findHalfMatch(text1, text2)\n  if (halfMatch) {\n    // A half-match was found, sort out the return data.\n    const text1A = halfMatch[0]\n    const text1B = halfMatch[1]\n    const text2A = halfMatch[2]\n    const text2B = halfMatch[3]\n    const midCommon = halfMatch[4]\n    // Send both pairs off for separate processing.\n    const diffsA = doDiff(text1A, text2A, opts)\n    const diffsB = doDiff(text1B, text2B, opts)\n    // Merge the results.\n    return diffsA.concat([[DIFF_EQUAL, midCommon]], diffsB)\n  }\n\n  if (opts.checkLines && text1.length > 100 && text2.length > 100) {\n    return doLineModeDiff(text1, text2, opts)\n  }\n\n  return bisect(text1, text2, opts.deadline)\n}\n","import {isHighSurrogate, isLowSurrogate} from '../utils/surrogatePairs.js'\nimport {cleanupMerge} from './cleanup.js'\nimport {getCommonPrefix} from './commonPrefix.js'\nimport {getCommonSuffix} from './commonSuffix.js'\nimport {computeDiff} from './compute.js'\n\n/**\n * Diff type for deleted text.\n *\n * @public\n */\nexport const DIFF_DELETE = -1\n\n/**\n * Diff type for inserted text.\n *\n * @public\n */\nexport const DIFF_INSERT = 1\n\n/**\n * Diff type for text that is equal.\n *\n * @public\n */\nexport const DIFF_EQUAL = 0\n\n/**\n * The three different types of changes possible in a diff:\n * - `DIFF_DELETE`: a deletion of text\n * - `DIFF_INSERT`: an insertion of text\n * - `DIFF_EQUAL` : an equal text\n *\n * @public\n */\nexport type DiffType = typeof DIFF_DELETE | typeof DIFF_INSERT | typeof DIFF_EQUAL\n\n/**\n * The data structure representing a diff is an array of tuples:\n * [[DIFF_DELETE, 'Hello'], [DIFF_INSERT, 'Goodbye'], [DIFF_EQUAL, ' world.']]\n * which means: delete 'Hello', add 'Goodbye' and keep ' world.'\n *\n * @public\n */\nexport type Diff = [DiffType, string]\n\n/**\n * Options for generating a diff.\n *\n * @public\n */\nexport interface DiffOptions {\n  checkLines: boolean\n  timeout: number\n}\n\n/**\n * @internal\n */\nexport interface InternalDiffOptions {\n  checkLines: boolean\n\n  /**\n   * Time when the diff should be complete by.\n   */\n  deadline: number\n}\n\n/**\n * Find the differences between two texts.  Simplifies the problem by stripping\n * any common prefix or suffix off the texts before diffing.\n *\n * @param textA - Old string to be diffed.\n * @param textA - New string to be diffed.\n * @returns Array of diff tuples.\n * @public\n */\nexport function diff(\n  textA: null | string,\n  textB: null | string,\n  opts?: Partial<DiffOptions>,\n): Diff[] {\n  // Check for null inputs.\n  if (textA === null || textB === null) {\n    throw new Error('Null input. (diff)')\n  }\n\n  const diffs = doDiff(textA, textB, createInternalOpts(opts || {}))\n  adjustDiffForSurrogatePairs(diffs)\n  return diffs\n}\n\n/**\n * Find the differences between two texts.  Simplifies the problem by stripping\n * any common prefix or suffix off the texts before diffing.\n *\n * @param textA - Old string to be diffed.\n * @param textB - New string to be diffed.\n * @returns Array of diff tuples.\n * @internal\n */\nexport function doDiff(textA: string, textB: string, options: InternalDiffOptions): Diff[] {\n  // Don't reassign fn params\n  let text1 = textA\n  let text2 = textB\n\n  // Check for equality (speedup).\n  if (text1 === text2) {\n    return text1 ? [[DIFF_EQUAL, text1]] : []\n  }\n\n  // Trim off common prefix (speedup).\n  let commonlength = getCommonPrefix(text1, text2)\n  const commonprefix = text1.substring(0, commonlength)\n  text1 = text1.substring(commonlength)\n  text2 = text2.substring(commonlength)\n\n  // Trim off common suffix (speedup).\n  commonlength = getCommonSuffix(text1, text2)\n  const commonsuffix = text1.substring(text1.length - commonlength)\n  text1 = text1.substring(0, text1.length - commonlength)\n  text2 = text2.substring(0, text2.length - commonlength)\n\n  // Compute the diff on the middle block.\n  let diffs = computeDiff(text1, text2, options)\n\n  // Restore the prefix and suffix.\n  if (commonprefix) {\n    diffs.unshift([DIFF_EQUAL, commonprefix])\n  }\n  if (commonsuffix) {\n    diffs.push([DIFF_EQUAL, commonsuffix])\n  }\n  diffs = cleanupMerge(diffs)\n  return diffs\n}\n\nfunction createDeadLine(timeout: undefined | number): number {\n  let t = 1\n  if (typeof timeout !== 'undefined') {\n    t = timeout <= 0 ? Number.MAX_VALUE : timeout\n  }\n  return Date.now() + t * 1000\n}\n\nfunction createInternalOpts(opts: Partial<DiffOptions>): InternalDiffOptions {\n  return {\n    checkLines: true,\n    deadline: createDeadLine(opts.timeout || 1.0),\n    ...opts,\n  }\n}\n\nfunction combineChar(data: string, char: string, dir: 1 | -1) {\n  return dir === 1 ? data + char : char + data\n}\n\n/**\n * Splits out a character in a given direction.\n */\nfunction splitChar(data: string, dir: 1 | -1): [string, string] {\n  return dir === 1\n    ? [data.substring(0, data.length - 1), data[data.length - 1]]\n    : [data.substring(1), data[0]]\n}\n\n/**\n * Checks if two entries of the diff has the same character in the same \"direction\".\n */\nfunction hasSharedChar(diffs: Diff[], i: number, j: number, dir: 1 | -1): boolean {\n  return dir === 1\n    ? diffs[i][1][diffs[i][1].length - 1] === diffs[j][1][diffs[j][1].length - 1]\n    : diffs[i][1][0] === diffs[j][1][0]\n}\n\n/**\n * Takes in a position of an EQUAL diff-type and attempts to \"deisolate\" the character for a given direction.\n * By this we mean that we attempt to either \"shift\" it to the later diffs, or bring another character next into this one.\n *\n * It's easier to understand with an example:\n *   [INSERT a, DELETE b, EQUAL cde, INSERT f, DELETE g]\n * shifting this forward will produce\n *   [INSERT a, DELETE b, EQUAL cd, INSERT ef, DELETE eg]\n *\n * This behavior is useful when `e` is actually a high surrogate character.\n *\n * Shifting it backwards produces\n *   [INSERT ac, DELETE bc, EQUAL cde, INSERT f, DELETE g]\n * which is useful when `c` is a low surrogate character.\n *\n * Note that these diffs are 100% semantically equal.\n *\n * If there's not a matching INSERT/DELETE then it's forced to insert an additional entry:\n *   [EQUAL abc, INSERT d, EQUAL e]\n * shifted forward becomes:\n *   [EQUAL ab, INSERT cd, DELETE c, EQUAL e]\n *\n * If the INSERT and DELETE ends with the same character it will instead deisolate it by\n * bring that charcter into _this_ equal:\n *   [EQUAL abc, INSERT de, DELETE df]\n * shifted forward actually becomes\n *   [EQUAL abcd, INSERT e, DELETE f]\n *\n * The original diff here is typically never produced by the diff algorithm directly,\n * but they occur when we isolate characters in other places.\n */\nfunction deisolateChar(diffs: Diff[], i: number, dir: 1 | -1) {\n  const inv = dir === 1 ? -1 : 1\n  let insertIdx: null | number = null\n  let deleteIdx: null | number = null\n\n  let j = i + dir\n  for (; j >= 0 && j < diffs.length && (insertIdx === null || deleteIdx === null); j += dir) {\n    const [op, text] = diffs[j]\n    if (text.length === 0) {\n      continue\n    }\n\n    if (op === DIFF_INSERT) {\n      if (insertIdx === null) {\n        insertIdx = j\n      }\n      continue\n    } else if (op === DIFF_DELETE) {\n      if (deleteIdx === null) {\n        deleteIdx = j\n      }\n      continue\n    } else if (op === DIFF_EQUAL) {\n      if (insertIdx === null && deleteIdx === null) {\n        // This means that there was two consecutive EQUAL. Kinda weird, but easy to handle.\n        const [rest, char] = splitChar(diffs[i][1], dir)\n        diffs[i][1] = rest\n        diffs[j][1] = combineChar(diffs[j][1], char, inv)\n        return\n      }\n      break\n    }\n  }\n\n  if (insertIdx !== null && deleteIdx !== null && hasSharedChar(diffs, insertIdx, deleteIdx, dir)) {\n    // Special case.\n    const [insertText, insertChar] = splitChar(diffs[insertIdx][1], inv)\n    const [deleteText] = splitChar(diffs[deleteIdx][1], inv)\n    diffs[insertIdx][1] = insertText\n    diffs[deleteIdx][1] = deleteText\n    diffs[i][1] = combineChar(diffs[i][1], insertChar, dir)\n    return\n  }\n\n  const [text, char] = splitChar(diffs[i][1], dir)\n  diffs[i][1] = text\n\n  if (insertIdx === null) {\n    diffs.splice(j, 0, [DIFF_INSERT, char])\n\n    // We need to adjust deleteIdx here since it's been shifted\n    if (deleteIdx !== null && deleteIdx >= j) deleteIdx++\n  } else {\n    diffs[insertIdx][1] = combineChar(diffs[insertIdx][1], char, inv)\n  }\n\n  if (deleteIdx === null) {\n    diffs.splice(j, 0, [DIFF_DELETE, char])\n  } else {\n    diffs[deleteIdx][1] = combineChar(diffs[deleteIdx][1], char, inv)\n  }\n}\n\nfunction adjustDiffForSurrogatePairs(diffs: Diff[]) {\n  // Go over each pair of diffs and see if there was a split at a surrogate pair\n  for (let i = 0; i < diffs.length; i++) {\n    const [diffType, diffText] = diffs[i]\n\n    if (diffText.length === 0) continue\n\n    const firstChar = diffText[0]\n    const lastChar = diffText[diffText.length - 1]\n\n    if (isHighSurrogate(lastChar) && diffType === DIFF_EQUAL) {\n      deisolateChar(diffs, i, 1)\n    }\n\n    if (isLowSurrogate(firstChar) && diffType === DIFF_EQUAL) {\n      deisolateChar(diffs, i, -1)\n    }\n  }\n\n  for (let i = 0; i < diffs.length; i++) {\n    // Remove any empty diffs\n    if (diffs[i][1].length === 0) {\n      diffs.splice(i, 1)\n    }\n  }\n}\n","import {cloneDiff} from './clone.js'\nimport {getCommonOverlap} from './commonOverlap.js'\nimport {getCommonPrefix} from './commonPrefix.js'\nimport {getCommonSuffix} from './commonSuffix.js'\nimport {type Diff, DIFF_DELETE, DIFF_EQUAL, DIFF_INSERT} from './diff.js'\n\n/**\n * Reduce the number of edits by eliminating semantically trivial equalities.\n *\n * @param rawDiffs - Array of diff tuples.\n * @returns Array of diff tuples.\n * @public\n */\nexport function cleanupSemantic(rawDiffs: Diff[]): Diff[] {\n  let diffs: Diff[] = rawDiffs.map((diff) => cloneDiff(diff))\n\n  let hasChanges = false\n  const equalities: number[] = [] // Stack of indices where equalities are found.\n  let equalitiesLength = 0 // Keeping our own length var is faster in JS.\n  /** @type {?string} */\n  let lastEquality = null\n  // Always equal to diffs[equalities[equalitiesLength - 1]][1]\n  let pointer = 0 // Index of current position.\n  // Number of characters that changed prior to the equality.\n  let lengthInsertions1 = 0\n  let lengthDeletions1 = 0\n  // Number of characters that changed after the equality.\n  let lengthInsertions2 = 0\n  let lengthDeletions2 = 0\n  while (pointer < diffs.length) {\n    if (diffs[pointer][0] === DIFF_EQUAL) {\n      // Equality found.\n      equalities[equalitiesLength++] = pointer\n      lengthInsertions1 = lengthInsertions2\n      lengthDeletions1 = lengthDeletions2\n      lengthInsertions2 = 0\n      lengthDeletions2 = 0\n      lastEquality = diffs[pointer][1]\n    } else {\n      // An insertion or deletion.\n      if (diffs[pointer][0] === DIFF_INSERT) {\n        lengthInsertions2 += diffs[pointer][1].length\n      } else {\n        lengthDeletions2 += diffs[pointer][1].length\n      }\n      // Eliminate an equality that is smaller or equal to the edits on both\n      // sides of it.\n      if (\n        lastEquality &&\n        lastEquality.length <= Math.max(lengthInsertions1, lengthDeletions1) &&\n        lastEquality.length <= Math.max(lengthInsertions2, lengthDeletions2)\n      ) {\n        // Duplicate record.\n        diffs.splice(equalities[equalitiesLength - 1], 0, [DIFF_DELETE, lastEquality])\n        // Change second copy to insert.\n        diffs[equalities[equalitiesLength - 1] + 1][0] = DIFF_INSERT\n        // Throw away the equality we just deleted.\n        equalitiesLength--\n        // Throw away the previous equality (it needs to be reevaluated).\n        equalitiesLength--\n        pointer = equalitiesLength > 0 ? equalities[equalitiesLength - 1] : -1\n        lengthInsertions1 = 0 // Reset the counters.\n        lengthDeletions1 = 0\n        lengthInsertions2 = 0\n        lengthDeletions2 = 0\n        lastEquality = null\n        hasChanges = true\n      }\n    }\n    pointer++\n  }\n\n  // Normalize the diff.\n  if (hasChanges) {\n    diffs = cleanupMerge(diffs)\n  }\n  diffs = cleanupSemanticLossless(diffs)\n\n  // Find any overlaps between deletions and insertions.\n  // e.g: <del>abczzz</del><ins>zzzdef</ins>\n  //   -> <del>abc</del>zzz<ins>def</ins>\n  // e.g: <del>zzzabc</del><ins>defzzz</ins>\n  //   -> <ins>def</ins>zzz<del>abc</del>\n  // Only extract an overlap if it is as big as the edit ahead or behind it.\n  pointer = 1\n  while (pointer < diffs.length) {\n    if (diffs[pointer - 1][0] === DIFF_DELETE && diffs[pointer][0] === DIFF_INSERT) {\n      const deletion = diffs[pointer - 1][1]\n      const insertion = diffs[pointer][1]\n      const overlapLength1 = getCommonOverlap(deletion, insertion)\n      const overlapLength2 = getCommonOverlap(insertion, deletion)\n      if (overlapLength1 >= overlapLength2) {\n        if (overlapLength1 >= deletion.length / 2 || overlapLength1 >= insertion.length / 2) {\n          // Overlap found.  Insert an equality and trim the surrounding edits.\n          diffs.splice(pointer, 0, [DIFF_EQUAL, insertion.substring(0, overlapLength1)])\n          diffs[pointer - 1][1] = deletion.substring(0, deletion.length - overlapLength1)\n          diffs[pointer + 1][1] = insertion.substring(overlapLength1)\n          pointer++\n        }\n      } else if (overlapLength2 >= deletion.length / 2 || overlapLength2 >= insertion.length / 2) {\n        // Reverse overlap found.\n        // Insert an equality and swap and trim the surrounding edits.\n        diffs.splice(pointer, 0, [DIFF_EQUAL, deletion.substring(0, overlapLength2)])\n        diffs[pointer - 1][0] = DIFF_INSERT\n        diffs[pointer - 1][1] = insertion.substring(0, insertion.length - overlapLength2)\n        diffs[pointer + 1][0] = DIFF_DELETE\n        diffs[pointer + 1][1] = deletion.substring(overlapLength2)\n        pointer++\n      }\n      pointer++\n    }\n    pointer++\n  }\n  return diffs\n}\n\n// Define some regex patterns for matching boundaries.\nconst nonAlphaNumericRegex = /[^a-zA-Z0-9]/\nconst whitespaceRegex = /\\s/\nconst linebreakRegex = /[\\r\\n]/\nconst blanklineEndRegex = /\\n\\r?\\n$/\nconst blanklineStartRegex = /^\\r?\\n\\r?\\n/\n\n/**\n * Look for single edits surrounded on both sides by equalities\n * which can be shifted sideways to align the edit to a word boundary.\n * e.g: The c<ins>at c</ins>ame. -> The <ins>cat </ins>came.\n *\n * @param rawDiffs - Array of diff tuples.\n * @returns Array of diff tuples.\n * @public\n */\nexport function cleanupSemanticLossless(rawDiffs: Diff[]): Diff[] {\n  const diffs = rawDiffs.map((diff) => cloneDiff(diff))\n\n  /**\n   * Given two strings, compute a score representing whether the internal\n   * boundary falls on logical boundaries.\n   * Scores range from 6 (best) to 0 (worst).\n   * Closure, but does not reference any external variables.\n   *\n   * @param one - First string.\n   * @param two - Second string.\n   * @returns The score.\n   * @internal\n   */\n  function diffCleanupSemanticScore(one: string, two: string) {\n    if (!one || !two) {\n      // Edges are the best.\n      return 6\n    }\n\n    // Each port of this function behaves slightly differently due to\n    // subtle differences in each language's definition of things like\n    // 'whitespace'.  Since this function's purpose is largely cosmetic,\n    // the choice has been made to use each language's native features\n    // rather than force total conformity.\n    const char1 = one.charAt(one.length - 1)\n    const char2 = two.charAt(0)\n    const nonAlphaNumeric1 = char1.match(nonAlphaNumericRegex)\n    const nonAlphaNumeric2 = char2.match(nonAlphaNumericRegex)\n    const whitespace1 = nonAlphaNumeric1 && char1.match(whitespaceRegex)\n    const whitespace2 = nonAlphaNumeric2 && char2.match(whitespaceRegex)\n    const lineBreak1 = whitespace1 && char1.match(linebreakRegex)\n    const lineBreak2 = whitespace2 && char2.match(linebreakRegex)\n    const blankLine1 = lineBreak1 && one.match(blanklineEndRegex)\n    const blankLine2 = lineBreak2 && two.match(blanklineStartRegex)\n\n    if (blankLine1 || blankLine2) {\n      // Five points for blank lines.\n      return 5\n    } else if (lineBreak1 || lineBreak2) {\n      // Four points for line breaks.\n      return 4\n    } else if (nonAlphaNumeric1 && !whitespace1 && whitespace2) {\n      // Three points for end of sentences.\n      return 3\n    } else if (whitespace1 || whitespace2) {\n      // Two points for whitespace.\n      return 2\n    } else if (nonAlphaNumeric1 || nonAlphaNumeric2) {\n      // One point for non-alphanumeric.\n      return 1\n    }\n    return 0\n  }\n\n  let pointer = 1\n  // Intentionally ignore the first and last element (don't need checking).\n  while (pointer < diffs.length - 1) {\n    if (diffs[pointer - 1][0] === DIFF_EQUAL && diffs[pointer + 1][0] === DIFF_EQUAL) {\n      // This is a single edit surrounded by equalities.\n      let equality1 = diffs[pointer - 1][1]\n      let edit = diffs[pointer][1]\n      let equality2 = diffs[pointer + 1][1]\n\n      // First, shift the edit as far left as possible.\n      const commonOffset = getCommonSuffix(equality1, edit)\n      if (commonOffset) {\n        const commonString = edit.substring(edit.length - commonOffset)\n        equality1 = equality1.substring(0, equality1.length - commonOffset)\n        edit = commonString + edit.substring(0, edit.length - commonOffset)\n        equality2 = commonString + equality2\n      }\n\n      // Second, step character by character right, looking for the best fit.\n      let bestEquality1 = equality1\n      let bestEdit = edit\n      let bestEquality2 = equality2\n      let bestScore =\n        diffCleanupSemanticScore(equality1, edit) + diffCleanupSemanticScore(edit, equality2)\n      while (edit.charAt(0) === equality2.charAt(0)) {\n        equality1 += edit.charAt(0)\n        edit = edit.substring(1) + equality2.charAt(0)\n        equality2 = equality2.substring(1)\n        const score =\n          diffCleanupSemanticScore(equality1, edit) + diffCleanupSemanticScore(edit, equality2)\n        // The >= encourages trailing rather than leading whitespace on edits.\n        if (score >= bestScore) {\n          bestScore = score\n          bestEquality1 = equality1\n          bestEdit = edit\n          bestEquality2 = equality2\n        }\n      }\n\n      if (diffs[pointer - 1][1] !== bestEquality1) {\n        // We have an improvement, save it back to the diff.\n        if (bestEquality1) {\n          diffs[pointer - 1][1] = bestEquality1\n        } else {\n          diffs.splice(pointer - 1, 1)\n          pointer--\n        }\n        diffs[pointer][1] = bestEdit\n        if (bestEquality2) {\n          diffs[pointer + 1][1] = bestEquality2\n        } else {\n          diffs.splice(pointer + 1, 1)\n          pointer--\n        }\n      }\n    }\n    pointer++\n  }\n\n  return diffs\n}\n\n/**\n * Reorder and merge like edit sections.  Merge equalities.\n * Any edit section can move as long as it doesn't cross an equality.\n *\n * @param rawDiffs - Array of diff tuples.\n * @returns Array of diff tuples.\n * @public\n */\nexport function cleanupMerge(rawDiffs: Diff[]): Diff[] {\n  let diffs = rawDiffs.map((diff) => cloneDiff(diff))\n\n  // Add a dummy entry at the end.\n  diffs.push([DIFF_EQUAL, ''])\n  let pointer = 0\n  let countDelete = 0\n  let countInsert = 0\n  let textDelete = ''\n  let textInsert = ''\n  let commonlength\n  while (pointer < diffs.length) {\n    switch (diffs[pointer][0]) {\n      case DIFF_INSERT:\n        countInsert++\n        textInsert += diffs[pointer][1]\n        pointer++\n        break\n      case DIFF_DELETE:\n        countDelete++\n        textDelete += diffs[pointer][1]\n        pointer++\n        break\n      case DIFF_EQUAL:\n        // Upon reaching an equality, check for prior redundancies.\n        if (countDelete + countInsert > 1) {\n          if (countDelete !== 0 && countInsert !== 0) {\n            // Factor out any common prefixies.\n            commonlength = getCommonPrefix(textInsert, textDelete)\n            if (commonlength !== 0) {\n              if (\n                pointer - countDelete - countInsert > 0 &&\n                diffs[pointer - countDelete - countInsert - 1][0] === DIFF_EQUAL\n              ) {\n                diffs[pointer - countDelete - countInsert - 1][1] += textInsert.substring(\n                  0,\n                  commonlength,\n                )\n              } else {\n                diffs.splice(0, 0, [DIFF_EQUAL, textInsert.substring(0, commonlength)])\n                pointer++\n              }\n              textInsert = textInsert.substring(commonlength)\n              textDelete = textDelete.substring(commonlength)\n            }\n            // Factor out any common suffixies.\n            commonlength = getCommonSuffix(textInsert, textDelete)\n            if (commonlength !== 0) {\n              diffs[pointer][1] =\n                textInsert.substring(textInsert.length - commonlength) + diffs[pointer][1]\n              textInsert = textInsert.substring(0, textInsert.length - commonlength)\n              textDelete = textDelete.substring(0, textDelete.length - commonlength)\n            }\n          }\n          // Delete the offending records and add the merged ones.\n          pointer -= countDelete + countInsert\n          diffs.splice(pointer, countDelete + countInsert)\n          if (textDelete.length) {\n            diffs.splice(pointer, 0, [DIFF_DELETE, textDelete])\n            pointer++\n          }\n          if (textInsert.length) {\n            diffs.splice(pointer, 0, [DIFF_INSERT, textInsert])\n            pointer++\n          }\n          pointer++\n        } else if (pointer !== 0 && diffs[pointer - 1][0] === DIFF_EQUAL) {\n          // Merge this equality with the previous one.\n          diffs[pointer - 1][1] += diffs[pointer][1]\n          diffs.splice(pointer, 1)\n        } else {\n          pointer++\n        }\n        countInsert = 0\n        countDelete = 0\n        textDelete = ''\n        textInsert = ''\n        break\n      default:\n        throw new Error('Unknown diff operation')\n    }\n  }\n  if (diffs[diffs.length - 1][1] === '') {\n    diffs.pop() // Remove the dummy entry at the end.\n  }\n\n  // Second pass: look for single edits surrounded on both sides by equalities\n  // which can be shifted sideways to eliminate an equality.\n  // e.g: A<ins>BA</ins>C -> <ins>AB</ins>AC\n  let hasChanges = false\n  pointer = 1\n  // Intentionally ignore the first and last element (don't need checking).\n  while (pointer < diffs.length - 1) {\n    if (diffs[pointer - 1][0] === DIFF_EQUAL && diffs[pointer + 1][0] === DIFF_EQUAL) {\n      // This is a single edit surrounded by equalities.\n      if (\n        diffs[pointer][1].substring(diffs[pointer][1].length - diffs[pointer - 1][1].length) ===\n        diffs[pointer - 1][1]\n      ) {\n        // Shift the edit over the previous equality.\n        diffs[pointer][1] =\n          diffs[pointer - 1][1] +\n          diffs[pointer][1].substring(0, diffs[pointer][1].length - diffs[pointer - 1][1].length)\n        diffs[pointer + 1][1] = diffs[pointer - 1][1] + diffs[pointer + 1][1]\n        diffs.splice(pointer - 1, 1)\n        hasChanges = true\n      } else if (\n        diffs[pointer][1].substring(0, diffs[pointer + 1][1].length) === diffs[pointer + 1][1]\n      ) {\n        // Shift the edit over the next equality.\n        diffs[pointer - 1][1] += diffs[pointer + 1][1]\n        diffs[pointer][1] =\n          diffs[pointer][1].substring(diffs[pointer + 1][1].length) + diffs[pointer + 1][1]\n        diffs.splice(pointer + 1, 1)\n        hasChanges = true\n      }\n    }\n    pointer++\n  }\n  // If shifts were made, the diff needs reordering and another shift sweep.\n  if (hasChanges) {\n    diffs = cleanupMerge(diffs)\n  }\n\n  return diffs\n}\n\nfunction trueCount(...args: boolean[]) {\n  return args.reduce((n, bool) => n + (bool ? 1 : 0), 0)\n}\n\n/**\n * Reduce the number of edits by eliminating operationally trivial equalities.\n *\n * @param rawDiffs - Array of diff tuples.\n * @param editCost - Cost of an empty edit operation in terms of edit characters.\n * @returns Array of diff tuples.\n * @public\n */\nexport function cleanupEfficiency(rawDiffs: Diff[], editCost: number = 4): Diff[] {\n  let diffs = rawDiffs.map((diff) => cloneDiff(diff))\n  let hasChanges = false\n  const equalities: number[] = [] // Stack of indices where equalities are found.\n  let equalitiesLength = 0 // Keeping our own length var is faster in JS.\n  let lastEquality: string | null = null\n  // Always equal to diffs[equalities[equalitiesLength - 1]][1]\n  let pointer = 0 // Index of current position.\n  // Is there an insertion operation before the last equality.\n  let preIns = false\n  // Is there a deletion operation before the last equality.\n  let preDel = false\n  // Is there an insertion operation after the last equality.\n  let postIns = false\n  // Is there a deletion operation after the last equality.\n  let postDel = false\n  while (pointer < diffs.length) {\n    if (diffs[pointer][0] === DIFF_EQUAL) {\n      // Equality found.\n      if (diffs[pointer][1].length < editCost && (postIns || postDel)) {\n        // Candidate found.\n        equalities[equalitiesLength++] = pointer\n        preIns = postIns\n        preDel = postDel\n        lastEquality = diffs[pointer][1]\n      } else {\n        // Not a candidate, and can never become one.\n        equalitiesLength = 0\n        lastEquality = null\n      }\n      postIns = false\n      postDel = false\n    } else {\n      // An insertion or deletion.\n      if (diffs[pointer][0] === DIFF_DELETE) {\n        postDel = true\n      } else {\n        postIns = true\n      }\n      /*\n       * Five types to be split:\n       * <ins>A</ins><del>B</del>XY<ins>C</ins><del>D</del>\n       * <ins>A</ins>X<ins>C</ins><del>D</del>\n       * <ins>A</ins><del>B</del>X<ins>C</ins>\n       * <ins>A</del>X<ins>C</ins><del>D</del>\n       * <ins>A</ins><del>B</del>X<del>C</del>\n       */\n      if (\n        lastEquality &&\n        ((preIns && preDel && postIns && postDel) ||\n          (lastEquality.length < editCost / 2 && trueCount(preIns, preDel, postIns, postDel) === 3))\n      ) {\n        // Duplicate record.\n        diffs.splice(equalities[equalitiesLength - 1], 0, [DIFF_DELETE, lastEquality])\n        // Change second copy to insert.\n        diffs[equalities[equalitiesLength - 1] + 1][0] = DIFF_INSERT\n        equalitiesLength-- // Throw away the equality we just deleted;\n        lastEquality = null\n        if (preIns && preDel) {\n          // No hasChanges made which could affect previous entry, keep going.\n          postIns = true\n          postDel = true\n          equalitiesLength = 0\n        } else {\n          equalitiesLength-- // Throw away the previous equality.\n          pointer = equalitiesLength > 0 ? equalities[equalitiesLength - 1] : -1\n          postIns = false\n          postDel = false\n        }\n        hasChanges = true\n      }\n    }\n    pointer++\n  }\n\n  if (hasChanges) {\n    diffs = cleanupMerge(diffs)\n  }\n\n  return diffs\n}\n","interface BitapOptions {\n  threshold: number\n  distance: number\n}\n\ninterface Alphabet {\n  [char: string]: number\n}\n\nconst DEFAULT_OPTIONS: BitapOptions = {\n  /**\n   * At what point is no match declared (0.0 = perfection, 1.0 = very loose).\n   */\n  threshold: 0.5,\n\n  /**\n   * How far to search for a match (0 = exact location, 1000+ = broad match).\n   * A match this many characters away from the expected location will add\n   * 1.0 to the score (0.0 is a perfect match).\n   */\n  distance: 1000,\n}\n\nfunction applyDefaults(options: Partial<BitapOptions>): BitapOptions {\n  return {...DEFAULT_OPTIONS, ...options}\n}\n\n// The number of bits in an int.\nconst MAX_BITS = 32\n\n/**\n * Locate the best instance of 'pattern' in 'text' near 'loc' using the\n * Bitap algorithm.\n *\n * @param text - The text to search.\n * @param pattern - The pattern to search for.\n * @param loc - The location to search around.\n * @param options - Options {@link BitapOptions}\n * @returns Best match index or -1.\n * @internal\n */\nexport function bitap(\n  text: string,\n  pattern: string,\n  loc: number,\n  opts: Partial<BitapOptions> = {},\n): number {\n  if (pattern.length > MAX_BITS) {\n    throw new Error('Pattern too long for this browser.')\n  }\n\n  const options = applyDefaults(opts)\n\n  // Initialise the alphabet.\n  const s = getAlphabetFromPattern(pattern)\n\n  /**\n   * Compute and return the score for a match with e errors and x location.\n   * Accesses loc and pattern through being a closure.\n   *\n   * @param e - Number of errors in match.\n   * @param x - Location of match.\n   * @returns Overall - score for match (0.0 = good, 1.0 = bad).\n   * @internal\n   */\n  function getBitapScore(e: number, x: number) {\n    const accuracy = e / pattern.length\n    const proximity = Math.abs(loc - x)\n    if (!options.distance) {\n      // Dodge divide by zero error.\n      return proximity ? 1.0 : accuracy\n    }\n    return accuracy + proximity / options.distance\n  }\n\n  // Highest score beyond which we give up.\n  let scoreThreshold = options.threshold\n  // Is there a nearby exact match? (speedup)\n  let bestLoc = text.indexOf(pattern, loc)\n  if (bestLoc !== -1) {\n    scoreThreshold = Math.min(getBitapScore(0, bestLoc), scoreThreshold)\n    // What about in the other direction? (speedup)\n    bestLoc = text.lastIndexOf(pattern, loc + pattern.length)\n    if (bestLoc !== -1) {\n      scoreThreshold = Math.min(getBitapScore(0, bestLoc), scoreThreshold)\n    }\n  }\n\n  // Initialise the bit arrays.\n  const matchmask = 1 << (pattern.length - 1)\n  bestLoc = -1\n\n  let binMin\n  let binMid\n  let binMax = pattern.length + text.length\n  let lastRd: number[] = []\n  for (let d = 0; d < pattern.length; d++) {\n    // Scan for the best match; each iteration allows for one more error.\n    // Run a binary search to determine how far from 'loc' we can stray at this\n    // error level.\n    binMin = 0\n    binMid = binMax\n    while (binMin < binMid) {\n      if (getBitapScore(d, loc + binMid) <= scoreThreshold) {\n        binMin = binMid\n      } else {\n        binMax = binMid\n      }\n      binMid = Math.floor((binMax - binMin) / 2 + binMin)\n    }\n    // Use the result from this iteration as the maximum for the next.\n    binMax = binMid\n    let start = Math.max(1, loc - binMid + 1)\n    const finish = Math.min(loc + binMid, text.length) + pattern.length\n\n    const rd: number[] = new Array(finish + 2)\n    rd[finish + 1] = (1 << d) - 1\n    for (let j = finish; j >= start; j--) {\n      // The alphabet (s) is a sparse hash, so the following line generates\n      // warnings.\n      const charMatch = s[text.charAt(j - 1)]\n      if (d === 0) {\n        // First pass: exact match.\n        rd[j] = ((rd[j + 1] << 1) | 1) & charMatch\n      } else {\n        // Subsequent passes: fuzzy match.\n        rd[j] =\n          (((rd[j + 1] << 1) | 1) & charMatch) |\n          (((lastRd[j + 1] | lastRd[j]) << 1) | 1) |\n          lastRd[j + 1]\n      }\n      if (rd[j] & matchmask) {\n        const score = getBitapScore(d, j - 1)\n        // This match will almost certainly be better than any existing match.\n        // But check anyway.\n        if (score <= scoreThreshold) {\n          // Told you so.\n          scoreThreshold = score\n          bestLoc = j - 1\n          if (bestLoc > loc) {\n            // When passing loc, don't exceed our current distance from loc.\n            start = Math.max(1, 2 * loc - bestLoc)\n          } else {\n            // Already passed loc, downhill from here on in.\n            break\n          }\n        }\n      }\n    }\n    // No hope for a (better) match at greater error levels.\n    if (getBitapScore(d + 1, loc) > scoreThreshold) {\n      break\n    }\n    lastRd = rd\n  }\n  return bestLoc\n}\n\n/**\n * Initialise the alphabet for the Bitap algorithm.\n *\n * @param pattern - The text to encode.\n * @returns Hash of character locations.\n * @internal\n */\nfunction getAlphabetFromPattern(pattern: string): Alphabet {\n  const s: Alphabet = {}\n  for (let i = 0; i < pattern.length; i++) {\n    s[pattern.charAt(i)] = 0\n  }\n  for (let i = 0; i < pattern.length; i++) {\n    s[pattern.charAt(i)] |= 1 << (pattern.length - i - 1)\n  }\n  return s\n}\n","import {bitap} from './bitap.js'\n\n/**\n * @public\n */\nexport interface MatchOptions {\n  /**\n   * At what point is no match declared (0.0 = perfection, 1.0 = very loose).\n   * The larger threshold is, the slower match() may take to compute\n   *\n   * Defaults to 0.5\n   */\n  threshold?: number\n\n  /**\n   * How far to search for a match (0 = exact location, 1000+ = broad match).\n   * A match this many characters away from the expected location will add\n   * 1.0 to the score (0.0 is a perfect match).\n   *\n   * The larger distance is, the slower match() may take to compute.\n   *\n   * Defaults to 1000.\n   */\n  distance?: number\n}\n\n/**\n * Locate the best instance of 'pattern' in 'text' near 'loc'.\n *\n * @param text - The text to search.\n * @param pattern - The pattern to search for.\n * @param searchLocation - The location to search around.\n * @param options - Options {@link MatchOptions}\n * @returns Best match index or -1.\n * @public\n */\nexport function match(\n  text: string,\n  pattern: string,\n  searchLocation: number,\n  options: MatchOptions = {},\n): number {\n  // Check for null inputs.\n  if (text === null || pattern === null || searchLocation === null) {\n    throw new Error('Null input. (match())')\n  }\n\n  const loc = Math.max(0, Math.min(searchLocation, text.length))\n  if (text === pattern) {\n    // Shortcut (potentially not guaranteed by the algorithm)\n    return 0\n  } else if (!text.length) {\n    // Nothing to match.\n    return -1\n  } else if (text.substring(loc, loc + pattern.length) === pattern) {\n    // Perfect match at the perfect spot!  (Includes case of null pattern)\n    return loc\n  }\n\n  // Do a fuzzy compare.\n  return bitap(text, pattern, loc, options)\n}\n","import {type Diff, DIFF_DELETE, DIFF_INSERT} from './diff.js'\n\n/**\n * Compute and return the source text (all equalities and deletions).\n *\n * @param diffs - Array of diff tuples.\n * @returns Source text.\n * @private\n */\nexport function diffText1(diffs: Diff[]): string {\n  const text: string[] = []\n  for (let x = 0; x < diffs.length; x++) {\n    if (diffs[x][0] !== DIFF_INSERT) {\n      text[x] = diffs[x][1]\n    }\n  }\n  return text.join('')\n}\n\n/**\n * Compute and return the destination text (all equalities and insertions).\n *\n * @param diffs - Array of diff tuples.\n * @returns Destination text.\n * @private\n */\nexport function diffText2(diffs: Diff[]): string {\n  const text: string[] = []\n  for (let x = 0; x < diffs.length; x++) {\n    if (diffs[x][0] !== DIFF_DELETE) {\n      text[x] = diffs[x][1]\n    }\n  }\n  return text.join('')\n}\n","import {type Diff, DIFF_DELETE, DIFF_EQUAL, DIFF_INSERT} from './diff.js'\n\n/**\n * Compute the Levenshtein distance; the number of inserted, deleted or\n * substituted characters.\n *\n * @param diffs - Array of diff tuples.\n * @returns Number of changes.\n * @internal\n */\nexport function levenshtein(diffs: Diff[]): number {\n  let leven = 0\n  let insertions = 0\n  let deletions = 0\n\n  for (let x = 0; x < diffs.length; x++) {\n    const op = diffs[x][0]\n    const data = diffs[x][1]\n    switch (op) {\n      case DIFF_INSERT:\n        insertions += data.length\n        break\n      case DIFF_DELETE:\n        deletions += data.length\n        break\n      case DIFF_EQUAL:\n        // A deletion and an insertion is one substitution.\n        leven += Math.max(insertions, deletions)\n        insertions = 0\n        deletions = 0\n        break\n      default:\n        throw new Error('Unknown diff operation.')\n    }\n  }\n  leven += Math.max(insertions, deletions)\n  return leven\n}\n","import {type Diff, DIFF_DELETE, DIFF_INSERT} from './diff.js'\n\n/**\n * loc is a location in textA, compute and return the equivalent location in\n * textB.\n * e.g. 'The cat' vs 'The big cat', 1->1, 5->8\n *\n * @param diffs - Array of diff tuples.\n * @param location - Location within textA.\n * @returns Location within textB.\n * @public\n */\nexport function xIndex(diffs: Diff[], location: number): number {\n  let chars1 = 0\n  let chars2 = 0\n  let lastChars1 = 0\n  let lastChars2 = 0\n  let x\n  for (x = 0; x < diffs.length; x++) {\n    if (diffs[x][0] !== DIFF_INSERT) {\n      // Equality or deletion.\n      chars1 += diffs[x][1].length\n    }\n    if (diffs[x][0] !== DIFF_DELETE) {\n      // Equality or insertion.\n      chars2 += diffs[x][1].length\n    }\n    if (chars1 > location) {\n      // Overshot the location.\n      break\n    }\n    lastChars1 = chars1\n    lastChars2 = chars2\n  }\n  // Was the location was deleted?\n  if (diffs.length !== x && diffs[x][0] === DIFF_DELETE) {\n    return lastChars2\n  }\n  // Add the remaining character length.\n  return lastChars2 + (location - lastChars1)\n}\n","import {cloneDiff} from '../diff/clone.js'\nimport {type Patch} from '../index.js'\n\n/**\n * Counts the number of bytes in a string.\n * Note that while this approach may seem heavy-handed, it is actually\n * significantly faster than both `new Blob([str]).size` and `TextEncoder`.\n *\n * @param str - String to count\n * @returns Number of bytes\n */\nexport function countUtf8Bytes(str: string): number {\n  let bytes = 0\n  for (let i = 0; i < str.length; i++) {\n    const codePoint = str.codePointAt(i)\n    if (typeof codePoint === 'undefined') {\n      throw new Error('Failed to get codepoint')\n    }\n    bytes += utf8len(codePoint)\n  }\n  return bytes\n}\n\n/**\n * Options for the index adjustment operations.\n *\n * @public\n */\nexport interface AdjustmentOptions {\n  /**\n   * When converting indices between UTF-8 and UCS-2, certain scenarios can occur\n   * where we go beyond the target offset. This can happen in particular with\n   * surrogate pairs/high codepoints, when the base string we are applying the\n   * patch to does not fully match the one that was used to generate the patch.\n   * Defaults to `false`.\n   */\n  allowExceedingIndices?: boolean\n}\n\n/**\n * Takes a `patches` array as produced by diff-match-patch and adjusts the\n * `start1` and `start2` properties so that they refer to UCS-2 index instead\n * of a UTF-8 index.\n *\n * @param patches - The patches to adjust\n * @param base - The base string to use for counting bytes\n * @param options - Options for the adjustment of indices\n * @returns A new array of patches with adjusted indicies\n * @beta\n */\nexport function adjustIndiciesToUcs2(\n  patches: Patch[],\n  base: string,\n  options: AdjustmentOptions = {},\n): Patch[] {\n  let byteOffset = 0\n  let idx = 0 // index into the input.\n\n  function advanceTo(target: number) {\n    for (; byteOffset < target; ) {\n      const codePoint = base.codePointAt(idx)\n      if (typeof codePoint === 'undefined') {\n        // Reached the end of the base string - the indicies won't be correct,\n        // but we also cannot advance any further to find a closer index.\n        return idx\n      }\n\n      byteOffset += utf8len(codePoint)\n\n      // This is encoded as a surrogate pair.\n      if (codePoint > 0xffff) {\n        idx += 2\n      } else {\n        idx += 1\n      }\n    }\n\n    if (!options.allowExceedingIndices && byteOffset !== target) {\n      throw new Error('Failed to determine byte offset')\n    }\n\n    return idx\n  }\n\n  const adjusted: Patch[] = []\n  for (const patch of patches) {\n    adjusted.push({\n      diffs: patch.diffs.map((diff) => cloneDiff(diff)),\n      start1: advanceTo(patch.start1),\n      start2: advanceTo(patch.start2),\n      utf8Start1: patch.utf8Start1,\n      utf8Start2: patch.utf8Start2,\n      length1: patch.length1,\n      length2: patch.length2,\n      utf8Length1: patch.utf8Length1,\n      utf8Length2: patch.utf8Length2,\n    })\n  }\n\n  return adjusted\n}\n\nfunction utf8len(codePoint: number): 1 | 2 | 3 | 4 {\n  // See table at https://en.wikipedia.org/wiki/UTF-8\n  if (codePoint <= 0x007f) return 1\n  if (codePoint <= 0x07ff) return 2\n  if (codePoint <= 0xffff) return 3\n  return 4\n}\n","// The number of bits in an int.\nexport const MAX_BITS = 32\n\nexport const DEFAULT_MARGIN = 4\n","import {DIFF_EQUAL} from '../diff/diff.js'\nimport {DEFAULT_MARGIN} from './constants.js'\nimport {type Patch} from './createPatchObject.js'\n\n/**\n * Add some padding on text start and end so that edges can match something.\n * Intended to be called only from within patch_apply.\n *\n * @param patches - Array of Patch objects.\n * @param margin - The margin length to add.\n * @returns The string, padded on each side.\n * @internal\n */\nexport function addPadding(patches: Patch[], margin: number = DEFAULT_MARGIN): string {\n  const paddingLength = margin\n  let nullPadding = ''\n  for (let x = 1; x <= paddingLength; x++) {\n    nullPadding += String.fromCharCode(x)\n  }\n\n  // Bump all the patches forward.\n  for (const p of patches) {\n    p.start1 += paddingLength\n    p.start2 += paddingLength\n    p.utf8Start1 += paddingLength\n    p.utf8Start2 += paddingLength\n  }\n\n  // Add some padding on start of first diff.\n  let patch = patches[0]\n  let diffs = patch.diffs\n  if (diffs.length === 0 || diffs[0][0] !== DIFF_EQUAL) {\n    // Add nullPadding equality.\n    diffs.unshift([DIFF_EQUAL, nullPadding])\n    patch.start1 -= paddingLength // Should be 0.\n    patch.start2 -= paddingLength // Should be 0.\n    patch.utf8Start1 -= paddingLength // Should be 0.\n    patch.utf8Start2 -= paddingLength // Should be 0.\n    patch.length1 += paddingLength\n    patch.length2 += paddingLength\n    patch.utf8Length1 += paddingLength\n    patch.utf8Length2 += paddingLength\n  } else if (paddingLength > diffs[0][1].length) {\n    // Grow first equality.\n    const firstDiffLength = diffs[0][1].length\n    const extraLength = paddingLength - firstDiffLength\n    diffs[0][1] = nullPadding.substring(firstDiffLength) + diffs[0][1]\n    patch.start1 -= extraLength\n    patch.start2 -= extraLength\n    patch.utf8Start1 -= extraLength\n    patch.utf8Start2 -= extraLength\n    patch.length1 += extraLength\n    patch.length2 += extraLength\n    patch.utf8Length1 += extraLength\n    patch.utf8Length2 += extraLength\n  }\n\n  // Add some padding on end of last diff.\n  patch = patches[patches.length - 1]\n  diffs = patch.diffs\n  if (diffs.length === 0 || diffs[diffs.length - 1][0] !== DIFF_EQUAL) {\n    // Add nullPadding equality.\n    diffs.push([DIFF_EQUAL, nullPadding])\n    patch.length1 += paddingLength\n    patch.length2 += paddingLength\n    patch.utf8Length1 += paddingLength\n    patch.utf8Length2 += paddingLength\n  } else if (paddingLength > diffs[diffs.length - 1][1].length) {\n    // Grow last equality.\n    const extraLength = paddingLength - diffs[diffs.length - 1][1].length\n    diffs[diffs.length - 1][1] += nullPadding.substring(0, extraLength)\n    patch.length1 += extraLength\n    patch.length2 += extraLength\n    patch.utf8Length1 += extraLength\n    patch.utf8Length2 += extraLength\n  }\n\n  return nullPadding\n}\n","import {type Diff} from '../diff/diff.js'\n\n/**\n * Object representing one patch operation.\n *\n * @public\n */\nexport interface Patch {\n  diffs: Diff[]\n\n  start1: number\n  start2: number\n  utf8Start1: number\n  utf8Start2: number\n\n  length1: number\n  length2: number\n  utf8Length1: number\n  utf8Length2: number\n}\n\n/**\n * Clones a patch object.\n *\n * @param patch - The patch to clone\n * @returns Cloned object\n * @private\n */\nexport function clone(patch: Patch): Patch {\n  return {...patch, diffs: patch.diffs.map((diff) => ({...diff}))}\n}\n\n/**\n * Performs a deep copy of a patch array.\n *\n * @param patches - Patches to clone\n * @returns Cloned array\n * @internal\n */\nexport function deepCopy(patches: Patch[]): Patch[] {\n  return patches.map(clone)\n}\n\n/**\n * Create a new, empty, patch object.\n *\n * @param start1 - The index to start the \"from\" at\n * @param start2 - The index to start the \"to\" at\n * @returns New patch object\n * @internal\n */\nexport function createPatchObject(start1: number, start2: number): Patch {\n  return {\n    diffs: [],\n\n    start1,\n    start2,\n    utf8Start1: start1,\n    utf8Start2: start2,\n\n    length1: 0,\n    length2: 0,\n    utf8Length1: 0,\n    utf8Length2: 0,\n  }\n}\n","import {DIFF_DELETE, DIFF_EQUAL, DIFF_INSERT} from '../diff/diff.js'\nimport {diffText1, diffText2} from '../diff/diffText.js'\nimport {countUtf8Bytes} from '../utils/utf8Indices.js'\nimport {DEFAULT_MARGIN, MAX_BITS} from './constants.js'\nimport {createPatchObject, type Patch} from './createPatchObject.js'\n\n/**\n * Look through the patches and break up any which are longer than the maximum\n * limit of the match algorithm.\n * Intended to be called only from within patch_apply.\n *\n * @param patches - Array of Patch objects.\n * @internal\n */\nexport function splitMax(patches: Patch[], margin: number = DEFAULT_MARGIN): void {\n  const patchSize = MAX_BITS\n  for (let x = 0; x < patches.length; x++) {\n    if (patches[x].length1 <= patchSize) {\n      continue\n    }\n    const bigpatch = patches[x]\n    // Remove the big old patch.\n    patches.splice(x--, 1)\n    let start1 = bigpatch.start1\n    let start2 = bigpatch.start2\n    let preContext = ''\n    while (bigpatch.diffs.length !== 0) {\n      // Create one of several smaller patches.\n      const patch = createPatchObject(start1 - preContext.length, start2 - preContext.length)\n      let empty = true\n\n      if (preContext !== '') {\n        const precontextByteCount = countUtf8Bytes(preContext)\n        patch.length1 = preContext.length\n        patch.utf8Length1 = precontextByteCount\n        patch.length2 = preContext.length\n        patch.utf8Length2 = precontextByteCount\n        patch.diffs.push([DIFF_EQUAL, preContext])\n      }\n      while (bigpatch.diffs.length !== 0 && patch.length1 < patchSize - margin) {\n        const diffType = bigpatch.diffs[0][0]\n        let diffText = bigpatch.diffs[0][1]\n        let diffTextByteCount = countUtf8Bytes(diffText)\n        if (diffType === DIFF_INSERT) {\n          // Insertions are harmless.\n          patch.length2 += diffText.length\n          patch.utf8Length2 += diffTextByteCount\n          start2 += diffText.length\n          const diff = bigpatch.diffs.shift()\n          if (diff) {\n            patch.diffs.push(diff)\n          }\n          empty = false\n        } else if (\n          diffType === DIFF_DELETE &&\n          patch.diffs.length === 1 &&\n          patch.diffs[0][0] === DIFF_EQUAL &&\n          diffText.length > 2 * patchSize\n        ) {\n          // This is a large deletion.  Let it pass in one chunk.\n          patch.length1 += diffText.length\n          patch.utf8Length1 += diffTextByteCount\n          start1 += diffText.length\n          empty = false\n          patch.diffs.push([diffType, diffText])\n          bigpatch.diffs.shift()\n        } else {\n          // Deletion or equality.  Only take as much as we can stomach.\n          diffText = diffText.substring(0, patchSize - patch.length1 - margin)\n          diffTextByteCount = countUtf8Bytes(diffText)\n          patch.length1 += diffText.length\n          patch.utf8Length1 += diffTextByteCount\n          start1 += diffText.length\n          if (diffType === DIFF_EQUAL) {\n            patch.length2 += diffText.length\n            patch.utf8Length2 += diffTextByteCount\n            start2 += diffText.length\n          } else {\n            empty = false\n          }\n          patch.diffs.push([diffType, diffText])\n          if (diffText === bigpatch.diffs[0][1]) {\n            bigpatch.diffs.shift()\n          } else {\n            bigpatch.diffs[0][1] = bigpatch.diffs[0][1].substring(diffText.length)\n          }\n        }\n      }\n      // Compute the head context for the next patch.\n      preContext = diffText2(patch.diffs)\n      preContext = preContext.substring(preContext.length - margin)\n      // Append the end context for this patch.\n      const postContext = diffText1(bigpatch.diffs).substring(0, margin)\n      const postContextByteCount = countUtf8Bytes(postContext)\n      if (postContext !== '') {\n        patch.length1 += postContext.length\n        patch.length2 += postContext.length\n        patch.utf8Length1 += postContextByteCount\n        patch.utf8Length2 += postContextByteCount\n        if (patch.diffs.length !== 0 && patch.diffs[patch.diffs.length - 1][0] === DIFF_EQUAL) {\n          patch.diffs[patch.diffs.length - 1][1] += postContext\n        } else {\n          patch.diffs.push([DIFF_EQUAL, postContext])\n        }\n      }\n      if (!empty) {\n        patches.splice(++x, 0, patch)\n      }\n    }\n  }\n}\n","/* eslint-disable max-depth */\n/* eslint-disable max-statements */\nimport {cleanupSemanticLossless} from '../diff/cleanup.js'\nimport {diff, DIFF_DELETE, DIFF_EQUAL, DIFF_INSERT} from '../diff/diff.js'\nimport {diffText1, diffText2} from '../diff/diffText.js'\nimport {levenshtein} from '../diff/levenshtein.js'\nimport {xIndex} from '../diff/xIndex.js'\nimport {match} from '../match/match.js'\nimport {adjustIndiciesToUcs2} from '../utils/utf8Indices.js'\nimport {addPadding} from './addPadding.js'\nimport {DEFAULT_MARGIN, MAX_BITS} from './constants.js'\nimport {type Patch} from './createPatchObject.js'\nimport {splitMax} from './splitMax.js'\n\n/**\n * Options for applying a patch.\n *\n * @public\n */\nexport interface ApplyPatchOptions {\n  /**\n   * Chunk size for context length\n   */\n  margin: number\n\n  /**\n   * When deleting a large block of text (over ~64 characters),\n   * how close do the contents have to be to match the expected contents.\n   * (0.0 = perfection, 1.0 = very loose).\n   */\n  deleteThreshold: number\n\n  /**\n   * When converting indices between UTF-8 and UCS-2, certain scenarios can occur\n   * where we go beyond the target offset. This can happen in particular with\n   * surrogate pairs/high codepoints, when the base string we are applying the\n   * patch to does not fully match the one that was used to generate the patch.\n   * Defaults to `false`.\n   */\n  allowExceedingIndices: boolean\n}\n\n/**\n * Result of a patch application operation.\n * Index 0 contains the new text\n * Index 1 contains an array of booleans indicating which patches were applied\n *\n * @public\n */\nexport type PatchResult = [string, boolean[]]\n\n/**\n * Merge a set of patches onto the text. Returns patched text, as well as a\n * list of true/false values indicating which patches were applied.\n *\n * @param patches - Array of Patch objects.\n * @param text - Old text.\n * @param opts - Optional settings for the patch application.\n * @returns Two element Array, containing the new text and an array of boolean values.\n * @public\n */\nexport function apply(\n  patches: Patch[],\n  originalText: string,\n  opts: Partial<ApplyPatchOptions> = {},\n): PatchResult {\n  if (typeof patches === 'string') {\n    throw new Error('Patches must be an array - pass the patch to `parsePatch()` first')\n  }\n\n  let text = originalText\n  if (patches.length === 0) {\n    return [text, []]\n  }\n\n  // Note: adjustment also deep-copies patches so that no changes are made to the originals.\n  const parsed = adjustIndiciesToUcs2(patches, text, {\n    allowExceedingIndices: opts.allowExceedingIndices,\n  })\n\n  const margin = opts.margin || DEFAULT_MARGIN\n  const deleteThreshold = opts.deleteThreshold || 0.4\n\n  const nullPadding = addPadding(parsed, margin)\n  text = nullPadding + text + nullPadding\n\n  splitMax(parsed, margin)\n  // delta keeps track of the offset between the expected and actual location\n  // of the previous patch.  If there are patches expected at positions 10 and\n  // 20, but the first patch was found at 12, delta is 2 and the second patch\n  // has an effective expected position of 22.\n  let delta = 0\n  const results: boolean[] = []\n  for (let x = 0; x < parsed.length; x++) {\n    const expectedLoc = parsed[x].start2 + delta\n    const text1 = diffText1(parsed[x].diffs)\n    let startLoc\n    let endLoc = -1\n    if (text1.length > MAX_BITS) {\n      // patch_splitMax will only provide an oversized pattern in the case of\n      // a monster delete.\n      startLoc = match(text, text1.substring(0, MAX_BITS), expectedLoc)\n      if (startLoc !== -1) {\n        endLoc = match(\n          text,\n          text1.substring(text1.length - MAX_BITS),\n          expectedLoc + text1.length - MAX_BITS,\n        )\n        if (endLoc === -1 || startLoc >= endLoc) {\n          // Can't find valid trailing context.  Drop this patch.\n          startLoc = -1\n        }\n      }\n    } else {\n      startLoc = match(text, text1, expectedLoc)\n    }\n    if (startLoc === -1) {\n      // No match found.  :(\n      results[x] = false\n      // Subtract the delta for this failed patch from subsequent patches.\n      delta -= parsed[x].length2 - parsed[x].length1\n    } else {\n      // Found a match.  :)\n      results[x] = true\n      delta = startLoc - expectedLoc\n      let text2\n      if (endLoc === -1) {\n        text2 = text.substring(startLoc, startLoc + text1.length)\n      } else {\n        text2 = text.substring(startLoc, endLoc + MAX_BITS)\n      }\n      if (text1 === text2) {\n        // Perfect match, just shove the replacement text in.\n        text =\n          text.substring(0, startLoc) +\n          diffText2(parsed[x].diffs) +\n          text.substring(startLoc + text1.length)\n      } else {\n        // Imperfect match. Run a diff to get a framework of equivalent indices.\n        let diffs = diff(text1, text2, {checkLines: false})\n        if (text1.length > MAX_BITS && levenshtein(diffs) / text1.length > deleteThreshold) {\n          // The end points match, but the content is unacceptably bad.\n          results[x] = false\n        } else {\n          diffs = cleanupSemanticLossless(diffs)\n          let index1 = 0\n          let index2 = 0\n          for (let y = 0; y < parsed[x].diffs.length; y++) {\n            const mod = parsed[x].diffs[y]\n            if (mod[0] !== DIFF_EQUAL) {\n              index2 = xIndex(diffs, index1)\n            }\n            if (mod[0] === DIFF_INSERT) {\n              // Insertion\n              text =\n                text.substring(0, startLoc + index2) + mod[1] + text.substring(startLoc + index2)\n            } else if (mod[0] === DIFF_DELETE) {\n              // Deletion\n              text =\n                text.substring(0, startLoc + index2) +\n                text.substring(startLoc + xIndex(diffs, index1 + mod[1].length))\n            }\n            if (mod[0] !== DIFF_DELETE) {\n              index1 += mod[1].length\n            }\n          }\n        }\n      }\n    }\n  }\n  // Strip the padding off.\n  text = text.substring(nullPadding.length, text.length - nullPadding.length)\n  return [text, results]\n}\n","import {cleanupEfficiency, cleanupSemantic} from '../diff/cleanup.js'\nimport {type Diff, diff, DIFF_DELETE, DIFF_EQUAL, DIFF_INSERT} from '../diff/diff.js'\nimport {diffText1} from '../diff/diffText.js'\nimport {isLowSurrogate} from '../utils/surrogatePairs.js'\nimport {countUtf8Bytes} from '../utils/utf8Indices.js'\nimport {MAX_BITS} from './constants.js'\nimport {createPatchObject, type Patch} from './createPatchObject.js'\n\n/**\n * Options for patch generation.\n *\n * @public\n */\nexport interface MakePatchOptions {\n  // Chunk size for context length.\n  margin: number\n}\n\nconst DEFAULT_OPTS: MakePatchOptions = {\n  margin: 4,\n}\n\nfunction getDefaultOpts(opts: Partial<MakePatchOptions> = {}): MakePatchOptions {\n  return {\n    ...DEFAULT_OPTS,\n    ...opts,\n  }\n}\n\n/**\n * Compute a list of patches to turn based on passed diffs.\n *\n * @param diffs - Array of diff tuples.\n * @param options - Options for the patch generation.\n * @returns Array of Patch objects.\n * @public\n */\nexport function make(diffs: Diff[], options?: Partial<MakePatchOptions>): Patch[]\n\n/**\n * Compute a list of patches to turn textA into textB.\n *\n * @param textA - Original text.\n * @param textB - New text.\n * @param options - Options for the patch generation.\n * @returns Array of Patch objects.\n * @public\n */\nexport function make(textA: string, textB: string, options?: Partial<MakePatchOptions>): Patch[]\n\n/**\n * Compute a list of patches to turn textA into textB using provided diff tuples.\n *\n * @param textA - Original text.\n * @param diffs - Diff tuples to use as base.\n * @param options - Options for the patch generation.\n * @returns Array of Patch objects.\n * @public\n */\nexport function make(textA: string, diffs: Diff[], options?: Partial<MakePatchOptions>): Patch[]\n\nexport function make(\n  a: Diff[] | string,\n  b?: Partial<MakePatchOptions> | string | Diff[],\n  options?: Partial<MakePatchOptions>,\n): Patch[] {\n  if (typeof a === 'string' && typeof b === 'string') {\n    // Method 1: textA, textB\n    // Compute diffs from textA and textB.\n    let diffs = diff(a, b, {checkLines: true})\n    if (diffs.length > 2) {\n      diffs = cleanupSemantic(diffs)\n      diffs = cleanupEfficiency(diffs)\n    }\n    return _make(a, diffs, getDefaultOpts(options))\n  }\n\n  if (a && Array.isArray(a) && typeof b === 'undefined') {\n    // Method 2: diffs\n    // Compute textA from diffs.\n    return _make(diffText1(a), a, getDefaultOpts(options))\n  }\n\n  if (typeof a === 'string' && b && Array.isArray(b)) {\n    // Method 3: textA, diffs\n    return _make(a, b, getDefaultOpts(options))\n  }\n\n  throw new Error('Unknown call format to make()')\n}\n\nfunction _make(textA: string, diffs: Diff[], options: MakePatchOptions): Patch[] {\n  if (diffs.length === 0) {\n    return [] // Get rid of the null case.\n  }\n  const patches: Patch[] = []\n\n  let patch = createPatchObject(0, 0)\n  let patchDiffLength = 0 // Keeping our own length var is faster in JS.\n  let charCount1 = 0 // Number of characters into the textA string.\n  let charCount2 = 0 // Number of characters into the textB string.\n  let utf8Count1 = 0 // Number of utf-8 bytes into the textA string.\n  let utf8Count2 = 0 // Number of utf-8 bytes into the textB string.\n\n  // Start with textA (prepatchText) and apply the diffs until we arrive at\n  // textB (postpatchText).  We recreate the patches one by one to determine\n  // context info.\n  let prepatchText = textA\n  let postpatchText = textA\n\n  for (let x = 0; x < diffs.length; x++) {\n    const currentDiff = diffs[x]\n    const [diffType, diffText] = currentDiff\n    const diffTextLength = diffText.length\n    const diffByteLength = countUtf8Bytes(diffText)\n\n    if (!patchDiffLength && diffType !== DIFF_EQUAL) {\n      // A new patch starts here.\n      patch.start1 = charCount1\n      patch.start2 = charCount2\n      patch.utf8Start1 = utf8Count1\n      patch.utf8Start2 = utf8Count2\n    }\n\n    switch (diffType) {\n      case DIFF_INSERT:\n        patch.diffs[patchDiffLength++] = currentDiff\n        patch.length2 += diffTextLength\n        patch.utf8Length2 += diffByteLength\n        postpatchText =\n          postpatchText.substring(0, charCount2) + diffText + postpatchText.substring(charCount2)\n        break\n      case DIFF_DELETE:\n        patch.length1 += diffTextLength\n        patch.utf8Length1 += diffByteLength\n        patch.diffs[patchDiffLength++] = currentDiff\n        postpatchText =\n          postpatchText.substring(0, charCount2) +\n          postpatchText.substring(charCount2 + diffTextLength)\n        break\n      case DIFF_EQUAL:\n        if (diffTextLength <= 2 * options.margin && patchDiffLength && diffs.length !== x + 1) {\n          // Small equality inside a patch.\n          patch.diffs[patchDiffLength++] = currentDiff\n          patch.length1 += diffTextLength\n          patch.length2 += diffTextLength\n          patch.utf8Length1 += diffByteLength\n          patch.utf8Length2 += diffByteLength\n        } else if (diffTextLength >= 2 * options.margin) {\n          // Time for a new patch.\n          if (patchDiffLength) {\n            addContext(patch, prepatchText, options)\n            patches.push(patch)\n            patch = createPatchObject(-1, -1)\n            patchDiffLength = 0\n            // Unlike Unidiff, our patch lists have a rolling context.\n            // http://code.google.com/p/google-diff-match-patch/wiki/Unidiff\n            // Update prepatch text & pos to reflect the application of the\n            // just completed patch.\n            prepatchText = postpatchText\n            charCount1 = charCount2\n            utf8Count1 = utf8Count2\n          }\n        }\n        break\n      default:\n        throw new Error('Unknown diff type')\n    }\n\n    // Update the current character count.\n    if (diffType !== DIFF_INSERT) {\n      charCount1 += diffTextLength\n      utf8Count1 += diffByteLength\n    }\n    if (diffType !== DIFF_DELETE) {\n      charCount2 += diffTextLength\n      utf8Count2 += diffByteLength\n    }\n  }\n\n  // Pick up the leftover patch if not empty.\n  if (patchDiffLength) {\n    addContext(patch, prepatchText, options)\n    patches.push(patch)\n  }\n\n  return patches\n}\n\n/**\n * Increase the context until it is unique,\n * but don't let the pattern expand beyond MAX_BITS.\n *\n * @param patch - The patch to grow.\n * @param text - Source text.\n * @param opts\n * @internal\n */\nexport function addContext(patch: Patch, text: string, opts: MakePatchOptions): void {\n  if (text.length === 0) {\n    return\n  }\n  let pattern = text.substring(patch.start2, patch.start2 + patch.length1)\n  let padding = 0\n\n  // Look for the first and last matches of pattern in text.  If two different\n  // matches are found, increase the pattern length.\n  while (\n    text.indexOf(pattern) !== text.lastIndexOf(pattern) &&\n    pattern.length < MAX_BITS - opts.margin - opts.margin\n  ) {\n    padding += opts.margin\n    pattern = text.substring(patch.start2 - padding, patch.start2 + patch.length1 + padding)\n  }\n  // Add one chunk for good luck.\n  padding += opts.margin\n\n  // Add the prefix.\n\n  // Avoid splitting inside a surrogate.\n  let prefixStart = patch.start2 - padding\n  if (prefixStart >= 1 && isLowSurrogate(text[prefixStart])) {\n    prefixStart--\n  }\n\n  const prefix = text.substring(prefixStart, patch.start2)\n  if (prefix) {\n    patch.diffs.unshift([DIFF_EQUAL, prefix])\n  }\n\n  const prefixLength = prefix.length\n  const prefixUtf8Length = countUtf8Bytes(prefix)\n\n  // Add the suffix.\n\n  // Avoid splitting inside a surrogate.\n  let suffixEnd = patch.start2 + patch.length1 + padding\n  if (suffixEnd < text.length && isLowSurrogate(text[suffixEnd])) {\n    suffixEnd++\n  }\n\n  const suffix = text.substring(patch.start2 + patch.length1, suffixEnd)\n  if (suffix) {\n    patch.diffs.push([DIFF_EQUAL, suffix])\n  }\n\n  const suffixLength = suffix.length\n  const suffixUtf8Length = countUtf8Bytes(suffix)\n\n  // Roll back the start points.\n  patch.start1 -= prefixLength\n  patch.start2 -= prefixLength\n  patch.utf8Start1 -= prefixUtf8Length\n  patch.utf8Start2 -= prefixUtf8Length\n\n  // Extend the lengths.\n  patch.length1 += prefixLength + suffixLength\n  patch.length2 += prefixLength + suffixLength\n  patch.utf8Length1 += prefixUtf8Length + suffixUtf8Length\n  patch.utf8Length2 += prefixUtf8Length + suffixUtf8Length\n}\n","import {DIFF_DELETE, DIFF_EQUAL, DIFF_INSERT} from '../diff/diff.js'\nimport {countUtf8Bytes} from '../utils/utf8Indices.js'\nimport {createPatchObject, type Patch} from './createPatchObject.js'\n\nconst patchHeader = /^@@ -(\\d+),?(\\d*) \\+(\\d+),?(\\d*) @@$/\n\n/**\n * Parse a textual representation of patches and return a list of Patch objects.\n *\n * @param textline - Text representation of patches.\n * @returns Array of Patch objects.\n * @public\n */\nexport function parse(textline: string): Patch[] {\n  if (!textline) {\n    return []\n  }\n\n  const patches: Patch[] = []\n  const lines = textline.split('\\n')\n\n  let textPointer = 0\n  while (textPointer < lines.length) {\n    const m = lines[textPointer].match(patchHeader)\n    if (!m) {\n      throw new Error(`Invalid patch string: ${lines[textPointer]}`)\n    }\n\n    const patch = createPatchObject(toInt(m[1]), toInt(m[3]))\n    patches.push(patch)\n    if (m[2] === '') {\n      patch.start1--\n      patch.utf8Start1--\n      patch.length1 = 1\n      patch.utf8Length1 = 1\n    } else if (m[2] === '0') {\n      patch.length1 = 0\n      patch.utf8Length1 = 0\n    } else {\n      patch.start1--\n      patch.utf8Start1--\n      // The patch itself will contain the UTF-8 length\n      patch.utf8Length1 = toInt(m[2])\n      // We start with UCS-2 length set to the same, but we adjust for it later\n      patch.length1 = patch.utf8Length1\n    }\n\n    if (m[4] === '') {\n      patch.start2--\n      patch.utf8Start2--\n      patch.length2 = 1\n      patch.utf8Length2 = 1\n    } else if (m[4] === '0') {\n      patch.length2 = 0\n      patch.utf8Length2 = 0\n    } else {\n      patch.start2--\n      patch.utf8Start2--\n      // The patch itself will contain the UTF-8 length\n      patch.utf8Length2 = toInt(m[4])\n      // We start with UCS-2 length set to the same, but we adjust for it later\n      patch.length2 = patch.utf8Length2\n    }\n    textPointer++\n\n    while (textPointer < lines.length) {\n      const currentLine = lines[textPointer]\n      const sign = currentLine.charAt(0)\n\n      if (sign === '@') {\n        // Start of next patch\n        break\n      }\n\n      if (sign === '') {\n        // Blank line? Ignore.\n        textPointer++\n        continue\n      }\n\n      let line: string\n      try {\n        line = decodeURI(currentLine.slice(1))\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      } catch (ex) {\n        // Malformed URI sequence.\n        throw new Error(`Illegal escape in parse: ${currentLine}`)\n      }\n\n      // The number of bytes in a line does not equate to the number of \"characters\"\n      // returned by `string.length` - we have to subtract the diff here in order to\n      // make slicing/calculations work correctly\n      const utf8Diff = countUtf8Bytes(line) - line.length\n      if (sign === '-') {\n        // Deletion.\n        patch.diffs.push([DIFF_DELETE, line])\n        patch.length1 -= utf8Diff\n      } else if (sign === '+') {\n        // Insertion.\n        patch.diffs.push([DIFF_INSERT, line])\n        patch.length2 -= utf8Diff\n      } else if (sign === ' ') {\n        // Minor equality.\n        patch.diffs.push([DIFF_EQUAL, line])\n        patch.length1 -= utf8Diff\n        patch.length2 -= utf8Diff\n      } else {\n        // WTF?\n        throw new Error(`Invalid patch mode \"${sign}\" in: ${line}`)\n      }\n      textPointer++\n    }\n  }\n  return patches\n}\n\nfunction toInt(num: string): number {\n  return parseInt(num, 10)\n}\n","import {DIFF_DELETE, DIFF_EQUAL, DIFF_INSERT} from '../diff/diff.js'\nimport {type Patch} from './createPatchObject.js'\n\n/**\n * Create a textual representation of a patch list.\n *\n * @param patches - Patches to stringify\n * @returns Text representation of patches\n * @public\n */\nexport function stringify(patches: Patch[]): string {\n  return patches.map(stringifyPatch).join('')\n}\n\n/**\n * Create a textual representation of a patch.\n *\n * @param patch - Patch to stringify\n * @returns Text representation of patch\n * @public\n */\nexport function stringifyPatch(patch: Patch): string {\n  const {utf8Length1, utf8Length2, utf8Start1, utf8Start2, diffs} = patch\n\n  let coords1: string\n  if (utf8Length1 === 0) {\n    coords1 = `${utf8Start1},0`\n  } else if (utf8Length1 === 1) {\n    coords1 = `${utf8Start1 + 1}`\n  } else {\n    coords1 = `${utf8Start1 + 1},${utf8Length1}`\n  }\n\n  let coords2: string\n  if (utf8Length2 === 0) {\n    coords2 = `${utf8Start2},0`\n  } else if (utf8Length2 === 1) {\n    coords2 = `${utf8Start2 + 1}`\n  } else {\n    coords2 = `${utf8Start2 + 1},${utf8Length2}`\n  }\n\n  const text = [`@@ -${coords1} +${coords2} @@\\n`]\n  let op\n\n  // Escape the body of the patch with %xx notation.\n  for (let x = 0; x < diffs.length; x++) {\n    switch (diffs[x][0]) {\n      case DIFF_INSERT:\n        op = '+'\n        break\n      case DIFF_DELETE:\n        op = '-'\n        break\n      case DIFF_EQUAL:\n        op = ' '\n        break\n      default:\n        throw new Error('Unknown patch operation.')\n    }\n    text[x + 1] = `${op + encodeURI(diffs[x][1])}\\n`\n  }\n\n  return text.join('').replace(/%20/g, ' ')\n}\n"],"names":["diff","__spreadValues","text","char","MAX_BITS"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"debugId":null}},
    {"offset": {"line": 6537, "column": 0}, "map": {"version":3,"file":"index.mjs","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/document/debug.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/patch/ImmutableAccessor.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/util.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/jsonpath/arrayToJSONMatchPath.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/jsonpath/descend.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/jsonpath/tokenize.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/jsonpath/parse.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/jsonpath/toPath.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/jsonpath/Expression.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/jsonpath/Descender.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/jsonpath/Matcher.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/jsonpath/PlainProbe.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/jsonpath/extractAccessors.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/jsonpath/extract.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/jsonpath/extractWithPath.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/patch/DiffMatchPatch.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/patch/IncPatch.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/patch/util.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/patch/InsertPatch.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/patch/SetIfMissingPatch.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/patch/SetPatch.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/patch/UnsetPatch.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/patch/parse.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/patch/Patcher.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/document/luid.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/document/Mutation.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/document/Document.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/document/SquashingBuffer.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/mutator/src/document/BufferedDocument.ts"],"sourcesContent":["import debugIt from 'debug'\n\nexport const debug = debugIt('mutator-document')\n","import {type Probe} from '../jsonpath/Probe'\n\n/**\n * An immutable probe/writer for plain JS objects that will never mutate\n * the provided _value in place. Each setter returns a new (wrapped) version\n * of the value.\n */\nexport class ImmutableAccessor implements Probe {\n  _value: unknown\n  path: (string | number)[]\n\n  constructor(value: unknown, path?: (string | number)[]) {\n    this._value = value\n    this.path = path || []\n  }\n\n  containerType(): 'array' | 'object' | 'primitive' {\n    if (Array.isArray(this._value)) {\n      return 'array'\n    } else if (this._value !== null && typeof this._value === 'object') {\n      return 'object'\n    }\n    return 'primitive'\n  }\n\n  // Common reader, supported by all containers\n  get(): unknown {\n    return this._value\n  }\n\n  // Array reader\n  length(): number {\n    if (!Array.isArray(this._value)) {\n      throw new Error(\"Won't return length of non-indexable _value\")\n    }\n\n    return this._value.length\n  }\n\n  getIndex(i: number): ImmutableAccessor | false | null {\n    if (!Array.isArray(this._value)) {\n      return false\n    }\n\n    if (i >= this.length()) {\n      return null\n    }\n\n    return new ImmutableAccessor(this._value[i], this.path.concat(i))\n  }\n\n  // Object reader\n  hasAttribute(key: string): boolean {\n    return isRecord(this._value) ? this._value.hasOwnProperty(key) : false\n  }\n\n  attributeKeys(): string[] {\n    return isRecord(this._value) ? Object.keys(this._value) : []\n  }\n\n  getAttribute(key: string): ImmutableAccessor | null {\n    if (!isRecord(this._value)) {\n      throw new Error('getAttribute only applies to plain objects')\n    }\n\n    if (!this.hasAttribute(key)) {\n      return null\n    }\n\n    return new ImmutableAccessor(this._value[key], this.path.concat(key))\n  }\n\n  // Common writer, supported by all containers\n  set(value: unknown): ImmutableAccessor {\n    return value === this._value ? this : new ImmutableAccessor(value, this.path)\n  }\n\n  // array writer interface\n  setIndex(i: number, value: unknown): ImmutableAccessor {\n    if (!Array.isArray(this._value)) {\n      throw new Error('setIndex only applies to arrays')\n    }\n\n    if (Object.is(value, this._value[i])) {\n      return this\n    }\n\n    const nextValue = this._value.slice()\n    nextValue[i] = value\n    return new ImmutableAccessor(nextValue, this.path)\n  }\n\n  setIndexAccessor(i: number, accessor: ImmutableAccessor): ImmutableAccessor {\n    return this.setIndex(i, accessor.get())\n  }\n\n  unsetIndices(indices: number[]): ImmutableAccessor {\n    if (!Array.isArray(this._value)) {\n      throw new Error('unsetIndices only applies to arrays')\n    }\n\n    const length = this._value.length\n    const nextValue = []\n    // Copy every _value _not_ in the indices array over to the newValue\n    for (let i = 0; i < length; i++) {\n      if (indices.indexOf(i) === -1) {\n        nextValue.push(this._value[i])\n      }\n    }\n    return new ImmutableAccessor(nextValue, this.path)\n  }\n\n  insertItemsAt(pos: number, items: unknown[]): ImmutableAccessor {\n    if (!Array.isArray(this._value)) {\n      throw new Error('insertItemsAt only applies to arrays')\n    }\n\n    let nextValue\n    if (this._value.length === 0 && pos === 0) {\n      nextValue = items\n    } else {\n      nextValue = this._value.slice(0, pos).concat(items).concat(this._value.slice(pos))\n    }\n\n    return new ImmutableAccessor(nextValue, this.path)\n  }\n\n  // Object writer interface\n  setAttribute(key: string, value: unknown): ImmutableAccessor {\n    if (!isRecord(this._value)) {\n      throw new Error('Unable to set attribute of non-object container')\n    }\n\n    if (Object.is(value, this._value[key])) {\n      return this\n    }\n\n    const nextValue = Object.assign({}, this._value, {[key]: value})\n    return new ImmutableAccessor(nextValue, this.path)\n  }\n\n  setAttributeAccessor(key: string, accessor: ImmutableAccessor): ImmutableAccessor {\n    return this.setAttribute(key, accessor.get())\n  }\n\n  unsetAttribute(key: string): ImmutableAccessor {\n    if (!isRecord(this._value)) {\n      throw new Error('Unable to unset attribute of non-object container')\n    }\n\n    const nextValue = Object.assign({}, this._value)\n    delete nextValue[key]\n    return new ImmutableAccessor(nextValue, this.path)\n  }\n}\n\nfunction isRecord(value: unknown): value is {[key: string]: unknown} {\n  return value !== null && typeof value === 'object'\n}\n","export function isRecord(value: unknown): value is {[key: string]: unknown} {\n  return value !== null && typeof value === 'object'\n}\n","import {type Path, type PathSegment} from '@sanity/types'\n\nimport {isRecord} from '../util'\n\nconst IS_DOTTABLE = /^[a-z_$]+/\n\n/**\n * Converts a path in array form to a JSONPath string\n *\n * @param pathArray - Array of path segments\n * @returns String representation of the path\n * @internal\n */\nexport function arrayToJSONMatchPath(pathArray: Path): string {\n  let path = ''\n  pathArray.forEach((segment, index) => {\n    path += stringifySegment(segment, index === 0)\n  })\n  return path\n}\n\n// Converts an array of simple values (strings, numbers only) to a jsonmatch path string.\nfunction stringifySegment(\n  segment: PathSegment | Record<string, unknown>,\n  hasLeading: boolean,\n): string {\n  if (typeof segment === 'number') {\n    return `[${segment}]`\n  }\n\n  if (isRecord(segment)) {\n    const seg = segment as Record<string, unknown>\n    return Object.keys(segment)\n      .map((key) => (isPrimitiveValue(seg[key]) ? `[${key}==\"${seg[key]}\"]` : ''))\n      .join('')\n  }\n\n  if (typeof segment === 'string' && IS_DOTTABLE.test(segment)) {\n    return hasLeading ? segment : `.${segment}`\n  }\n\n  return `['${segment}']`\n}\n\nfunction isPrimitiveValue(val: unknown): val is string | number | boolean {\n  switch (typeof val) {\n    case 'number':\n    case 'string':\n    case 'boolean':\n      return true\n    default:\n      return false\n  }\n}\n","import {type Expr, type PathExpr} from './types'\n\n/**\n * Splits an expression into a set of heads, tails. A head is the next leaf node to\n * check for matches, and a tail is everything that follows it. Matching is done by\n * matching heads, then proceedint to the matching value, splitting the tail into\n * heads and tails and checking the heads against the new value, and so on.\n */\nexport function descend(tail: Expr): [Expr | null, PathExpr | null][] {\n  const [head, newTail] = splitIfPath(tail)\n  if (!head) {\n    throw new Error('Head cannot be null')\n  }\n\n  return spreadIfUnionHead(head, newTail)\n}\n\n// Split path in [head, tail]\nfunction splitIfPath(tail: Expr): [Expr | null, PathExpr | null] {\n  if (tail.type !== 'path') {\n    return [tail, null]\n  }\n\n  const nodes = tail.nodes\n  if (nodes.length === 0) {\n    return [null, null]\n  }\n\n  if (nodes.length === 1) {\n    return [nodes[0], null]\n  }\n\n  return [nodes[0], {type: 'path', nodes: nodes.slice(1)}]\n}\n\nfunction concatPaths(path1: PathExpr | null, path2: PathExpr | null): PathExpr | null {\n  if (!path1 && !path2) {\n    return null\n  }\n\n  const nodes1 = path1 ? path1.nodes : []\n  const nodes2 = path2 ? path2.nodes : []\n  return {\n    type: 'path',\n    nodes: nodes1.concat(nodes2),\n  }\n}\n\n// Spreads a union head into several heads/tails\nfunction spreadIfUnionHead(head: Expr, tail: PathExpr | null): [Expr | null, PathExpr | null][] {\n  if (head.type !== 'union') {\n    return [[head, tail]]\n  }\n\n  return head.nodes.map((node) => {\n    if (node.type === 'path') {\n      const [subHead, subTail] = splitIfPath(node)\n      return [subHead, concatPaths(subTail, tail)]\n    }\n\n    return [node, tail]\n  })\n}\n","import {\n  type IdentifierToken,\n  type NumberToken,\n  type QuotedToken,\n  type SymbolClass,\n  type SymbolToken,\n  type Token,\n} from './types'\n\n// TODO: Support '*'\n\nconst digitChar = /[0-9]/\nconst attributeCharMatcher = /^[a-zA-Z0-9_]$/\nconst attributeFirstCharMatcher = /^[a-zA-Z_]$/\n\nconst symbols: Record<SymbolClass, string[]> = {\n  // NOTE: These are compared against in order of definition,\n  // thus '==' must come before '=', '>=' before '>', etc.\n  operator: ['..', '.', ',', ':', '?'],\n  comparator: ['>=', '<=', '<', '>', '==', '!='],\n  keyword: ['$', '@'],\n  boolean: ['true', 'false'],\n  paren: ['[', ']'],\n}\n\nconst symbolClasses = Object.keys(symbols) as SymbolClass[]\n\ntype TokenizerFn = () => Token | null\n\n/**\n * Tokenizes a jsonpath2 expression\n */\nclass Tokenizer {\n  source: string\n  i: number\n  length: number\n  tokenizers: TokenizerFn[]\n\n  constructor(path: string) {\n    this.source = path\n    this.length = path.length\n    this.i = 0\n    this.tokenizers = [\n      this.tokenizeSymbol,\n      this.tokenizeIdentifier,\n      this.tokenizeNumber,\n      this.tokenizeQuoted,\n    ].map((fn) => fn.bind(this))\n  }\n\n  tokenize(): Token[] {\n    const result: Token[] = []\n    while (!this.EOF()) {\n      this.chompWhitespace()\n      let token: Token | null = null\n      // @todo refactor into a simpler `.find()`?\n      const found = this.tokenizers.some((tokenizer) => {\n        token = tokenizer()\n        return Boolean(token)\n      })\n      if (!found || !token) {\n        throw new Error(`Invalid tokens in jsonpath '${this.source}' @ ${this.i}`)\n      }\n      result.push(token)\n    }\n    return result\n  }\n\n  takeWhile(fn: (character: string) => string | null): string | null {\n    const start = this.i\n    let result = ''\n    while (!this.EOF()) {\n      const nextChar = fn(this.source[this.i])\n      if (nextChar === null) {\n        break\n      }\n      result += nextChar\n      this.i++\n    }\n    if (this.i === start) {\n      return null\n    }\n    return result\n  }\n\n  EOF(): boolean {\n    return this.i >= this.length\n  }\n\n  peek(): string | null {\n    if (this.EOF()) {\n      return null\n    }\n    return this.source[this.i]\n  }\n\n  consume(str: string) {\n    if (this.i + str.length > this.length) {\n      throw new Error(`Expected ${str} at end of jsonpath`)\n    }\n    if (str === this.source.slice(this.i, this.i + str.length)) {\n      this.i += str.length\n    } else {\n      throw new Error(`Expected \"${str}\", but source contained \"${this.source.slice()}`)\n    }\n  }\n\n  // Tries to match the upcoming bit of string with the provided string. If it matches, returns\n  // the string, then advances the read pointer to the next bit. If not, returns null and nothing\n  // happens.\n  tryConsume(str: string) {\n    if (this.i + str.length > this.length) {\n      return null\n    }\n    if (str === this.source.slice(this.i, this.i + str.length)) {\n      // When checking symbols that consist of valid attribute characters, we\n      // need to make sure we don't inadvertently treat an attribute as a\n      // symbol. For example, an attribute 'trueCustomerField' should not be\n      // scanned as the boolean symbol \"true\".\n      if (str[0].match(attributeCharMatcher)) {\n        // check that char following the symbol match is not also an attribute char\n        if (this.length > this.i + str.length) {\n          const nextChar = this.source[this.i + str.length]\n          if (nextChar && nextChar.match(attributeCharMatcher)) {\n            return null\n          }\n        }\n      }\n      this.i += str.length\n      return str\n    }\n    return null\n  }\n\n  chompWhitespace(): void {\n    this.takeWhile((char): string | null => {\n      return char === ' ' ? '' : null\n    })\n  }\n\n  tokenizeQuoted(): QuotedToken | null {\n    const quote = this.peek()\n    if (quote === \"'\" || quote === '\"') {\n      this.consume(quote)\n      let escape = false\n      const inner = this.takeWhile((char) => {\n        if (escape) {\n          escape = false\n          return char\n        }\n        if (char === '\\\\') {\n          escape = true\n          return ''\n        }\n        if (char != quote) {\n          return char\n        }\n        return null\n      })\n      this.consume(quote)\n      return {\n        type: 'quoted',\n        value: inner,\n        quote: quote === '\"' ? 'double' : 'single',\n      }\n    }\n    return null\n  }\n\n  tokenizeIdentifier(): IdentifierToken | null {\n    let first = true\n    const identifier = this.takeWhile((char) => {\n      if (first) {\n        first = false\n        return char.match(attributeFirstCharMatcher) ? char : null\n      }\n      return char.match(attributeCharMatcher) ? char : null\n    })\n    if (identifier !== null) {\n      return {\n        type: 'identifier',\n        name: identifier,\n      }\n    }\n    return null\n  }\n\n  tokenizeNumber(): NumberToken | null {\n    const start = this.i\n    let dotSeen = false\n    let digitSeen = false\n    let negative = false\n    if (this.peek() === '-') {\n      negative = true\n      this.consume('-')\n    }\n    const number = this.takeWhile((char) => {\n      if (char === '.' && !dotSeen && digitSeen) {\n        dotSeen = true\n        return char\n      }\n      digitSeen = true\n      return char.match(digitChar) ? char : null\n    })\n    if (number !== null) {\n      return {\n        type: 'number',\n        value: negative ? -number : +number,\n        raw: negative ? `-${number}` : number,\n      }\n    }\n    // No number, rewind\n    this.i = start\n    return null\n  }\n\n  tokenizeSymbol(): SymbolToken | null {\n    for (const symbolClass of symbolClasses) {\n      const patterns = symbols[symbolClass]\n      const symbol = patterns.find((pattern) => this.tryConsume(pattern))\n      if (symbol) {\n        return {\n          type: symbolClass,\n          symbol,\n        }\n      }\n    }\n\n    return null\n  }\n}\n\nexport function tokenize(jsonpath: string): Token[] {\n  return new Tokenizer(jsonpath).tokenize()\n}\n","// Converts a string into an abstract syntax tree representation\n\nimport {tokenize} from './tokenize'\nimport {\n  type AliasExpr,\n  type AttributeExpr,\n  type BooleanExpr,\n  type ConstraintExpr,\n  type IndexExpr,\n  type NumberExpr,\n  type PathExpr,\n  type RangeExpr,\n  type RecursiveExpr,\n  type StringExpr,\n  type Token,\n  type UnionExpr,\n} from './types'\n\n// TODO: Support '*'\n\nclass Parser {\n  tokens: Token[]\n  length: number\n  i: number\n\n  constructor(path: string) {\n    this.tokens = tokenize(path)\n    this.length = this.tokens.length\n    this.i = 0\n  }\n\n  parse() {\n    return this.parsePath()\n  }\n\n  EOF() {\n    return this.i >= this.length\n  }\n\n  // Look at upcoming token\n  peek() {\n    if (this.EOF()) {\n      return null\n    }\n    return this.tokens[this.i]\n  }\n\n  consume() {\n    const result = this.peek()\n    this.i += 1\n    return result\n  }\n\n  // Return next token if it matches the pattern\n  probe(pattern: Record<string, unknown>): Token | null {\n    const token = this.peek()\n    if (!token) {\n      return null\n    }\n\n    const record = token as unknown as Record<string, unknown>\n    const match = Object.keys(pattern).every((key) => {\n      return key in token && pattern[key] === record[key]\n    })\n\n    return match ? token : null\n  }\n\n  // Return and consume next token if it matches the pattern\n  match(pattern: Partial<Token>): Token | null {\n    return this.probe(pattern) ? this.consume() : null\n  }\n\n  parseAttribute(): AttributeExpr | null {\n    const token = this.match({type: 'identifier'})\n    if (token && token.type === 'identifier') {\n      return {\n        type: 'attribute',\n        name: token.name,\n      }\n    }\n    const quoted = this.match({type: 'quoted', quote: 'single'})\n    if (quoted && quoted.type === 'quoted') {\n      return {\n        type: 'attribute',\n        name: quoted.value || '',\n      }\n    }\n    return null\n  }\n\n  parseAlias(): AliasExpr | null {\n    if (this.match({type: 'keyword', symbol: '@'}) || this.match({type: 'keyword', symbol: '$'})) {\n      return {\n        type: 'alias',\n        target: 'self',\n      }\n    }\n    return null\n  }\n\n  parseNumber(): NumberExpr | null {\n    const token = this.match({type: 'number'})\n    if (token && token.type === 'number') {\n      return {\n        type: 'number',\n        value: token.value,\n      }\n    }\n    return null\n  }\n\n  parseNumberValue(): number | null {\n    const expr = this.parseNumber()\n    if (expr) {\n      return expr.value\n    }\n    return null\n  }\n\n  parseSliceSelector(): RangeExpr | IndexExpr | null {\n    const start = this.i\n    const rangeStart = this.parseNumberValue()\n\n    const colon1 = this.match({type: 'operator', symbol: ':'})\n    if (!colon1) {\n      if (rangeStart === null) {\n        // Rewind, this was actually nothing\n        this.i = start\n        return null\n      }\n\n      // Unwrap, this was just a single index not followed by colon\n      return {type: 'index', value: rangeStart}\n    }\n\n    const result: RangeExpr = {\n      type: 'range',\n      start: rangeStart,\n      end: this.parseNumberValue(),\n    }\n\n    const colon2 = this.match({type: 'operator', symbol: ':'})\n    if (colon2) {\n      result.step = this.parseNumberValue()\n    }\n\n    if (result.start === null && result.end === null) {\n      // rewind, this wasnt' a slice selector\n      this.i = start\n      return null\n    }\n\n    return result\n  }\n\n  parseValueReference(): AttributeExpr | RangeExpr | IndexExpr | null {\n    return this.parseAttribute() || this.parseSliceSelector()\n  }\n\n  parseLiteralValue(): StringExpr | BooleanExpr | NumberExpr | null {\n    const literalString = this.match({type: 'quoted', quote: 'double'})\n    if (literalString && literalString.type === 'quoted') {\n      return {\n        type: 'string',\n        value: literalString.value || '',\n      }\n    }\n    const literalBoolean = this.match({type: 'boolean'})\n    if (literalBoolean && literalBoolean.type === 'boolean') {\n      return {\n        type: 'boolean',\n        value: literalBoolean.symbol === 'true',\n      }\n    }\n    return this.parseNumber()\n  }\n\n  // TODO: Reorder constraints so that literal value is always on rhs, and variable is always\n  // on lhs.\n  parseFilterExpression(): ConstraintExpr | null {\n    const start = this.i\n    const expr = this.parseAttribute() || this.parseAlias()\n    if (!expr) {\n      return null\n    }\n\n    if (this.match({type: 'operator', symbol: '?'})) {\n      return {\n        type: 'constraint',\n        operator: '?',\n        lhs: expr,\n      }\n    }\n\n    const binOp = this.match({type: 'comparator'})\n    if (!binOp || binOp.type !== 'comparator') {\n      // No expression, rewind!\n      this.i = start\n      return null\n    }\n\n    const lhs = expr\n    const rhs = this.parseLiteralValue()\n    if (!rhs) {\n      throw new Error(`Operator ${binOp.symbol} needs a literal value at the right hand side`)\n    }\n\n    return {\n      type: 'constraint',\n      operator: binOp.symbol,\n      lhs: lhs,\n      rhs: rhs,\n    }\n  }\n\n  parseExpression(): ConstraintExpr | AttributeExpr | RangeExpr | IndexExpr | null {\n    return this.parseFilterExpression() || this.parseValueReference()\n  }\n\n  parseUnion(): UnionExpr | null {\n    if (!this.match({type: 'paren', symbol: '['})) {\n      return null\n    }\n\n    const terms = []\n    let expr = this.parseFilterExpression() || this.parsePath() || this.parseValueReference()\n    while (expr) {\n      terms.push(expr)\n      // End of union?\n      if (this.match({type: 'paren', symbol: ']'})) {\n        break\n      }\n\n      if (!this.match({type: 'operator', symbol: ','})) {\n        throw new Error('Expected ]')\n      }\n\n      expr = this.parseFilterExpression() || this.parsePath() || this.parseValueReference()\n      if (!expr) {\n        throw new Error(\"Expected expression following ','\")\n      }\n    }\n\n    return {\n      type: 'union',\n      nodes: terms,\n    }\n  }\n\n  parseRecursive(): RecursiveExpr | null {\n    if (!this.match({type: 'operator', symbol: '..'})) {\n      return null\n    }\n\n    const subpath = this.parsePath()\n    if (!subpath) {\n      throw new Error(\"Expected path following '..' operator\")\n    }\n\n    return {\n      type: 'recursive',\n      term: subpath,\n    }\n  }\n\n  parsePath(): PathExpr | AttributeExpr | UnionExpr | RecursiveExpr | null {\n    const nodes: (AttributeExpr | UnionExpr | RecursiveExpr)[] = []\n    const expr = this.parseAttribute() || this.parseUnion() || this.parseRecursive()\n    if (!expr) {\n      return null\n    }\n\n    nodes.push(expr)\n    while (!this.EOF()) {\n      if (this.match({type: 'operator', symbol: '.'})) {\n        const attr = this.parseAttribute()\n        if (!attr) {\n          throw new Error(\"Expected attribute name following '.\")\n        }\n        nodes.push(attr)\n        continue\n      } else if (this.probe({type: 'paren', symbol: '['})) {\n        const union = this.parseUnion()\n        if (!union) {\n          throw new Error(\"Expected union following '['\")\n        }\n        nodes.push(union)\n      } else {\n        const recursive = this.parseRecursive()\n        if (recursive) {\n          nodes.push(recursive)\n        }\n        break\n      }\n    }\n\n    if (nodes.length === 1) {\n      return nodes[0]\n    }\n\n    return {\n      type: 'path',\n      nodes: nodes,\n    }\n  }\n}\n\nexport function parseJsonPath(path: string): PathExpr | AttributeExpr | UnionExpr | RecursiveExpr {\n  const parsed = new Parser(path).parse()\n  if (!parsed) {\n    throw new Error(`Failed to parse JSON path \"${path}\"`)\n  }\n  return parsed\n}\n","import {type Expr} from './types'\n\n/**\n * Converts a parsed expression back into jsonpath2, roughly -\n * mostly for use with tests.\n *\n * @param expr - Expression to convert to path\n * @returns a string representation of the path\n * @internal\n */\nexport function toPath(expr: Expr): string {\n  return toPathInner(expr, false)\n}\n\nfunction toPathInner(expr: Expr, inUnion: boolean): string {\n  switch (expr.type) {\n    case 'attribute':\n      return expr.name\n    case 'alias':\n      return expr.target === 'self' ? '@' : '$'\n    case 'number':\n      return `${expr.value}`\n    case 'range': {\n      const result = []\n      if (!inUnion) {\n        result.push('[')\n      }\n      if (expr.start) {\n        result.push(`${expr.start}`)\n      }\n      result.push(':')\n      if (expr.end) {\n        result.push(`${expr.end}`)\n      }\n      if (expr.step) {\n        result.push(`:${expr.step}`)\n      }\n      if (!inUnion) {\n        result.push(']')\n      }\n      return result.join('')\n    }\n    case 'index':\n      if (inUnion) {\n        return `${expr.value}`\n      }\n\n      return `[${expr.value}]`\n    case 'constraint': {\n      const rhs = expr.rhs ? ` ${toPathInner(expr.rhs, false)}` : ''\n      const inner = `${toPathInner(expr.lhs, false)} ${expr.operator}${rhs}`\n\n      if (inUnion) {\n        return inner\n      }\n\n      return `[${inner}]`\n    }\n    case 'string':\n      return JSON.stringify(expr.value)\n    case 'path': {\n      const result = []\n      const nodes = expr.nodes.slice()\n      while (nodes.length > 0) {\n        const node = nodes.shift()\n        if (node) {\n          result.push(toPath(node))\n        }\n\n        const upcoming = nodes[0]\n        if (upcoming && toPathInner(upcoming, false)[0] !== '[') {\n          result.push('.')\n        }\n      }\n      return result.join('')\n    }\n    case 'union':\n      return `[${expr.nodes.map((e) => toPathInner(e, true)).join(',')}]`\n    default:\n      throw new Error(`Unknown node type ${expr.type}`)\n    case 'recursive':\n      return `..${toPathInner(expr.term, false)}`\n  }\n}\n","// A utility wrapper class to process parsed jsonpath expressions\n\nimport {descend} from './descend'\nimport {parseJsonPath} from './parse'\nimport {type Probe} from './Probe'\nimport {toPath} from './toPath'\nimport {type Expr, type HeadTail} from './types'\n\nexport interface Range {\n  start: number\n  end: number\n  step: number\n}\n\nexport class Expression {\n  expr: Expr\n\n  constructor(expr: Expr | Expression | null) {\n    if (!expr) {\n      throw new Error('Attempted to create Expression from null-value')\n    }\n\n    // This is a wrapped expr\n    if ('expr' in expr) {\n      this.expr = expr.expr\n    } else {\n      this.expr = expr\n    }\n\n    if (!('type' in this.expr)) {\n      throw new Error('Attempt to create Expression for expression with no type')\n    }\n  }\n\n  isPath(): boolean {\n    return this.expr.type === 'path'\n  }\n\n  isUnion(): boolean {\n    return this.expr.type === 'union'\n  }\n\n  isCollection(): boolean {\n    return this.isPath() || this.isUnion()\n  }\n\n  isConstraint(): boolean {\n    return this.expr.type === 'constraint'\n  }\n\n  isRecursive(): boolean {\n    return this.expr.type === 'recursive'\n  }\n\n  isExistenceConstraint(): boolean {\n    return this.expr.type === 'constraint' && this.expr.operator === '?'\n  }\n\n  isIndex(): boolean {\n    return this.expr.type === 'index'\n  }\n\n  isRange(): boolean {\n    return this.expr.type === 'range'\n  }\n\n  expandRange(probe?: Probe): Range {\n    const probeLength = () => {\n      if (!probe) {\n        throw new Error('expandRange() required a probe that was not passed')\n      }\n\n      return probe.length()\n    }\n\n    let start = 'start' in this.expr ? this.expr.start || 0 : 0\n    start = interpretNegativeIndex(start, probe)\n    let end = 'end' in this.expr ? this.expr.end || probeLength() : probeLength()\n    end = interpretNegativeIndex(end, probe)\n    const step = 'step' in this.expr ? this.expr.step || 1 : 1\n    return {start, end, step}\n  }\n\n  isAttributeReference(): boolean {\n    return this.expr.type === 'attribute'\n  }\n\n  // Is a range or index -> something referencing indexes\n  isIndexReference(): boolean {\n    return this.isIndex() || this.isRange()\n  }\n\n  name(): string {\n    return 'name' in this.expr ? this.expr.name : ''\n  }\n\n  isSelfReference(): boolean {\n    return this.expr.type === 'alias' && this.expr.target === 'self'\n  }\n\n  constraintTargetIsSelf(): boolean {\n    return (\n      this.expr.type === 'constraint' &&\n      this.expr.lhs.type === 'alias' &&\n      this.expr.lhs.target === 'self'\n    )\n  }\n\n  constraintTargetIsAttribute(): boolean {\n    return this.expr.type === 'constraint' && this.expr.lhs.type === 'attribute'\n  }\n\n  testConstraint(probe: Probe): boolean {\n    const expr = this.expr\n\n    if (expr.type === 'constraint' && expr.lhs.type === 'alias' && expr.lhs.target === 'self') {\n      if (probe.containerType() !== 'primitive') {\n        return false\n      }\n\n      if (expr.type === 'constraint' && expr.operator === '?') {\n        return true\n      }\n\n      const lhs = probe.get()\n      const rhs = expr.rhs && 'value' in expr.rhs ? expr.rhs.value : undefined\n      return testBinaryOperator(lhs, expr.operator, rhs)\n    }\n\n    if (expr.type !== 'constraint') {\n      return false\n    }\n\n    const lhs = expr.lhs\n    if (!lhs) {\n      throw new Error('No LHS of expression')\n    }\n\n    if (lhs.type !== 'attribute') {\n      throw new Error(`Constraint target ${lhs.type} not supported`)\n    }\n\n    if (probe.containerType() !== 'object') {\n      return false\n    }\n\n    const lhsValue = probe.getAttribute(lhs.name)\n    if (lhsValue === undefined || lhsValue === null || lhsValue.containerType() !== 'primitive') {\n      // LHS is void and empty, or it is a collection\n      return false\n    }\n\n    if (this.isExistenceConstraint()) {\n      // There is no rhs, and if we're here the key did exist\n      return true\n    }\n\n    const rhs = expr.rhs && 'value' in expr.rhs ? expr.rhs.value : undefined\n    return testBinaryOperator(lhsValue.get(), expr.operator, rhs)\n  }\n\n  pathNodes(): Expr[] {\n    return this.expr.type === 'path' ? this.expr.nodes : [this.expr]\n  }\n\n  prepend(node: Expression): Expression {\n    if (!node) {\n      return this\n    }\n\n    return new Expression({\n      type: 'path',\n      nodes: node.pathNodes().concat(this.pathNodes()),\n    })\n  }\n\n  concat(other: Expression | null): Expression {\n    return other ? other.prepend(this) : this\n  }\n\n  descend(): HeadTail[] {\n    return descend(this.expr).map((headTail) => {\n      const [head, tail] = headTail\n      return {\n        head: head ? new Expression(head) : null,\n        tail: tail ? new Expression(tail) : null,\n      }\n    })\n  }\n\n  unwrapRecursive(): Expression {\n    if (this.expr.type !== 'recursive') {\n      throw new Error(`Attempt to unwrap recursive on type ${this.expr.type}`)\n    }\n\n    return new Expression(this.expr.term)\n  }\n\n  toIndicies(probe?: Probe): number[] {\n    if (this.expr.type !== 'index' && this.expr.type !== 'range') {\n      throw new Error('Node cannot be converted to indexes')\n    }\n\n    if (this.expr.type === 'index') {\n      return [interpretNegativeIndex(this.expr.value, probe)]\n    }\n\n    const result: number[] = []\n    const range = this.expandRange(probe)\n    let {start, end} = range\n    if (range.step < 0) {\n      ;[start, end] = [end, start]\n    }\n\n    for (let i = start; i < end; i++) {\n      result.push(i)\n    }\n\n    return result\n  }\n\n  toFieldReferences(): number[] | string[] {\n    if (this.isIndexReference()) {\n      return this.toIndicies()\n    }\n    if (this.expr.type === 'attribute') {\n      return [this.expr.name]\n    }\n    throw new Error(`Can't convert ${this.expr.type} to field references`)\n  }\n\n  toString(): string {\n    return toPath(this.expr)\n  }\n\n  static fromPath(path: string): Expression {\n    const parsed = parseJsonPath(path)\n    if (!parsed) {\n      throw new Error(`Failed to parse path \"${path}\"`)\n    }\n\n    return new Expression(parsed)\n  }\n\n  static attributeReference(name: string): Expression {\n    return new Expression({\n      type: 'attribute',\n      name: name,\n    })\n  }\n\n  static indexReference(i: number): Expression {\n    return new Expression({\n      type: 'index',\n      value: i,\n    })\n  }\n}\n\n// Tests an operator on two given primitive values\nfunction testBinaryOperator(lhsValue: any, operator: string, rhsValue: any) {\n  switch (operator) {\n    case '>':\n      return lhsValue > rhsValue\n    case '>=':\n      return lhsValue >= rhsValue\n    case '<':\n      return lhsValue < rhsValue\n    case '<=':\n      return lhsValue <= rhsValue\n    case '==':\n      return lhsValue === rhsValue\n    case '!=':\n      return lhsValue !== rhsValue\n    default:\n      throw new Error(`Unsupported binary operator ${operator}`)\n  }\n}\n\nfunction interpretNegativeIndex(index: number, probe?: Probe): number {\n  if (index >= 0) {\n    return index\n  }\n\n  if (!probe) {\n    throw new Error('interpretNegativeIndex() must have a probe when < 0')\n  }\n\n  return index + probe.length()\n}\n","import {flatten} from 'lodash'\n\nimport {Expression} from './Expression'\nimport {type Probe} from './Probe'\n\n/**\n * Descender models the state of one partial jsonpath evaluation. Head is the\n * next thing to match, tail is the upcoming things once the head is matched.\n */\nexport class Descender {\n  head: Expression | null\n  tail: Expression | null\n\n  constructor(head: Expression | null, tail: Expression | null) {\n    this.head = head\n    this.tail = tail\n  }\n\n  // Iterate this descender once processing any constraints that are\n  // resolvable on the current value. Returns an array of new descenders\n  // that are guaranteed to be without constraints in the head\n  iterate(probe: Probe): Descender[] {\n    let result: Descender[] = [this]\n    if (this.head && this.head.isConstraint()) {\n      let anyConstraints = true\n      // Keep rewriting constraints until there are none left\n      while (anyConstraints) {\n        result = flatten(\n          result.map((descender) => {\n            return descender.iterateConstraints(probe)\n          }),\n        )\n        anyConstraints = result.some((descender) => {\n          return descender.head && descender.head.isConstraint()\n        })\n      }\n    }\n    return result\n  }\n\n  isRecursive(): boolean {\n    return Boolean(this.head && this.head.isRecursive())\n  }\n\n  hasArrived(): boolean {\n    return this.head === null && this.tail === null\n  }\n\n  extractRecursives(): Descender[] {\n    if (this.head && this.head.isRecursive()) {\n      const term = this.head.unwrapRecursive()\n      return new Descender(null, term.concat(this.tail)).descend()\n    }\n    return []\n  }\n\n  iterateConstraints(probe: Probe): Descender[] {\n    const head = this.head\n    if (head === null || !head.isConstraint()) {\n      // Not a constraint, no rewrite\n      return [this]\n    }\n\n    const result: Descender[] = []\n\n    if (probe.containerType() === 'primitive' && head.constraintTargetIsSelf()) {\n      if (head.testConstraint(probe)) {\n        result.push(...this.descend())\n      }\n      return result\n    }\n\n    // The value is an array\n    if (probe.containerType() === 'array') {\n      const length = probe.length()\n      for (let i = 0; i < length; i++) {\n        // Push new descenders with constraint translated to literal indices\n        // where they match\n        const constraint = probe.getIndex(i)\n        if (constraint && head.testConstraint(constraint)) {\n          result.push(new Descender(new Expression({type: 'index', value: i}), this.tail))\n        }\n      }\n      return result\n    }\n\n    // The value is an object\n    if (probe.containerType() === 'object') {\n      if (head.constraintTargetIsSelf()) {\n        // There are no matches for target self ('@') on a plain object\n        return []\n      }\n\n      if (head.testConstraint(probe)) {\n        return this.descend()\n      }\n\n      return result\n    }\n\n    return result\n  }\n\n  descend(): Descender[] {\n    if (!this.tail) {\n      return [new Descender(null, null)]\n    }\n\n    return this.tail.descend().map((ht) => {\n      return new Descender(ht.head, ht.tail)\n    })\n  }\n\n  toString(): string {\n    const result = ['<']\n    if (this.head) {\n      result.push(this.head.toString())\n    }\n    result.push('|')\n    if (this.tail) {\n      result.push(this.tail.toString())\n    }\n    result.push('>')\n    return result.join('')\n  }\n}\n","import {Descender} from './Descender'\nimport {Expression} from './Expression'\nimport {parseJsonPath} from './parse'\nimport {type Probe} from './Probe'\n\ninterface Result<P = unknown> {\n  leads: {\n    target: Expression\n    matcher: Matcher\n  }[]\n\n  delivery?: {\n    targets: Expression[]\n    payload: P\n  }\n}\n\n/**\n * @internal\n */\nexport class Matcher {\n  active: Descender[]\n  recursives: Descender[]\n  payload: unknown\n\n  constructor(active: Descender[], parent?: Matcher) {\n    this.active = active || []\n    if (parent) {\n      this.recursives = parent.recursives\n      this.payload = parent.payload\n    } else {\n      this.recursives = []\n    }\n    this.extractRecursives()\n  }\n\n  setPayload(payload: unknown): this {\n    this.payload = payload\n    return this\n  }\n\n  // Moves any recursive descenders onto the recursive track, removing them from\n  // the active set\n  extractRecursives(): void {\n    this.active = this.active.filter((descender) => {\n      if (descender.isRecursive()) {\n        this.recursives.push(...descender.extractRecursives())\n        return false\n      }\n      return true\n    })\n  }\n\n  // Find recursives that are relevant now and should be considered part of the active set\n  activeRecursives(probe: Probe): Descender[] {\n    return this.recursives.filter((descender) => {\n      const head = descender.head\n      if (!head) {\n        return false\n      }\n\n      // Constraints are always relevant\n      if (head.isConstraint()) {\n        return true\n      }\n\n      // Index references are only relevant for indexable values\n      if (probe.containerType() === 'array' && head.isIndexReference()) {\n        return true\n      }\n\n      // Attribute references are relevant for plain objects\n      if (probe.containerType() === 'object') {\n        return head.isAttributeReference() && probe.hasAttribute(head.name())\n      }\n\n      return false\n    })\n  }\n\n  match(probe: Probe): Result {\n    return this.iterate(probe).extractMatches(probe)\n  }\n\n  iterate(probe: Probe): Matcher {\n    const newActiveSet: Descender[] = []\n    this.active.concat(this.activeRecursives(probe)).forEach((descender) => {\n      newActiveSet.push(...descender.iterate(probe))\n    })\n    return new Matcher(newActiveSet, this)\n  }\n\n  // Returns true if any of the descenders in the active or recursive set\n  // consider the current state a final destination\n  isDestination(): boolean {\n    return this.active.some((descender) => descender.hasArrived())\n  }\n\n  hasRecursives(): boolean {\n    return this.recursives.length > 0\n  }\n\n  // Returns any payload delivieries and leads that needs to be followed to complete\n  // the process.\n  extractMatches(probe: Probe): Result {\n    const leads: {target: Expression; matcher: Matcher}[] = []\n    const targets: Expression[] = []\n    this.active.forEach((descender) => {\n      if (descender.hasArrived()) {\n        // This was already arrived, so matches this value, not descenders\n        targets.push(\n          new Expression({\n            type: 'alias',\n            target: 'self',\n          }),\n        )\n        return\n      }\n\n      const descenderHead = descender.head\n      if (!descenderHead) {\n        return\n      }\n\n      if (probe.containerType() === 'array' && !descenderHead.isIndexReference()) {\n        // This descender does not match an indexable value\n        return\n      }\n\n      if (probe.containerType() === 'object' && !descenderHead.isAttributeReference()) {\n        // This descender never match a plain object\n        return\n      }\n\n      if (descender.tail) {\n        // Not arrived yet\n        const matcher = new Matcher(descender.descend(), this)\n        descenderHead.toFieldReferences().forEach(() => {\n          leads.push({\n            target: descenderHead,\n            matcher: matcher,\n          })\n        })\n      } else {\n        // arrived\n        targets.push(descenderHead)\n      }\n    })\n\n    // If there are recursive terms, we need to add a lead for every descendant ...\n    if (this.hasRecursives()) {\n      // The recustives matcher will have no active set, only inherit recursives from this\n      const recursivesMatcher = new Matcher([], this)\n      if (probe.containerType() === 'array') {\n        const length = probe.length()\n        for (let i = 0; i < length; i++) {\n          leads.push({\n            target: Expression.indexReference(i),\n            matcher: recursivesMatcher,\n          })\n        }\n      } else if (probe.containerType() === 'object') {\n        probe.attributeKeys().forEach((name) => {\n          leads.push({\n            target: Expression.attributeReference(name),\n            matcher: recursivesMatcher,\n          })\n        })\n      }\n    }\n\n    return targets.length > 0\n      ? {leads: leads, delivery: {targets, payload: this.payload}}\n      : {leads: leads}\n  }\n\n  static fromPath(jsonpath: string): Matcher {\n    const path = parseJsonPath(jsonpath)\n    if (!path) {\n      throw new Error(`Failed to parse path from \"${jsonpath}\"`)\n    }\n\n    const descender = new Descender(null, new Expression(path))\n    return new Matcher(descender.descend())\n  }\n}\n","import {isRecord} from '../util'\nimport {type Probe} from './Probe'\n\n// A default implementation of a probe for vanilla JS _values\nexport class PlainProbe implements Probe {\n  _value: unknown\n  path: (string | number)[]\n\n  constructor(value: unknown, path?: (string | number)[]) {\n    this._value = value\n    this.path = path || []\n  }\n\n  containerType(): 'array' | 'object' | 'primitive' {\n    if (Array.isArray(this._value)) {\n      return 'array'\n    } else if (this._value !== null && typeof this._value === 'object') {\n      return 'object'\n    }\n    return 'primitive'\n  }\n\n  length(): number {\n    if (!Array.isArray(this._value)) {\n      throw new Error(\"Won't return length of non-indexable _value\")\n    }\n\n    return this._value.length\n  }\n\n  getIndex(i: number): false | null | PlainProbe {\n    if (!Array.isArray(this._value)) {\n      return false\n    }\n\n    if (i >= this.length()) {\n      return null\n    }\n\n    return new PlainProbe(this._value[i], this.path.concat(i))\n  }\n\n  hasAttribute(key: string): boolean {\n    if (!isRecord(this._value)) {\n      return false\n    }\n\n    return this._value.hasOwnProperty(key)\n  }\n\n  attributeKeys(): string[] {\n    return isRecord(this._value) ? Object.keys(this._value) : []\n  }\n\n  getAttribute(key: string): null | PlainProbe {\n    if (!isRecord(this._value)) {\n      throw new Error('getAttribute only applies to plain objects')\n    }\n\n    if (!this.hasAttribute(key)) {\n      return null\n    }\n\n    return new PlainProbe(this._value[key], this.path.concat(key))\n  }\n\n  get(): unknown {\n    return this._value\n  }\n}\n","import {compact} from 'lodash'\n\nimport {type Expression} from './Expression'\nimport {Matcher} from './Matcher'\nimport {PlainProbe} from './PlainProbe'\nimport {type Probe} from './Probe'\n\nexport function extractAccessors(path: string, value: unknown): Probe[] {\n  const result: Probe[] = []\n  const matcher = Matcher.fromPath(path).setPayload(function appendResult(values: Probe[]) {\n    result.push(...values)\n  })\n  const accessor = new PlainProbe(value)\n  descend(matcher, accessor)\n  return result\n}\n\nfunction descend(matcher: Matcher, accessor: Probe) {\n  const {leads, delivery} = matcher.match(accessor)\n\n  leads.forEach((lead) => {\n    accessorsFromTarget(lead.target, accessor).forEach((childAccessor) => {\n      descend(lead.matcher, childAccessor)\n    })\n  })\n\n  if (delivery) {\n    delivery.targets.forEach((target) => {\n      if (typeof delivery.payload === 'function') {\n        delivery.payload(accessorsFromTarget(target, accessor))\n      }\n    })\n  }\n}\n\nfunction accessorsFromTarget(target: Expression, accessor: Probe) {\n  const result = []\n  if (target.isIndexReference()) {\n    target.toIndicies(accessor).forEach((i) => {\n      result.push(accessor.getIndex(i))\n    })\n  } else if (target.isAttributeReference()) {\n    result.push(accessor.getAttribute(target.name()))\n  } else if (target.isSelfReference()) {\n    result.push(accessor)\n  } else {\n    throw new Error(`Unable to derive accessor for target ${target.toString()}`)\n  }\n  return compact(result)\n}\n","import {extractAccessors} from './extractAccessors'\n\n/**\n * Extracts values matching the given JsonPath\n *\n * @param path - Path to extract\n * @param value - Value to extract from\n * @returns An array of values matching the given path\n * @public\n */\nexport function extract(path: string, value: unknown): unknown[] {\n  const accessors = extractAccessors(path, value)\n  return accessors.map((acc) => acc.get())\n}\n","import {extractAccessors} from './extractAccessors'\n\n/**\n * Extracts a value for the given JsonPath, and includes the specific path of where it was found\n *\n * @param path - Path to extract\n * @param value - Value to extract from\n * @returns An array of objects with `path` and `value` keys\n * @internal\n */\nexport function extractWithPath(\n  path: string,\n  value: unknown,\n): {path: (string | number)[]; value: unknown}[] {\n  const accessors = extractAccessors(path, value)\n  return accessors.map((acc) => ({path: acc.path, value: acc.get()}))\n}\n","import {applyPatches, parsePatch, type Patch} from '@sanity/diff-match-patch'\n\nimport {type Expression} from '../jsonpath'\nimport {type ImmutableAccessor} from './ImmutableAccessor'\n\nfunction applyPatch(patch: Patch[], oldValue: unknown) {\n  // Silently avoid patching if the value type is not string\n  if (typeof oldValue !== 'string') return oldValue\n  const [result] = applyPatches(patch, oldValue, {allowExceedingIndices: true})\n  return result\n}\n\nexport class DiffMatchPatch {\n  path: string\n  dmpPatch: Patch[]\n  id: string\n\n  constructor(id: string, path: string, dmpPatchSrc: string) {\n    this.id = id\n    this.path = path\n    this.dmpPatch = parsePatch(dmpPatchSrc)\n  }\n\n  apply(targets: Expression[], accessor: ImmutableAccessor): ImmutableAccessor {\n    let result = accessor\n\n    // The target must be a container type\n    if (result.containerType() === 'primitive') {\n      return result\n    }\n\n    for (const target of targets) {\n      if (target.isIndexReference()) {\n        for (const index of target.toIndicies(accessor)) {\n          // Skip patching unless the index actually currently exists\n          const item = result.getIndex(index)\n          if (!item) {\n            continue\n          }\n\n          const oldValue = item.get()\n          const nextValue = applyPatch(this.dmpPatch, oldValue)\n          result = result.setIndex(index, nextValue)\n        }\n\n        continue\n      }\n\n      if (target.isAttributeReference() && result.hasAttribute(target.name())) {\n        const attribute = result.getAttribute(target.name())\n        if (!attribute) {\n          continue\n        }\n\n        const oldValue = attribute.get()\n        const nextValue = applyPatch(this.dmpPatch, oldValue)\n        result = result.setAttribute(target.name(), nextValue)\n        continue\n      }\n\n      throw new Error(`Unable to apply diffMatchPatch to target ${target.toString()}`)\n    }\n\n    return result\n  }\n}\n","import {type Expression} from '../jsonpath'\nimport {type ImmutableAccessor} from './ImmutableAccessor'\n\nfunction performIncrement(previousValue: unknown, delta: number): number {\n  if (typeof previousValue !== 'number' || !Number.isFinite(previousValue)) {\n    return previousValue as number\n  }\n\n  return previousValue + delta\n}\n\nexport class IncPatch {\n  path: string\n  value: number\n  id: string\n\n  constructor(id: string, path: string, value: number) {\n    this.path = path\n    this.value = value\n    this.id = id\n  }\n\n  apply(targets: Expression[], accessor: ImmutableAccessor): ImmutableAccessor {\n    let result = accessor\n\n    // The target must be a container type\n    if (result.containerType() === 'primitive') {\n      return result\n    }\n\n    for (const target of targets) {\n      if (target.isIndexReference()) {\n        for (const index of target.toIndicies(accessor)) {\n          // Skip patching unless the index actually currently exists\n          const item = result.getIndex(index)\n          if (!item) {\n            continue\n          }\n\n          const previousValue = item.get()\n          result = result.setIndex(index, performIncrement(previousValue, this.value))\n        }\n\n        continue\n      }\n\n      if (target.isAttributeReference()) {\n        const attribute = result.getAttribute(target.name())\n        if (!attribute) {\n          continue\n        }\n\n        const previousValue = attribute.get()\n        result = result.setAttribute(target.name(), performIncrement(previousValue, this.value))\n        continue\n      }\n\n      throw new Error(`Unable to apply to target ${target.toString()}`)\n    }\n\n    return result\n  }\n}\n","import {type Expression} from '../jsonpath'\nimport {type ImmutableAccessor} from './ImmutableAccessor'\n\nexport function targetsToIndicies(targets: Expression[], accessor: ImmutableAccessor): number[] {\n  const result: number[] = []\n  targets.forEach((target) => {\n    if (target.isIndexReference()) {\n      result.push(...target.toIndicies(accessor))\n    }\n  })\n  return result.sort()\n}\n","import {max, min} from 'lodash'\n\nimport {type Expression} from '../jsonpath'\nimport {type ImmutableAccessor} from './ImmutableAccessor'\nimport {targetsToIndicies} from './util'\n\nexport class InsertPatch {\n  location: string\n  path: string\n  items: unknown[]\n  id: string\n\n  constructor(id: string, location: string, path: string, items: unknown[]) {\n    this.id = id\n    this.location = location\n    this.path = path\n    this.items = items\n  }\n\n  apply(targets: Expression[], accessor: ImmutableAccessor): ImmutableAccessor {\n    let result = accessor\n    if (accessor.containerType() !== 'array') {\n      throw new Error('Attempt to apply insert patch to non-array value')\n    }\n\n    switch (this.location) {\n      case 'before': {\n        const pos = minIndex(targets, accessor)\n        result = result.insertItemsAt(pos, this.items)\n        break\n      }\n      case 'after': {\n        const pos = maxIndex(targets, accessor)\n        result = result.insertItemsAt(pos + 1, this.items)\n        break\n      }\n      case 'replace': {\n        // TODO: Properly implement ranges in compliance with content lake\n        // This will only properly support single contiguous ranges\n        const indicies = targetsToIndicies(targets, accessor)\n        result = result.unsetIndices(indicies)\n        result = result.insertItemsAt(indicies[0], this.items)\n        break\n      }\n      default: {\n        throw new Error(`Unsupported location atm: ${this.location}`)\n      }\n    }\n    return result\n  }\n}\n\nfunction minIndex(targets: Expression[], accessor: ImmutableAccessor): number {\n  let result = min(targetsToIndicies(targets, accessor)) || 0\n\n  // Ranges may be zero-length and not turn up in indices\n  targets.forEach((target) => {\n    if (target.isRange()) {\n      const {start} = target.expandRange()\n      if (start < result) {\n        result = start\n      }\n    }\n  })\n  return result\n}\n\nfunction maxIndex(targets: Expression[], accessor: ImmutableAccessor): number {\n  let result = max(targetsToIndicies(targets, accessor)) || 0\n\n  // Ranges may be zero-length and not turn up in indices\n  targets.forEach((target) => {\n    if (target.isRange()) {\n      const {end} = target.expandRange()\n      if (end > result) {\n        result = end\n      }\n    }\n  })\n  return result\n}\n","import {type Expression} from '../jsonpath'\nimport {type ImmutableAccessor} from './ImmutableAccessor'\n\nexport class SetIfMissingPatch {\n  id: string\n  path: string\n  value: unknown\n\n  constructor(id: string, path: string, value: unknown) {\n    this.id = id\n    this.path = path\n    this.value = value\n  }\n\n  apply(targets: Expression[], accessor: ImmutableAccessor): ImmutableAccessor {\n    let result = accessor\n    targets.forEach((target) => {\n      if (target.isIndexReference()) {\n        // setIfMissing do not apply to arrays, since Content Lake will reject nulls in arrays\n      } else if (target.isAttributeReference()) {\n        // setting a subproperty on a primitive value overwrites it, eg\n        // `{setIfMissing: {'address.street': 'California St'}}` on `{address: 'Fiction St'}` will\n        // result in `{address: {street: 'California St'}}`\n        if (result.containerType() === 'primitive') {\n          result = result.set({[target.name()]: this.value})\n        } else if (!result.hasAttribute(target.name())) {\n          result = accessor.setAttribute(target.name(), this.value)\n        }\n      } else {\n        throw new Error(`Unable to apply to target ${target.toString()}`)\n      }\n    })\n    return result\n  }\n}\n","import {type Expression} from '../jsonpath'\nimport {type ImmutableAccessor} from './ImmutableAccessor'\n\nexport class SetPatch {\n  id: string\n  path: string\n  value: unknown\n\n  constructor(id: string, path: string, value: unknown) {\n    this.id = id\n    this.path = path\n    this.value = value\n  }\n\n  apply(targets: Expression[], accessor: ImmutableAccessor): ImmutableAccessor {\n    let result = accessor\n    targets.forEach((target) => {\n      if (target.isSelfReference()) {\n        result = result.set(this.value)\n      } else if (target.isIndexReference()) {\n        target.toIndicies(accessor).forEach((i) => {\n          result = result.setIndex(i, this.value)\n        })\n      } else if (target.isAttributeReference()) {\n        // setting a subproperty on a primitive value overwrites it, eg\n        // `{set: {'address.street': 'California St'}}` on `{address: 'Fiction St'}` will result in\n        // `{address: {street: 'California St'}}`\n        if (result.containerType() === 'primitive') {\n          result = result.set({[target.name()]: this.value})\n        } else {\n          result = result.setAttribute(target.name(), this.value)\n        }\n      } else {\n        throw new Error(`Unable to apply to target ${target.toString()}`)\n      }\n    })\n    return result\n  }\n}\n","import {type Expression} from '../jsonpath'\nimport {type ImmutableAccessor} from './ImmutableAccessor'\nimport {targetsToIndicies} from './util'\n\nexport class UnsetPatch {\n  id: string\n  path: string\n  value: unknown\n\n  constructor(id: string, path: string) {\n    this.id = id\n    this.path = path\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  apply(targets: Expression[], accessor: ImmutableAccessor): ImmutableAccessor {\n    let result = accessor\n    switch (accessor.containerType()) {\n      case 'array':\n        result = result.unsetIndices(targetsToIndicies(targets, accessor))\n        break\n      case 'object':\n        targets.forEach((target) => {\n          result = result.unsetAttribute(target.name())\n        })\n        break\n      default:\n        throw new Error(\n          'Target value is neither indexable or an object. This error should potentially just be silently ignored?',\n        )\n    }\n    return result\n  }\n}\n","import {DiffMatchPatch} from './DiffMatchPatch'\nimport {IncPatch} from './IncPatch'\nimport {InsertPatch} from './InsertPatch'\nimport {SetIfMissingPatch} from './SetIfMissingPatch'\nimport {SetPatch} from './SetPatch'\nimport {type PatchTypes, type SingleDocumentPatch} from './types'\nimport {UnsetPatch} from './UnsetPatch'\n\n// Parses a content lake patch into our own personal patch implementations\nexport function parsePatch(patch: SingleDocumentPatch | SingleDocumentPatch[]): PatchTypes[] {\n  const result: PatchTypes[] = []\n  if (Array.isArray(patch)) {\n    return patch.reduce((r, p) => r.concat(parsePatch(p)), result)\n  }\n\n  const {set, setIfMissing, unset, diffMatchPatch, inc, dec, insert} = patch\n  if (setIfMissing) {\n    Object.keys(setIfMissing).forEach((path) => {\n      result.push(new SetIfMissingPatch(patch.id, path, setIfMissing[path]))\n    })\n  }\n\n  if (set) {\n    Object.keys(set).forEach((path) => {\n      result.push(new SetPatch(patch.id, path, set[path]))\n    })\n  }\n\n  if (unset) {\n    unset.forEach((path) => {\n      result.push(new UnsetPatch(patch.id, path))\n    })\n  }\n\n  if (diffMatchPatch) {\n    Object.keys(diffMatchPatch).forEach((path) => {\n      result.push(new DiffMatchPatch(patch.id, path, diffMatchPatch[path]))\n    })\n  }\n\n  if (inc) {\n    Object.keys(inc).forEach((path) => {\n      result.push(new IncPatch(patch.id, path, inc[path]))\n    })\n  }\n\n  if (dec) {\n    Object.keys(dec).forEach((path) => {\n      result.push(new IncPatch(patch.id, path, -dec[path]))\n    })\n  }\n\n  if (insert) {\n    let location: string\n    let path: string\n    const spec = insert\n    if ('before' in spec) {\n      location = 'before'\n      path = spec.before\n    } else if ('after' in spec) {\n      location = 'after'\n      path = spec.after\n    } else if ('replace' in spec) {\n      location = 'replace'\n      path = spec.replace\n    } else {\n      throw new Error('Invalid insert patch')\n    }\n\n    result.push(new InsertPatch(patch.id, location, path, spec.items))\n  }\n\n  return result\n}\n","import {type Doc} from '../document/types'\nimport {Matcher} from '../jsonpath'\nimport {ImmutableAccessor} from './ImmutableAccessor'\nimport {parsePatch} from './parse'\nimport {SetIfMissingPatch} from './SetIfMissingPatch'\nimport {SetPatch} from './SetPatch'\nimport {type PatchTypes, type SingleDocumentPatch} from './types'\n\nexport interface Patch {\n  id: string\n  path: string\n}\n\nexport class Patcher {\n  patches: PatchTypes[]\n\n  constructor(patch: SingleDocumentPatch | SingleDocumentPatch[]) {\n    this.patches = parsePatch(patch)\n  }\n\n  apply(value: Doc | null): unknown {\n    // Apply just makes a root accessor around the provided\n    // value, then applies the patches. Due to the use of\n    // ImmutableAccessor it is guaranteed to return either the\n    // exact same object it was provided (in the case of no changes),\n    // or a completely new object. It will never mutate the object in place.\n    const accessor = new ImmutableAccessor(value)\n    return this.applyViaAccessor(accessor).get()\n  }\n\n  // If you want to use your own accessor implementation, you can use this method\n  // to invoke the patcher. Since all subsequent accessors for children of this accessor\n  // are obtained through the methods in the accessors, you retain full control of the\n  // implementation throguhgout the application. Have a look in ImmutableAccessor\n  // to see an example of how accessors are implemented.\n  applyViaAccessor(accessor: ImmutableAccessor): ImmutableAccessor {\n    let result = accessor\n    const idAccessor = accessor.getAttribute('_id')\n    if (!idAccessor) {\n      throw new Error('Cannot apply patch to document with no _id')\n    }\n\n    const id = idAccessor.get()\n    for (const patch of this.patches) {\n      if (patch.id !== id) {\n        // Ignore patches that are not targetted at this document\n        continue\n      }\n\n      const matcher = Matcher.fromPath(patch.path).setPayload(patch)\n      result = process(matcher, result)\n    }\n\n    return result\n  }\n}\n\n// Recursively (depth first) follows any leads generated by the matcher, expecting\n// a patch to be the payload. When matchers report a delivery, the\n// apply(targets, accessor) is called on the patch\nfunction process(matcher: Matcher, accessor: ImmutableAccessor) {\n  const isSetPatch =\n    matcher.payload instanceof SetPatch || matcher.payload instanceof SetIfMissingPatch\n\n  let result = accessor\n  // Every time we execute the matcher a new set of leads is generated. Each lead\n  // is a target (being an index, an attribute name or a range) in the form of an\n  // Expression instance. For each lead target there is also a matcher. Our job is to obtain\n  // accessor(s) for each target (there might be more than one, since the targets may\n  // be ranges) and run the provided matcher on those accessors.\n  const {leads, delivery} = matcher.match(accessor)\n  leads.forEach((lead) => {\n    if (lead.target.isIndexReference()) {\n      lead.target.toIndicies().forEach((i) => {\n        const item = result.getIndex(i)\n        if (!item) {\n          throw new Error('Index out of bounds')\n        }\n\n        result = result.setIndexAccessor(i, process(lead.matcher, item))\n      })\n    } else if (lead.target.isAttributeReference()) {\n      // `set`/`setIfMissing` on a primitive value overwrites it\n      if (isSetPatch && result.containerType() === 'primitive') {\n        result = result.set({})\n      }\n\n      let oldValueAccessor = result.getAttribute(lead.target.name())\n\n      // If the patch is a set/setIfMissing patch, we allow deeply setting properties,\n      // creating missing segments as we go.\n      if (!oldValueAccessor && isSetPatch) {\n        result = result.setAttribute(lead.target.name(), {})\n        oldValueAccessor = result.getAttribute(lead.target.name())\n      }\n\n      if (!oldValueAccessor) {\n        // Don't follow lead, no such attribute\n        return\n      }\n\n      const newValueAccessor = process(lead.matcher, oldValueAccessor)\n      if (oldValueAccessor !== newValueAccessor) {\n        result = result.setAttributeAccessor(lead.target.name(), newValueAccessor)\n      }\n    } else {\n      throw new Error(`Unable to handle target ${lead.target.toString()}`)\n    }\n  })\n\n  // Each time we run the matcher, we might also get a delivery. This means that a\n  // term in the jsonpath terminated here and the patch should be applied. The delivery\n  // arrives in the form of an array of targets and a payload (which in this application\n  // is the patch). Conveniently the patches accept an array of targets and an accessor\n  // to do its work, so here we just pass those to the patch and we're done.\n  if (delivery && isPatcher(delivery.payload)) {\n    const patch = delivery.payload\n    result = patch.apply(delivery.targets, result)\n  }\n\n  return result\n}\n\nfunction isPatcher(payload: unknown): payload is PatchTypes {\n  return Boolean(\n    payload &&\n      typeof payload === 'object' &&\n      payload !== null &&\n      'apply' in payload &&\n      typeof (payload as PatchTypes).apply === 'function',\n  )\n}\n","import {uuid} from '@sanity/uuid'\n\n/**\n * Locally unique id's. We use this to generate transaction ids, and they don't have to be\n * cryptographically unique, as the worst that can happen is that they get rejected because\n * of a collision, and then we should just retry with a new id.\n */\nexport const luid: typeof uuid = uuid\n","import {Patcher} from '../patch'\nimport {debug} from './debug'\nimport {luid} from './luid'\nimport {type Doc, type Mut} from './types'\n\n/**\n * Parameters attached to the mutation\n *\n * @internal\n */\nexport interface MutationParams {\n  transactionId?: string\n  transition?: string\n  identity?: string\n  previousRev?: string\n  resultRev?: string\n  mutations: Mut[]\n  timestamp?: string\n  effects?: {apply: unknown; revert: unknown}\n}\n\n/**\n * A mutation describing a number of operations on a single document.\n * This should be considered an immutable structure. Mutations are compiled\n * on first application, and any changes in properties will not effectively\n * change its behavior after that.\n *\n * @internal\n */\nexport class Mutation {\n  params: MutationParams\n\n  compiled?: (doc: Doc | null) => Doc | null\n\n  _appliesToMissingDocument: boolean | undefined\n\n  constructor(options: MutationParams) {\n    this.params = options\n  }\n\n  get transactionId(): string | undefined {\n    return this.params.transactionId\n  }\n\n  get transition(): string | undefined {\n    return this.params.transition\n  }\n\n  get identity(): string | undefined {\n    return this.params.identity\n  }\n\n  get previousRev(): string | undefined {\n    return this.params.previousRev\n  }\n\n  get resultRev(): string | undefined {\n    return this.params.resultRev\n  }\n\n  get mutations(): Mut[] {\n    return this.params.mutations\n  }\n\n  get timestamp(): Date | undefined {\n    if (typeof this.params.timestamp === 'string') {\n      return new Date(this.params.timestamp)\n    }\n\n    return undefined\n  }\n\n  get effects():\n    | {\n        apply: unknown\n        revert: unknown\n      }\n    | undefined {\n    return this.params.effects\n  }\n\n  assignRandomTransactionId(): void {\n    this.params.transactionId = luid()\n    this.params.resultRev = this.params.transactionId\n  }\n\n  appliesToMissingDocument(): boolean {\n    if (typeof this._appliesToMissingDocument !== 'undefined') {\n      return this._appliesToMissingDocument\n    }\n\n    // Only mutations starting with a create operation apply to documents that do not exist ...\n    const firstMut = this.mutations[0]\n    if (firstMut) {\n      this._appliesToMissingDocument = Boolean(\n        firstMut.create || firstMut.createIfNotExists || firstMut.createOrReplace,\n      )\n    } else {\n      this._appliesToMissingDocument = true\n    }\n\n    return this._appliesToMissingDocument\n  }\n\n  // Compiles all mutations into a handy function\n  compile(): void {\n    const operations: ((doc: Doc | null) => Doc | null)[] = []\n\n    // creation requires a _createdAt\n    const getGuaranteedCreatedAt = (doc: Doc): string =>\n      doc?._createdAt || this.params.timestamp || new Date().toISOString()\n\n    this.mutations.forEach((mutation) => {\n      if (mutation.create) {\n        // TODO: Fail entire patch if document did exist\n        const create = (mutation.create || {}) as Doc\n        operations.push((doc): Doc => {\n          if (doc) {\n            return doc\n          }\n\n          return Object.assign(create, {\n            _createdAt: getGuaranteedCreatedAt(create),\n          })\n        })\n        return\n      }\n\n      if (mutation.createIfNotExists) {\n        const createIfNotExists = mutation.createIfNotExists || {}\n        operations.push((doc) =>\n          doc === null\n            ? Object.assign(createIfNotExists, {\n                _createdAt: getGuaranteedCreatedAt(createIfNotExists),\n              })\n            : doc,\n        )\n        return\n      }\n\n      if (mutation.createOrReplace) {\n        const createOrReplace = mutation.createOrReplace || {}\n        operations.push(() =>\n          Object.assign(createOrReplace, {\n            _createdAt: getGuaranteedCreatedAt(createOrReplace),\n          }),\n        )\n        return\n      }\n\n      if (mutation.delete) {\n        operations.push(() => null)\n        return\n      }\n\n      if (mutation.patch) {\n        if ('query' in mutation.patch) {\n          // @todo Warn/throw? Investigate if this can ever happen\n          return\n        }\n\n        const patch = new Patcher(mutation.patch)\n        operations.push((doc) => patch.apply(doc) as Doc | null)\n        return\n      }\n\n      throw new Error(`Unsupported mutation ${JSON.stringify(mutation, null, 2)}`)\n    })\n\n    // Assign `_updatedAt` to the timestamp of the mutation if set\n    if (typeof this.params.timestamp === 'string') {\n      operations.push((doc) => {\n        return doc ? Object.assign(doc, {_updatedAt: this.params.timestamp}) : null\n      })\n    }\n\n    const prevRev = this.previousRev\n    const rev = this.resultRev || this.transactionId\n    this.compiled = (doc: Doc | null) => {\n      if (prevRev && doc && prevRev !== doc._rev) {\n        throw new Error(\n          `Previous revision for this mutation was ${prevRev}, but the document revision is ${doc._rev}`,\n        )\n      }\n\n      let result: Doc | null = doc\n      for (const operation of operations) {\n        result = operation(result)\n      }\n\n      // Should update _rev?\n      if (result && rev) {\n        // Ensure that result is a unique object, even if the operation was a no-op\n        if (result === doc) {\n          result = Object.assign({}, doc)\n        }\n        result._rev = rev\n      }\n\n      return result\n    }\n  }\n\n  apply(document: Doc | null): Doc | null {\n    debug('Applying mutation %O to document %O', this.mutations, document)\n    if (!this.compiled) {\n      this.compile()\n    }\n\n    const result = this.compiled!(document)\n    debug('  => %O', result)\n    return result\n  }\n\n  static applyAll(document: Doc | null, mutations: Mutation[]): Doc | null {\n    return mutations.reduce((doc, mutation) => mutation.apply(doc), document)\n  }\n\n  // Given a number of yet-to-be-committed mutation objects, collects them into one big mutation\n  // any metadata like transactionId is ignored and must be submitted by the client. It is assumed\n  // that all mutations are on the same document.\n  // TOOO: Optimize mutations, eliminating mutations that overwrite themselves!\n  static squash(document: Doc | null, mutations: Mutation[]): Mutation {\n    const squashed = mutations.reduce(\n      (result, mutation) => result.concat(...mutation.mutations),\n      [] as Mut[],\n    )\n    return new Mutation({mutations: squashed})\n  }\n}\n","// TODO: When we have timestamps on mutation notifications, we can reject incoming mutations that are older\n// than the document we are seeing.\n\nimport {isEqual} from 'lodash'\n\nimport {debug} from './debug'\nimport {Mutation} from './Mutation'\nimport {type Doc} from './types'\n\n/**\n * @internal\n */\nexport interface SubmissionResponder {\n  success: () => void\n  failure: () => void\n}\n\n/**\n * Models a document as it is changed by our own local patches and remote patches coming in from\n * the server. Consolidates incoming patches with our own submitted patches and maintains two\n * versions of the document. EDGE is the optimistic document that the user sees that will always\n * immediately reflect whatever she is doing to it, and HEAD which is the confirmed version of the\n * document consistent with the mutations we have received from the server. As long as nothing out of\n * the ordinary happens, we can track all changes by hooking into the onMutation callback, but we\n * must also respect onRebase events that fire when we have to backtrack because one of our optimistically\n * applied patches were rejected, or some bastard was able to slip a mutation in between ours own.\n *\n * @internal\n */\nexport class Document {\n  /**\n   * Incoming patches from the server waiting to be applied to HEAD\n   */\n  incoming: Mutation[] = []\n\n  /**\n   * Patches we know has been subitted to the server, but has not been seen yet in the return channel\n   * so we can't be sure about the ordering yet (someone else might have slipped something between them)\n   */\n  submitted: Mutation[] = []\n\n  /**\n   * Pending mutations\n   */\n  pending: Mutation[] = []\n\n  /**\n   * Our model of the document according to the incoming patches from the server\n   */\n  HEAD: Doc | null\n\n  /**\n   * Our optimistic model of what the document will probably look like as soon as all our patches\n   * have been processed. Updated every time we stage a new mutation, but also might revert back\n   * to previous states if our mutations fail, or could change if unexpected mutations arrive\n   * between our own. The `onRebase` callback will be called when EDGE changes in this manner.\n   */\n  EDGE: Doc | null\n\n  /**\n   * Called with the EDGE document when that document changes for a reason other than us staging\n   * a new patch or receiving a mutation from the server while our EDGE is in sync with HEAD:\n   * I.e. when EDGE changes because the order of mutations has changed in relation to our\n   * optimistic predictions.\n   */\n  onRebase?: (edge: Doc | null, incomingMutations: Mutation[], pendingMutations: Mutation[]) => void\n\n  /**\n   * Called when we receive a patch in the normal order of things, but the mutation is not ours\n   */\n  onMutation?: (msg: {mutation: Mutation; document: Doc | null; remote: boolean}) => void\n\n  /**\n   * Called when consistency state changes with the boolean value of the current consistency state\n   */\n  onConsistencyChanged?: (isConsistent: boolean) => void\n\n  /**\n   * Called whenever a new incoming mutation comes in. These are always ordered correctly.\n   */\n  onRemoteMutation?: (mut: Mutation) => void\n\n  /**\n   * We are consistent when there are no unresolved mutations of our own, and no un-applicable\n   * incoming mutations. When this has been going on for too long, and there has been a while\n   * since we staged a new mutation, it is time to reset your state.\n   */\n  inconsistentAt: Date | null = null\n\n  /**\n   * The last time we staged a patch of our own. If we have been inconsistent for a while, but it\n   * hasn't been long since we staged a new mutation, the reason is probably just because the user\n   * is typing or something.\n   *\n   * Should be used as a guard against resetting state for inconsistency reasons.\n   */\n  lastStagedAt: Date | null = null\n\n  constructor(doc: Doc | null) {\n    this.reset(doc)\n    this.HEAD = doc\n    this.EDGE = doc\n  }\n\n  // Reset the state of the Document, used to recover from unsavory states by reloading the document\n  reset(doc: Doc | null): void {\n    this.incoming = []\n    this.submitted = []\n    this.pending = []\n    this.inconsistentAt = null\n    this.HEAD = doc\n    this.EDGE = doc\n    this.considerIncoming()\n    this.updateConsistencyFlag()\n  }\n\n  // Call when a mutation arrives from Sanity\n  arrive(mutation: Mutation): void {\n    this.incoming.push(mutation)\n    this.considerIncoming()\n    this.updateConsistencyFlag()\n  }\n\n  // Call to signal that we are submitting a mutation. Returns a callback object with a\n  // success and failure handler that must be called according to the outcome of our\n  // submission.\n  stage(mutation: Mutation, silent?: boolean): SubmissionResponder {\n    if (!mutation.transactionId) {\n      throw new Error('Mutations _must_ have transactionId when submitted')\n    }\n    this.lastStagedAt = new Date()\n\n    debug('Staging mutation %s (pushed to pending)', mutation.transactionId)\n    this.pending.push(mutation)\n    this.EDGE = mutation.apply(this.EDGE)\n\n    if (this.onMutation && !silent) {\n      this.onMutation({\n        mutation,\n        document: this.EDGE,\n        remote: false,\n      })\n    }\n\n    const txnId = mutation.transactionId\n\n    this.updateConsistencyFlag()\n\n    return {\n      success: () => {\n        this.pendingSuccessfullySubmitted(txnId)\n        this.updateConsistencyFlag()\n      },\n      failure: () => {\n        this.pendingFailed(txnId)\n        this.updateConsistencyFlag()\n      },\n    }\n  }\n\n  // Call to check if everything is nice and quiet and there are no unresolved mutations.\n  // Means this model thinks both HEAD and EDGE is up to date with what the server sees.\n  isConsistent(): boolean {\n    return !this.inconsistentAt\n  }\n\n  // Private\n\n  // Attempts to apply any resolvable incoming patches to HEAD. Will keep patching as long as there\n  // are applicable patches to be applied\n  considerIncoming(): void {\n    let mustRebase = false\n    let nextMut: Mutation | undefined\n    const rebaseMutations: Mutation[] = []\n\n    // Filter mutations that are older than the document\n    if (this.HEAD && this.HEAD._updatedAt) {\n      const updatedAt = new Date(this.HEAD._updatedAt)\n      if (this.incoming.find((mut) => mut.timestamp && mut.timestamp < updatedAt)) {\n        this.incoming = this.incoming.filter((mut) => mut.timestamp && mut.timestamp < updatedAt)\n      }\n    }\n\n    // Keep applying mutations as long as any apply\n    let protect = 0\n    do {\n      // Find next mutation that can be applied to HEAD (if any)\n      if (this.HEAD) {\n        const HEAD = this.HEAD\n        nextMut = HEAD._rev ? this.incoming.find((mut) => mut.previousRev === HEAD._rev) : undefined\n      } else {\n        // When HEAD is null, that means the document is currently deleted. Only mutations that start with a create\n        // operation will be considered.\n        nextMut = this.incoming.find((mut) => mut.appliesToMissingDocument())\n      }\n\n      if (nextMut) {\n        const applied = this.applyIncoming(nextMut)\n        mustRebase = mustRebase || applied\n        if (mustRebase) {\n          rebaseMutations.push(nextMut)\n        }\n\n        if (protect++ > 10) {\n          throw new Error(\n            `Mutator stuck flushing incoming mutations. Probably stuck here: ${JSON.stringify(\n              nextMut,\n            )}`,\n          )\n        }\n      }\n    } while (nextMut)\n\n    if (this.incoming.length > 0 && debug.enabled) {\n      debug(\n        'Unable to apply mutations %s',\n        this.incoming.map((mut) => mut.transactionId).join(', '),\n      )\n    }\n\n    if (mustRebase) {\n      this.rebase(rebaseMutations)\n    }\n  }\n\n  // check current consistency state, update flag and invoke callback if needed\n  updateConsistencyFlag(): void {\n    const wasConsistent = this.isConsistent()\n    const isConsistent =\n      this.pending.length === 0 && this.submitted.length === 0 && this.incoming.length === 0\n    // Update the consistency state, taking care not to update the timestamp if we were inconsistent and still are\n    if (isConsistent) {\n      this.inconsistentAt = null\n    } else if (!this.inconsistentAt) {\n      this.inconsistentAt = new Date()\n    }\n    // Handle onConsistencyChanged callback\n    if (wasConsistent != isConsistent && this.onConsistencyChanged) {\n      if (isConsistent) {\n        debug('Buffered document is inconsistent')\n      } else {\n        debug('Buffered document is consistent')\n      }\n      this.onConsistencyChanged(isConsistent)\n    }\n  }\n\n  // apply an incoming patch that has been prequalified as the next in line for this document\n  applyIncoming(mut: Mutation | undefined): boolean {\n    if (!mut) {\n      return false\n    }\n\n    if (!mut.transactionId) {\n      throw new Error('Received incoming mutation without a transaction ID')\n    }\n\n    debug(\n      'Applying mutation %s -> %s to rev %s',\n      mut.previousRev,\n      mut.resultRev,\n      this.HEAD && this.HEAD._rev,\n    )\n\n    this.HEAD = mut.apply(this.HEAD)\n\n    if (this.onRemoteMutation) {\n      this.onRemoteMutation(mut)\n    }\n\n    // Eliminate from incoming set\n    this.incoming = this.incoming.filter((m) => m.transactionId !== mut.transactionId)\n\n    if (this.hasUnresolvedMutations()) {\n      const needRebase = this.consumeUnresolved(mut.transactionId)\n      if (debug.enabled) {\n        debug(\n          `Incoming mutation ${mut.transactionId} appeared while there were pending or submitted local mutations`,\n        )\n        debug(`Submitted txnIds: ${this.submitted.map((m) => m.transactionId).join(', ')}`)\n        debug(`Pending txnIds: ${this.pending.map((m) => m.transactionId).join(', ')}`)\n        debug(`needRebase === %s`, needRebase)\n      }\n      return needRebase\n    }\n    debug(\n      `Remote mutation %s arrived w/o any pending or submitted local mutations`,\n      mut.transactionId,\n    )\n    this.EDGE = this.HEAD\n    if (this.onMutation) {\n      this.onMutation({\n        mutation: mut,\n        document: this.EDGE,\n        remote: true,\n      })\n    }\n    return false\n  }\n\n  /**\n   * Returns true if there are unresolved mutations between HEAD and EDGE, meaning we have\n   * mutations that are still waiting to be either submitted, or to be confirmed by the server.\n   *\n   * @returns true if there are unresolved mutations between HEAD and EDGE, false otherwise\n   */\n  hasUnresolvedMutations(): boolean {\n    return this.submitted.length > 0 || this.pending.length > 0\n  }\n\n  /**\n   * When an incoming mutation is applied to HEAD, this is called to remove the mutation from\n   * the unresolved state. If the newly applied patch is the next upcoming unresolved mutation,\n   * no rebase is needed, but we might have the wrong idea about the ordering of mutations, so in\n   * that case we are given the flag `needRebase` to tell us that this mutation arrived out of\n   * order in terms of our optimistic version, so a rebase is needed.\n   *\n   * @param txnId - Transaction ID of the remote mutation\n   * @returns true if rebase is needed, false otherwise\n   */\n  consumeUnresolved(txnId: string): boolean {\n    // If we have nothing queued up, we are in sync and can apply patch with no\n    // rebasing\n    if (this.submitted.length === 0 && this.pending.length === 0) {\n      return false\n    }\n\n    // If we can consume the directly upcoming mutation, we won't have to rebase\n    if (this.submitted.length !== 0) {\n      if (this.submitted[0].transactionId === txnId) {\n        debug(\n          `Remote mutation %s matches upcoming submitted mutation, consumed from 'submitted' buffer`,\n          txnId,\n        )\n        this.submitted.shift()\n        return false\n      }\n    } else if (this.pending.length > 0 && this.pending[0].transactionId === txnId) {\n      // There are no submitted, but some are pending so let's check the upcoming pending\n      debug(\n        `Remote mutation %s matches upcoming pending mutation, consumed from 'pending' buffer`,\n        txnId,\n      )\n      this.pending.shift()\n      return false\n    }\n\n    debug(\n      'The mutation was not the upcoming mutation, scrubbing. Pending: %d, Submitted: %d',\n      this.pending.length,\n      this.submitted.length,\n    )\n\n    // The mutation was not the upcoming mutation, so we'll have to check everything to\n    // see if we have an out of order situation\n    this.submitted = this.submitted.filter((mut) => mut.transactionId !== txnId)\n    this.pending = this.pending.filter((mut) => mut.transactionId !== txnId)\n    debug(`After scrubbing: Pending: %d, Submitted: %d`, this.pending.length, this.submitted.length)\n\n    // Whether we had it or not we have either a reordering, or an unexpected mutation\n    // so must rebase\n    return true\n  }\n\n  pendingSuccessfullySubmitted(pendingTxnId: string): void {\n    if (this.pending.length === 0) {\n      // If there are no pending, it has probably arrived allready\n      return\n    }\n\n    const first = this.pending[0]\n    if (first.transactionId === pendingTxnId) {\n      // Nice, the pending transaction arrived in order\n      this.pending.shift()\n      this.submitted.push(first)\n      return\n    }\n\n    // Oh, no. Submitted out of order.\n    let justSubmitted: Mutation | undefined\n    const stillPending: Mutation[] = []\n    this.pending.forEach((mutation) => {\n      if (mutation.transactionId === pendingTxnId) {\n        justSubmitted = mutation\n        return\n      }\n\n      stillPending.push(mutation)\n    })\n\n    // Not found? Hopefully it has already arrived. Might have been forgotten by now\n    if (justSubmitted) {\n      this.submitted.push(justSubmitted)\n    }\n\n    this.pending = stillPending\n\n    // Must rebase since mutation order has changed\n    this.rebase([])\n  }\n\n  pendingFailed(pendingTxnId: string): void {\n    this.pending = this.pending.filter((mutation) => mutation.transactionId !== pendingTxnId)\n\n    // Rebase to revert document to what it looked like before the failed mutation\n    this.rebase([])\n  }\n\n  rebase(incomingMutations: Mutation[]): void {\n    const oldEdge = this.EDGE\n    this.EDGE = Mutation.applyAll(this.HEAD, this.submitted.concat(this.pending))\n\n    // Copy over rev, since we don't care if it changed, we only care about the content\n    if (oldEdge !== null && this.EDGE !== null) {\n      oldEdge._rev = this.EDGE._rev\n    }\n\n    const changed = !isEqual(this.EDGE, oldEdge)\n    if (changed && this.onRebase) {\n      this.onRebase(this.EDGE, incomingMutations, this.pending)\n    }\n  }\n}\n","import {makePatches, stringifyPatches} from '@sanity/diff-match-patch'\n\nimport {arrayToJSONMatchPath} from '../jsonpath/arrayToJSONMatchPath'\nimport {extractWithPath} from '../jsonpath/extractWithPath'\nimport {debug} from './debug'\nimport {Mutation} from './Mutation'\nimport {type Doc, type Mut} from './types'\n\n/**\n * Implements a buffer for mutations that incrementally optimises the mutations by\n * eliminating set-operations that overwrite earlier set-operations, and rewrite\n * set-operations that change strings into other strings into diffMatchPatch operations.\n *\n * @internal\n */\nexport class SquashingBuffer {\n  /**\n   * The document forming the basis of this squash\n   */\n  BASIS: Doc | null\n\n  /**\n   * The document after the out-Mutation has been applied, but before the staged\n   * operations are committed.\n   */\n  PRESTAGE: Doc | null\n\n  /**\n   * setOperations contain the latest set operation by path. If the set-operations are\n   * updating strings to new strings, they are rewritten as diffMatchPatch operations,\n   * any new set operations on the same paths overwrites any older set operations.\n   * Only set-operations assigning plain values to plain values gets optimized like this.\n   */\n  setOperations: Record<string, Mut | undefined>\n\n  /**\n   * `documentPresent` is true whenever we know that the document must be present due\n   * to preceeding mutations. `false` implies that it may or may not already exist.\n   */\n  documentPresent: boolean\n\n  /**\n   * The operations in the out-Mutation are not able to be optimized any further\n   */\n  out: Mut[] = []\n\n  /**\n   * Staged mutation operations\n   */\n  staged: Mut[]\n\n  constructor(doc: Doc | null) {\n    if (doc) {\n      debug('Reset mutation buffer to rev %s', doc._rev)\n    } else {\n      debug('Reset mutation buffer state to document being deleted')\n    }\n\n    this.staged = []\n    this.setOperations = {}\n    this.documentPresent = false\n\n    this.BASIS = doc\n    this.PRESTAGE = doc\n  }\n\n  add(mut: Mutation): void {\n    mut.mutations.forEach((op) => this.addOperation(op))\n  }\n\n  hasChanges(): boolean {\n    return this.out.length > 0 || Object.keys(this.setOperations).length > 0\n  }\n\n  /**\n   * Extracts the mutations in this buffer.\n   * After this is done, the buffer lifecycle is over and the client should\n   * create an new one with the new, updated BASIS.\n   *\n   * @param txnId - Transaction ID\n   * @returns A `Mutation` instance if we had outgoing mutations pending, null otherwise\n   */\n  purge(txnId?: string): Mutation | null {\n    this.stashStagedOperations()\n    let result = null\n    if (this.out.length > 0) {\n      debug('Purged mutation buffer')\n      result = new Mutation({\n        mutations: this.out,\n        resultRev: txnId,\n        transactionId: txnId,\n      })\n    }\n    this.out = []\n    this.documentPresent = false\n    return result\n  }\n\n  addOperation(op: Mut): void {\n    // Is this a set patch, and only a set patch, and does it apply to the document at hand?\n    if (\n      op.patch &&\n      op.patch.set &&\n      'id' in op.patch &&\n      op.patch.id === this.PRESTAGE?._id &&\n      Object.keys(op.patch).length === 2 // `id` + `set`\n    ) {\n      const setPatch = op.patch.set\n      const unoptimizable: Record<string, unknown> = {}\n      // Apply all optimisable keys in the patch\n      for (const path of Object.keys(setPatch)) {\n        if (setPatch.hasOwnProperty(path)) {\n          if (!this.optimiseSetOperation(path, setPatch[path])) {\n            // If not optimisable, add to unoptimizable set\n            unoptimizable[path] = setPatch[path]\n          }\n        }\n      }\n\n      // If any weren't optimisable, add them to an unoptimised set-operation, then\n      // stash everything.\n      if (Object.keys(unoptimizable).length > 0) {\n        debug('Unoptimizable set-operation detected, purging optimization buffer')\n        this.staged.push({patch: {id: this.PRESTAGE._id, set: unoptimizable}})\n        this.stashStagedOperations()\n      }\n\n      return\n    }\n\n    // Is this a createIfNotExists for our document?\n    if (op.createIfNotExists && this.PRESTAGE && op.createIfNotExists._id === this.PRESTAGE._id) {\n      if (!this.documentPresent) {\n        // If we don't know that it's present we'll have to stage and stash.\n        this.staged.push(op)\n        this.documentPresent = true\n        this.stashStagedOperations()\n      }\n\n      // Otherwise we can fully ignore it.\n      return\n    }\n\n    debug('Unoptimizable mutation detected, purging optimization buffer')\n    // console.log(\"Unoptimizable operation, stashing\", JSON.stringify(op))\n    // Un-optimisable operations causes everything to be stashed\n    this.staged.push(op)\n    this.stashStagedOperations()\n  }\n\n  /**\n   * Attempt to perform one single set operation in an optimised manner, return value\n   * reflects whether or not the operation could be performed.\n\n   * @param path - The JSONPath to the set operation in question\n   * @param nextValue - The value to be set\n   * @returns True of optimized, false otherwise\n   */\n  optimiseSetOperation(path: string, nextValue: unknown): boolean {\n    // console.log('optimiseSetOperation', path, nextValue)\n    // If target value is not a plain value, unable to optimise\n    if (typeof nextValue === 'object') {\n      // console.log(\"Not optimisable because next value is object\")\n      return false\n    }\n\n    // Check the source values, if there is more than one value being assigned,\n    // we won't optimise\n    const matches = extractWithPath(path, this.PRESTAGE)\n    // If we are not overwriting exactly one key, this cannot be optimised, so we bail\n    if (matches.length !== 1) {\n      // console.log('Not optimisable because match count is != 1', JSON.stringify(matches))\n      return false\n    }\n\n    // Okay, we are assigning exactly one value to exactly one existing slot, so we might optimise\n    const match = matches[0]\n    // If the value of the match is an array or object, we cannot safely optimise this since the meaning\n    // of pre-existing operations might change (in theory, at least), so we bail\n    if (typeof match.value === 'object') {\n      // console.log(\"Not optimisable because old value is object\")\n      return false\n    }\n\n    if (!this.PRESTAGE) {\n      // Shouldn't happen, but makes typescript happy\n      return false\n    }\n\n    // If the new and old value are the equal, we optimise this operation by discarding it\n    // Now, let's build the operation\n    let op: Mut | null = null\n    if (match.value === nextValue) {\n      // If new and old values are equal, we optimise this by deleting the operation\n      // console.log(\"Omitting operation\")\n      op = null\n    } else if (typeof match.value === 'string' && typeof nextValue === 'string') {\n      // console.log(\"Rewriting to dmp\")\n      // We are updating a string to another string, so we are making a diffMatchPatch\n      try {\n        const patch = stringifyPatches(makePatches(match.value, nextValue))\n        op = {patch: {id: this.PRESTAGE._id, diffMatchPatch: {[path]: patch}}}\n      } catch {\n        // patch_make failed due to unicode issue https://github.com/google/diff-match-patch/issues/59\n        return false\n      }\n    } else {\n      // console.log(\"Not able to rewrite to dmp, making normal set\")\n      // We are changing the type of the value, so must make a normal set-operation\n      op = {patch: {id: this.PRESTAGE._id, set: {[path]: nextValue}}}\n    }\n\n    // Let's make a plain, concrete path from the array-path. We use this to keep only the latest set\n    // operation touching this path in the buffer.\n    const canonicalPath = arrayToJSONMatchPath(match.path)\n\n    // Store this operation, overwriting any previous operations touching this same path\n    if (op) {\n      this.setOperations[canonicalPath] = op\n    } else {\n      delete this.setOperations[canonicalPath]\n    }\n\n    // Signal that we succeeded in optimizing this patch\n    return true\n  }\n\n  stashStagedOperations(): void {\n    // Short circuit if there are no staged operations\n    const nextOps: Mut[] = []\n\n    // Extract the existing outgoing operations if any\n    Object.keys(this.setOperations).forEach((key) => {\n      const op = this.setOperations[key]\n      if (op) {\n        nextOps.push(op)\n      }\n    })\n\n    nextOps.push(...this.staged)\n    if (nextOps.length > 0) {\n      this.PRESTAGE = new Mutation({mutations: nextOps}).apply(this.PRESTAGE) as Doc\n      this.staged = []\n      this.setOperations = {}\n    }\n\n    this.out.push(...nextOps)\n  }\n\n  /**\n   * Rebases given the new base-document\n   *\n   * @param newBasis - New base document to rebase on\n   * @returns New \"edge\" document with buffered changes integrated\n   */\n  rebase(newBasis: Doc | null): Doc | null {\n    this.stashStagedOperations()\n\n    if (newBasis === null) {\n      // If document was just deleted, we must throw out local changes\n      this.out = []\n      this.BASIS = newBasis\n      this.PRESTAGE = newBasis\n      this.documentPresent = false\n    } else {\n      this.BASIS = newBasis\n\n      // @todo was this supposed to be `this.out.length > 0`?\n      // surely this is always `true`?\n      if (this.out) {\n        this.PRESTAGE = new Mutation({mutations: this.out}).apply(this.BASIS) as Doc\n      } else {\n        this.PRESTAGE = this.BASIS\n      }\n    }\n\n    return this.PRESTAGE\n  }\n}\n","import {isEqual} from 'lodash'\n\nimport {debug} from './debug'\nimport {Document} from './Document'\nimport {Mutation} from './Mutation'\nimport {SquashingBuffer} from './SquashingBuffer'\nimport {type Doc, type Mut} from './types'\n\nconst ONE_MINUTE = 1000 * 60\n\n/**\n * @internal\n */\nexport interface CommitHandlerMessage {\n  mutation: Mutation\n  success: () => void\n  failure: () => void\n  cancel: (error: Error) => void\n}\n\n/**\n * A wrapper for Document that allows the client to gather mutations on the\n * client side and commit them when it wants to.\n */\nclass Commit {\n  mutations: Mutation[]\n  tries: number\n  resolve: () => void\n  reject: (error: Error) => void\n\n  constructor(\n    mutations: Mutation[],\n    {resolve, reject}: {resolve: () => void; reject: (error: Error) => void},\n  ) {\n    this.mutations = mutations\n    this.tries = 0\n    this.resolve = resolve\n    this.reject = reject\n  }\n\n  apply(doc: Doc | null): Doc | null {\n    return Mutation.applyAll(doc, this.mutations)\n  }\n\n  squash(doc: Doc | null) {\n    const result = Mutation.squash(doc, this.mutations)\n    result.assignRandomTransactionId()\n    return result\n  }\n}\n\nconst mutReducerFn = (acc: Mut[], mut: Mutation): Mut[] => acc.concat(mut.mutations)\n\n/**\n * @internal\n */\nexport class BufferedDocument {\n  private mutations: Mutation[]\n\n  /**\n   * The Document we are wrapping\n   */\n  document: Document\n\n  /**\n   * The Document with local changes applied\n   */\n  LOCAL: Doc | null\n\n  /**\n   * Commits that are waiting to be delivered to the server\n   */\n  private commits: Commit[]\n\n  /**\n   * Local mutations that are not scheduled to be committed yet\n   */\n  buffer: SquashingBuffer\n\n  /**\n   * Assignable event handler for when the buffered document applies a mutation\n   */\n  onMutation?: (message: {mutation: Mutation; document: Doc | null; remote: boolean}) => void\n\n  /**\n   * Assignable event handler for when a remote mutation happened\n   */\n  onRemoteMutation?: Document['onRemoteMutation']\n\n  /**\n   * Assignable event handler for when the buffered document rebased\n   */\n  onRebase?: (localDoc: Doc | null, remoteMutations: Mut[], localMutations: Mut[]) => void\n\n  /**\n   * Assignable event handler for when the document is deleted\n   */\n  onDelete?: (doc: Doc | null) => void\n\n  /**\n   * Assignable event handler for when the state of consistency changed\n   */\n  onConsistencyChanged?: (isConsistent: boolean) => void\n\n  /**\n   * Assignable event handler for when the buffered document should commit changes\n   */\n  commitHandler?: (msg: CommitHandlerMessage) => void\n\n  /**\n   * Whether or not we are currently commiting\n   */\n  committerRunning = false\n\n  constructor(doc: Doc | null) {\n    this.buffer = new SquashingBuffer(doc)\n    this.document = new Document(doc)\n    this.document.onMutation = (msg) => this.handleDocMutation(msg)\n    this.document.onRemoteMutation = (mut) => this.onRemoteMutation && this.onRemoteMutation(mut)\n    this.document.onRebase = (edge, remoteMutations, localMutations) =>\n      this.handleDocRebase(edge, remoteMutations, localMutations)\n    this.document.onConsistencyChanged = (msg) => this.handleDocConsistencyChanged(msg)\n    this.LOCAL = doc\n    this.mutations = []\n    this.commits = []\n  }\n\n  // Used to reset the state of the local document model. If the model has been inconsistent\n  // for too long, it has probably missed a notification, and should reload the document from the server\n  reset(doc: Doc | null): void {\n    if (doc) {\n      debug('Document state reset to revision %s', doc._rev)\n    } else {\n      debug('Document state reset to being deleted')\n    }\n    this.document.reset(doc)\n    this.rebase([], [])\n    this.handleDocConsistencyChanged(this.document.isConsistent())\n  }\n\n  // Add a change to the buffer\n  add(mutation: Mutation): void {\n    if (this.onConsistencyChanged) {\n      this.onConsistencyChanged(false)\n    }\n    debug('Staged local mutation')\n    this.buffer.add(mutation)\n    const oldLocal = this.LOCAL\n    this.LOCAL = mutation.apply(this.LOCAL)\n    if (this.onMutation && oldLocal !== this.LOCAL) {\n      debug('onMutation fired')\n      this.onMutation({\n        mutation,\n        document: this.LOCAL,\n        remote: false,\n      })\n      if (this.LOCAL === null && this.onDelete) {\n        this.onDelete(this.LOCAL)\n      }\n    }\n  }\n\n  // Call when a mutation arrives from Sanity\n  arrive(mutation: Mutation): void {\n    debug('Remote mutation arrived %s -> %s', mutation.previousRev, mutation.resultRev)\n    if (mutation.previousRev === mutation.resultRev) {\n      throw new Error(\n        `Mutation ${mutation.transactionId} has previousRev === resultRev (${mutation.previousRev})`,\n      )\n    }\n    return this.document.arrive(mutation)\n  }\n\n  // Submit all mutations in the buffer to be committed\n  commit(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      // Anything to commit?\n      if (!this.buffer.hasChanges()) {\n        resolve()\n        return\n      }\n      debug('Committing local changes')\n      // Collect current staged mutations into a commit and ...\n      const pendingMutations = this.buffer.purge()\n      this.commits.push(new Commit(pendingMutations ? [pendingMutations] : [], {resolve, reject}))\n      // ... clear the table for the next commit.\n      this.buffer = new SquashingBuffer(this.LOCAL)\n      this.performCommits()\n    })\n  }\n\n  // Starts the committer that will try to committ all staged commits to the database\n  // by calling the commitHandler. Will keep running until all commits are successfully\n  // committed.\n  performCommits(): void {\n    if (!this.commitHandler) {\n      throw new Error('No commitHandler configured for this BufferedDocument')\n    }\n    if (this.committerRunning) {\n      // We can have only one committer at any given time\n      return\n    }\n    this._cycleCommitter()\n  }\n\n  // TODO: Error handling, right now retries after every error\n  _cycleCommitter(): void {\n    const commit = this.commits.shift()\n    if (!commit) {\n      this.committerRunning = false\n      return\n    }\n\n    this.committerRunning = true\n    const squashed = commit.squash(this.LOCAL)\n    const docResponder = this.document.stage(squashed, true)\n\n    const responder = {\n      success: () => {\n        debug('Commit succeeded')\n        docResponder.success()\n        commit.resolve()\n        // Keep running the committer until no more commits\n        this._cycleCommitter()\n      },\n\n      failure: () => {\n        debug('Commit failed')\n        // Re stage commit\n        commit.tries += 1\n        if (this.LOCAL !== null) {\n          // Only schedule this commit for a retry of the document still exist to avoid looping\n          // indefinitely when the document was deleted from under our noses\n          this.commits.unshift(commit)\n        }\n        docResponder.failure()\n\n        // Todo: Need better error handling (i.e. propagate to user and provide means of retrying)\n        if (commit.tries < 200) {\n          setTimeout(() => this._cycleCommitter(), Math.min(commit.tries * 1000, ONE_MINUTE))\n        }\n      },\n\n      cancel: (error: Error) => {\n        this.commits.forEach((comm) => comm.reject(error))\n\n        // Throw away waiting commits\n        this.commits = []\n\n        // Reset back to last known state from content lake and cause a rebase that will\n        // reset the view in the form\n        this.reset(this.document.HEAD)\n\n        // Clear the buffer of recent mutations\n        this.buffer = new SquashingBuffer(this.LOCAL)\n\n        // Stop the committer loop\n        this.committerRunning = false\n      },\n    }\n\n    debug('Posting commit')\n    if (this.commitHandler) {\n      this.commitHandler({\n        mutation: squashed,\n        success: responder.success,\n        failure: responder.failure,\n        cancel: responder.cancel,\n      })\n    }\n  }\n\n  handleDocRebase(edge: Doc | null, remoteMutations: Mutation[], localMutations: Mutation[]): void {\n    this.rebase(remoteMutations, localMutations)\n  }\n\n  handleDocumentDeleted(): void {\n    debug('Document deleted')\n    // If the document was just deleted, fire the onDelete event with the absolutely latest\n    // version of the document before someone deleted it so that the client may revive the\n    // document in the last state the user saw it, should they so desire.\n    if (this.LOCAL !== null && this.onDelete) {\n      this.onDelete(this.LOCAL)\n    }\n\n    this.commits = []\n    this.mutations = []\n  }\n\n  handleDocMutation(msg: {mutation: Mutation; document: Doc | null; remote: boolean}): void {\n    // If we have no local changes, we can just pass this on to the client\n    if (this.commits.length === 0 && !this.buffer.hasChanges()) {\n      debug('Document mutated from remote with no local changes')\n      this.LOCAL = this.document.EDGE\n      this.buffer = new SquashingBuffer(this.LOCAL)\n      if (this.onMutation) {\n        this.onMutation(msg)\n      }\n      return\n    }\n\n    debug('Document mutated from remote with local changes')\n\n    // If there are local edits, and the document was deleted, we need to purge those local edits now\n    if (this.document.EDGE === null) {\n      this.handleDocumentDeleted()\n    }\n\n    // We had local changes, so need to signal rebase\n    this.rebase([msg.mutation], [])\n  }\n\n  rebase(remoteMutations: Mutation[], localMutations: Mutation[]): void {\n    debug('Rebasing document')\n    if (this.document.EDGE === null) {\n      this.handleDocumentDeleted()\n    }\n\n    const oldLocal = this.LOCAL\n    this.LOCAL = this.commits.reduce((doc, commit) => commit.apply(doc), this.document.EDGE)\n    this.LOCAL = this.buffer.rebase(this.LOCAL)\n\n    // Copy over rev, since we don't care if it changed, we only care about the content\n    if (oldLocal !== null && this.LOCAL !== null) {\n      oldLocal._rev = this.LOCAL._rev\n    }\n\n    const changed = !isEqual(this.LOCAL, oldLocal)\n    if (changed && this.onRebase) {\n      this.onRebase(\n        this.LOCAL,\n        remoteMutations.reduce(mutReducerFn, []),\n        localMutations.reduce(mutReducerFn, []),\n      )\n    }\n  }\n\n  handleDocConsistencyChanged(isConsistent: boolean): void {\n    if (!this.onConsistencyChanged) {\n      return\n    }\n\n    const hasLocalChanges = this.commits.length > 0 || this.buffer.hasChanges()\n\n    if (isConsistent && !hasLocalChanges) {\n      this.onConsistencyChanged(true)\n    }\n\n    if (!isConsistent) {\n      this.onConsistencyChanged(false)\n    }\n  }\n}\n"],"names":["isRecord","descend","lhs","rhs","parsePatch"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],"debugId":null}},
    {"offset": {"line": 8350, "column": 0}, "map": {"version":3,"file":"index.mjs","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff/src/helpers.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff/src/calculate/lcs.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff/src/calculate/diffArray.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff/src/calculate/diffObject.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff/src/calculate/diffSimple.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff/src/calculate/diffString.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff/src/calculate/diffTypeChange.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff/src/calculate/diffInput.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff/src/inputWrappers/array.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff/src/inputWrappers/basic.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff/src/inputWrappers/object.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff/src/inputWrappers/string.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff/src/inputWrappers/index.ts"],"sourcesContent":["export function replaceProperty<P, V extends P[K], K extends keyof P>(\n  parent: P,\n  prop: K,\n  value: V,\n): V {\n  delete parent[prop]\n  parent[prop] = value\n  return value\n}\n","/*\n * Longest common subsequence implementation, for diffing arrays\n * Reference: http://en.wikipedia.org/wiki/Longest_common_subsequence_problem\n */\n\ntype NumberArray = number[]\ntype LengthMatrix = NumberArray[]\ntype Subsequence<E> = {\n  sequence: E[]\n  prevIndices: number[]\n  nextIndices: number[]\n}\n\nexport function getLongestCommonSubsequence<E>(previous: E[], next: E[]): Subsequence<E> {\n  const matrix = getLengthMatrix(previous, next)\n  const result = backtrack(matrix, previous, next)\n  return result\n}\n\nfunction getLengthMatrix<E>(previous: E[], next: E[]): LengthMatrix {\n  const len1 = previous.length\n  const len2 = next.length\n  let x = 0\n  let y = 0\n\n  // initialize empty matrix of len1+1 x len2+1\n  const matrix: LengthMatrix = new Array(len1 + 1)\n  for (x = 0; x < len1 + 1; x++) {\n    matrix[x] = [len2 + 1]\n    for (y = 0; y < len2 + 1; y++) {\n      matrix[x][y] = 0\n    }\n  }\n\n  // save sequence lengths for each coordinate\n  for (x = 1; x < len1 + 1; x++) {\n    for (y = 1; y < len2 + 1; y++) {\n      if (previous[x - 1] === next[y - 1]) {\n        matrix[x][y] = matrix[x - 1][y - 1] + 1\n      } else {\n        matrix[x][y] = Math.max(matrix[x - 1][y], matrix[x][y - 1])\n      }\n    }\n  }\n\n  return matrix\n}\n\nfunction backtrack<E>(matrix: LengthMatrix, previous: E[], next: E[]): Subsequence<E> {\n  let prevIndex = previous.length\n  let nextIndex = next.length\n  const subsequence: Subsequence<E> = {\n    sequence: [],\n    prevIndices: [],\n    nextIndices: [],\n  }\n\n  while (prevIndex !== 0 && nextIndex !== 0) {\n    const areEqual = previous[prevIndex - 1] === next[nextIndex - 1]\n    if (areEqual) {\n      subsequence.sequence.unshift(previous[prevIndex - 1])\n      subsequence.prevIndices.unshift(prevIndex - 1)\n      subsequence.nextIndices.unshift(nextIndex - 1)\n      --prevIndex\n      --nextIndex\n    } else {\n      const valueAtMatrixAbove = matrix[prevIndex][nextIndex - 1]\n      const valueAtMatrixLeft = matrix[prevIndex - 1][nextIndex]\n      if (valueAtMatrixAbove > valueAtMatrixLeft) {\n        --nextIndex\n      } else {\n        --prevIndex\n      }\n    }\n  }\n  return subsequence\n}\n","import {replaceProperty} from '../helpers'\nimport {type ArrayDiff, type ArrayInput, type DiffOptions, type ItemDiff} from '../types'\nimport {addedInput, diffInput, removedInput} from './diffInput'\nimport {getLongestCommonSubsequence} from './lcs'\n\nexport function diffArray<A>(\n  fromInput: ArrayInput<A>,\n  toInput: ArrayInput<A>,\n  options: DiffOptions,\n): ArrayDiff<A> {\n  if (fromInput === toInput) {\n    const fromValue = fromInput.value\n    const toValue = toInput.value\n\n    return {\n      type: 'array',\n      action: 'unchanged',\n      isChanged: false,\n      fromValue,\n      toValue,\n      get items(): ItemDiff<A>[] {\n        const items = diffExactByPosition(fromInput, toInput, options)\n        if (!items) throw new Error('invariant broken: equivalent input, but diff detected')\n        return replaceProperty(this, 'items', items)\n      },\n    }\n  }\n\n  // The key-ed approach should handle most cases (_key'ed objects, primitives):\n  const keyedA = indexByKey(fromInput)\n  const keyedB = indexByKey(toInput)\n\n  if (keyedA && keyedB) {\n    return diffArrayByKey(fromInput, keyedA, toInput, keyedB, options)\n  }\n\n  // Check if they are 100% equivalent:\n  const items = diffExactByPosition(fromInput, toInput, options)\n  if (items) return buildArrayDiff(fromInput, toInput, items, false)\n\n  // Otherwise we create a diff where we model it as removing the from-items and adding the to-items.\n  return diffArrayByReinsert(fromInput, toInput, options)\n}\n\nfunction buildArrayDiff<A>(\n  fromInput: ArrayInput<A>,\n  toInput: ArrayInput<A>,\n  items: ItemDiff<A>[],\n  isChanged: boolean,\n): ArrayDiff<A> {\n  const fromValue = fromInput.value\n  const toValue = toInput.value\n\n  return isChanged\n    ? {\n        type: 'array',\n        action: 'changed',\n        isChanged: true,\n        fromValue,\n        toValue,\n        items,\n        annotation: toInput.annotation,\n      }\n    : {\n        type: 'array',\n        action: 'unchanged',\n        isChanged: false,\n        fromValue,\n        toValue,\n        items,\n      }\n}\n\n/**\n * Diffes the two arrays by position. Returns an `items` array if they are unchanged, or undefined\n * if there are any changes anywhere.\n */\nfunction diffExactByPosition<A>(\n  fromInput: ArrayInput<A>,\n  toInput: ArrayInput<A>,\n  options: DiffOptions,\n): ItemDiff<A>[] | undefined {\n  if (fromInput.length !== toInput.length) {\n    return undefined\n  }\n\n  const items: ItemDiff<A>[] = []\n\n  for (let idx = 0; idx < fromInput.length; idx++) {\n    const diff = diffInput(fromInput.at(idx), toInput.at(idx), options)\n    if (diff.isChanged) {\n      return undefined\n    }\n\n    items.push({\n      fromIndex: idx,\n      toIndex: idx,\n      hasMoved: false,\n      diff,\n      annotation: toInput.annotationAt(idx),\n    })\n  }\n\n  return items\n}\n\nfunction diffArrayByReinsert<A>(\n  fromInput: ArrayInput<A>,\n  toInput: ArrayInput<A>,\n  options: DiffOptions,\n): ArrayDiff<A> {\n  const items: ItemDiff<A>[] = []\n\n  for (let idx = 0; idx < toInput.length; idx++) {\n    const input = toInput.at(idx)\n\n    items.push({\n      fromIndex: undefined,\n      toIndex: idx,\n      hasMoved: false,\n      diff: addedInput(input, undefined, options),\n      annotation: input.annotation,\n    })\n  }\n\n  for (let idx = 0; idx < fromInput.length; idx++) {\n    const input = fromInput.at(idx)\n\n    items.push({\n      fromIndex: idx,\n      toIndex: undefined,\n      hasMoved: false,\n      diff: removedInput(input, undefined, options),\n      annotation: input.annotation,\n    })\n  }\n\n  return buildArrayDiff(fromInput, toInput, items, true)\n}\n\ntype Key = string | number | boolean\n\n/**\n * Diff an array when all the elements have _key in the same position.\n */\nfunction diffArrayByKey<A>(\n  fromArray: ArrayInput<A>,\n  fromKeyIndex: KeyIndex,\n  toArray: ArrayInput<A>,\n  toKeyIndex: KeyIndex,\n  options: DiffOptions,\n): ArrayDiff<A> {\n  const items: ItemDiff<A>[] = []\n  let isChanged = false\n\n  function diffCommon(key: Key, fromIndex: number, toIndex: number, hasMoved: boolean) {\n    deletePositionInIndex(fromKeyIndex.index, key, fromIndex)\n    deletePositionInIndex(toKeyIndex.index, key, toIndex)\n\n    const fromInput = fromArray.at(fromIndex)\n    const toInput = toArray.at(toIndex)\n\n    const diff = diffInput(fromInput, toInput)\n    items.push({\n      fromIndex,\n      toIndex,\n      hasMoved,\n      diff,\n      annotation: toArray.annotationAt(toIndex),\n    })\n\n    if (diff.isChanged || fromIndex !== toIndex) {\n      isChanged = true\n    }\n  }\n\n  const lcs = getLongestCommonSubsequence(fromKeyIndex.keys, toKeyIndex.keys)\n\n  for (let fromIndex = 0; fromIndex < fromKeyIndex.keys.length; fromIndex++) {\n    const key = fromKeyIndex.keys[fromIndex]\n\n    const subsequenceIdx = lcs.prevIndices.indexOf(fromIndex)\n    if (subsequenceIdx !== -1) {\n      // Part of the common subsequence => hasMoved:false\n      diffCommon(key, fromIndex, lcs.nextIndices[subsequenceIdx], false)\n      continue\n    }\n\n    // Not a part of the subsequence. Try to find another item which has the same key\n    // and also is not part of the common subsequence.\n    const toIndexes = toKeyIndex.index.get(key)\n    const toIndex = toIndexes && toIndexes.find((idx) => !lcs.nextIndices.includes(idx))\n    if (toIndex !== undefined) {\n      diffCommon(key, fromIndex, toIndex, true)\n      continue\n    }\n\n    const input = fromArray.at(fromIndex)\n\n    items.push({\n      fromIndex,\n      toIndex: undefined,\n      hasMoved: false,\n      diff: removedInput(input, undefined, options),\n      annotation: fromArray.annotationAt(fromIndex),\n    })\n\n    isChanged = true\n  }\n\n  // The remaining data in toKeyIndex are the new elements which has been added\n  for (const positions of toKeyIndex.index.values()) {\n    for (const toIndex of positions) {\n      const input = toArray.at(toIndex)\n      items.push({\n        fromIndex: undefined,\n        toIndex,\n        hasMoved: false,\n        diff: addedInput(input, undefined, options),\n        annotation: toArray.annotationAt(toIndex),\n      })\n    }\n\n    isChanged = true\n  }\n\n  items.sort(compareItemDiff)\n\n  return buildArrayDiff(fromArray, toArray, items, isChanged)\n}\n\nfunction compareItemDiff<A>(a: ItemDiff<A>, b: ItemDiff<A>): number {\n  if (a.toIndex !== undefined && b.toIndex !== undefined) {\n    return a.toIndex - b.toIndex\n  }\n\n  if (a.fromIndex !== undefined && b.fromIndex !== undefined) {\n    return a.fromIndex - b.fromIndex\n  }\n\n  if (a.fromIndex !== undefined && b.toIndex !== undefined) {\n    // A was removed and B was added. Prefer to sort removals last.\n    return -1\n  }\n\n  if (a.toIndex !== undefined && b.fromIndex !== undefined) {\n    // A was added and B was removed. Prefer to sort removals last.\n    return 1\n  }\n\n  throw new Error('invalid item diff comparison')\n}\n\nfunction deletePositionInIndex(index: Map<Key, number[]>, key: Key, pos: number) {\n  const positions = index.get(key)!\n  deleteArrayValue(positions, pos)\n  if (positions.length === 0) {\n    index.delete(key)\n  }\n}\n\nfunction deleteArrayValue<E>(arr: E[], value: E) {\n  const idx = arr.indexOf(value)\n  if (idx === -1) throw new Error('value not found')\n  arr.splice(idx, 1)\n}\n\ntype KeyIndex = {\n  keys: Key[]\n  index: Map<Key, number[]>\n}\n\n/**\n * Indexes the array by a key. This handles cases where the items are:\n *\n * - Objects with _key\n * - Strings\n * - Numbers\n */\nfunction indexByKey<A>(arr: ArrayInput<A>): KeyIndex | undefined {\n  const index = new Map<Key, number[]>()\n  const keys: Key[] = []\n  const length = arr.length\n\n  for (let i = 0; i < length; i++) {\n    const item = arr.at(i)\n\n    let key: Key | null = null\n\n    switch (item.type) {\n      case 'string':\n        key = `s${item.value}`\n        break\n      case 'number':\n        key = item.value\n        break\n      case 'boolean':\n        key = item.value\n        break\n      case 'null':\n        key = 'n'\n        break\n      case 'object':\n        {\n          const keyField = item.get('_key')\n          if (keyField && keyField.type === 'string') {\n            key = `k${keyField.value}`\n\n            // We do not handle duplicate _key\n            if (index.has(key)) return undefined\n          }\n        }\n        break\n      default:\n    }\n\n    // No key => abort\n    if (key === null) return undefined\n\n    keys.push(key)\n    let positions = index.get(key)\n    if (!positions) {\n      positions = []\n      index.set(key, positions)\n    }\n    positions.push(i)\n  }\n\n  // All is good.\n  return {keys, index}\n}\n\nexport function removedArray<A>(\n  input: ArrayInput<A>,\n  toValue: null | undefined,\n  options: DiffOptions,\n): ArrayDiff<A> & {action: 'removed'} {\n  return {\n    type: 'array',\n    action: 'removed',\n    isChanged: true,\n    fromValue: input.value,\n    toValue,\n    annotation: input.annotation,\n\n    get items(): ArrayDiff<A>['items'] {\n      const items: ArrayDiff<A>['items'] = []\n      for (let i = 0; i < input.length; i++) {\n        const item = input.at(i)\n        items.push({\n          fromIndex: i,\n          toIndex: undefined,\n          hasMoved: false,\n          diff: removedInput(item, undefined, options),\n          annotation: input.annotationAt(i),\n        })\n      }\n\n      return replaceProperty(this, 'items', items)\n    },\n  }\n}\n\nexport function addedArray<A>(\n  input: ArrayInput<A>,\n  fromValue: null | undefined,\n  options: DiffOptions,\n): ArrayDiff<A> & {action: 'added'} {\n  return {\n    type: 'array',\n    action: 'added',\n    isChanged: true,\n    fromValue,\n    toValue: input.value,\n    annotation: input.annotation,\n\n    get items(): ArrayDiff<A>['items'] {\n      const items: ArrayDiff<A>['items'] = []\n      for (let i = 0; i < input.length; i++) {\n        const item = input.at(i)\n        items.push({\n          fromIndex: undefined,\n          toIndex: i,\n          hasMoved: false,\n          diff: addedInput(item, undefined, options),\n          annotation: input.annotationAt(i),\n        })\n      }\n\n      return replaceProperty(this, 'items', items)\n    },\n  }\n}\n","import {replaceProperty} from '../helpers'\nimport {type DiffOptions, type ObjectDiff, type ObjectInput} from '../types'\nimport {addedInput, diffInput, removedInput} from './diffInput'\n\nconst ignoredFields = new Set(['_id', '_type', '_createdAt', '_updatedAt', '_rev', '_weak'])\n\nexport function diffObject<A>(\n  fromInput: ObjectInput<A>,\n  toInput: ObjectInput<A>,\n  options: DiffOptions,\n): ObjectDiff<A> {\n  const fields: ObjectDiff<A>['fields'] = {}\n  let isChanged = false\n\n  for (const key of fromInput.keys) {\n    if (ignoredFields.has(key)) continue\n\n    const fromField = fromInput.get(key)!\n\n    const toField = toInput.get(key)\n    if (toField) {\n      const fieldDiff = diffInput(fromField, toField, options)\n      fields[key] = fieldDiff\n      if (fieldDiff.isChanged) isChanged = true\n    } else {\n      fields[key] = removedInput(fromField, undefined, options)\n      isChanged = true\n    }\n  }\n\n  for (const key of toInput.keys) {\n    if (ignoredFields.has(key)) continue\n\n    // Already handled above\n    if (fromInput.get(key)) continue\n\n    const toField = toInput.get(key)!\n    fields[key] = addedInput(toField, undefined, options)\n    isChanged = true\n  }\n\n  const fromValue = fromInput.value\n  const toValue = toInput.value\n\n  if (!isChanged) {\n    return {\n      type: 'object',\n      action: 'unchanged',\n      isChanged: false,\n      fromValue,\n      toValue,\n      fields,\n    }\n  }\n\n  return {\n    type: 'object',\n    action: 'changed',\n    isChanged: true,\n    fromValue,\n    toValue,\n    fields,\n    annotation: toInput.annotation,\n  }\n}\n\nexport function removedObject<A>(\n  input: ObjectInput<A>,\n  toValue: null | undefined,\n  options: DiffOptions,\n): ObjectDiff<A> & {action: 'removed'} {\n  return {\n    type: 'object',\n    action: 'removed',\n    isChanged: true,\n    fromValue: input.value,\n    toValue,\n    annotation: input.annotation,\n\n    get fields(): ObjectDiff<A>['fields'] {\n      const fields: ObjectDiff<A>['fields'] = {}\n      for (const key of input.keys) {\n        const value = input.get(key)!\n        fields[key] = removedInput(value, undefined, options)\n      }\n      return replaceProperty(this, 'fields', fields)\n    },\n  }\n}\n\nexport function addedObject<A>(\n  input: ObjectInput<A>,\n  fromValue: null | undefined,\n  options: DiffOptions,\n): ObjectDiff<A> & {action: 'added'} {\n  return {\n    type: 'object',\n    action: 'added',\n    isChanged: true,\n    fromValue,\n    toValue: input.value,\n    annotation: input.annotation,\n\n    get fields(): ObjectDiff<A>['fields'] {\n      const fields: ObjectDiff<A>['fields'] = {}\n      for (const key of input.keys) {\n        const value = input.get(key)!\n        fields[key] = addedInput(value, undefined, options)\n      }\n      return replaceProperty(this, 'fields', fields)\n    },\n  }\n}\n","import {\n  type BooleanDiff,\n  type BooleanInput,\n  type DiffOptions,\n  type NumberDiff,\n  type NumberInput,\n} from '../types'\n\nexport function diffNumber<A>(\n  fromInput: NumberInput<A>,\n  toInput: NumberInput<A>,\n  options: DiffOptions,\n): NumberDiff<A> {\n  const fromValue = fromInput.value\n  const toValue = toInput.value\n  const type = fromInput.type\n\n  if (fromValue === toValue)\n    return {\n      type,\n      action: 'unchanged',\n      fromValue,\n      toValue,\n      isChanged: false,\n    }\n\n  return {\n    type: fromInput.type,\n    action: 'changed',\n    isChanged: true,\n    fromValue: fromValue,\n    toValue: toValue,\n    annotation: toInput.annotation,\n  }\n}\n\nexport function diffBoolean<A>(\n  fromInput: BooleanInput<A>,\n  toInput: BooleanInput<A>,\n  options: DiffOptions,\n): BooleanDiff<A> {\n  const fromValue = fromInput.value\n  const toValue = toInput.value\n  const type = fromInput.type\n\n  if (fromValue === toValue)\n    return {\n      type,\n      action: 'unchanged',\n      fromValue,\n      toValue,\n      isChanged: false,\n    }\n\n  return {\n    type: fromInput.type,\n    action: 'changed',\n    isChanged: true,\n    fromValue: fromValue,\n    toValue: toValue,\n    annotation: toInput.annotation,\n  }\n}\n","import {\n  cleanupSemantic,\n  DIFF_DELETE,\n  DIFF_EQUAL,\n  DIFF_INSERT,\n  makeDiff,\n} from '@sanity/diff-match-patch'\n\nimport {replaceProperty} from '../helpers'\nimport {type DiffOptions, type StringDiff, type StringDiffSegment, type StringInput} from '../types'\n\nexport function diffString<A>(\n  fromInput: StringInput<A>,\n  toInput: StringInput<A>,\n  options: DiffOptions,\n): StringDiff<A> {\n  const fromValue = fromInput.value\n  const toValue = toInput.value\n\n  if (fromValue === toValue) {\n    return {\n      type: 'string',\n      action: 'unchanged',\n      isChanged: false,\n      fromValue,\n      toValue,\n      segments: [{type: 'stringSegment', action: 'unchanged', text: fromValue}],\n    }\n  }\n\n  return {\n    type: 'string',\n    action: 'changed',\n    isChanged: true,\n    fromValue,\n    toValue,\n    annotation: toInput.annotation,\n\n    // Compute and memoize string segments only when accessed\n    get segments(): StringDiffSegment<A>[] {\n      const segments = buildSegments(fromInput, toInput)\n      return replaceProperty(this, 'segments', segments)\n    },\n  }\n}\n\nfunction buildSegments<A>(\n  fromInput: StringInput<A>,\n  toInput: StringInput<A>,\n): StringDiffSegment<A>[] {\n  const segments: StringDiffSegment<A>[] = []\n  const dmpDiffs = cleanupSemantic(makeDiff(fromInput.value, toInput.value))\n\n  let fromIdx = 0\n  let toIdx = 0\n\n  for (const [op, text] of dmpDiffs) {\n    switch (op) {\n      case DIFF_EQUAL:\n        segments.push({type: 'stringSegment', action: 'unchanged', text})\n        fromIdx += text.length\n        toIdx += text.length\n        break\n      case DIFF_DELETE:\n        for (const segment of fromInput.sliceAnnotation(fromIdx, fromIdx + text.length)) {\n          segments.push({\n            type: 'stringSegment',\n            action: 'removed',\n            text: segment.text,\n            annotation: segment.annotation,\n          })\n        }\n        fromIdx += text.length\n        break\n      case DIFF_INSERT:\n        for (const segment of toInput.sliceAnnotation(toIdx, toIdx + text.length)) {\n          segments.push({\n            type: 'stringSegment',\n            action: 'added',\n            text: segment.text,\n            annotation: segment.annotation,\n          })\n        }\n        toIdx += text.length\n        break\n      default:\n        throw new Error(`Unhandled diff-match-patch operation \"${op}\"`)\n    }\n  }\n\n  return segments\n}\n\nexport function removedString<A>(\n  input: StringInput<A>,\n  toValue: null | undefined,\n  options: DiffOptions,\n): StringDiff<A> & {action: 'removed'} {\n  return {\n    type: 'string',\n    action: 'removed',\n    isChanged: true,\n    fromValue: input.value,\n    toValue,\n    annotation: input.annotation,\n\n    get segments(): StringDiffSegment<A>[] {\n      const segments: StringDiffSegment<A>[] = input\n        .sliceAnnotation(0, input.value.length)\n        .map((segment) => ({type: 'stringSegment', action: 'removed', ...segment}))\n\n      return replaceProperty(this, 'segments', segments)\n    },\n  }\n}\n\nexport function addedString<A>(\n  input: StringInput<A>,\n  fromValue: null | undefined,\n  options: DiffOptions,\n): StringDiff<A> & {action: 'added'} {\n  return {\n    type: 'string',\n    action: 'added',\n    isChanged: true,\n    fromValue,\n    toValue: input.value,\n    annotation: input.annotation,\n\n    get segments(): StringDiffSegment<A>[] {\n      const segments: StringDiffSegment<A>[] = input\n        .sliceAnnotation(0, input.value.length)\n        .map((segment) => ({type: 'stringSegment', action: 'added', ...segment}))\n\n      return replaceProperty(this, 'segments', segments)\n    },\n  }\n}\n","import {type DiffOptions, type Input, type TypeChangeDiff} from '../types'\nimport {addedInput, removedInput} from './diffInput'\n\nexport function diffTypeChange<A>(\n  fromInput: Input<A>,\n  toInput: Input<A>,\n  options: DiffOptions,\n): TypeChangeDiff<A> {\n  return {\n    type: 'typeChange',\n    action: 'changed',\n    isChanged: true,\n\n    fromType: fromInput.type,\n    fromValue: fromInput.value,\n    fromDiff: removedInput(fromInput, undefined, options),\n\n    toType: toInput.type,\n    toValue: toInput.value,\n    toDiff: addedInput(toInput, undefined, options),\n\n    annotation: toInput.annotation,\n  }\n}\n","import {\n  type ArrayInput,\n  type BooleanInput,\n  type Diff,\n  type DiffOptions,\n  type Input,\n  type NumberInput,\n  type ObjectInput,\n  type StringInput,\n} from '../types'\nimport {addedArray, diffArray, removedArray} from './diffArray'\nimport {addedObject, diffObject, removedObject} from './diffObject'\nimport {diffBoolean, diffNumber} from './diffSimple'\nimport {addedString, diffString, removedString} from './diffString'\nimport {diffTypeChange} from './diffTypeChange'\n\n/**\n * Takes a `from` and `to` input and calulates a diff between the two\n *\n * @param fromInput - The source (`from`) input - use {@link wrap | the wrap() method} to generate an \"input\"\n * @param toInput - The destination (`to`) input - use {@link wrap | the wrap() method} to generate an \"input\"\n * @param options - Options for the diffing process - currently no options are defined\n * @returns A diff object representing the change\n * @public\n */\nexport function diffInput<A>(\n  fromInput: Input<A>,\n  toInput: Input<A>,\n  options: DiffOptions = {},\n): Diff<A> {\n  if (fromInput.type !== toInput.type) {\n    if (fromInput.type === 'null') {\n      return addedInput(toInput, null, options)\n    }\n\n    if (toInput.type === 'null') {\n      return removedInput(fromInput, null, options)\n    }\n\n    return diffTypeChange(fromInput, toInput, options)\n  }\n\n  return diffWithType(fromInput.type, fromInput, toInput, options)\n}\n\nfunction diffWithType<A>(\n  type: Input<A>['type'],\n  fromInput: Input<A>,\n  toInput: Input<A>,\n  options: DiffOptions,\n): Diff<A> {\n  switch (type) {\n    case 'null':\n      return {\n        type: 'null',\n        action: 'unchanged',\n        isChanged: false,\n        toValue: null,\n        fromValue: null,\n      }\n    case 'boolean':\n      return diffBoolean(fromInput as BooleanInput<A>, toInput as BooleanInput<A>, options)\n    case 'number':\n      return diffNumber(fromInput as NumberInput<A>, toInput as NumberInput<A>, options)\n    case 'string':\n      return diffString(fromInput as StringInput<A>, toInput as StringInput<A>, options)\n    case 'array':\n      return diffArray(fromInput as ArrayInput<A>, toInput as ArrayInput<A>, options)\n    case 'object':\n      return diffObject(fromInput as ObjectInput<A>, toInput as ObjectInput<A>, options)\n    default:\n      throw new Error(`Unhandled diff type \"${type}\"`)\n  }\n}\n\nexport function removedInput<A>(\n  input: Input<A>,\n  toValue: null | undefined,\n  options: DiffOptions,\n): Diff<A> & {action: 'removed'} {\n  switch (input.type) {\n    case 'null':\n      return {\n        type: 'null',\n        action: 'removed',\n        isChanged: true,\n        fromValue: null,\n        toValue,\n        annotation: input.annotation,\n      }\n    case 'boolean':\n      return {\n        type: 'boolean',\n        action: 'removed',\n        isChanged: true,\n        fromValue: input.value,\n        toValue,\n        annotation: input.annotation,\n      }\n    case 'number':\n      return {\n        type: 'number',\n        action: 'removed',\n        isChanged: true,\n        fromValue: input.value,\n        toValue,\n        annotation: input.annotation,\n      }\n    case 'string':\n      return removedString(input, toValue, options)\n    case 'array':\n      return removedArray(input, toValue, options)\n    case 'object':\n      return removedObject(input, toValue, options)\n    default:\n      throw new Error('Unhandled diff type')\n  }\n}\n\nexport function addedInput<A>(\n  input: Input<A>,\n  fromValue: null | undefined,\n  options: DiffOptions,\n): Diff<A> & {action: 'added'} {\n  switch (input.type) {\n    case 'null':\n      return {\n        type: 'null',\n        action: 'added',\n        isChanged: true,\n        fromValue,\n        toValue: null,\n        annotation: input.annotation,\n      }\n    case 'boolean':\n      return {\n        type: 'boolean',\n        action: 'added',\n        isChanged: true,\n        fromValue,\n        toValue: input.value,\n        annotation: input.annotation,\n      }\n    case 'number':\n      return {\n        type: 'number',\n        action: 'added',\n        isChanged: true,\n        fromValue,\n        toValue: input.value,\n        annotation: input.annotation,\n      }\n    case 'string':\n      return addedString(input, fromValue, options)\n    case 'array':\n      return addedArray(input, fromValue, options)\n    case 'object':\n      return addedObject(input, fromValue, options)\n    default:\n      throw new Error('Unhandled diff type')\n  }\n}\n","import {type ArrayInput, type Input} from '../types'\nimport {wrap} from './index'\n\nexport default class ArrayWrapper<A> implements ArrayInput<A> {\n  type = 'array' as const\n  length: number\n  value: unknown[]\n  annotation: A\n\n  private elements: Input<A>[] = []\n\n  constructor(value: unknown[], annotation: A) {\n    this.annotation = annotation\n    this.value = value\n    this.length = value.length\n  }\n\n  at(idx: number): Input<A> {\n    if (idx >= this.length) throw new Error('out of bounds')\n    const input = this.elements[idx]\n    if (input) {\n      return input\n    }\n\n    return (this.elements[idx] = wrap(this.value[idx], this.annotation))\n  }\n\n  annotationAt(): A {\n    return this.annotation\n  }\n}\n","type SimpleType = 'boolean' | 'number' | 'null'\n\nexport default class BasicWrapper<K extends SimpleType, V, A> {\n  type: K\n  value: V\n  annotation: A\n\n  constructor(type: K, value: V, annotation: A) {\n    this.type = type\n    this.value = value\n    this.annotation = annotation\n  }\n}\n","import {type Input, type ObjectInput} from '../types'\nimport {wrap} from './index'\n\nexport default class ObjectWrapper<A> implements ObjectInput<A> {\n  type = 'object' as const\n  value: Record<string, unknown>\n  keys: string[]\n  annotation: A\n\n  private fields: Record<string, Input<A>> = {}\n\n  constructor(value: Record<string, unknown>, annotation: A) {\n    this.value = filterUndefinedEntries(value)\n    this.annotation = annotation\n    this.keys = Object.keys(this.value)\n  }\n\n  get(key: string): Input<A> | undefined {\n    const input = this.fields[key]\n    if (input) {\n      return input\n    }\n\n    if (!this.value.hasOwnProperty(key)) {\n      return undefined\n    }\n\n    const raw = this.value[key]\n    return (this.fields[key] = wrap(raw, this.annotation))\n  }\n}\n\nfunction filterUndefinedEntries(value: Record<string, unknown>): Record<string, unknown> {\n  return Object.fromEntries(\n    Object.entries(value).filter(([, entryValue]) => typeof entryValue !== 'undefined'),\n  )\n}\n","import {type StringInput} from '../types'\n\nexport default class StringWrapper<A> implements StringInput<A> {\n  type = 'string' as const\n  value: string\n  annotation: A\n\n  constructor(value: string, annotation: A) {\n    this.value = value\n    this.annotation = annotation\n  }\n\n  sliceAnnotation(start: number, end: number): {text: string; annotation: A}[] {\n    return [{text: this.value.slice(start, end), annotation: this.annotation}]\n  }\n}\n","import {type Input} from '../types'\nimport ArrayWrapper from './array'\nimport BasicWrapper from './basic'\nimport ObjectWrapper from './object'\nimport StringWrapper from './string'\n\n/**\n * Takes an input (any JSON-serializable value) and an annotation, and generates an input\n * object for it, to be used with {@link diffInput | the diffInput() method} and others.\n *\n * @param input - The value to wrap in an input object\n * @param annotation - Annotation attached to the input - will be bound to generated diffs\n * @returns A input object\n * @throws if `input` is not a JSON-serializable type\n * @public\n */\nexport function wrap<A>(input: unknown, annotation: A): Input<A> {\n  if (Array.isArray(input)) {\n    return new ArrayWrapper(input, annotation)\n  } else if (input === null) {\n    return new BasicWrapper('null', input, annotation)\n  }\n\n  const type = typeof input\n  switch (type) {\n    case 'number':\n      return new BasicWrapper(type, input as number, annotation)\n    case 'boolean':\n      return new BasicWrapper(type, input as boolean, annotation)\n    case 'object':\n      return new ObjectWrapper(input as Record<string, unknown>, annotation)\n    case 'string':\n      return new StringWrapper(input as string, annotation)\n    default:\n      throw new Error(`cannot wrap value of type: ${type}`)\n  }\n}\n"],"names":["items"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12],"debugId":null}},
    {"offset": {"line": 9032, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/logos/src/groqLogo.tsx","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/logos/src/groqMonogram.tsx","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/logos/src/colors.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/logos/src/sanityLogo.tsx","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/logos/src/sanityMonogram.tsx"],"sourcesContent":["import {hues} from '@sanity/color'\nimport {forwardRef, type ForwardRefExoticComponent, type RefAttributes, type SVGProps} from 'react'\n\n/**\n * @public\n */\nexport const GroqLogo: ForwardRefExoticComponent<\n  Omit<SVGProps<SVGSVGElement>, 'ref'> & RefAttributes<SVGSVGElement>\n> = /* @__PURE__ */ forwardRef(function GroqLogo(props, ref) {\n  return (\n    <svg\n      data-sanity-icon=\"groq-logo\"\n      height=\"1em\"\n      viewBox=\"0 0 304 64\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      {...props}\n      ref={ref}\n    >\n      <path d=\"M32 0L0 32H32V0Z\" fill={hues.magenta[400].hex} />\n      <path d=\"M32 32H0L32 64V32Z\" fill={hues.green[300].hex} />\n      <path d=\"M64 32H32V64L64 32Z\" fill={hues.purple[300].hex} />\n      <path d=\"M112 0L80 32H112V0Z\" fill={hues.green[300].hex} />\n      <path d=\"M112 0H80V32L112 0Z\" fill={hues.purple[300].hex} />\n      <path d=\"M112 32H80L112 64V32Z\" fill={hues.yellow[200].hex} />\n      <path d=\"M144 64L112 32V64H144Z\" fill={hues.blue[300].hex} />\n      <path d=\"M80 32V64H112L80 32Z\" fill={hues.orange[400].hex} />\n      <path d=\"M112 0V32H144L112 0Z\" fill={hues.magenta[400].hex} />\n      <path d=\"M192 0L160 32H192V0Z\" fill={hues.yellow[200].hex} />\n      <path d=\"M192 32H160L192 64V32Z\" fill={hues.orange[400].hex} />\n      <path d=\"M224 32H192V64L224 32Z\" fill={hues.green[300].hex} />\n      <path d=\"M192 0V32H224L192 0Z\" fill={hues.blue[300].hex} />\n      <path d=\"M272 0L240 32H272V0Z\" fill={hues.purple[300].hex} />\n      <path d=\"M304 32L272 64H304V32Z\" fill={hues.magenta[400].hex} />\n      <path d=\"M272 32H240L272 64V32Z\" fill={hues.blue[300].hex} />\n      <path d=\"M304 32H272V64L304 32Z\" fill={hues.yellow[200].hex} />\n      <path d=\"M272 0V32H304L272 0Z\" fill={hues.green[300].hex} />\n    </svg>\n  )\n})\n","import {hues} from '@sanity/color'\nimport {forwardRef, type ForwardRefExoticComponent, type RefAttributes, type SVGProps} from 'react'\n\n/**\n * @public\n */\nexport const GroqMonogram: ForwardRefExoticComponent<\n  Omit<SVGProps<SVGSVGElement>, 'ref'> & RefAttributes<SVGSVGElement>\n> = /* @__PURE__ */ forwardRef(function GroqMonogram(props, ref) {\n  return (\n    <svg\n      data-sanity-icon=\"groq-monogram\"\n      width=\"1em\"\n      height=\"1em\"\n      viewBox=\"0 0 128 128\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      {...props}\n      ref={ref}\n    >\n      <rect width=\"128\" height=\"128\" rx=\"8\" fill={hues.green[950].hex} />\n      <rect y=\"32\" width=\"64\" height=\"64\" fill={hues.green[800].hex} />\n      <path d=\"M64 32L32 64H64V32Z\" fill={hues.magenta[400].hex} />\n      <path d=\"M64 64H32L64 96V64Z\" fill={hues.green[300].hex} />\n      <path d=\"M96 64H64V96L96 64Z\" fill={hues.purple[300].hex} />\n    </svg>\n  )\n})\n","/**\n * Placeholder color definitions until\n * @sanity/color is updated with new branding\n */\n\nexport const NEW_SANITY_ORANGE = '#FF5500'\nexport const NEW_SANITY_BLACK = '#0D0E12'\n","import {white} from '@sanity/color'\nimport {forwardRef, type ForwardRefExoticComponent, type RefAttributes, type SVGProps} from 'react'\nimport {NEW_SANITY_BLACK} from './colors'\n\n/**\n * @public\n */\nexport interface SanityLogoProps {\n  dark?: boolean\n}\n\n/**\n * @public\n */\nexport const SanityLogo: ForwardRefExoticComponent<\n  Omit<SanityLogoProps & SVGProps<SVGSVGElement>, 'ref'> & RefAttributes<SVGSVGElement>\n> = /* @__PURE__ */ forwardRef(function SanityLogo(props, ref) {\n  const {dark, ...svgProps} = props\n  const fill = dark ? white.hex : NEW_SANITY_BLACK\n\n  return (\n    <svg\n      data-sanity-icon=\"sanity-logo\"\n      height=\"1em\"\n      viewBox=\"0 0 435 154\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      {...svgProps}\n      ref={ref}\n    >\n      <path\n        d=\"M44.883 52.4463C33.4181 43.7972 21.8121 37.1021 21.8121 27.3381C21.8121 21.482 26.9827 15.4851 34.1181 15.4851C46.983 15.4851 54.5302 28.8754 61.942 45.6103H66.5538V7.11182H34.3946C7.82952 7.11182 0 23.1543 0 35.7055C0 52.1647 13.5649 61.9287 28.9416 73.365C39.7064 81.3158 48.7948 88.7092 48.7948 97.2175C48.7948 106.424 42.5006 111.723 34.5299 111.723C26.0004 111.723 13.4178 100.562 4.60595 77.4137H0V120.096H36.777C59.4302 120.096 70.7539 102.24 71.1716 87.876C71.7304 71.1411 57.3302 61.7937 44.883 52.4463Z\"\n        fill={fill}\n      />\n      <path\n        d=\"M145.002 106.841V61.7878C145.002 42.2598 132.837 37.1021 115.219 37.1021H83.8952L84.0364 68.9054H89.2071C94.6601 55.3743 102.49 45.4754 110.878 45.4754C118.149 45.4754 121.366 51.7539 121.366 58.3082V64.4459C109.619 71.4227 78.301 77.2788 78.301 98.4791C78.301 110.754 86.8306 120.935 99.2778 120.935C110.043 120.935 117.454 113.958 121.231 105.732C121.931 112.568 126.402 120.096 136.614 120.096H152.696V113.958C147.525 113.958 145.008 110.473 145.008 106.847L145.002 106.841ZM120.949 99.8639C118.713 103.074 115.213 106.7 111.019 106.7C105.148 106.7 101.372 102.234 101.372 93.3096C101.372 83.129 115.072 76.5746 120.949 71.6926V99.8697V99.8639Z\"\n        fill={fill}\n      />\n      <path\n        d=\"M270.145 28.4529C279.092 28.4529 284.686 22.1744 284.686 14.0885C284.686 6.00274 279.092 0 270.145 0C261.198 0 255.462 5.99688 255.462 14.0885C255.462 22.1802 261.474 28.4529 270.145 28.4529Z\"\n        fill={fill}\n      />\n      <path\n        d=\"M409.135 37.102V43.2397C417.947 43.2397 420.459 47.84 416.129 60.2563L405.641 88.5683L392.217 54.1186C389.141 47.4234 390.817 43.2397 397.252 43.2397V37.102H330.557V9.20654H324.263C322.446 18.6889 312.516 37.102 295.598 37.102V43.2397H306.504V100.568C306.504 110.191 309.722 121.07 328.457 121.07H357.54V89.5482H352.37C350.269 96.9417 345.94 111.723 336.569 111.723C331.399 111.723 330.557 106.002 330.557 101.401V45.8861H357.264C360.481 45.8861 363.834 46.3027 365.511 50.2106L393.894 120.231C388.441 132.647 379.07 134.595 362.293 129.437V153.988C366.629 153.988 377.811 154.129 379.77 153.572C390.817 150.362 398.364 128.745 401.441 120.378L425.488 55.521C428.147 48.4092 430.382 43.2456 434.994 43.2456V37.1079H409.129L409.135 37.102Z\"\n        fill={fill}\n      />\n      <path\n        d=\"M237.703 106.841V59.2764C237.703 44.3546 230.574 35.4238 216.45 35.4238C204.009 35.4238 196.803 44.0319 191.279 52.0414V37.0961H159.396V43.2338C164.849 43.2338 167.226 46.5785 167.226 50.4864V106.835C167.226 110.602 164.432 113.947 159.396 113.947V120.084H199.109V113.947C194.073 113.947 191.279 110.602 191.279 106.835V59.646C194.503 55.3743 198.214 50.7681 204.42 50.7681C210.291 50.7681 213.65 55.5093 213.65 61.2303V106.841C213.65 110.608 210.856 113.952 205.82 113.952V120.09H245.533V113.952C240.497 113.952 237.703 110.608 237.703 106.841Z\"\n        fill={fill}\n      />\n      <path\n        d=\"M284.127 106.841V37.1021H252.245V43.2398C257.698 43.2398 260.074 46.5844 260.074 50.4923V106.841C260.074 110.608 257.28 113.952 252.245 113.952V120.09H291.957V113.952C286.922 113.952 284.127 110.608 284.127 106.841Z\"\n        fill={fill}\n      />\n    </svg>\n  )\n})\n","import {white} from '@sanity/color'\nimport {forwardRef, type ForwardRefExoticComponent, type RefAttributes, type SVGProps} from 'react'\nimport {NEW_SANITY_BLACK, NEW_SANITY_ORANGE} from './colors'\n\n/**\n * @public\n */\nexport type SanityMonogramScheme = 'light' | 'dark' | 'default'\n\n/**\n * @public\n * @deprecated use {@link SanityMonogramScheme} as the `scheme` prop instead\n */\nexport interface SanityMonogramColor {\n  bg1: string\n  /**\n   * `bg2` is unused, use `bg1` instead\n   */\n  bg2: string\n  fg: string\n}\n\n/**\n * @public\n */\nexport type SanityMonogramProps =\n  | {color: SanityMonogramColor; scheme?: undefined}\n  | {color?: undefined; scheme: SanityMonogramScheme}\n  | {color?: undefined; scheme?: undefined}\n\nconst SANITY_MONOGRAM_COLOR: {[key in SanityMonogramScheme]: {bg: string; fg: string}} = {\n  light: {bg: white.hex, fg: NEW_SANITY_BLACK},\n  dark: {bg: NEW_SANITY_BLACK, fg: white.hex},\n  default: {bg: NEW_SANITY_ORANGE, fg: NEW_SANITY_BLACK},\n}\n\n/**\n * @public\n */\nexport const SanityMonogram: ForwardRefExoticComponent<\n  SanityMonogramProps &\n    Omit<SVGProps<SVGSVGElement>, 'color' | 'ref'> &\n    RefAttributes<SVGSVGElement>\n> = /* @__PURE__ */ forwardRef(function SanityMonogram(props, ref) {\n  const {scheme = 'default', color, ...restProps} = props\n  const bg = color?.bg1 || SANITY_MONOGRAM_COLOR[scheme].bg\n  const fg = color?.fg || SANITY_MONOGRAM_COLOR[scheme].fg\n\n  return (\n    <svg\n      data-sanity-icon=\"sanity-monogram\"\n      height=\"1em\"\n      viewBox=\"0 0 192 192\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      {...restProps}\n      ref={ref}\n    >\n      <rect width=\"192\" height=\"192\" fill={bg} />\n      <path\n        d=\"M160.077 112.697L154.865 103.629L129.659 118.981L157.655 83.3368L161.888 80.8533L160.841 79.2802L162.764 76.8232L153.929 69.4699L149.886 74.6225L68.2657 122.375L98.4429 86.0855L154.651 55.2759L149.311 44.953L118.696 61.7277L133.771 43.6096L125.134 36L91.2055 76.7966L57.5083 95.2771L83.307 61.1709L99.4731 52.757L94.3391 42.3192L47.2403 66.8361L60.0839 49.8405L51.1123 42.6551L24 78.5378L24.4207 78.8736L29.486 89.1877L59.543 73.5354L32.1474 109.745L36.6375 113.342L39.3075 118.504L70.9528 101.154L36.1052 143.065L44.742 150.674L46.4762 148.588L130.543 99.2454L102.632 134.792L103.088 135.172L103.045 135.199L108.831 145.265L145.954 122.649L131.659 145.716L141.24 152L164 115.278L160.077 112.697Z\"\n        fill={fg}\n      />\n    </svg>\n  )\n})\n"],"names":[],"mappings":"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","ignoreList":[0,1,2,3,4],"debugId":null}},
    {"offset": {"line": 9246, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/insert-menu/src/getSchemaTypeIcon.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/insert-menu/src/InsertMenu.tsx"],"sourcesContent":["import {type ReferenceSchemaType, type SchemaType} from '@sanity/types'\nimport {type ComponentType} from 'react'\n\n/** @internal */\nexport function getSchemaTypeIcon(schemaType: SchemaType): ComponentType | undefined {\n  // Use reference icon if reference is to one schemaType only\n  const referenceIcon =\n    isReferenceSchemaType(schemaType) && (schemaType.to ?? []).length === 1\n      ? schemaType.to[0]!.icon\n      : undefined\n\n  return schemaType.icon ?? schemaType.type?.icon ?? referenceIcon\n}\n\nfunction isReferenceSchemaType(type: unknown): type is ReferenceSchemaType {\n  return isRecord(type) && (type['name'] === 'reference' || isReferenceSchemaType(type['type']))\n}\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return !!value && (typeof value == 'object' || typeof value == 'function')\n}\n","import {SearchIcon, ThLargeIcon, UlistIcon} from '@sanity/icons'\nimport {type SchemaType} from '@sanity/types'\nimport {\n  Box,\n  Button,\n  Flex,\n  Grid,\n  Menu,\n  MenuItem,\n  Stack,\n  Tab,\n  TabList,\n  Text,\n  TextInput,\n  Tooltip,\n  type MenuItemProps,\n} from '@sanity/ui/_visual-editing'\nimport {startCase} from 'lodash'\nimport {useReducer, useState, type ChangeEvent, type CSSProperties} from 'react'\nimport {isValidElementType} from 'react-is'\nimport {getSchemaTypeIcon} from './getSchemaTypeIcon'\nimport type {InsertMenuOptions} from './InsertMenuOptions'\n\ntype InsertMenuGroup = NonNullable<InsertMenuOptions['groups']>[number] & {selected: boolean}\ntype InsertMenuViews = NonNullable<InsertMenuOptions['views']>\ntype InsertMenuView = InsertMenuViews[number]\n\ntype InsertMenuEvent =\n  | {type: 'toggle view'; name: InsertMenuView['name']}\n  | {type: 'change query'; query: string}\n  | {type: 'select group'; name: string | undefined}\n\ntype InsertMenuState = {\n  query: string\n  groups: Array<InsertMenuGroup>\n  views: Array<InsertMenuViews[number] & {selected: boolean}>\n}\n\nfunction fullInsertMenuReducer(state: InsertMenuState, event: InsertMenuEvent): InsertMenuState {\n  return {\n    query: event.type === 'change query' ? event.query : state.query,\n    groups:\n      event.type === 'select group'\n        ? state.groups.map((group) => ({...group, selected: event.name === group.name}))\n        : state.groups,\n    views:\n      event.type === 'toggle view'\n        ? state.views.map((view) => ({...view, selected: event.name === view.name}))\n        : state.views,\n  }\n}\n\nconst ALL_ITEMS_GROUP_NAME = 'all-items'\n\nconst gridStyle: CSSProperties = {\n  gridTemplateColumns: 'repeat(auto-fill, minmax(118px, 1fr))',\n  alignItems: 'start',\n}\n\n/** @alpha */\nexport type InsertMenuProps = InsertMenuOptions & {\n  schemaTypes: Array<SchemaType>\n  onSelect: (schemaType: SchemaType) => void\n  labels: {\n    'insert-menu.filter.all-items': string\n    'insert-menu.search.no-results': string\n    'insert-menu.search.placeholder': string\n    'insert-menu.toggle-grid-view.tooltip': string\n    'insert-menu.toggle-list-view.tooltip': string\n  }\n}\n\n/** @alpha */\nexport function InsertMenu(props: InsertMenuProps): React.JSX.Element {\n  const showIcons = props.showIcons === undefined ? true : props.showIcons\n  const showFilter =\n    props.filter === undefined || props.filter === 'auto'\n      ? props.schemaTypes.length > 5\n      : props.filter\n  const [state, send] = useReducer(fullInsertMenuReducer, {\n    query: '',\n    groups: props.groups\n      ? [\n          {\n            name: ALL_ITEMS_GROUP_NAME,\n            title: props.labels['insert-menu.filter.all-items'],\n            selected: true,\n          },\n          ...props.groups.map((group) => ({...group, selected: false})),\n        ]\n      : [],\n    views: (props.views ?? [{name: 'list'}]).map((view, index) => ({\n      ...view,\n      selected: index === 0,\n    })),\n  })\n  const filteredSchemaTypes = filterSchemaTypes(props.schemaTypes, state.query, state.groups)\n  const selectedView = state.views.find((view) => view.selected)\n  const showingFilterOrViews = showFilter || state.views.length > 1\n  const showingTabs = state.groups && state.groups.length > 0\n  const showingAnyOptions = showingFilterOrViews || showingTabs\n\n  return (\n    <Menu padding={0}>\n      <Flex direction=\"column\" height=\"fill\">\n        <Box\n          {...(showingAnyOptions\n            ? {\n                style: {borderBottom: '1px solid var(--card-border-color)'},\n                paddingBottom: 1,\n              }\n            : {})}\n        >\n          {/* filter and views button */}\n          {showingFilterOrViews ? (\n            <Flex flex=\"none\" align=\"center\" paddingTop={1} paddingX={1} gap={1}>\n              {showFilter ? (\n                <Box flex={1}>\n                  <TextInput\n                    autoFocus\n                    border={false}\n                    fontSize={1}\n                    icon={SearchIcon}\n                    onChange={(event: ChangeEvent<HTMLInputElement>) => {\n                      send({type: 'change query', query: event.target.value})\n                    }}\n                    placeholder={props.labels['insert-menu.search.placeholder']}\n                    value={state.query}\n                  />\n                </Box>\n              ) : null}\n              {state.views.length > 1 ? (\n                <Box flex=\"none\">\n                  <ViewToggle\n                    views={state.views}\n                    onToggle={(name) => {\n                      send({type: 'toggle view', name})\n                    }}\n                    labels={props.labels}\n                  />\n                </Box>\n              ) : null}\n            </Flex>\n          ) : null}\n\n          {/* tabs */}\n          {showingTabs ? (\n            <Box paddingTop={1} paddingX={1}>\n              <TabList space={1}>\n                {state.groups.map((group) => (\n                  <Tab\n                    id={`${group.name}-tab`}\n                    aria-controls={`${group.name}-panel`}\n                    key={group.name}\n                    label={group.title ?? startCase(group.name)}\n                    selected={group.selected}\n                    onClick={() => {\n                      send({type: 'select group', name: group.name})\n                    }}\n                  />\n                ))}\n              </TabList>\n            </Box>\n          ) : null}\n        </Box>\n\n        {/* results */}\n        <Box padding={1}>\n          {filteredSchemaTypes.length === 0 ? (\n            <Box padding={2}>\n              <Text muted size={1}>\n                {props.labels['insert-menu.search.no-results']}\n              </Text>\n            </Box>\n          ) : !selectedView ? null : selectedView.name === 'grid' ? (\n            <Grid autoRows=\"auto\" flex={1} gap={1} style={gridStyle}>\n              {filteredSchemaTypes.map((schemaType) => (\n                <GridMenuItem\n                  key={schemaType.name}\n                  icon={showIcons ? getSchemaTypeIcon(schemaType) : undefined}\n                  onClick={() => {\n                    props.onSelect(schemaType)\n                  }}\n                  previewImageUrl={selectedView.previewImageUrl?.(schemaType.name)}\n                  schemaType={schemaType}\n                />\n              ))}\n            </Grid>\n          ) : (\n            <Stack flex={1} space={1}>\n              {filteredSchemaTypes.map((schemaType) => (\n                <MenuItem\n                  key={schemaType.name}\n                  icon={showIcons ? getSchemaTypeIcon(schemaType) : undefined}\n                  onClick={() => {\n                    props.onSelect(schemaType)\n                  }}\n                  text={schemaType.title ?? startCase(schemaType.name)}\n                />\n              ))}\n            </Stack>\n          )}\n        </Box>\n      </Flex>\n    </Menu>\n  )\n}\n\nconst viewToggleIcon: Record<InsertMenuView['name'], React.ElementType> = {\n  grid: ThLargeIcon,\n  list: UlistIcon,\n}\n\nconst viewToggleTooltip: Record<InsertMenuView['name'], keyof ViewToggleProps['labels']> = {\n  grid: 'insert-menu.toggle-grid-view.tooltip',\n  list: 'insert-menu.toggle-list-view.tooltip',\n}\n\ntype ViewToggleProps = {\n  views: InsertMenuState['views']\n  onToggle: (viewName: InsertMenuView['name']) => void\n  labels: Pick<\n    InsertMenuProps['labels'],\n    'insert-menu.toggle-grid-view.tooltip' | 'insert-menu.toggle-list-view.tooltip'\n  >\n}\n\nfunction ViewToggle(props: ViewToggleProps) {\n  const viewIndex = props.views.findIndex((view) => view.selected)\n  const nextView = props.views[viewIndex + 1] ?? props.views[0]!\n\n  return (\n    <Tooltip\n      content={<Text size={1}>{props.labels[viewToggleTooltip[nextView.name]]}</Text>}\n      placement=\"top\"\n      portal\n    >\n      <Button\n        mode=\"bleed\"\n        icon={viewToggleIcon[nextView.name]}\n        onClick={() => {\n          props.onToggle(nextView.name)\n        }}\n      />\n    </Tooltip>\n  )\n}\n\ntype GridMenuItemProps = {\n  onClick: () => void\n  schemaType: SchemaType\n  icon: MenuItemProps['icon']\n  previewImageUrl: ReturnType<\n    NonNullable<\n      Extract<NonNullable<InsertMenuOptions['views']>[number], {name: 'grid'}>['previewImageUrl']\n    >\n  >\n}\n\nfunction GridMenuItem(props: GridMenuItemProps) {\n  const [failedToLoad, setFailedToLoad] = useState(false)\n  const Icon = props.icon\n\n  return (\n    <MenuItem padding={0} radius={2} onClick={props.onClick} style={{overflow: 'hidden'}}>\n      <Flex direction=\"column\" gap={1} padding={1}>\n        <Box\n          flex=\"none\"\n          style={{\n            backgroundColor: 'var(--card-muted-bg-color)',\n            paddingBottom: '66.6%',\n            position: 'relative',\n          }}\n        >\n          {isValidElementType(Icon) ? (\n            <Flex\n              align=\"center\"\n              justify=\"center\"\n              style={{\n                position: 'absolute',\n                top: 0,\n                left: 0,\n                width: '100%',\n                height: '100%',\n              }}\n            >\n              <Text size={1}>\n                <Icon />\n              </Text>\n            </Flex>\n          ) : null}\n          {!props.previewImageUrl || failedToLoad ? null : (\n            <img\n              src={props.previewImageUrl}\n              style={{\n                objectFit: 'contain',\n                width: '100%',\n                height: '100%',\n                position: 'absolute',\n                inset: 0,\n              }}\n              onError={() => {\n                setFailedToLoad(true)\n              }}\n            />\n          )}\n\n          <div\n            style={{\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              width: '100%',\n              height: '100%',\n              boxShadow: 'inset 0 0 0 0.5px var(--card-fg-color)',\n              opacity: 0.1,\n            }}\n          />\n        </Box>\n        <Box flex={1} padding={2}>\n          <Text size={1} weight=\"medium\">\n            {props.schemaType.title ?? props.schemaType.name}\n          </Text>\n        </Box>\n      </Flex>\n    </MenuItem>\n  )\n}\n\nfunction filterSchemaTypes(\n  schemaTypes: Array<SchemaType>,\n  query: string,\n  groups: Array<InsertMenuGroup>,\n) {\n  return schemaTypes.filter(\n    (schemaType) => passesGroupFilter(schemaType, groups) && passesQueryFilter(schemaType, query),\n  )\n}\n\nfunction passesQueryFilter(schemaType: SchemaType, query: string) {\n  const sanitizedQuery = query.trim().toLowerCase()\n\n  return schemaType.title\n    ? schemaType.title?.toLowerCase().includes(sanitizedQuery)\n    : schemaType.name.includes(sanitizedQuery)\n}\n\nfunction passesGroupFilter(schemaType: SchemaType, groups: Array<InsertMenuGroup>) {\n  const selectedGroup = groups.find((group) => group.selected)\n\n  return selectedGroup\n    ? selectedGroup.name === ALL_ITEMS_GROUP_NAME\n      ? true\n      : selectedGroup.of?.includes(schemaType.name)\n    : true\n}\n"],"names":["getSchemaTypeIcon","schemaType","referenceIcon","isReferenceSchemaType","to","length","icon","undefined","type","isRecord","value","fullInsertMenuReducer","state","event","query","groups","map","group","selected","name","views","view","ALL_ITEMS_GROUP_NAME","gridStyle","gridTemplateColumns","alignItems","InsertMenu","props","$","_c","showIcons","showFilter","filter","schemaTypes","t0","labels","title","_temp","t1","t2","_temp2","t3","send","useReducer","T0","T1","T2","t4","t5","t6","t7","t8","t9","filteredSchemaTypes","filterSchemaTypes","selectedView","find","_temp3","showingFilterOrViews","showingTabs","showingAnyOptions","Menu","Flex","t10","style","borderBottom","paddingBottom","t11","SearchIcon","target","t12","group_0","startCase","Box","onSelect","previewImageUrl","schemaType_0","view_0","index","viewToggleIcon","grid","ThLargeIcon","list","UlistIcon","viewToggleTooltip","ViewToggle","viewIndex","findIndex","_temp4","nextView","onToggle","GridMenuItem","failedToLoad","setFailedToLoad","useState","Icon","Symbol","for","overflow","backgroundColor","position","isValidElementType","top","left","width","height","objectFit","inset","boxShadow","opacity","onClick","passesGroupFilter","passesQueryFilter","sanitizedQuery","trim","toLowerCase","includes","selectedGroup","of"],"mappings":"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","ignoreList":[0,1],"debugId":null}},
    {"offset": {"line": 9608, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/comlink/src/common.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/comlink/src/constants.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/comlink/src/request.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/comlink/src/connection.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/comlink/src/controller.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/comlink/src/util.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/comlink/src/node.ts"],"sourcesContent":["import {bufferCount, concatMap, defer, filter, fromEvent, map, pipe, take} from 'rxjs'\nimport {fromEventObservable} from 'xstate'\nimport type {ListenInput, ProtocolMessage} from './types'\n\nexport const listenInputFromContext =\n  (\n    config: (\n      | {\n          include: string | string[]\n          exclude?: string | string[]\n        }\n      | {\n          include?: string | string[]\n          exclude: string | string[]\n        }\n    ) & {\n      matches?: boolean\n      count?: number\n      responseType?: string\n    },\n  ) =>\n  <\n    TContext extends {\n      domain: string\n      connectTo: string\n      name: string\n      target: MessageEventSource | undefined\n    },\n  >({\n    context,\n  }: {\n    context: TContext\n  }): ListenInput => {\n    const {count, include, exclude, responseType = 'message.received'} = config\n    return {\n      count,\n      domain: context.domain,\n      from: context.connectTo,\n      include: include ? (Array.isArray(include) ? include : [include]) : [],\n      exclude: exclude ? (Array.isArray(exclude) ? exclude : [exclude]) : [],\n      responseType,\n      target: context.target,\n      to: context.name,\n    }\n  }\n\nexport const listenFilter =\n  (input: ListenInput) =>\n  (event: MessageEvent<ProtocolMessage>): boolean => {\n    const {data} = event\n    return (\n      (input.include.length ? input.include.includes(data.type) : true) &&\n      (input.exclude.length ? !input.exclude.includes(data.type) : true) &&\n      data.domain === input.domain &&\n      data.from === input.from &&\n      data.to === input.to &&\n      (!input.target || event.source === input.target)\n    )\n  }\n\nexport const eventToMessage =\n  <TType>(type: TType) =>\n  (\n    event: MessageEvent<ProtocolMessage>,\n  ): {type: TType; message: MessageEvent<ProtocolMessage>} => ({\n    type,\n    message: event,\n  })\n\nexport const messageEvents$ = defer(() =>\n  fromEvent<MessageEvent<ProtocolMessage>>(window, 'message'),\n)\n\n/**\n * @public\n */\nexport const createListenLogic = (\n  compatMap?: (event: MessageEvent<ProtocolMessage>) => MessageEvent<ProtocolMessage>,\n) =>\n  fromEventObservable(({input}: {input: ListenInput}) => {\n    return messageEvents$.pipe(\n      compatMap ? map(compatMap) : pipe(),\n      filter(listenFilter(input)),\n      map(eventToMessage(input.responseType)),\n      input.count\n        ? pipe(\n            bufferCount(input.count),\n            concatMap((arr) => arr),\n            take(input.count),\n          )\n        : pipe(),\n    )\n  })\n","import type {MessageType} from './types'\n\n/** @internal */\nexport const DOMAIN = 'sanity/comlink'\n\n/** @internal */\nexport const RESPONSE_TIMEOUT_DEFAULT = 3_000\n\n/** @internal */\nexport const FETCH_TIMEOUT_DEFAULT = 10_000\n\n/** @internal */\nexport const HEARTBEAT_INTERVAL = 1000\n\n/** @internal */\nexport const HANDSHAKE_INTERVAL = 500\n\n/**\n * @public\n */\nexport const MSG_RESPONSE = 'comlink/response'\n\n/**\n * @public\n */\nexport const MSG_HEARTBEAT = 'comlink/heartbeat'\n\n/** @internal */\nexport const MSG_DISCONNECT = 'comlink/disconnect'\n\n/** @internal */\nexport const MSG_HANDSHAKE_SYN = 'comlink/handshake/syn'\n\n/** @internal */\nexport const MSG_HANDSHAKE_SYN_ACK = 'comlink/handshake/syn-ack'\n\n/** @internal */\nexport const MSG_HANDSHAKE_ACK = 'comlink/handshake/ack'\n\n/** @internal */\nexport const HANDSHAKE_MSG_TYPES = [\n  MSG_HANDSHAKE_SYN,\n  MSG_HANDSHAKE_SYN_ACK,\n  MSG_HANDSHAKE_ACK,\n] satisfies MessageType[]\n\n/** @internal */\nexport const INTERNAL_MSG_TYPES = [\n  MSG_RESPONSE,\n  MSG_DISCONNECT,\n  MSG_HEARTBEAT,\n  ...HANDSHAKE_MSG_TYPES,\n] satisfies MessageType[]\n","import {EMPTY, filter, fromEvent, map, take, takeUntil, type Observable} from 'rxjs'\nimport {v4 as uuid} from 'uuid'\nimport {\n  assign,\n  fromEventObservable,\n  sendTo,\n  setup,\n  type ActorRefFrom,\n  type AnyActorRef,\n} from 'xstate'\nimport {MSG_RESPONSE, RESPONSE_TIMEOUT_DEFAULT} from './constants'\nimport type {Message, MessageData, MessageType, ProtocolMessage, ResponseMessage} from './types'\n\nconst throwOnEvent =\n  <T>(message?: string) =>\n  (source: Observable<T>) =>\n    source.pipe(\n      take(1),\n      map(() => {\n        throw new Error(message)\n      }),\n    )\n\n/**\n * @public\n */\nexport interface RequestMachineContext<TSends extends Message> {\n  channelId: string\n  data: MessageData | undefined\n  domain: string\n  expectResponse: boolean\n  from: string\n  id: string\n  parentRef: AnyActorRef\n  resolvable: PromiseWithResolvers<TSends['response']> | undefined\n  response: TSends['response'] | null\n  responseTimeout: number | undefined\n  responseTo: string | undefined\n  signal: AbortSignal | undefined\n  suppressWarnings: boolean | undefined\n  sources: Set<MessageEventSource>\n  targetOrigin: string\n  to: string\n  type: MessageType\n}\n\n/**\n * @public\n */\nexport type RequestActorRef<TSends extends Message> = ActorRefFrom<\n  ReturnType<typeof createRequestMachine<TSends>>\n>\n\n/**\n * @public\n */\nexport const createRequestMachine = <TSends extends Message>() => {\n  return setup({\n    types: {} as {\n      children: {\n        'listen for response': 'listen'\n      }\n      context: RequestMachineContext<TSends>\n      // @todo Should response types be specified?\n      events: {type: 'message'; data: ProtocolMessage<ResponseMessage>} | {type: 'abort'}\n      emitted:\n        | {type: 'request.failed'; requestId: string}\n        | {type: 'request.aborted'; requestId: string}\n        | {\n            type: 'request.success'\n            requestId: string\n            response: MessageData | null\n            responseTo: string | undefined\n          }\n      input: {\n        channelId: string\n        data?: TSends['data']\n        domain: string\n        expectResponse?: boolean\n        from: string\n        parentRef: AnyActorRef\n        resolvable?: PromiseWithResolvers<TSends['response']>\n        responseTimeout?: number\n        responseTo?: string\n        signal?: AbortSignal\n        sources: Set<MessageEventSource> | MessageEventSource\n        suppressWarnings?: boolean\n        targetOrigin: string\n        to: string\n        type: TSends['type']\n      }\n      output: {\n        requestId: string\n        response: TSends['response'] | null\n        responseTo: string | undefined\n      }\n    },\n    actors: {\n      listen: fromEventObservable(\n        ({\n          input,\n        }: {\n          input: {\n            requestId: string\n            sources: Set<MessageEventSource>\n            signal?: AbortSignal\n          }\n        }) => {\n          const abortSignal$ = input.signal\n            ? fromEvent(input.signal, 'abort').pipe(\n                throwOnEvent(`Request ${input.requestId} aborted`),\n              )\n            : EMPTY\n\n          const messageFilter = (event: MessageEvent<ProtocolMessage<ResponseMessage>>) =>\n            event.data?.type === MSG_RESPONSE &&\n            event.data?.responseTo === input.requestId &&\n            !!event.source &&\n            input.sources.has(event.source)\n\n          return fromEvent<MessageEvent<ProtocolMessage<ResponseMessage>>>(window, 'message').pipe(\n            filter(messageFilter),\n            take(input.sources.size),\n            takeUntil(abortSignal$),\n          )\n        },\n      ),\n    },\n    actions: {\n      'send message': ({context}, params: {message: ProtocolMessage}) => {\n        const {sources, targetOrigin} = context\n        const {message} = params\n\n        sources.forEach((source) => {\n          source.postMessage(message, {targetOrigin})\n        })\n      },\n      'on success': sendTo(\n        ({context}) => context.parentRef,\n        ({context, self}) => {\n          if (context.response) {\n            context.resolvable?.resolve(context.response)\n          }\n          return {\n            type: 'request.success',\n            requestId: self.id,\n            response: context.response,\n            responseTo: context.responseTo,\n          }\n        },\n      ),\n      'on fail': sendTo(\n        ({context}) => context.parentRef,\n        ({context, self}) => {\n          if (!context.suppressWarnings) {\n            console.warn(\n              `[@sanity/comlink] Received no response to message '${context.type}' on client '${context.from}' (ID: '${context.id}').`,\n            )\n          }\n          context.resolvable?.reject(new Error('No response received'))\n          return {type: 'request.failed', requestId: self.id}\n        },\n      ),\n      'on abort': sendTo(\n        ({context}) => context.parentRef,\n        ({context, self}) => {\n          context.resolvable?.reject(new Error('Request aborted'))\n          return {type: 'request.aborted', requestId: self.id}\n        },\n      ),\n    },\n    guards: {\n      expectsResponse: ({context}) => context.expectResponse,\n    },\n    delays: {\n      initialTimeout: 0,\n      responseTimeout: ({context}) => context.responseTimeout ?? RESPONSE_TIMEOUT_DEFAULT,\n    },\n  }).createMachine({\n    /** @xstate-layout N4IgpgJg5mDOIC5QAoC2BDAxgCwJYDswBKAOlwgBswBiAD1gBd0GwT0AzFgJ2QNwdzoKAFVyowAewCuDItTRY8hUuSoBtAAwBdRKAAOE2P1wT8ukLUQBGAEwBWEgBYAnK+eOAzB7sB2DzY8rABoQAE9rDQc3V0cNTw8fAA4NHwBfVJCFHAJiElgwfAgCKGpNHSQQAyMBU3NLBDsrDxI7DTaAjQA2OOcNDxDwhHsNJx9Ou0TOq2cJxP9HdMyMbOU8gqL8ErUrcv1DY1qK+sbm1vaPLp6+gcRnGydo9wDGycWQLKVc9AB3dGNN6jiWCwdAwMrmKoHMxHRCJRKOEiJHwuZKBZwXKzBMKIGyYkhtAkXOweTqOHw2RJvD45Ug-P4CAH0JgsNicMA8LhwAz4fKicTSWTyZafWm-f5QcEVSE1aGgepwhFIlF9aYYrGDC4+JzEppjGzOUkeGbpDIgfASCBwczU5QQ-YyuqIAC0nRuCBd+IJXu9KSpwppZEoYDt1RMsosiEcNjdVjiJEeGisiSTHkcVgWpptuXyhWKIahjqGzi1BqRJINnVcdkcbuTLS9VYC8ISfsUAbp4vzDphCHJIyjBvJNlxNmRNexQ3sJGH43GPj8jWJrZWuXYfyoEC7YcLsbrgRsjkcvkmdgNbopVhIPhVfnsh8ClMz-tWsCkmEwcHgUvt257u8v+6Hse4xnhOdZnImVidPqCRNB4JqpEAA */\n    context: ({input}) => {\n      return {\n        channelId: input.channelId,\n        data: input.data,\n        domain: input.domain,\n        expectResponse: input.expectResponse ?? false,\n        from: input.from,\n        id: `msg-${uuid()}`,\n        parentRef: input.parentRef,\n        resolvable: input.resolvable,\n        response: null,\n        responseTimeout: input.responseTimeout,\n        responseTo: input.responseTo,\n        signal: input.signal,\n        sources: input.sources instanceof Set ? input.sources : new Set([input.sources]),\n        suppressWarnings: input.suppressWarnings,\n        targetOrigin: input.targetOrigin,\n        to: input.to,\n        type: input.type,\n      }\n    },\n    initial: 'idle',\n    on: {\n      abort: '.aborted',\n    },\n    states: {\n      idle: {\n        after: {\n          initialTimeout: [\n            {\n              target: 'sending',\n            },\n          ],\n        },\n      },\n      sending: {\n        entry: {\n          type: 'send message',\n          params: ({context}) => {\n            const {channelId, data, domain, from, id, responseTo, to, type} = context\n            const message = {\n              channelId,\n              data,\n              domain,\n              from,\n              id,\n              to,\n              type,\n              responseTo,\n            }\n            return {message}\n          },\n        },\n        always: [\n          {\n            guard: 'expectsResponse',\n            target: 'awaiting',\n          },\n          'success',\n        ],\n      },\n      awaiting: {\n        invoke: {\n          id: 'listen for response',\n          src: 'listen',\n          input: ({context}) => ({\n            requestId: context.id,\n            sources: context.sources,\n            signal: context.signal,\n          }),\n          onError: 'aborted',\n        },\n        after: {\n          responseTimeout: 'failed',\n        },\n        on: {\n          message: {\n            actions: assign({\n              response: ({event}) => event.data.data,\n              responseTo: ({event}) => event.data.responseTo,\n            }),\n            target: 'success',\n          },\n        },\n      },\n      failed: {\n        type: 'final',\n        entry: 'on fail',\n      },\n      success: {\n        type: 'final',\n        entry: 'on success',\n      },\n      aborted: {\n        type: 'final',\n        entry: 'on abort',\n      },\n    },\n    output: ({context, self}) => {\n      const output = {\n        requestId: self.id,\n        response: context.response,\n        responseTo: context.responseTo,\n      }\n      return output\n    },\n  })\n}\n\n// export const delayedRequestMachine = requestMachine.provide({\n//   delays: {\n//     initialTimeout: 500,\n//   },\n// })\n","import {v4 as uuid} from 'uuid'\nimport {\n  assertEvent,\n  assign,\n  createActor,\n  emit,\n  enqueueActions,\n  fromCallback,\n  raise,\n  setup,\n  stopChild,\n  type ActorRefFrom,\n  type EventObject,\n} from 'xstate'\nimport {createListenLogic, listenInputFromContext} from './common'\nimport {\n  DOMAIN,\n  HANDSHAKE_INTERVAL,\n  MSG_DISCONNECT,\n  MSG_HANDSHAKE_ACK,\n  MSG_HANDSHAKE_SYN,\n  MSG_HANDSHAKE_SYN_ACK,\n  MSG_HEARTBEAT,\n  MSG_RESPONSE,\n} from './constants'\nimport {createRequestMachine, type RequestActorRef} from './request'\nimport type {\n  BufferAddedEmitEvent,\n  BufferFlushedEmitEvent,\n  Message,\n  MessageEmitEvent,\n  ProtocolMessage,\n  RequestData,\n  Status,\n  StatusEmitEvent,\n  WithoutResponse,\n} from './types'\n\n/**\n * @public\n */\nexport type ConnectionActorLogic<TSends extends Message, TReceives extends Message> = ReturnType<\n  typeof createConnectionMachine<TSends, TReceives>\n>\n/**\n * @public\n */\nexport type ConnectionActor<TSends extends Message, TReceives extends Message> = ActorRefFrom<\n  ReturnType<typeof createConnectionMachine<TSends, TReceives>>\n>\n\n/**\n * @public\n */\nexport type Connection<TSends extends Message = Message, TReceives extends Message = Message> = {\n  actor: ConnectionActor<TSends, TReceives>\n  connect: () => void\n  disconnect: () => void\n  id: string\n  name: string\n  machine: ReturnType<typeof createConnectionMachine<TSends, TReceives>>\n  on: <TType extends TReceives['type'], TMessage extends Extract<TReceives, {type: TType}>>(\n    type: TType,\n    handler: (data: TMessage['data']) => Promise<TMessage['response']> | TMessage['response'],\n  ) => () => void\n  onStatus: (handler: (status: Status) => void, filter?: Status) => () => void\n  post: <TType extends TSends['type'], TMessage extends Extract<TSends, {type: TType}>>(\n    ...params: (TMessage['data'] extends undefined ? [TType] : never) | [TType, TMessage['data']]\n  ) => void\n  setTarget: (target: MessageEventSource) => void\n  start: () => () => void\n  stop: () => void\n  target: MessageEventSource | undefined\n}\n\n/**\n * @public\n */\nexport interface ConnectionInput {\n  connectTo: string\n  domain?: string\n  heartbeat?: boolean\n  name: string\n  id?: string\n  target?: MessageEventSource\n  targetOrigin: string\n}\n\nconst sendBackAtInterval = fromCallback<\n  EventObject,\n  {event: EventObject; immediate?: boolean; interval: number}\n>(({sendBack, input}) => {\n  const send = () => {\n    sendBack(input.event)\n  }\n\n  if (input.immediate) {\n    send()\n  }\n\n  const interval = setInterval(send, input.interval)\n\n  return () => {\n    clearInterval(interval)\n  }\n})\n\n/**\n * @public\n */\nexport const createConnectionMachine = <\n  TSends extends Message, // Sends\n  TReceives extends Message, // Receives\n  TSendsWithoutResponse extends WithoutResponse<TSends> = WithoutResponse<TSends>,\n>() => {\n  const connectionMachine = setup({\n    types: {} as {\n      children: {\n        'listen for handshake': 'listen'\n        'listen for messages': 'listen'\n        'send heartbeat': 'sendBackAtInterval'\n        'send syn': 'sendBackAtInterval'\n      }\n      context: {\n        buffer: Array<TSendsWithoutResponse>\n        channelId: string\n        connectTo: string\n        domain: string\n        heartbeat: boolean\n        id: string\n        name: string\n        requests: Array<RequestActorRef<TSends>>\n        target: MessageEventSource | undefined\n        targetOrigin: string\n      }\n      emitted:\n        | BufferAddedEmitEvent<TSendsWithoutResponse>\n        | BufferFlushedEmitEvent<TSendsWithoutResponse>\n        | MessageEmitEvent<TReceives>\n        | StatusEmitEvent\n      events:\n        | {type: 'connect'}\n        | {type: 'disconnect'}\n        | {type: 'message.received'; message: MessageEvent<ProtocolMessage<TReceives>>}\n        | {type: 'post'; data: TSendsWithoutResponse}\n        | {type: 'response'; respondTo: string; data: Pick<TSends, 'response'>}\n        | {type: 'request.aborted'; requestId: string}\n        | {type: 'request.failed'; requestId: string}\n        | {\n            type: 'request.success'\n            requestId: string\n            response: TSends['response'] | null\n            responseTo: string | undefined\n          }\n        | {type: 'request'; data: RequestData<TSends> | RequestData<TSends>[]}\n        | {type: 'syn'}\n        | {type: 'target.set'; target: MessageEventSource}\n      input: ConnectionInput\n    },\n    actors: {\n      requestMachine: createRequestMachine<TSends>(),\n      listen: createListenLogic(),\n      sendBackAtInterval,\n    },\n    actions: {\n      'buffer message': enqueueActions(({enqueue}) => {\n        enqueue.assign({\n          buffer: ({event, context}) => {\n            assertEvent(event, 'post')\n            return [...context.buffer, event.data]\n          },\n        })\n        enqueue.emit(({event}) => {\n          assertEvent(event, 'post')\n          return {\n            type: 'buffer.added',\n            message: event.data,\n          } satisfies BufferAddedEmitEvent<TSendsWithoutResponse>\n        })\n      }),\n      'create request': assign({\n        requests: ({context, event, self, spawn}) => {\n          assertEvent(event, 'request')\n          const arr = Array.isArray(event.data) ? event.data : [event.data]\n          const requests = arr.map((request) => {\n            const id = `req-${uuid()}`\n            return spawn('requestMachine', {\n              id,\n              input: {\n                channelId: context.channelId,\n                data: request.data,\n                domain: context.domain,\n                expectResponse: request.expectResponse,\n                from: context.name,\n                parentRef: self,\n                responseTo: request.responseTo,\n                sources: context.target!,\n                targetOrigin: context.targetOrigin,\n                to: context.connectTo,\n                type: request.type,\n              },\n            })\n          })\n          return [...context.requests, ...requests]\n        },\n      }),\n      'emit received message': enqueueActions(({enqueue}) => {\n        enqueue.emit(({event}) => {\n          assertEvent(event, 'message.received')\n          return {\n            type: 'message',\n            message: event.message.data,\n          }\n        })\n      }),\n      'emit status': emit((_, params: {status: Status}) => {\n        return {\n          type: 'status',\n          status: params.status,\n        } satisfies StatusEmitEvent\n      }),\n      'post message': raise(({event}) => {\n        assertEvent(event, 'post')\n        return {\n          type: 'request' as const,\n          data: {\n            data: event.data.data,\n            expectResponse: true,\n            type: event.data.type,\n          },\n        }\n      }),\n      'remove request': enqueueActions(({context, enqueue, event}) => {\n        assertEvent(event, ['request.success', 'request.failed', 'request.aborted'])\n        stopChild(event.requestId)\n        enqueue.assign({requests: context.requests.filter(({id}) => id !== event.requestId)})\n      }),\n      'respond': raise(({event}) => {\n        assertEvent(event, 'response')\n        return {\n          type: 'request' as const,\n          data: {\n            data: event.data,\n            type: MSG_RESPONSE,\n            responseTo: event.respondTo,\n          },\n        }\n      }),\n\n      'send handshake ack': raise({\n        type: 'request',\n        data: {type: MSG_HANDSHAKE_ACK},\n      }),\n      'send disconnect': raise(() => {\n        return {\n          type: 'request' as const,\n          data: {type: MSG_DISCONNECT},\n        }\n      }),\n      'send handshake syn': raise({\n        type: 'request',\n        data: {type: MSG_HANDSHAKE_SYN},\n      }),\n      'send pending messages': enqueueActions(({enqueue}) => {\n        enqueue.raise(({context}) => ({\n          type: 'request',\n          data: context.buffer.map(({data, type}) => ({data, type})),\n        }))\n        enqueue.emit(({context}) => {\n          return {\n            type: 'buffer.flushed',\n            messages: context.buffer,\n          } satisfies BufferFlushedEmitEvent<TSendsWithoutResponse>\n        })\n        enqueue.assign({\n          buffer: [],\n        })\n      }),\n      'set target': assign({\n        target: ({event}) => {\n          assertEvent(event, 'target.set')\n          return event.target\n        },\n      }),\n    },\n    guards: {\n      'has target': ({context}) => !!context.target,\n      'should send heartbeats': ({context}) => context.heartbeat,\n    },\n  }).createMachine({\n    /** @xstate-layout N4IgpgJg5mDOIC5QGMAWBDAdpsAbAxAC7oBOMhAdLGIQNoAMAuoqAA4D2sAloV+5ixAAPRAHZRAJgoAWABz0ArHICMy2QGZZCgJwAaEAE9EE+tIrb6ANgkLl46fTuj1AXxf60WHARJgAjgCucJSwAcjIcLAMzEggHNy8-IIiCKLS2hQS6qb2yurisrL6RgjK9LIyCuqq0g7WstZuHhjYePi+gcEUAGboXLiQ0YLxPHwCsSmiCgoykpayDtqS6trqxYjKEk0gnq24FFwQA-jI-DjIdEzDnKNJExuOZpZ12eq29OrSCuupypYUojUaTKCnm5Wk2123gORzA+HilxibBuiXGoBSGnUAIU4gU9FWamUtR+lmUM1EllBEkslMUEnpkJa0JaEFgGAA1lxMFB8LADJghrERqjkhtshk3mTtNo5OpqpYfqCKhTptoqpY1WUtu4dky8BQWWz0Jzue1-EFYIjrgkxqLSupqRRPpoPqJtLI0hIioZENJJE7NnJ8ZYHVk1YyvPrDRyuTyEYLkTa7uixVlMh81KGFhS1j6EPkZlpVjTphr8mkI3sDVhWTHTQBbSLoGAUXwRLgAN0GVyFKNt91KimUFEKXvKC2s9R+6X+jipnzJeSqEJ1UKjNaNJp5EC4sFOrQuCbifeTwg2cgoym0RPxDtqkj0eaB9Ao8zSolMEivZVcq71+33c5CEgeFOCtXskzRM8EDxKRpmkSw3QJbQsmpH5tHmV8JHSbJpDsakV2aSMALOMALhAjoLXAxNbiglI-SxWw1Vw0QNDw0Qfg9KQ7EJSxHHxApK2hQCyOAiAzVgDhMGoI9hX7FMEHSF8cWkelpHURCbBsb481xAEgT9BQJCmWQsiE-URPI8TG1gWBmzAVsyLATtuyRY9ILtWoKmlL82Kqd0tAVJ91LMHFZDKIkVlkNVZHMkiDzE-Adz3UjDx7GiRQHCKnheD53k+HSSkDDIwpBVTqQwuKKEssSDTAUhCAAI3qyg0DIrd8Fkk86MQUMnVM+RynoegTDJH48hGp0vR-FDRqqKqasgOqGua9AQjATAd1NSiul6fpXOtWi7Wy19cslD4vnG7IX3oVjVDUVYEJQqrksW8SdstLqPKy0wKgG1RhtMWogqKhoMjkWp6XxUyFBe3c3tAz70vco6fq+V8PTkGUFzdQqNnELEM2yClrwwzQ4ZShKQJqr7UYU98AS0W9pT4z5pHG0yXwMkNNTyGk3B1TB2AgOBBDXXBDsyhSFG9EovQqN5i1JeRcKqw4Bkl+ToMx8x0j+EaqQ9XMSkBURMgMkEwQWKro2NWNNdPFJAzN0lJGM4slDxhBEJfXyplBd03wW1KxIdnrBxBh4JAyW75C8rJpmDqmIGWkgmpasPjqUcaHooMLHA0uU1UkJOgKW1B6rT1bWor5At0zgcTAkK7hrz1irB0D8cW0UvRPLyv07WqgNq2qAG+l9SnXUz0UOXD5xuMs3Y4+DVJBX7UiKrV6Q8gcfoJO54rFefLLqfJYX1WKYNLxL4NO1NwgA */\n    id: 'connection',\n    context: ({input}) => ({\n      id: input.id || `${input.name}-${uuid()}`,\n      buffer: [],\n      channelId: `chn-${uuid()}`,\n      connectTo: input.connectTo,\n      domain: input.domain ?? DOMAIN,\n      heartbeat: input.heartbeat ?? false,\n      name: input.name,\n      requests: [],\n      target: input.target,\n      targetOrigin: input.targetOrigin,\n    }),\n    on: {\n      'target.set': {\n        actions: 'set target',\n      },\n      'request.success': {\n        actions: 'remove request',\n      },\n      'request.failed': {\n        actions: 'remove request',\n      },\n    },\n    initial: 'idle',\n    states: {\n      idle: {\n        entry: [{type: 'emit status', params: {status: 'idle'}}],\n        on: {\n          connect: {\n            target: 'handshaking',\n            guard: 'has target',\n          },\n          post: {\n            actions: 'buffer message',\n          },\n        },\n      },\n      handshaking: {\n        id: 'handshaking',\n        entry: [{type: 'emit status', params: {status: 'handshaking'}}],\n        invoke: [\n          {\n            id: 'send syn',\n            src: 'sendBackAtInterval',\n            input: () => ({\n              event: {type: 'syn'},\n              interval: HANDSHAKE_INTERVAL,\n              immediate: true,\n            }),\n          },\n          {\n            id: 'listen for handshake',\n            src: 'listen',\n            input: (input) =>\n              listenInputFromContext({\n                include: MSG_HANDSHAKE_SYN_ACK,\n                count: 1,\n              })(input),\n            /* Below would maybe be more readable than transitioning to\n          'connected' on 'message', and 'ack' on exit but having onDone when\n          using passing invocations currently breaks XState Editor */\n            // onDone: {\n            //   target: 'connected',\n            //   actions: 'ack',\n            // },\n          },\n        ],\n        on: {\n          'syn': {\n            actions: 'send handshake syn',\n          },\n          'request': {\n            actions: 'create request',\n          },\n          'post': {\n            actions: 'buffer message',\n          },\n          'message.received': {\n            target: 'connected',\n          },\n          'disconnect': {\n            target: 'disconnected',\n          },\n        },\n        exit: 'send handshake ack',\n      },\n      connected: {\n        entry: ['send pending messages', {type: 'emit status', params: {status: 'connected'}}],\n        invoke: {\n          id: 'listen for messages',\n          src: 'listen',\n          input: listenInputFromContext({\n            exclude: [MSG_RESPONSE, MSG_HEARTBEAT],\n          }),\n        },\n        on: {\n          'post': {\n            actions: 'post message',\n          },\n          'request': {\n            actions: 'create request',\n          },\n          'response': {\n            actions: 'respond',\n          },\n          'message.received': {\n            actions: 'emit received message',\n          },\n          'disconnect': {\n            target: 'disconnected',\n          },\n        },\n        initial: 'heartbeat',\n        states: {\n          heartbeat: {\n            initial: 'checking',\n            states: {\n              checking: {\n                always: {\n                  guard: 'should send heartbeats',\n                  target: 'sending',\n                },\n              },\n              sending: {\n                on: {\n                  'request.failed': {\n                    target: '#handshaking',\n                  },\n                },\n                invoke: {\n                  id: 'send heartbeat',\n                  src: 'sendBackAtInterval',\n                  input: () => ({\n                    event: {type: 'post', data: {type: MSG_HEARTBEAT, data: undefined}},\n                    interval: 2000,\n                    immediate: false,\n                  }),\n                },\n              },\n            },\n          },\n        },\n      },\n      disconnected: {\n        id: 'disconnected',\n        entry: ['send disconnect', {type: 'emit status', params: {status: 'disconnected'}}],\n        on: {\n          request: {\n            actions: 'create request',\n          },\n          post: {\n            actions: 'buffer message',\n          },\n          connect: {\n            target: 'handshaking',\n            guard: 'has target',\n          },\n        },\n      },\n    },\n  })\n\n  return connectionMachine\n}\n\n/**\n * @public\n */\nexport const createConnection = <TSends extends Message, TReceives extends Message>(\n  input: ConnectionInput,\n  machine: ConnectionActorLogic<TSends, TReceives> = createConnectionMachine<TSends, TReceives>(),\n): Connection<TSends, TReceives> => {\n  const id = input.id || `${input.name}-${uuid()}`\n  const actor = createActor(machine, {\n    input: {...input, id},\n  })\n\n  const eventHandlers: Map<\n    string,\n    Set<(event: TReceives['data']) => Promise<TReceives['response']> | TReceives['response']>\n  > = new Map()\n\n  const unhandledMessages: Map<string, Set<ProtocolMessage<Message>>> = new Map()\n\n  const on = <TType extends TReceives['type'], TMessage extends Extract<TReceives, {type: TType}>>(\n    type: TType,\n    handler: (data: TMessage['data']) => Promise<TMessage['response']> | TMessage['response'],\n    options?: {replay?: number},\n  ) => {\n    const handlers = eventHandlers.get(type) || new Set()\n\n    if (!eventHandlers.has(type)) {\n      eventHandlers.set(type, handlers)\n    }\n\n    // Register the new handler\n    handlers.add(handler)\n\n    // Process any unhandled messages for this type\n    const unhandledMessagesForType = unhandledMessages.get(type)\n    if (unhandledMessagesForType) {\n      const replayCount = options?.replay ?? 1\n      const messagesToReplay = Array.from(unhandledMessagesForType).slice(-replayCount)\n\n      // Replay messages to the new handler\n      messagesToReplay.forEach(async ({data, id}) => {\n        const response = await handler(data)\n        if (response) {\n          actor.send({\n            type: 'response',\n            respondTo: id,\n            data: response,\n          })\n        }\n      })\n\n      // Clear the unhandled messages for this type\n      unhandledMessages.delete(type)\n    }\n\n    return () => {\n      handlers.delete(handler)\n    }\n  }\n\n  const connect = () => {\n    actor.send({type: 'connect'})\n  }\n\n  const disconnect = () => {\n    actor.send({type: 'disconnect'})\n  }\n\n  const onStatus = (handler: (status: Status) => void, filter?: Status) => {\n    const subscription = actor.on('status', (event: StatusEmitEvent & {status: Status}) => {\n      if (filter && event.status !== filter) {\n        return\n      }\n\n      handler(event.status)\n    })\n\n    return () => subscription.unsubscribe()\n  }\n\n  const setTarget = (target: MessageEventSource) => {\n    actor.send({type: 'target.set', target})\n  }\n\n  const post = <TType extends TSends['type'], TMessage extends Extract<TSends, {type: TType}>>(\n    type: TType,\n    data?: TMessage['data'],\n  ) => {\n    const _data = {type, data} as WithoutResponse<TMessage>\n    actor.send({type: 'post', data: _data})\n  }\n\n  actor.on('message', async ({message}) => {\n    const handlers = eventHandlers.get(message.type)\n\n    if (handlers) {\n      // Execute all registered handlers for this message type\n      handlers.forEach(async (handler) => {\n        const response = await handler(message.data)\n        if (response) {\n          actor.send({type: 'response', respondTo: message.id, data: response})\n        }\n      })\n      return\n    }\n\n    // Store unhandled messages for potential replay\n    const unhandledMessagesForType = unhandledMessages.get(message.type)\n    if (unhandledMessagesForType) {\n      unhandledMessagesForType.add(message)\n    } else {\n      unhandledMessages.set(message.type, new Set([message]))\n    }\n  })\n\n  const stop = () => {\n    actor.stop()\n  }\n\n  const start = () => {\n    actor.start()\n    return stop\n  }\n\n  return {\n    actor,\n    connect,\n    disconnect,\n    id,\n    name: input.name,\n    machine,\n    on,\n    onStatus,\n    post,\n    setTarget,\n    start,\n    stop,\n    get target() {\n      return actor.getSnapshot().context.target\n    },\n  }\n}\n\n// Helper function to cleanup a connection\nexport const cleanupConnection: (connection: Connection<Message, Message>) => void = (\n  connection,\n) => {\n  connection.disconnect()\n  // Necessary to allow disconnect messages to be sent before the connection\n  // actor is stopped\n  setTimeout(() => {\n    connection.stop()\n  }, 0)\n}\n","import {\n  cleanupConnection,\n  createConnection,\n  createConnectionMachine,\n  type Connection,\n  type ConnectionActorLogic,\n  type ConnectionInput,\n} from './connection'\nimport {type InternalEmitEvent, type Message, type StatusEvent} from './types'\n\n/**\n * @public\n */\nexport type ChannelInput = Omit<ConnectionInput, 'target' | 'targetOrigin'>\n\n/**\n * @public\n */\nexport interface ChannelInstance<TSends extends Message, TReceives extends Message> {\n  on: <TType extends TReceives['type'], TMessage extends Extract<TReceives, {type: TType}>>(\n    type: TType,\n    handler: (data: TMessage['data']) => Promise<TMessage['response']> | TMessage['response'],\n  ) => () => void\n  onInternalEvent: <\n    TType extends InternalEmitEvent<TSends, TReceives>['type'],\n    TEvent extends Extract<InternalEmitEvent<TSends, TReceives>, {type: TType}>,\n  >(\n    type: TType,\n    handler: (event: TEvent) => void,\n  ) => () => void\n  onStatus: (handler: (event: StatusEvent) => void) => void\n  post: <TType extends TSends['type'], TMessage extends Extract<TSends, {type: TType}>>(\n    ...params: (TMessage['data'] extends undefined ? [TType] : never) | [TType, TMessage['data']]\n  ) => void\n  start: () => () => void\n  stop: () => void\n}\n\n/**\n * @public\n */\nexport interface Controller {\n  addTarget: (target: MessageEventSource) => () => void\n  createChannel: <TSends extends Message, TReceives extends Message>(\n    input: ChannelInput,\n    machine?: ConnectionActorLogic<TSends, TReceives>,\n  ) => ChannelInstance<TSends, TReceives>\n  destroy: () => void\n}\n\ninterface Channel<\n  TSends extends Message = Message,\n  TReceives extends Message = Message,\n  TType extends InternalEmitEvent<TSends, TReceives>['type'] = InternalEmitEvent<\n    TSends,\n    TReceives\n  >['type'],\n> {\n  input: ChannelInput\n  connections: Set<Connection<TSends, TReceives>>\n  internalEventSubscribers: Set<{\n    type: TType\n    handler: (event: Extract<InternalEmitEvent<TSends, TReceives>, {type: TType}>) => void\n    unsubscribers: Array<() => void>\n  }>\n  machine: ConnectionActorLogic<TSends, TReceives>\n  statusSubscribers: Set<{\n    handler: (event: StatusEvent) => void\n    unsubscribers: Array<() => void>\n  }>\n  subscribers: Set<{\n    type: TReceives['type']\n    handler: (event: TReceives['data']) => Promise<TReceives['response']> | TReceives['response']\n    unsubscribers: Array<() => void>\n  }>\n}\n\nconst noop = () => {}\n\n/**\n * @public\n */\nexport const createController = (input: {targetOrigin: string}): Controller => {\n  const {targetOrigin} = input\n  const targets = new Set<MessageEventSource>()\n  const channels = new Set<Channel>()\n\n  const addTarget = (target: MessageEventSource) => {\n    // If the target has already been added, return just a noop cleanup\n    if (targets.has(target)) {\n      return noop\n    }\n\n    if (!targets.size || !channels.size) {\n      targets.add(target)\n\n      // If there are existing channels, set the target on all existing\n      // connections, and trigger a connection event\n      channels.forEach((channel) => {\n        channel.connections.forEach((connection) => {\n          connection.setTarget(target)\n          connection.connect()\n        })\n      })\n      // We perform a 'soft' cleanup here: disconnect only as we want to\n      // maintain at least one live connection per channel\n      return () => {\n        targets.delete(target)\n        channels.forEach((channel) => {\n          channel.connections.forEach((connection) => {\n            if (connection.target === target) {\n              connection.disconnect()\n            }\n          })\n        })\n      }\n    }\n\n    targets.add(target)\n\n    // Maintain a list of connections to cleanup\n    const targetConnections = new Set<Connection<Message, Message>>()\n\n    // If we already have targets and channels, we need to create new\n    // connections for each source with all the associated subscribers.\n    channels.forEach((channel) => {\n      const connection = createConnection(\n        {\n          ...channel.input,\n          target,\n          targetOrigin,\n        },\n        channel.machine,\n      )\n\n      targetConnections.add(connection)\n      channel.connections.add(connection)\n\n      channel.subscribers.forEach(({type, handler, unsubscribers}) => {\n        unsubscribers.push(connection.on(type, handler))\n      })\n      channel.internalEventSubscribers.forEach(({type, handler, unsubscribers}) => {\n        const subscription = connection.actor.on(type, handler)\n        unsubscribers.push(() => subscription.unsubscribe())\n      })\n      channel.statusSubscribers.forEach(({handler, unsubscribers}) => {\n        unsubscribers.push(\n          connection.onStatus((status) => handler({connection: connection.id, status})),\n        )\n      })\n\n      connection.start()\n      connection.connect()\n    })\n\n    // We perform a more 'aggressive' cleanup here as we do not need to maintain\n    // these 'duplicate' connections: disconnect, stop, and remove the connections from\n    // all channels\n    return () => {\n      targets.delete(target)\n      targetConnections.forEach((connection) => {\n        cleanupConnection(connection)\n        channels.forEach((channel) => {\n          channel.connections.delete(connection)\n        })\n      })\n    }\n  }\n\n  const createChannel = <TSends extends Message, TReceives extends Message>(\n    input: ChannelInput,\n    machine: ConnectionActorLogic<TSends, TReceives> = createConnectionMachine<TSends, TReceives>(),\n  ): ChannelInstance<TSends, TReceives> => {\n    const channel: Channel<TSends, TReceives> = {\n      connections: new Set(),\n      input,\n      internalEventSubscribers: new Set(),\n      machine,\n      statusSubscribers: new Set(),\n      subscribers: new Set(),\n    }\n\n    channels.add(channel as unknown as Channel)\n\n    const {connections, internalEventSubscribers, statusSubscribers, subscribers} = channel\n\n    if (targets.size) {\n      // If targets have already been added, create a connection for each target\n      targets.forEach((target) => {\n        const connection = createConnection<TSends, TReceives>(\n          {\n            ...input,\n            target,\n            targetOrigin,\n          },\n          machine,\n        )\n        connections.add(connection)\n      })\n    } else {\n      // If targets have not been added yet, create a connection without a target\n      const connection = createConnection<TSends, TReceives>({...input, targetOrigin}, machine)\n      connections.add(connection)\n    }\n\n    const post: ChannelInstance<TSends, TReceives>['post'] = (...params) => {\n      const [type, data] = params\n      connections.forEach((connection) => {\n        connection.post(type, data)\n      })\n    }\n\n    const on: ChannelInstance<TSends, TReceives>['on'] = (type, handler) => {\n      const unsubscribers: Array<() => void> = []\n      connections.forEach((connection) => {\n        unsubscribers.push(connection.on(type, handler))\n      })\n      const subscriber = {type, handler, unsubscribers}\n      subscribers.add(subscriber)\n      return () => {\n        unsubscribers.forEach((unsub) => unsub())\n        subscribers.delete(subscriber)\n      }\n    }\n\n    const onInternalEvent = <\n      TType extends InternalEmitEvent<TSends, TReceives>['type'],\n      TEvent extends Extract<InternalEmitEvent<TSends, TReceives>, {type: TType}>,\n    >(\n      type: TType,\n      handler: (event: TEvent) => void,\n    ) => {\n      const unsubscribers: Array<() => void> = []\n      connections.forEach((connection) => {\n        // @ts-expect-error @todo @help\n        const subscription = connection.actor.on(type, handler)\n        unsubscribers.push(() => subscription.unsubscribe())\n      })\n      const subscriber = {type, handler, unsubscribers}\n      // @ts-expect-error @todo @help\n      internalEventSubscribers.add(subscriber)\n      return () => {\n        unsubscribers.forEach((unsub) => unsub())\n        // @ts-expect-error @todo @help\n        internalEventSubscribers.delete(subscriber)\n      }\n    }\n\n    const onStatus = (handler: (event: StatusEvent) => void) => {\n      const unsubscribers: Array<() => void> = []\n      connections.forEach((connection) => {\n        unsubscribers.push(\n          connection.onStatus((status) => handler({connection: connection.id, status})),\n        )\n      })\n      const subscriber = {handler, unsubscribers}\n      statusSubscribers.add(subscriber)\n      return () => {\n        unsubscribers.forEach((unsub) => unsub())\n        statusSubscribers.delete(subscriber)\n      }\n    }\n\n    // Stop a connection, cleanup all connections and remove the connection itself\n    // from the controller\n    // @todo Remove casting\n    const stop = () => {\n      const connections = channel.connections as unknown as Set<Connection>\n      connections.forEach(cleanupConnection)\n      connections.clear()\n      channels.delete(channel as unknown as Channel)\n    }\n\n    const start = () => {\n      connections.forEach((connection) => {\n        connection.start()\n        connection.connect()\n      })\n\n      return stop\n    }\n\n    return {\n      on,\n      onInternalEvent,\n      onStatus,\n      post,\n      start,\n      stop,\n    }\n  }\n\n  // Destroy the controller, cleanup all connections in all channels\n  const destroy = () => {\n    channels.forEach(({connections}) => {\n      connections.forEach(cleanupConnection)\n      connections.clear()\n    })\n    channels.clear()\n    targets.clear()\n  }\n\n  return {\n    addTarget,\n    createChannel,\n    destroy,\n  }\n}\n","// Returns Promise.withResolvers or polyfill if unavailable\nexport function createPromiseWithResolvers<T = unknown>(): {\n  promise: Promise<T>\n  resolve: (value: T | PromiseLike<T>) => void\n  reject: (reason?: any) => void\n} {\n  if (typeof Promise.withResolvers === 'function') {\n    return Promise.withResolvers<T>()\n  }\n\n  let resolve!: (value: T | PromiseLike<T>) => void\n  let reject!: (reason?: any) => void\n\n  const promise = new Promise<T>((res, rej) => {\n    resolve = res\n    reject = rej\n  })\n\n  return {promise, resolve, reject}\n}\n","import {v4 as uuid} from 'uuid'\nimport {\n  assertEvent,\n  assign,\n  createActor,\n  emit,\n  enqueueActions,\n  raise,\n  setup,\n  stopChild,\n  type ActorRefFrom,\n} from 'xstate'\nimport {createListenLogic, listenInputFromContext} from './common'\nimport {\n  DOMAIN,\n  FETCH_TIMEOUT_DEFAULT,\n  MSG_DISCONNECT,\n  MSG_HANDSHAKE_ACK,\n  MSG_HANDSHAKE_SYN,\n  MSG_HANDSHAKE_SYN_ACK,\n  MSG_HEARTBEAT,\n  MSG_RESPONSE,\n} from './constants'\nimport {createRequestMachine, type RequestActorRef} from './request'\nimport type {\n  BufferAddedEmitEvent,\n  BufferFlushedEmitEvent,\n  HeartbeatEmitEvent,\n  HeartbeatMessage,\n  Message,\n  MessageEmitEvent,\n  ProtocolMessage,\n  RequestData,\n  Status,\n  StatusEmitEvent,\n  WithoutResponse,\n} from './types'\nimport {createPromiseWithResolvers} from './util'\n\n/**\n * @public\n */\nexport interface NodeInput {\n  name: string\n  connectTo: string\n  domain?: string\n}\n\n/**\n * @public\n */\nexport type NodeActorLogic<TSends extends Message, TReceives extends Message> = ReturnType<\n  typeof createNodeMachine<TSends, TReceives>\n>\n\n/**\n * @public\n */\nexport type NodeActor<TSends extends Message, TReceives extends Message> = ActorRefFrom<\n  NodeActorLogic<TSends, TReceives>\n>\n\n/**\n * @public\n */\nexport type Node<TSends extends Message, TReceives extends Message> = {\n  actor: NodeActor<TSends, TReceives>\n  fetch: <TType extends TSends['type'], TMessage extends Extract<TSends, {type: TType}>>(\n    ...params:\n      | (TMessage['data'] extends undefined ? [TType] : never)\n      | [TType, TMessage['data']]\n      | [TType, TMessage['data'], {signal?: AbortSignal; suppressWarnings?: boolean}]\n  ) => TSends extends TMessage\n    ? TSends['type'] extends TType\n      ? Promise<TSends['response']>\n      : never\n    : never\n  machine: NodeActorLogic<TSends, TReceives>\n  on: <TType extends TReceives['type'], TMessage extends Extract<TReceives, {type: TType}>>(\n    type: TType,\n    handler: (event: TMessage['data']) => TMessage['response'],\n  ) => () => void\n  onStatus: (\n    handler: (status: Exclude<Status, 'disconnected'>) => void,\n    filter?: Exclude<Status, 'disconnected'>,\n  ) => () => void\n  post: <TType extends TSends['type'], TMessage extends Extract<TSends, {type: TType}>>(\n    ...params: (TMessage['data'] extends undefined ? [TType] : never) | [TType, TMessage['data']]\n  ) => void\n  start: () => () => void\n  stop: () => void\n}\n\n/**\n * @public\n */\nexport const createNodeMachine = <\n  TSends extends Message, // Sends\n  TReceives extends Message, // Receives\n  TSendsWithoutResponse extends WithoutResponse<TSends> = WithoutResponse<TSends>,\n>() => {\n  const nodeMachine = setup({\n    types: {} as {\n      children: {\n        'listen for disconnect': 'listen'\n        'listen for handshake ack': 'listen'\n        'listen for handshake syn': 'listen'\n        'listen for heartbeat': 'listen'\n        'listen for messages': 'listen'\n      }\n      context: {\n        buffer: Array<{\n          data: TSendsWithoutResponse\n          resolvable?: PromiseWithResolvers<TSends['response']>\n          options?: {\n            signal?: AbortSignal\n            suppressWarnings?: boolean\n          }\n        }>\n        channelId: string | null\n        connectTo: string\n        domain: string\n        // The handshake buffer is a workaround to maintain backwards\n        // compatibility with the Sanity channels package, which may incorrectly\n        // send buffered messages _before_ it completes the handshake (i.e.\n        // sends an ack message). It should be removed in the next major.\n        handshakeBuffer: Array<{\n          type: 'message.received'\n          message: MessageEvent<ProtocolMessage<TReceives>>\n        }>\n        name: string\n        requests: Array<RequestActorRef<TSends>>\n        target: MessageEventSource | undefined\n        targetOrigin: string | null\n      }\n      emitted:\n        | BufferAddedEmitEvent<TSendsWithoutResponse>\n        | BufferFlushedEmitEvent<TSendsWithoutResponse>\n        | HeartbeatEmitEvent\n        | MessageEmitEvent<TReceives>\n        | (StatusEmitEvent & {status: Exclude<Status, 'disconnected'>})\n      events:\n        | {type: 'heartbeat.received'; message: MessageEvent<ProtocolMessage<HeartbeatMessage>>}\n        | {type: 'message.received'; message: MessageEvent<ProtocolMessage<TReceives>>}\n        | {type: 'handshake.syn'; message: MessageEvent<ProtocolMessage<TReceives>>}\n        | {\n            type: 'post'\n            data: TSendsWithoutResponse\n            resolvable?: PromiseWithResolvers<TSends['response']>\n            options?: {\n              responseTimeout?: number\n              signal?: AbortSignal\n              suppressWarnings?: boolean\n            }\n          }\n        | {type: 'request.aborted'; requestId: string}\n        | {type: 'request.failed'; requestId: string}\n        | {\n            type: 'request.success'\n            requestId: string\n            response: TSends['response'] | null\n            responseTo: string | undefined\n          }\n        | {type: 'request'; data: RequestData<TSends> | RequestData<TSends>[]} // @todo align with 'post' type\n      input: NodeInput\n    },\n    actors: {\n      requestMachine: createRequestMachine<TSends>(),\n      listen: createListenLogic(),\n    },\n    actions: {\n      'buffer handshake': assign({\n        handshakeBuffer: ({event, context}) => {\n          assertEvent(event, 'message.received')\n          return [...context.handshakeBuffer, event]\n        },\n      }),\n      'buffer message': enqueueActions(({enqueue}) => {\n        enqueue.assign({\n          buffer: ({event, context}) => {\n            assertEvent(event, 'post')\n            return [\n              ...context.buffer,\n              {\n                data: event.data,\n                resolvable: event.resolvable,\n                options: event.options,\n              },\n            ]\n          },\n        })\n        enqueue.emit(({event}) => {\n          assertEvent(event, 'post')\n          return {\n            type: 'buffer.added',\n            message: event.data,\n          } satisfies BufferAddedEmitEvent<TSendsWithoutResponse>\n        })\n      }),\n      'create request': assign({\n        requests: ({context, event, self, spawn}) => {\n          assertEvent(event, 'request')\n          const arr = Array.isArray(event.data) ? event.data : [event.data]\n          const requests = arr.map((request) => {\n            const id = `req-${uuid()}`\n            return spawn('requestMachine', {\n              id,\n              input: {\n                channelId: context.channelId!,\n                data: request.data,\n                domain: context.domain!,\n                expectResponse: request.expectResponse,\n                from: context.name,\n                parentRef: self,\n                resolvable: request.resolvable,\n                responseTimeout: request.options?.responseTimeout,\n                responseTo: request.responseTo,\n                signal: request.options?.signal,\n                sources: context.target!,\n                suppressWarnings: request.options?.suppressWarnings,\n                targetOrigin: context.targetOrigin!,\n                to: context.connectTo,\n                type: request.type,\n              },\n            })\n          })\n          return [...context.requests, ...requests]\n        },\n      }),\n      'emit heartbeat': emit(() => {\n        return {\n          type: 'heartbeat',\n        } satisfies HeartbeatEmitEvent\n      }),\n      'emit received message': enqueueActions(({enqueue}) => {\n        enqueue.emit(({event}) => {\n          assertEvent(event, 'message.received')\n          return {\n            type: 'message',\n            message: event.message.data,\n          }\n        })\n      }),\n      'emit status': emit((_, params: {status: Exclude<Status, 'disconnected'>}) => {\n        return {\n          type: 'status',\n          status: params.status,\n        } satisfies StatusEmitEvent & {status: Exclude<Status, 'disconnected'>}\n      }),\n      'post message': raise(({event}) => {\n        assertEvent(event, 'post')\n        return {\n          type: 'request' as const,\n          data: {\n            data: event.data.data,\n            expectResponse: event.resolvable ? true : false,\n            type: event.data.type,\n            resolvable: event.resolvable,\n            options: event.options,\n          },\n        }\n      }),\n      'process pending handshakes': enqueueActions(({context, enqueue}) => {\n        context.handshakeBuffer.forEach((event) => enqueue.raise(event))\n        enqueue.assign({\n          handshakeBuffer: [],\n        })\n      }),\n      'remove request': enqueueActions(({context, enqueue, event}) => {\n        assertEvent(event, ['request.success', 'request.failed', 'request.aborted'])\n        stopChild(event.requestId)\n        enqueue.assign({requests: context.requests.filter(({id}) => id !== event.requestId)})\n      }),\n      'send response': raise(({event}) => {\n        assertEvent(event, ['message.received', 'heartbeat.received'])\n        return {\n          type: 'request' as const,\n          data: {\n            type: MSG_RESPONSE,\n            responseTo: event.message.data.id,\n            data: undefined,\n          },\n        }\n      }),\n      'send handshake syn ack': raise({\n        type: 'request',\n        data: {type: MSG_HANDSHAKE_SYN_ACK},\n      }),\n      'send pending messages': enqueueActions(({enqueue}) => {\n        enqueue.raise(({context}) => ({\n          type: 'request',\n          data: context.buffer.map(({data, resolvable, options}) => ({\n            data: data.data,\n            type: data.type,\n            expectResponse: resolvable ? true : false,\n            resolvable,\n            options,\n          })),\n        }))\n        enqueue.emit(({context}) => {\n          return {\n            type: 'buffer.flushed',\n            messages: context.buffer.map(({data}) => data),\n          } satisfies BufferFlushedEmitEvent<TSendsWithoutResponse>\n        })\n        enqueue.assign({\n          buffer: [],\n        })\n      }),\n      'set connection config': assign({\n        channelId: ({event}) => {\n          assertEvent(event, 'handshake.syn')\n          return event.message.data.channelId\n        },\n        target: ({event}) => {\n          assertEvent(event, 'handshake.syn')\n          return event.message.source || undefined\n        },\n        targetOrigin: ({event}) => {\n          assertEvent(event, 'handshake.syn')\n          return event.message.origin\n        },\n      }),\n    },\n    guards: {\n      hasSource: ({context}) => context.target !== null,\n    },\n  }).createMachine({\n    /** @xstate-layout N4IgpgJg5mDOIC5QDsD2EwGIBOYCOArnAC4B0sBAxpXLANoAMAuoqAA6qwCWxXqyrEAA9EAVgYAWUgEYJDUQA4JAZmUSJC0coDsAGhABPRNIYLSErdOkBOAGzbx227YUBfV-rQYc+IrDIAZgCGXAA2kIwsSCAc3Lz8giIIoiakqgBMDKbp2tYS0srp+kYI0ununuhgpFwQ4ZgQ-NVcyABuqADW1V7NdWAILe2UQfHIkZGCsTx8AtFJ6aKipAzWOtrpC7Z5BUWGiNoK6aS26RLW2tLaqkqqFSA9NX2YALa0QTCkuDRcrRHMk5xpgk5ogJLZSNZIVDoVCFLZiohbIVSLkXLZRHZDgxbHcHrV6rFiBNolNRolEVJbCsdGUzsoyhiEcllOC1DowelVmVrOUPPcqqQABZBZAQWDCjotKANJo1NqdboC4Wi8VBSXIKADeXDUbjf4kwFkkEILbg8RZMHKOzWKzKJkHJa086Xa4qZS4pUisUSqU+QgkYnsQ0zcnJaRLDbpZwKNQSBYspm2MEyC5KTnaDSSd18h7K71q32EwMxYPA0BJFLKY5yZxIrKSURM0RnFHSBTrQqQ9babQejBCr2q9XSiBcWCUfjIMCUIn6oNxEPGtTWFFR0RUy7iGzt+3Ip0XURXVZKPvVCfIKczyB+vyzqLzoGzcuIG0MGTyCztjRtjaJjbHVMNAUTdu1PUhz0vYhryLOcSwXMthBfK0ZGsLQGBZekCi0Jso1IdI23WG04zOE4wIg6coIgBox3Imdi1JRdnxNOxSHNSQkWtW0mTjMxMQ7fDzgcbNKn7WjKJeN4Pi+MAfj+e84MfUMFHbZZwxOHZNDyO09gQOQjmAhZJCM9IMjIycKOvQUwCCbBiAAI2sshpNkiB6NLJ9EIQBQbWOdJlMhYCUjbJkchXGsFmsJQMVsWl3BzKp4GiHoAXgjykgAWmkZZ6xy3LZF2EobCy6xsQWJQ42kE4FjA-EwBSxTjSRUhDgqkzgO2BxdykU4AvXFQ-KjMC8yHKV6qNJi6WOdcypcZsXGxe0JG0XySKjM5lKsMyLwsiAxsYzylDfONznUEqrmi+1ThkHqXDONbULi1wgA */\n    id: 'node',\n    context: ({input}) => ({\n      buffer: [],\n      channelId: null,\n      connectTo: input.connectTo,\n      domain: input.domain ?? DOMAIN,\n      handshakeBuffer: [],\n      name: input.name,\n      requests: [],\n      target: undefined,\n      targetOrigin: null,\n    }),\n    // Always listen for handshake syn messages. The channel could have\n    // disconnected without being able to notify the node, and so need to\n    // re-establish the connection.\n    invoke: {\n      id: 'listen for handshake syn',\n      src: 'listen',\n      input: listenInputFromContext({\n        include: MSG_HANDSHAKE_SYN,\n        responseType: 'handshake.syn',\n      }),\n    },\n    on: {\n      'request.success': {\n        actions: 'remove request',\n      },\n      'request.failed': {\n        actions: 'remove request',\n      },\n      'request.aborted': {\n        actions: 'remove request',\n      },\n      'handshake.syn': {\n        actions: 'set connection config',\n        target: '.handshaking',\n      },\n    },\n    initial: 'idle',\n    states: {\n      idle: {\n        entry: [{type: 'emit status', params: {status: 'idle'}}],\n        on: {\n          post: {\n            actions: 'buffer message',\n          },\n        },\n      },\n      handshaking: {\n        guard: 'hasSource',\n        entry: ['send handshake syn ack', {type: 'emit status', params: {status: 'handshaking'}}],\n        invoke: [\n          {\n            id: 'listen for handshake ack',\n            src: 'listen',\n            input: listenInputFromContext({\n              include: MSG_HANDSHAKE_ACK,\n              count: 1,\n              // Override the default `message.received` responseType to prevent\n              // buffering the ack message. We transition to the connected state\n              // using onDone instead of listening to this event using `on`\n              responseType: 'handshake.complete',\n            }),\n            onDone: 'connected',\n          },\n          {\n            id: 'listen for disconnect',\n            src: 'listen',\n            input: listenInputFromContext({\n              include: MSG_DISCONNECT,\n              count: 1,\n              responseType: 'disconnect',\n            }),\n          },\n          {\n            id: 'listen for messages',\n            src: 'listen',\n            input: listenInputFromContext({\n              exclude: [\n                MSG_DISCONNECT,\n                MSG_HANDSHAKE_SYN,\n                MSG_HANDSHAKE_ACK,\n                MSG_HEARTBEAT,\n                MSG_RESPONSE,\n              ],\n            }),\n          },\n        ],\n        on: {\n          'request': {\n            actions: 'create request',\n          },\n          'post': {\n            actions: 'buffer message',\n          },\n          'message.received': {\n            actions: 'buffer handshake',\n          },\n          'disconnect': {\n            target: 'idle',\n          },\n        },\n      },\n      connected: {\n        entry: [\n          'process pending handshakes',\n          'send pending messages',\n          {type: 'emit status', params: {status: 'connected'}},\n        ],\n        invoke: [\n          {\n            id: 'listen for messages',\n            src: 'listen',\n            input: listenInputFromContext({\n              exclude: [\n                MSG_DISCONNECT,\n                MSG_HANDSHAKE_SYN,\n                MSG_HANDSHAKE_ACK,\n                MSG_HEARTBEAT,\n                MSG_RESPONSE,\n              ],\n            }),\n          },\n          {\n            id: 'listen for heartbeat',\n            src: 'listen',\n            input: listenInputFromContext({\n              include: MSG_HEARTBEAT,\n              responseType: 'heartbeat.received',\n            }),\n          },\n          {\n            id: 'listen for disconnect',\n            src: 'listen',\n            input: listenInputFromContext({\n              include: MSG_DISCONNECT,\n              count: 1,\n              responseType: 'disconnect',\n            }),\n          },\n        ],\n        on: {\n          'request': {\n            actions: 'create request',\n          },\n          'post': {\n            actions: 'post message',\n          },\n          'disconnect': {\n            target: 'idle',\n          },\n          'message.received': {\n            actions: ['send response', 'emit received message'],\n          },\n          'heartbeat.received': {\n            actions: ['send response', 'emit heartbeat'],\n          },\n        },\n      },\n    },\n  })\n  return nodeMachine\n}\n\n/**\n * @public\n */\nexport const createNode = <TSends extends Message, TReceives extends Message>(\n  input: NodeInput,\n  machine: NodeActorLogic<TSends, TReceives> = createNodeMachine<TSends, TReceives>(),\n): Node<TSends, TReceives> => {\n  const actor = createActor(machine, {\n    input,\n  })\n\n  const eventHandlers: Map<\n    string,\n    Set<(event: TReceives['data']) => TReceives['response']>\n  > = new Map()\n\n  const unhandledMessages: Map<string, Set<ProtocolMessage<Message>>> = new Map()\n\n  const on = <TType extends TReceives['type'], TMessage extends Extract<TReceives, {type: TType}>>(\n    type: TType,\n    handler: (event: TMessage['data']) => TMessage['response'],\n    options?: {replay?: number},\n  ) => {\n    const handlers = eventHandlers.get(type) || new Set()\n\n    if (!eventHandlers.has(type)) {\n      eventHandlers.set(type, handlers)\n    }\n\n    // Register the new handler\n    handlers.add(handler)\n\n    // Process any unhandled messages for this type\n    const unhandledMessagesForType = unhandledMessages.get(type)\n    if (unhandledMessagesForType) {\n      const replayCount = options?.replay ?? 1\n      const messagesToReplay = Array.from(unhandledMessagesForType).slice(-replayCount)\n\n      // Replay messages to the new handler\n      messagesToReplay.forEach(({data}) => handler(data))\n\n      // Clear the unhandled messages for this type\n      unhandledMessages.delete(type)\n    }\n\n    return () => {\n      handlers.delete(handler)\n    }\n  }\n\n  let cachedStatus: Exclude<Status, 'disconnected'>\n  const onStatus = (\n    handler: (status: Exclude<Status, 'disconnected'>) => void,\n    filter?: Exclude<Status, 'disconnected'>,\n  ) => {\n    const subscription = actor.on(\n      'status',\n      (event: StatusEmitEvent & {status: Exclude<Status, 'disconnected'>}) => {\n        cachedStatus = event.status\n        if (filter && event.status !== filter) {\n          return\n        }\n\n        handler(event.status)\n      },\n    )\n\n    // Call the handler immediately with the current status, if we have one\n    if (cachedStatus) {\n      handler(cachedStatus)\n    }\n\n    return () => subscription.unsubscribe()\n  }\n\n  const post = <TType extends TSends['type'], TMessage extends Extract<TSends, {type: TType}>>(\n    type: TType,\n    data?: TMessage['data'],\n  ) => {\n    const _data = {type, data} as WithoutResponse<TMessage>\n    actor.send({type: 'post', data: _data})\n  }\n\n  const fetch = <TType extends TSends['type'], TMessage extends Extract<TSends, {type: TType}>>(\n    type: TType,\n    data?: TMessage['data'],\n    options?: {\n      responseTimeout?: number\n      signal?: AbortSignal\n      suppressWarnings?: boolean\n    },\n  ) => {\n    const {responseTimeout = FETCH_TIMEOUT_DEFAULT, signal, suppressWarnings} = options || {}\n\n    const resolvable = createPromiseWithResolvers<TSends['response']>()\n    const _data = {type, data} as WithoutResponse<TMessage>\n\n    actor.send({\n      type: 'post',\n      data: _data,\n      resolvable,\n      options: {responseTimeout, signal, suppressWarnings},\n    })\n    return resolvable.promise as never\n  }\n\n  actor.on('message', ({message}) => {\n    const handlers = eventHandlers.get(message.type)\n\n    if (handlers) {\n      // Execute all registered handlers for this message type\n      handlers.forEach((handler) => handler(message.data))\n      return\n    }\n\n    // Store unhandled messages for potential replay\n    const unhandledMessagesForType = unhandledMessages.get(message.type)\n    if (unhandledMessagesForType) {\n      unhandledMessagesForType.add(message)\n    } else {\n      unhandledMessages.set(message.type, new Set([message]))\n    }\n  })\n\n  const stop = () => {\n    actor.stop()\n  }\n\n  const start = () => {\n    actor.start()\n    return stop\n  }\n\n  return {\n    actor,\n    fetch,\n    machine,\n    on,\n    onStatus,\n    post,\n    start,\n    stop,\n  }\n}\n"],"names":["uuid","id","filter","input","connections"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6],"debugId":null}},
    {"offset": {"line": 10809, "column": 0}, "map": {"version":3,"file":"index.js","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-patch/src/paths.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-patch/src/diffError.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-patch/src/validate.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/diff-patch/src/diffPatch.ts"],"sourcesContent":["import type {KeyedSanityObject} from './diffPatch.js'\n\nconst IS_DOTTABLE_RE = /^[A-Za-z_][A-Za-z0-9_]*$/\n\n/**\n * A segment of a path\n *\n * @public\n */\nexport type PathSegment =\n  | string // Property\n  | number // Array index\n  | {_key: string} // Array `_key` lookup\n  | [number | '', number | ''] // From/to array index\n\n/**\n * An array of path segments representing a path in a document\n *\n * @public\n */\nexport type Path = PathSegment[]\n\n/**\n * Converts an array path to a string path\n *\n * @param path - The array path to convert\n * @returns A stringified path\n * @internal\n */\nexport function pathToString(path: Path): string {\n  return path.reduce((target: string, segment: PathSegment, i: number) => {\n    if (Array.isArray(segment)) {\n      return `${target}[${segment.join(':')}]`\n    }\n\n    if (isKeyedObject(segment)) {\n      return `${target}[_key==\"${segment._key}\"]`\n    }\n\n    if (typeof segment === 'number') {\n      return `${target}[${segment}]`\n    }\n\n    if (typeof segment === 'string' && !IS_DOTTABLE_RE.test(segment)) {\n      return `${target}['${segment}']`\n    }\n\n    if (typeof segment === 'string') {\n      const separator = i === 0 ? '' : '.'\n      return `${target}${separator}${segment}`\n    }\n\n    throw new Error(`Unsupported path segment \"${segment}\"`)\n  }, '')\n}\n\nfunction isKeyedObject(obj: any): obj is KeyedSanityObject {\n  return typeof obj === 'object' && typeof obj._key === 'string'\n}\n","import {type Path, pathToString} from './paths.js'\n\n/**\n * Represents an error that occurred during a diff process.\n * Contains `path`, `value` and `serializedPath` properties,\n * which is helpful for debugging and showing friendly messages.\n *\n * @public\n */\nexport class DiffError extends Error {\n  public path: Path\n  public value: unknown\n  public serializedPath: string\n\n  constructor(message: string, path: Path, value?: unknown) {\n    const serializedPath = pathToString(path)\n    super(`${message} (at '${serializedPath}')`)\n\n    this.path = path\n    this.serializedPath = serializedPath\n    this.value = value\n  }\n}\n","import {DiffError} from './diffError.js'\nimport type {Path} from './paths.js'\n\nconst idPattern = /^[a-z0-9][a-z0-9_.-]+$/i\nconst propPattern = /^[a-zA-Z_][a-zA-Z0-9_-]*$/\nconst propStartPattern = /^[a-z_]/i\n\n/**\n * Validate the given document/subtree for Sanity compatibility\n *\n * @param item - The document or subtree to validate\n * @param path - The path to the current item, for error reporting\n * @returns True if valid, throws otherwise\n * @internal\n */\nexport function validateDocument(item: unknown, path: Path = []): boolean {\n  if (Array.isArray(item)) {\n    return item.every((child, i) => {\n      if (Array.isArray(child)) {\n        throw new DiffError('Multi-dimensional arrays not supported', path.concat(i))\n      }\n\n      return validateDocument(child, path.concat(i))\n    })\n  }\n\n  if (typeof item === 'object' && item !== null) {\n    const obj = item as {[key: string]: any}\n    return Object.keys(obj).every(\n      (key) =>\n        validateProperty(key, obj[key], path) && validateDocument(obj[key], path.concat(key)),\n    )\n  }\n\n  return true\n}\n\n/**\n * Validate a property for Sanity compatibility\n *\n * @param property - The property to valide\n * @param value - The value of the property\n * @param path - The path of the property, for error reporting\n * @returns The property name, if valid\n * @internal\n */\nexport function validateProperty(property: string, value: unknown, path: Path): string {\n  if (!propStartPattern.test(property)) {\n    throw new DiffError('Keys must start with a letter (a-z)', path.concat(property), value)\n  }\n\n  if (!propPattern.test(property)) {\n    throw new DiffError(\n      'Keys can only contain letters, numbers and underscores',\n      path.concat(property),\n      value,\n    )\n  }\n\n  if (property === '_key' || property === '_ref' || property === '_type') {\n    if (typeof value !== 'string') {\n      throw new DiffError('Keys must be strings', path.concat(property), value)\n    }\n\n    if (!idPattern.test(value)) {\n      throw new DiffError('Invalid key - use less exotic characters', path.concat(property), value)\n    }\n  }\n\n  return property\n}\n","import {cleanupEfficiency, makeDiff, makePatches, stringifyPatches} from '@sanity/diff-match-patch'\nimport {DiffError} from './diffError.js'\nimport {type Path, pathToString} from './paths.js'\nimport {validateProperty} from './validate.js'\nimport {\n  type Patch,\n  type SetPatch,\n  type UnsetPatch,\n  type InsertAfterPatch,\n  type DiffMatchPatch,\n  type SanityInsertPatch,\n  type SanityPatch,\n  type SanitySetPatch,\n  type SanityUnsetPatch,\n  type SanityDiffMatchPatch,\n  type SanityPatchMutation,\n} from './patches.js'\n\nconst ignoredKeys = ['_id', '_type', '_createdAt', '_updatedAt', '_rev']\n\ntype PrimitiveValue = string | number | boolean | null | undefined\n\n/**\n * An object (record) that has a `_key` property\n *\n * @internal\n */\nexport interface KeyedSanityObject {\n  [key: string]: unknown\n  _key: string\n}\n\n/**\n * An object (record) that _may_ have a `_key` property\n *\n * @internal\n */\nexport type SanityObject = KeyedSanityObject | Partial<KeyedSanityObject>\n\n/**\n * Represents a partial Sanity document (eg a \"stub\").\n *\n * @public\n */\nexport interface DocumentStub {\n  _id?: string\n  _type?: string\n  _rev?: string\n  _createdAt?: string\n  _updatedAt?: string\n  [key: string]: unknown\n}\n\n/**\n * Options for the diff-match-patch algorithm.\n *\n * @public\n */\nexport interface DiffMatchPatchOptions {\n  /**\n   * Whether or not to use diff-match-patch at all\n   *\n   * @defaultValue `true`\n   */\n  enabled: boolean\n\n  /**\n   * Threshold at which to start using diff-match-patch instead of a regular `set` patch.\n   *\n   * @defaultValue `30`\n   */\n  lengthThresholdAbsolute: number\n\n  /**\n   * Only use generated diff-match-patch if the patch length is less than or equal to\n   * (targetString * relative). Example: A 100 character target with a relative factor\n   * of 1.2 will allow a 120 character diff-match-patch. If larger than this number,\n   * it will fall back to a regular `set` patch.\n   *\n   * @defaultValue `1.2`\n   */\n  lengthThresholdRelative: number\n}\n\n/**\n * Options for the patch generator\n *\n * @public\n */\nexport interface PatchOptions {\n  /**\n   * Document ID to apply the patch to.\n   *\n   * @defaultValue `undefined` - tries to extract `_id` from passed document\n   */\n  id?: string\n\n  /**\n   * Base path to apply the patch to - useful if diffing sub-branches of a document.\n   *\n   * @defaultValue `[]` - eg root of the document\n   */\n  basePath?: Path\n\n  /**\n   * Only apply the patch if the document revision matches this value.\n   * If the property is the boolean value `true`, it will attempt to extract\n   * the revision from the document `_rev` property.\n   *\n   * @defaultValue `undefined` (do not apply revision check)\n   */\n  ifRevisionID?: string | true\n\n  /**\n   * Whether or not to hide warnings during the diff process.\n   *\n   * @defaultValue `false`\n   */\n  hideWarnings?: boolean\n\n  /**\n   * Options for the diff-match-patch algorithm.\n   */\n  diffMatchPatch?: Partial<DiffMatchPatchOptions>\n}\n\n/**\n * Options for diff generation, where all DMP properties are required\n *\n * @public\n */\nexport type DiffOptions = PatchOptions & {diffMatchPatch: Required<DiffMatchPatchOptions>}\n\nconst defaultOptions = {\n  hideWarnings: false,\n  diffMatchPatch: {\n    enabled: true,\n\n    // Only use diff-match-patch if target string is longer than this threshold\n    lengthThresholdAbsolute: 30,\n\n    // Only use generated diff-match-patch if the patch length is less than or equal to\n    // (targetString * relative). Example: A 100 character target with a relative factor\n    // of 1.2 will allow a 120 character diff-match-patch. If larger than this number,\n    // it will fall back to a regular `set` patch.\n    lengthThresholdRelative: 1.2,\n  },\n} satisfies DiffOptions\n\n/**\n * Merges the default options with the passed in options.\n *\n * @param options - Options to merge with the defaults\n * @returns Merged options\n */\nfunction mergeOptions(options: PatchOptions): DiffOptions {\n  return {\n    ...defaultOptions,\n    ...options,\n    diffMatchPatch: {...defaultOptions.diffMatchPatch, ...(options.diffMatchPatch || {})},\n  }\n}\n\n/**\n * Generates an array of mutations for Sanity, based on the differences between\n * the two passed documents/trees.\n *\n * @param itemA - The first document/tree to compare\n * @param itemB - The second document/tree to compare\n * @param opts - Options for the diff generation\n * @returns Array of mutations\n * @public\n */\nexport function diffPatch(\n  itemA: DocumentStub,\n  itemB: DocumentStub,\n  opts?: PatchOptions,\n): SanityPatchMutation[] {\n  const options = mergeOptions(opts || {})\n  const id = options.id || (itemA._id === itemB._id && itemA._id)\n  const revisionLocked = options.ifRevisionID\n  const ifRevisionID = typeof revisionLocked === 'boolean' ? itemA._rev : revisionLocked\n  const basePath = options.basePath || []\n  if (!id) {\n    throw new Error(\n      '_id on itemA and itemB not present or differs, specify document id the mutations should be applied to',\n    )\n  }\n\n  if (revisionLocked === true && !ifRevisionID) {\n    throw new Error(\n      '`ifRevisionID` is set to `true`, but no `_rev` was passed in item A. Either explicitly set `ifRevisionID` to a revision, or pass `_rev` as part of item A.',\n    )\n  }\n\n  if (basePath.length === 0 && itemA._type !== itemB._type) {\n    throw new Error(`_type is immutable and cannot be changed (${itemA._type} => ${itemB._type})`)\n  }\n\n  const operations = diffItem(itemA, itemB, options, basePath, [])\n  return serializePatches(operations, {id, ifRevisionID: revisionLocked ? ifRevisionID : undefined})\n}\n\n/**\n * Diffs two items and returns an array of patches.\n * Note that this is different from `diffPatch`, which generates _mutations_.\n *\n * @param itemA - The first item to compare\n * @param itemB - The second item to compare\n * @param opts - Options for the diff generation\n * @param path - Path to the current item\n * @param patches - Array of patches to append the results to. Note that this is MUTATED.\n * @returns Array of patches\n * @public\n */\nexport function diffItem(\n  itemA: unknown,\n  itemB: unknown,\n  opts: DiffOptions = defaultOptions,\n  path: Path = [],\n  patches: Patch[] = [],\n): Patch[] {\n  if (itemA === itemB) {\n    return patches\n  }\n\n  const aType = Array.isArray(itemA) ? 'array' : typeof itemA\n  const bType = Array.isArray(itemB) ? 'array' : typeof itemB\n\n  const aIsUndefined = aType === 'undefined'\n  const bIsUndefined = bType === 'undefined'\n\n  if (aIsUndefined && !bIsUndefined) {\n    patches.push({op: 'set', path, value: itemB})\n    return patches\n  }\n\n  if (!aIsUndefined && bIsUndefined) {\n    patches.push({op: 'unset', path})\n    return patches\n  }\n\n  const options = mergeOptions(opts)\n  const dataType = aIsUndefined ? bType : aType\n  const isContainer = dataType === 'object' || dataType === 'array'\n  if (!isContainer) {\n    return diffPrimitive(itemA as PrimitiveValue, itemB as PrimitiveValue, options, path, patches)\n  }\n\n  if (aType !== bType) {\n    // Array => Object / Object => Array\n    patches.push({op: 'set', path, value: itemB})\n    return patches\n  }\n\n  return dataType === 'array'\n    ? diffArray(itemA as unknown[], itemB as unknown[], options, path, patches)\n    : diffObject(itemA as object, itemB as object, options, path, patches)\n}\n\nfunction diffObject(\n  itemA: SanityObject,\n  itemB: SanityObject,\n  options: DiffOptions,\n  path: Path,\n  patches: Patch[],\n) {\n  const atRoot = path.length === 0\n  const aKeys = Object.keys(itemA)\n    .filter(atRoot ? isNotIgnoredKey : yes)\n    .map((key) => validateProperty(key, itemA[key], path))\n\n  const aKeysLength = aKeys.length\n  const bKeys = Object.keys(itemB)\n    .filter(atRoot ? isNotIgnoredKey : yes)\n    .map((key) => validateProperty(key, itemB[key], path))\n\n  const bKeysLength = bKeys.length\n\n  // Check for deleted items\n  for (let i = 0; i < aKeysLength; i++) {\n    const key = aKeys[i]\n    if (!(key in itemB)) {\n      patches.push({op: 'unset', path: path.concat(key)})\n    }\n  }\n\n  // Check for changed items\n  for (let i = 0; i < bKeysLength; i++) {\n    const key = bKeys[i]\n    diffItem(itemA[key], itemB[key], options, path.concat([key]), patches)\n  }\n\n  return patches\n}\n\nfunction diffArray(\n  itemA: unknown[],\n  itemB: unknown[],\n  options: DiffOptions,\n  path: Path,\n  patches: Patch[],\n) {\n  // Check for new items\n  if (itemB.length > itemA.length) {\n    patches.push({\n      op: 'insert',\n      after: path.concat([-1]),\n      items: itemB.slice(itemA.length).map((item, i) => nullifyUndefined(item, path, i, options)),\n    })\n  }\n\n  // Check for deleted items\n  if (itemB.length < itemA.length) {\n    const isSingle = itemA.length - itemB.length === 1\n    const unsetItems = itemA.slice(itemB.length)\n\n    // If we're revision locked, we can safely unset ranges (eg 5:<end-of-array>).\n    // Also, if we don't have unique array keys, we can't use any better approach\n    // than array indexes. If we _do_ have unique array keys, we'll want to unset\n    // by key, as this is safer in a realtime, collaborative setting\n    if (isRevisionLocked(options) || !isUniquelyKeyed(unsetItems)) {\n      patches.push({\n        op: 'unset',\n        path: path.concat([isSingle ? itemB.length : [itemB.length, '']]),\n      })\n    } else {\n      patches.push(\n        ...unsetItems.map(\n          (item): UnsetPatch => ({op: 'unset', path: path.concat({_key: item._key})}),\n        ),\n      )\n    }\n  }\n\n  // Check for illegal array contents\n  for (let i = 0; i < itemB.length; i++) {\n    if (Array.isArray(itemB[i])) {\n      throw new DiffError('Multi-dimensional arrays not supported', path.concat(i), itemB[i])\n    }\n  }\n\n  const overlapping = Math.min(itemA.length, itemB.length)\n  const segmentA = itemA.slice(0, overlapping)\n  const segmentB = itemB.slice(0, overlapping)\n\n  return isUniquelyKeyed(segmentA) && isUniquelyKeyed(segmentB)\n    ? diffArrayByKey(segmentA, segmentB, options, path, patches)\n    : diffArrayByIndex(segmentA, segmentB, options, path, patches)\n}\n\nfunction diffArrayByIndex(\n  itemA: unknown[],\n  itemB: unknown[],\n  options: DiffOptions,\n  path: Path,\n  patches: Patch[],\n) {\n  for (let i = 0; i < itemA.length; i++) {\n    diffItem(\n      itemA[i],\n      nullifyUndefined(itemB[i], path, i, options),\n      options,\n      path.concat(i),\n      patches,\n    )\n  }\n\n  return patches\n}\n\nfunction diffArrayByKey(\n  itemA: KeyedSanityObject[],\n  itemB: KeyedSanityObject[],\n  options: DiffOptions,\n  path: Path,\n  patches: Patch[],\n) {\n  const keyedA = indexByKey(itemA)\n  const keyedB = indexByKey(itemB)\n\n  // There's a bunch of hard/semi-hard problems related to using keys\n  // Unless we have the exact same order, just use indexes for now\n  if (!arrayIsEqual(keyedA.keys, keyedB.keys)) {\n    return diffArrayByIndex(itemA, itemB, options, path, patches)\n  }\n\n  for (let i = 0; i < keyedB.keys.length; i++) {\n    const key = keyedB.keys[i]\n    const valueA = keyedA.index[key]\n    const valueB = nullifyUndefined(keyedB.index[key], path, i, options)\n    diffItem(valueA, valueB, options, path.concat({_key: key}), patches)\n  }\n\n  return patches\n}\n\nfunction getDiffMatchPatch(\n  itemA: PrimitiveValue,\n  itemB: PrimitiveValue,\n  options: DiffOptions,\n  path: Path,\n): DiffMatchPatch | undefined {\n  const {enabled, lengthThresholdRelative, lengthThresholdAbsolute} = options.diffMatchPatch\n  const segment = path[path.length - 1]\n  if (\n    !enabled ||\n    // Don't use for anything but strings\n    typeof itemA !== 'string' ||\n    typeof itemB !== 'string' ||\n    // Don't use for `_key`, `_ref` etc\n    (typeof segment === 'string' && segment[0] === '_') ||\n    // Don't use on short strings\n    itemB.length < lengthThresholdAbsolute\n  ) {\n    return undefined\n  }\n\n  let strPatch = ''\n  try {\n    const patch = makeDiff(itemA, itemB)\n    const diff = cleanupEfficiency(patch)\n    strPatch = stringifyPatches(makePatches(diff))\n  } catch (err) {\n    // Fall back to using regular set patch\n    return undefined\n  }\n\n  // Don't use patch if it's longer than allowed relative threshold.\n  // Allow a 120 character patch for a 100 character string,\n  // but don't allow a 800 character patch for a 500 character value.\n  return strPatch.length > itemB.length * lengthThresholdRelative\n    ? undefined\n    : {op: 'diffMatchPatch', path, value: strPatch}\n}\n\nfunction diffPrimitive(\n  itemA: PrimitiveValue,\n  itemB: PrimitiveValue,\n  options: DiffOptions,\n  path: Path,\n  patches: Patch[],\n): Patch[] {\n  const dmp = getDiffMatchPatch(itemA, itemB, options, path)\n\n  patches.push(\n    dmp || {\n      op: 'set',\n      path,\n      value: itemB,\n    },\n  )\n\n  return patches\n}\n\nfunction isNotIgnoredKey(key: string) {\n  return ignoredKeys.indexOf(key) === -1\n}\n\nfunction serializePatches(\n  patches: Patch[],\n  options: {id: string; ifRevisionID?: string},\n): SanityPatchMutation[] {\n  if (patches.length === 0) {\n    return []\n  }\n\n  const {id, ifRevisionID} = options\n  const set = patches.filter((patch): patch is SetPatch => patch.op === 'set')\n  const unset = patches.filter((patch): patch is UnsetPatch => patch.op === 'unset')\n  const insert = patches.filter((patch): patch is InsertAfterPatch => patch.op === 'insert')\n  const dmp = patches.filter((patch): patch is DiffMatchPatch => patch.op === 'diffMatchPatch')\n\n  const withSet =\n    set.length > 0 &&\n    set.reduce(\n      (patch: SanitySetPatch, item: SetPatch) => {\n        const path = pathToString(item.path)\n        patch.set[path] = item.value\n        return patch\n      },\n      {id, set: {}},\n    )\n\n  const withUnset =\n    unset.length > 0 &&\n    unset.reduce(\n      (patch: SanityUnsetPatch, item: UnsetPatch) => {\n        const path = pathToString(item.path)\n        patch.unset.push(path)\n        return patch\n      },\n      {id, unset: []},\n    )\n\n  const withInsert = insert.reduce((acc: SanityInsertPatch[], item: InsertAfterPatch) => {\n    const after = pathToString(item.after)\n    return acc.concat({id, insert: {after, items: item.items}})\n  }, [])\n\n  const withDmp =\n    dmp.length > 0 &&\n    dmp.reduce(\n      (patch: SanityDiffMatchPatch, item: DiffMatchPatch) => {\n        const path = pathToString(item.path)\n        patch.diffMatchPatch[path] = item.value\n        return patch\n      },\n      {id, diffMatchPatch: {}},\n    )\n\n  const patchSet: SanityPatch[] = [withUnset, withSet, withDmp, ...withInsert].filter(\n    (item): item is SanityPatch => item !== false,\n  )\n\n  return patchSet.map((patch, i) => ({\n    patch: ifRevisionID && i === 0 ? {...patch, ifRevisionID} : patch,\n  }))\n}\n\nfunction isUniquelyKeyed(arr: unknown[]): arr is KeyedSanityObject[] {\n  const keys = []\n\n  for (let i = 0; i < arr.length; i++) {\n    const key = getKey(arr[i])\n    if (!key || keys.indexOf(key) !== -1) {\n      return false\n    }\n\n    keys.push(key)\n  }\n\n  return true\n}\n\nfunction getKey(obj: unknown) {\n  return typeof obj === 'object' && obj !== null && (obj as KeyedSanityObject)._key\n}\n\nfunction indexByKey(arr: KeyedSanityObject[]) {\n  return arr.reduce(\n    (acc, item) => {\n      acc.keys.push(item._key)\n      acc.index[item._key] = item\n      return acc\n    },\n    {keys: [] as string[], index: {} as {[key: string]: KeyedSanityObject}},\n  )\n}\n\nfunction arrayIsEqual(itemA: unknown[], itemB: unknown[]) {\n  return itemA.length === itemB.length && itemA.every((item, i) => itemB[i] === item)\n}\n\nfunction nullifyUndefined(item: unknown, path: Path, index: number, options: PatchOptions) {\n  if (typeof item !== 'undefined') {\n    return item\n  }\n\n  if (!options.hideWarnings) {\n    const serializedPath = pathToString(path.concat(index))\n    console.warn(`undefined value in array converted to null (at '${serializedPath}')`)\n  }\n\n  return null\n}\n\nfunction isRevisionLocked(options: PatchOptions): boolean {\n  return Boolean(options.ifRevisionID)\n}\n\nfunction yes(_: unknown) {\n  return true\n}\n"],"names":[],"mappings":"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","ignoreList":[0,1,2,3],"debugId":null}},
    {"offset": {"line": 11083, "column": 0}, "map": {"version":3,"file":"index.mjs","sources":["file:///Users/isseemii/app/letterseed/node_modules/%40sanity/vision/src/i18n/index.ts","file:///Users/isseemii/app/letterseed/node_modules/%40sanity/vision/src/visionTool.ts"],"sourcesContent":["import {defineLocaleResourceBundle} from 'sanity'\n\n/**\n * The locale namespace for the vision tool\n *\n * @internal\n */\nexport const visionLocaleNamespace = 'vision' as const\n\n/**\n * The default locale bundle for the vision tool, which is US English.\n *\n * @internal\n */\nexport const visionUsEnglishLocaleBundle = defineLocaleResourceBundle({\n  locale: 'en-US',\n  namespace: visionLocaleNamespace,\n  resources: () => import('./resources'),\n})\n","import {EyeOpenIcon} from '@sanity/icons'\nimport {lazy} from 'react'\nimport {definePlugin} from 'sanity'\nimport {route} from 'sanity/router'\n\nimport {visionUsEnglishLocaleBundle} from './i18n'\nimport {type VisionToolConfig} from './types'\n\nexport const visionTool = definePlugin<VisionToolConfig | void>((options) => {\n  const {name, title, icon, ...config} = options || {}\n  return {\n    name: '@sanity/vision',\n    tools: [\n      {\n        name: name || 'vision',\n        title: title || 'Vision',\n        icon: icon || EyeOpenIcon,\n        component: lazy(() => import('./SanityVision')),\n        options: config,\n        router: route.create('/*'),\n        __internalApplicationType: 'sanity/vision',\n      },\n    ],\n    i18n: {\n      bundles: [visionUsEnglishLocaleBundle],\n    },\n  }\n})\n"],"names":["visionLocaleNamespace","visionUsEnglishLocaleBundle","defineLocaleResourceBundle","locale","namespace","resources","visionTool","definePlugin","options","name","title","icon","config","tools","EyeOpenIcon","component","lazy","router","route","create","__internalApplicationType","i18n","bundles"],"mappings":";;;;;;;;;;;;AAOO,MAAMA,wBAAwB,UAOxBC,6LAA8BC,6BAAAA,EAA2B;IACpEC,QAAQ;IACRC,WAAWJ;IACXK,WAAWA,MAAM,OAAO,iBAAa;AACvC,CAAC,GCVYC,aAAaC,8KAAAA,EAAuCC,CAAAA,YAAY;IAC3E,MAAM,EAACC,IAAAA,EAAMC,KAAAA,EAAOC,IAAAA,EAAM,GAAGC,QAAAA,GAAUJ,WAAW,CAAA;IAClD,OAAO;QACLC,MAAM;QACNI,OAAO;YACL;gBACEJ,MAAMA,QAAQ;gBACdC,OAAOA,SAAS;gBAChBC,MAAMA,8JAAQG,cAAAA;gBACdC,6KAAWC,OAAAA,EAAK,MAAM,OAAO,oBAAgB,CAAC;gBAC9CR,SAASI;gBACTK,oKAAQC,QAAAA,CAAMC,MAAAA,CAAO,IAAI;gBACzBC,2BAA2B;YAAA,CAC5B;SAAA;QAEHC,MAAM;YACJC,SAAS;gBAACrB,2BAA2B;aAAA;QAAA;IACvC;AAEJ,CAAC","ignoreList":[0,1],"debugId":null}}]
}